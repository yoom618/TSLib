Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8275132179260254
Epoch: 1, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.582 Vali Acc: 0.417 Test Loss: 1.582 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 2.300274610519409
Epoch: 2, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.366 Vali Acc: 0.522 Test Loss: 1.366 Test Acc: 0.522
Validation loss decreased (-0.416651 --> -0.522209).  Saving model ...
Epoch: 3 cost time: 2.3601536750793457
Epoch: 3, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.644 Vali Acc: 0.728 Test Loss: 0.644 Test Acc: 0.728
Validation loss decreased (-0.522209 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 2.432321071624756
Epoch: 4, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.548 Vali Acc: 0.739 Test Loss: 0.548 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 2.4016284942626953
Epoch: 5, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.467 Vali Acc: 0.783 Test Loss: 0.467 Test Acc: 0.783
Validation loss decreased (-0.738883 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 2.2595090866088867
Epoch: 6, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 2.267393112182617
Epoch: 7, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.801 Vali Acc: 0.767 Test Loss: 0.801 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.288719654083252
Epoch: 8, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.491 Vali Acc: 0.794 Test Loss: 0.491 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.7799599170684814
Epoch: 9, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.358 Vali Acc: 0.817 Test Loss: 0.358 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 2.3495676517486572
Epoch: 10, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.376 Vali Acc: 0.833 Test Loss: 0.376 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 2.423699378967285
Epoch: 11, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.494 Vali Acc: 0.811 Test Loss: 0.494 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1594398021698
Epoch: 12, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 2.2043304443359375
Epoch: 13, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.514 Vali Acc: 0.811 Test Loss: 0.514 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7566823959350586
Epoch: 14, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3382632732391357
Epoch: 15, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.484 Vali Acc: 0.817 Test Loss: 0.484 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2955331802368164
Epoch: 16, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3918604850769043
Epoch: 17, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.489 Vali Acc: 0.800 Test Loss: 0.489 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9914286136627197
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.651 Vali Acc: 0.783 Test Loss: 0.651 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2570629119873047
Epoch: 19, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.782 Vali Acc: 0.806 Test Loss: 0.782 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.187074899673462
Epoch: 20, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3181660175323486
Epoch: 21, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 22 cost time: 2.4216384887695312
Epoch: 22, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0518758296966553
Epoch: 23, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.729 Vali Acc: 0.822 Test Loss: 0.729 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.229193925857544
Epoch: 24, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.458 Vali Acc: 0.839 Test Loss: 0.458 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.237178087234497
Epoch: 25, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9449641704559326
Epoch: 26, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.518 Vali Acc: 0.800 Test Loss: 0.518 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.696577787399292
Epoch: 27, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0803825855255127
Epoch: 28, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 2.2786006927490234
Epoch: 29, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3065688610076904
Epoch: 30, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.533 Vali Acc: 0.817 Test Loss: 0.533 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.4916231632232666
Epoch: 31, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.575 Vali Acc: 0.811 Test Loss: 0.575 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0860002040863037
Epoch: 32, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.3696603775024414
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.481 Vali Acc: 0.828 Test Loss: 0.481 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.319288492202759
Epoch: 34, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.701 Vali Acc: 0.833 Test Loss: 0.701 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.2682762145996094
Epoch: 35, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.0401735305786133
Epoch: 36, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.404 Vali Acc: 0.878 Test Loss: 0.404 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877774).  Saving model ...
Epoch: 37 cost time: 2.1798665523529053
Epoch: 37, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.855 Vali Acc: 0.850 Test Loss: 0.855 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.341285467147827
Epoch: 38, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.490 Vali Acc: 0.839 Test Loss: 0.490 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.090710163116455
Epoch: 39, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.401813268661499
Epoch: 40, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.252807140350342
Epoch: 41, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.269820213317871
Epoch: 42, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.3568363189697266
Epoch: 43, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.148585557937622
Epoch: 44, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.088862895965576
Epoch: 45, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.1283087730407715
Epoch: 46, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 14330178
model size : 59.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.275471448898315
Epoch: 1, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.529 Vali Acc: 0.544 Test Loss: 1.529 Test Acc: 0.544
Validation loss decreased (inf --> -0.544429).  Saving model ...
Epoch: 2 cost time: 2.406172037124634
Epoch: 2, Steps: 12 | Train Loss: 1.307 Vali Loss: 0.922 Vali Acc: 0.628 Test Loss: 0.922 Test Acc: 0.628
Validation loss decreased (-0.544429 --> -0.627769).  Saving model ...
Epoch: 3 cost time: 2.5858891010284424
Epoch: 3, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.721 Vali Acc: 0.611 Test Loss: 1.721 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1367456912994385
Epoch: 4, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.540 Vali Acc: 0.756 Test Loss: 0.540 Test Acc: 0.756
Validation loss decreased (-0.627769 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 2.928508996963501
Epoch: 5, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.473 Vali Acc: 0.761 Test Loss: 0.473 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 2.996572256088257
Epoch: 6, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.415 Vali Acc: 0.828 Test Loss: 0.415 Test Acc: 0.828
Validation loss decreased (-0.761106 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.5064635276794434
Epoch: 7, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 3.147891044616699
Epoch: 8, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.533 Vali Acc: 0.794 Test Loss: 0.533 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.34161376953125
Epoch: 9, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.328544855117798
Epoch: 10, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.411984920501709
Epoch: 11, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.433 Vali Acc: 0.844 Test Loss: 0.433 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.74712872505188
Epoch: 12, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.505615711212158
Epoch: 13, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.502 Vali Acc: 0.806 Test Loss: 0.502 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.781203269958496
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.423 Vali Acc: 0.828 Test Loss: 0.423 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.8264386653900146
Epoch: 15, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.34175181388855
Epoch: 16, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.473 Vali Acc: 0.828 Test Loss: 0.473 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.7050416469573975
Epoch: 17, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.498 Vali Acc: 0.806 Test Loss: 0.498 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 14327362
model size : 59.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.33312726020813
Epoch: 1, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.448 Vali Acc: 0.461 Test Loss: 1.448 Test Acc: 0.461
Validation loss decreased (inf --> -0.461097).  Saving model ...
Epoch: 2 cost time: 3.0569281578063965
Epoch: 2, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.015 Vali Acc: 0.644 Test Loss: 1.015 Test Acc: 0.644
Validation loss decreased (-0.461097 --> -0.644434).  Saving model ...
Epoch: 3 cost time: 2.657032012939453
Epoch: 3, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.648 Vali Acc: 0.700 Test Loss: 0.648 Test Acc: 0.700
Validation loss decreased (-0.644434 --> -0.699994).  Saving model ...
Epoch: 4 cost time: 2.4840774536132812
Epoch: 4, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.868 Vali Acc: 0.728 Test Loss: 0.868 Test Acc: 0.728
Validation loss decreased (-0.699994 --> -0.727769).  Saving model ...
Epoch: 5 cost time: 2.8003883361816406
Epoch: 5, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
Validation loss decreased (-0.727769 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 2.6361050605773926
Epoch: 6, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.505 Vali Acc: 0.761 Test Loss: 0.505 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8895206451416016
Epoch: 7, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.540 Vali Acc: 0.794 Test Loss: 0.540 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794439).  Saving model ...
Epoch: 8 cost time: 3.445582151412964
Epoch: 8, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.430 Vali Acc: 0.817 Test Loss: 0.430 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 9 cost time: 3.4129366874694824
Epoch: 9, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.394 Vali Acc: 0.811 Test Loss: 0.394 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3942039012908936
Epoch: 10, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.443 Vali Acc: 0.811 Test Loss: 0.443 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5243771076202393
Epoch: 11, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
Validation loss decreased (-0.816662 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 2.8386383056640625
Epoch: 12, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.452 Vali Acc: 0.817 Test Loss: 0.452 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1708667278289795
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.432 Vali Acc: 0.844 Test Loss: 0.432 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.03698992729187
Epoch: 14, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.556 Vali Acc: 0.817 Test Loss: 0.556 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3719446659088135
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.4627931118011475
Epoch: 16, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.986701726913452
Epoch: 17, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.149981737136841
Epoch: 18, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.536 Vali Acc: 0.817 Test Loss: 0.536 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.8379898071289062
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.454 Vali Acc: 0.828 Test Loss: 0.454 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.408825397491455
Epoch: 20, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.302788019180298
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.358 Vali Acc: 0.894 Test Loss: 0.358 Test Acc: 0.894
Validation loss decreased (-0.849997 --> -0.894441).  Saving model ...
Epoch: 22 cost time: 3.0078887939453125
Epoch: 22, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.404 Vali Acc: 0.844 Test Loss: 0.404 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.270169258117676
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.626542568206787
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3973283767700195
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.435 Vali Acc: 0.839 Test Loss: 0.435 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.8185036182403564
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.9682581424713135
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.865 Vali Acc: 0.806 Test Loss: 0.865 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.5256600379943848
Epoch: 28, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.574 Vali Acc: 0.811 Test Loss: 0.574 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.7478487491607666
Epoch: 29, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.562 Vali Acc: 0.817 Test Loss: 0.562 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.602250337600708
Epoch: 30, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.9079043865203857
Epoch: 31, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.700 Vali Acc: 0.811 Test Loss: 0.700 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 14324546
model size : 59.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.5161964893341064
Epoch: 1, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.458 Vali Acc: 0.344 Test Loss: 1.458 Test Acc: 0.344
Validation loss decreased (inf --> -0.344430).  Saving model ...
Epoch: 2 cost time: 2.856840133666992
Epoch: 2, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.298 Vali Acc: 0.517 Test Loss: 1.298 Test Acc: 0.517
Validation loss decreased (-0.344430 --> -0.516654).  Saving model ...
Epoch: 3 cost time: 2.8522660732269287
Epoch: 3, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.651 Vali Acc: 0.706 Test Loss: 0.651 Test Acc: 0.706
Validation loss decreased (-0.516654 --> -0.705549).  Saving model ...
Epoch: 4 cost time: 2.614299774169922
Epoch: 4, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.701 Vali Acc: 0.717 Test Loss: 0.701 Test Acc: 0.717
Validation loss decreased (-0.705549 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 2.6843838691711426
Epoch: 5, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.494 Vali Acc: 0.800 Test Loss: 0.494 Test Acc: 0.800
Validation loss decreased (-0.716660 --> -0.799995).  Saving model ...
Epoch: 6 cost time: 2.7170748710632324
Epoch: 6, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.442 Vali Acc: 0.783 Test Loss: 0.442 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.664701223373413
Epoch: 7, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.375 Vali Acc: 0.833 Test Loss: 0.375 Test Acc: 0.833
Validation loss decreased (-0.799995 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 2.682644844055176
Epoch: 8, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.668086051940918
Epoch: 9, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7064342498779297
Epoch: 10, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0058815479278564
Epoch: 11, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.483 Vali Acc: 0.817 Test Loss: 0.483 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0322225093841553
Epoch: 12, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.455 Vali Acc: 0.828 Test Loss: 0.455 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3356258869171143
Epoch: 13, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.419 Vali Acc: 0.817 Test Loss: 0.419 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.929349422454834
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 2.4116876125335693
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.505 Vali Acc: 0.800 Test Loss: 0.505 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7978250980377197
Epoch: 16, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.512 Vali Acc: 0.817 Test Loss: 0.512 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.409306764602661
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4066321849823
Epoch: 18, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.508 Vali Acc: 0.800 Test Loss: 0.508 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.402585029602051
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2189342975616455
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.570 Vali Acc: 0.800 Test Loss: 0.570 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3612759113311768
Epoch: 21, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.655 Vali Acc: 0.794 Test Loss: 0.655 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0385963916778564
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 2.9028918743133545
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.715 Vali Acc: 0.822 Test Loss: 0.715 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9664528369903564
Epoch: 24, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.003016710281372
Epoch: 25, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.710 Vali Acc: 0.794 Test Loss: 0.710 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.0289251804351807
Epoch: 26, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.422 Vali Acc: 0.861 Test Loss: 0.422 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 27 cost time: 3.2671432495117188
Epoch: 27, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.548 Vali Acc: 0.811 Test Loss: 0.548 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.297367811203003
Epoch: 28, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8836615085601807
Epoch: 29, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.484 Vali Acc: 0.839 Test Loss: 0.484 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.9131810665130615
Epoch: 30, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.903374671936035
Epoch: 31, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.719 Vali Acc: 0.767 Test Loss: 0.719 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.2330265045166016
Epoch: 32, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.638 Vali Acc: 0.800 Test Loss: 0.638 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.0727195739746094
Epoch: 33, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.335866689682007
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.7932162284851074
Epoch: 35, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.021 Vali Acc: 0.794 Test Loss: 1.021 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.1260931491851807
Epoch: 36, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.784 Vali Acc: 0.789 Test Loss: 0.784 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 14321730
model size : 59.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.566787242889404
Epoch: 1, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.536 Vali Acc: 0.522 Test Loss: 1.536 Test Acc: 0.522
Validation loss decreased (inf --> -0.522207).  Saving model ...
Epoch: 2 cost time: 3.1054389476776123
Epoch: 2, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.327 Vali Acc: 0.394 Test Loss: 1.327 Test Acc: 0.394
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.990466356277466
Epoch: 3, Steps: 12 | Train Loss: 0.920 Vali Loss: 0.793 Vali Acc: 0.678 Test Loss: 0.793 Test Acc: 0.678
Validation loss decreased (-0.522207 --> -0.677770).  Saving model ...
Epoch: 4 cost time: 2.6604983806610107
Epoch: 4, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.597 Vali Acc: 0.739 Test Loss: 0.597 Test Acc: 0.739
Validation loss decreased (-0.677770 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 2.8338851928710938
Epoch: 5, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.493 Vali Acc: 0.767 Test Loss: 0.493 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 3.1187517642974854
Epoch: 6, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3133656978607178
Epoch: 7, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.383 Vali Acc: 0.822 Test Loss: 0.383 Test Acc: 0.822
Validation loss decreased (-0.766662 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 3.4473307132720947
Epoch: 8, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8197031021118164
Epoch: 9, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 3.0082080364227295
Epoch: 10, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.478 Vali Acc: 0.806 Test Loss: 0.478 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3644707202911377
Epoch: 11, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844440).  Saving model ...
Epoch: 12 cost time: 3.2543458938598633
Epoch: 12, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.554 Vali Acc: 0.800 Test Loss: 0.554 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.272545337677002
Epoch: 13, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.605 Vali Acc: 0.794 Test Loss: 0.605 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8630261421203613
Epoch: 14, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 3.426201105117798
Epoch: 15, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.482151508331299
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.530 Vali Acc: 0.817 Test Loss: 0.530 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.608748435974121
Epoch: 17, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.514 Vali Acc: 0.811 Test Loss: 0.514 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1387531757354736
Epoch: 18, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.542534351348877
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.484477996826172
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.410 Vali Acc: 0.839 Test Loss: 0.410 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9343154430389404
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.943812847137451
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 2.887446641921997
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.362 Vali Acc: 0.856 Test Loss: 0.362 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.115192174911499
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.419 Vali Acc: 0.839 Test Loss: 0.419 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6507768630981445
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.450 Vali Acc: 0.856 Test Loss: 0.450 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.1189441680908203
Epoch: 26, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.442 Vali Acc: 0.839 Test Loss: 0.442 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.297959804534912
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.653 Vali Acc: 0.822 Test Loss: 0.653 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.5968542098999023
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.406 Vali Acc: 0.867 Test Loss: 0.406 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.0899617671966553
Epoch: 29, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.0125677585601807
Epoch: 30, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.550006151199341
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.928635835647583
Epoch: 32, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.005 Vali Acc: 0.761 Test Loss: 1.005 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 11966274
model size : 50.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.526894807815552
Epoch: 1, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.544 Vali Acc: 0.511 Test Loss: 1.544 Test Acc: 0.511
Validation loss decreased (inf --> -0.511096).  Saving model ...
Epoch: 2 cost time: 2.5464069843292236
Epoch: 2, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.254 Vali Acc: 0.517 Test Loss: 1.254 Test Acc: 0.517
Validation loss decreased (-0.511096 --> -0.516654).  Saving model ...
Epoch: 3 cost time: 3.1705482006073
Epoch: 3, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.642 Vali Acc: 0.728 Test Loss: 0.642 Test Acc: 0.728
Validation loss decreased (-0.516654 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 3.5725512504577637
Epoch: 4, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.588 Vali Acc: 0.739 Test Loss: 0.588 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 2.7558960914611816
Epoch: 5, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.537 Vali Acc: 0.772 Test Loss: 0.537 Test Acc: 0.772
Validation loss decreased (-0.738883 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 2.7700729370117188
Epoch: 6, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.404 Vali Acc: 0.789 Test Loss: 0.404 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788885).  Saving model ...
Epoch: 7 cost time: 3.400691032409668
Epoch: 7, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.481 Vali Acc: 0.811 Test Loss: 0.481 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811106).  Saving model ...
Epoch: 8 cost time: 3.4021244049072266
Epoch: 8, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.375 Vali Acc: 0.811 Test Loss: 0.375 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 3.324857711791992
Epoch: 9, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 2.860504627227783
Epoch: 10, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.427 Vali Acc: 0.794 Test Loss: 0.427 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6137759685516357
Epoch: 11, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.359 Vali Acc: 0.833 Test Loss: 0.359 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.227064609527588
Epoch: 12, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.083284854888916
Epoch: 13, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.430 Vali Acc: 0.839 Test Loss: 0.430 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0339901447296143
Epoch: 14, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.026024103164673
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.390 Vali Acc: 0.828 Test Loss: 0.390 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8680498600006104
Epoch: 16, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.383 Vali Acc: 0.839 Test Loss: 0.383 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.4292614459991455
Epoch: 17, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 3.1736674308776855
Epoch: 18, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 19 cost time: 3.1065480709075928
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 20 cost time: 2.941040277481079
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9579577445983887
Epoch: 21, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.485 Vali Acc: 0.839 Test Loss: 0.485 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.381169557571411
Epoch: 22, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.446460485458374
Epoch: 23, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.126983642578125
Epoch: 24, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.7397773265838623
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.778 Vali Acc: 0.806 Test Loss: 0.778 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.4729862213134766
Epoch: 26, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.553 Vali Acc: 0.811 Test Loss: 0.553 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.2829277515411377
Epoch: 27, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.0232503414154053
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.473 Vali Acc: 0.861 Test Loss: 0.473 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.0843892097473145
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.406 Vali Acc: 0.878 Test Loss: 0.406 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 30 cost time: 3.080099105834961
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1838455200195312
Epoch: 31, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.354 Vali Acc: 0.878 Test Loss: 0.354 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 32 cost time: 3.2094922065734863
Epoch: 32, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.1133525371551514
Epoch: 33, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.9517321586608887
Epoch: 34, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.659327745437622
Epoch: 35, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.693 Vali Acc: 0.806 Test Loss: 0.693 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.835069179534912
Epoch: 36, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.867 Vali Acc: 0.806 Test Loss: 0.867 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.03346848487854
Epoch: 37, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.9860777854919434
Epoch: 38, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.741 Vali Acc: 0.839 Test Loss: 0.741 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.030294418334961
Epoch: 39, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.081160306930542
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.100994110107422
Epoch: 41, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 11963458
model size : 50.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.477982997894287
Epoch: 1, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.618 Vali Acc: 0.289 Test Loss: 1.618 Test Acc: 0.289
Validation loss decreased (inf --> -0.288873).  Saving model ...
Epoch: 2 cost time: 3.108222246170044
Epoch: 2, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.267 Vali Acc: 0.583 Test Loss: 1.267 Test Acc: 0.583
Validation loss decreased (-0.288873 --> -0.583321).  Saving model ...
Epoch: 3 cost time: 2.6064882278442383
Epoch: 3, Steps: 12 | Train Loss: 1.066 Vali Loss: 0.720 Vali Acc: 0.678 Test Loss: 0.720 Test Acc: 0.678
Validation loss decreased (-0.583321 --> -0.677771).  Saving model ...
Epoch: 4 cost time: 2.8567612171173096
Epoch: 4, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.709 Vali Acc: 0.728 Test Loss: 0.709 Test Acc: 0.728
Validation loss decreased (-0.677771 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 3.0861399173736572
Epoch: 5, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 2.7666890621185303
Epoch: 6, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.513 Vali Acc: 0.767 Test Loss: 0.513 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 3.4784629344940186
Epoch: 7, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.808 Vali Acc: 0.789 Test Loss: 0.808 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788881).  Saving model ...
Epoch: 8 cost time: 3.3335113525390625
Epoch: 8, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.588 Vali Acc: 0.767 Test Loss: 0.588 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1451473236083984
Epoch: 9, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 3.0207347869873047
Epoch: 10, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
Validation loss decreased (-0.788884 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 3.424649477005005
Epoch: 11, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.397 Vali Acc: 0.822 Test Loss: 0.397 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3395352363586426
Epoch: 12, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.515 Vali Acc: 0.800 Test Loss: 0.515 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7722976207733154
Epoch: 13, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.608 Vali Acc: 0.794 Test Loss: 0.608 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.2504653930664062
Epoch: 14, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7928626537323
Epoch: 15, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.734539270401001
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8265364170074463
Epoch: 17, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.428 Vali Acc: 0.828 Test Loss: 0.428 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0604357719421387
Epoch: 18, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.421 Vali Acc: 0.822 Test Loss: 0.421 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.517289876937866
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8278727531433105
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.392 Vali Acc: 0.839 Test Loss: 0.392 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 11960642
model size : 50.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.534390926361084
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.533 Vali Acc: 0.406 Test Loss: 1.533 Test Acc: 0.406
Validation loss decreased (inf --> -0.405540).  Saving model ...
Epoch: 2 cost time: 3.087752342224121
Epoch: 2, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.188 Vali Acc: 0.478 Test Loss: 1.188 Test Acc: 0.478
Validation loss decreased (-0.405540 --> -0.477766).  Saving model ...
Epoch: 3 cost time: 3.1378281116485596
Epoch: 3, Steps: 12 | Train Loss: 1.069 Vali Loss: 0.755 Vali Acc: 0.650 Test Loss: 0.755 Test Acc: 0.650
Validation loss decreased (-0.477766 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 3.1055195331573486
Epoch: 4, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.826 Vali Acc: 0.672 Test Loss: 0.826 Test Acc: 0.672
Validation loss decreased (-0.649992 --> -0.672214).  Saving model ...
Epoch: 5 cost time: 3.239790916442871
Epoch: 5, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.484 Vali Acc: 0.756 Test Loss: 0.484 Test Acc: 0.756
Validation loss decreased (-0.672214 --> -0.755551).  Saving model ...
Epoch: 6 cost time: 2.9564449787139893
Epoch: 6, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.501 Vali Acc: 0.772 Test Loss: 0.501 Test Acc: 0.772
Validation loss decreased (-0.755551 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 2.8505961894989014
Epoch: 7, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.480 Vali Acc: 0.817 Test Loss: 0.480 Test Acc: 0.817
Validation loss decreased (-0.772217 --> -0.816662).  Saving model ...
Epoch: 8 cost time: 2.7937870025634766
Epoch: 8, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.454 Vali Acc: 0.817 Test Loss: 0.454 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 9 cost time: 2.6262056827545166
Epoch: 9, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 2.856163263320923
Epoch: 10, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8928418159484863
Epoch: 11, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.422 Vali Acc: 0.800 Test Loss: 0.422 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8526973724365234
Epoch: 12, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.441 Vali Acc: 0.828 Test Loss: 0.441 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.213941812515259
Epoch: 13, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.689 Vali Acc: 0.789 Test Loss: 0.689 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0382752418518066
Epoch: 14, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.055455446243286
Epoch: 15, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7854766845703125
Epoch: 16, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.652 Vali Acc: 0.794 Test Loss: 0.652 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5892629623413086
Epoch: 17, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.409 Vali Acc: 0.844 Test Loss: 0.409 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 18 cost time: 2.9402270317077637
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.359 Vali Acc: 0.856 Test Loss: 0.359 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 2.432180166244507
Epoch: 19, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.385 Vali Acc: 0.839 Test Loss: 0.385 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0430045127868652
Epoch: 20, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.737 Vali Acc: 0.811 Test Loss: 0.737 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5042660236358643
Epoch: 21, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.353 Vali Acc: 0.872 Test Loss: 0.353 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 2.8748233318328857
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.965637445449829
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.720 Vali Acc: 0.789 Test Loss: 0.720 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.905759811401367
Epoch: 24, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3328120708465576
Epoch: 25, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.1304056644439697
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1119489669799805
Epoch: 27, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.5241029262542725
Epoch: 28, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.8162713050842285
Epoch: 29, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.08119535446167
Epoch: 30, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.572 Vali Acc: 0.817 Test Loss: 0.572 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.4399771690368652
Epoch: 31, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 11957826
model size : 50.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.735943555831909
Epoch: 1, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.600 Vali Acc: 0.356 Test Loss: 1.600 Test Acc: 0.356
Validation loss decreased (inf --> -0.355540).  Saving model ...
Epoch: 2 cost time: 2.599407911300659
Epoch: 2, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.111 Vali Acc: 0.572 Test Loss: 1.111 Test Acc: 0.572
Validation loss decreased (-0.355540 --> -0.572211).  Saving model ...
Epoch: 3 cost time: 3.430093765258789
Epoch: 3, Steps: 12 | Train Loss: 0.923 Vali Loss: 0.649 Vali Acc: 0.728 Test Loss: 0.649 Test Acc: 0.728
Validation loss decreased (-0.572211 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 2.8047425746917725
Epoch: 4, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.772 Vali Acc: 0.700 Test Loss: 0.772 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.24045991897583
Epoch: 5, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.597 Vali Acc: 0.756 Test Loss: 0.597 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 3.064032793045044
Epoch: 6, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.463 Vali Acc: 0.783 Test Loss: 0.463 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 2.5774080753326416
Epoch: 7, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.511 Vali Acc: 0.800 Test Loss: 0.511 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 3.5237221717834473
Epoch: 8, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.457 Vali Acc: 0.817 Test Loss: 0.457 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816662).  Saving model ...
Epoch: 9 cost time: 3.626283884048462
Epoch: 9, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
Validation loss decreased (-0.816662 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 3.0259737968444824
Epoch: 10, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872220).  Saving model ...
Epoch: 11 cost time: 2.922637462615967
Epoch: 11, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.840649127960205
Epoch: 12, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.759296417236328
Epoch: 13, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7676808834075928
Epoch: 14, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.928643226623535
Epoch: 15, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7161788940429688
Epoch: 16, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.699 Vali Acc: 0.817 Test Loss: 0.699 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4919958114624023
Epoch: 17, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.878253936767578
Epoch: 18, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.434 Vali Acc: 0.833 Test Loss: 0.434 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.9412693977355957
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.379 Vali Acc: 0.856 Test Loss: 0.379 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2022712230682373
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 10784322
model size : 46.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.230183124542236
Epoch: 1, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.779 Vali Acc: 0.194 Test Loss: 1.779 Test Acc: 0.194
Validation loss decreased (inf --> -0.194427).  Saving model ...
Epoch: 2 cost time: 3.3750669956207275
Epoch: 2, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.335 Vali Acc: 0.539 Test Loss: 1.335 Test Acc: 0.539
Validation loss decreased (-0.194427 --> -0.538876).  Saving model ...
Epoch: 3 cost time: 2.6967642307281494
Epoch: 3, Steps: 12 | Train Loss: 0.975 Vali Loss: 0.882 Vali Acc: 0.600 Test Loss: 0.882 Test Acc: 0.600
Validation loss decreased (-0.538876 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 2.990884780883789
Epoch: 4, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.744 Vali Acc: 0.761 Test Loss: 0.744 Test Acc: 0.761
Validation loss decreased (-0.599991 --> -0.761104).  Saving model ...
Epoch: 5 cost time: 3.265077590942383
Epoch: 5, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.466 Vali Acc: 0.767 Test Loss: 0.466 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 3.3542628288269043
Epoch: 6, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.510 Vali Acc: 0.794 Test Loss: 0.510 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794439).  Saving model ...
Epoch: 7 cost time: 2.8708460330963135
Epoch: 7, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.507 Vali Acc: 0.794 Test Loss: 0.507 Test Acc: 0.794
Validation loss decreased (-0.794439 --> -0.794439).  Saving model ...
Epoch: 8 cost time: 3.652132511138916
Epoch: 8, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.398 Vali Acc: 0.817 Test Loss: 0.398 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816663).  Saving model ...
Epoch: 9 cost time: 3.2119667530059814
Epoch: 9, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 3.127006769180298
Epoch: 10, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 3.249178647994995
Epoch: 11, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1001062393188477
Epoch: 12, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.438 Vali Acc: 0.817 Test Loss: 0.438 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9659042358398438
Epoch: 13, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.483 Vali Acc: 0.806 Test Loss: 0.483 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5301055908203125
Epoch: 14, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 2.35404372215271
Epoch: 15, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.928 Vali Acc: 0.800 Test Loss: 0.928 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.525576591491699
Epoch: 16, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7716476917266846
Epoch: 17, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.035249948501587
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.380 Vali Acc: 0.867 Test Loss: 0.380 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 19 cost time: 2.6842098236083984
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7690818309783936
Epoch: 20, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.560 Vali Acc: 0.811 Test Loss: 0.560 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.196040153503418
Epoch: 21, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4122157096862793
Epoch: 22, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.488 Vali Acc: 0.806 Test Loss: 0.488 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.170701503753662
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.676 Vali Acc: 0.811 Test Loss: 0.676 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7711236476898193
Epoch: 24, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.669 Vali Acc: 0.806 Test Loss: 0.669 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.952549934387207
Epoch: 25, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.8273580074310303
Epoch: 26, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.3558201789855957
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.361 Vali Acc: 0.856 Test Loss: 0.361 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.3568644523620605
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.659 Vali Acc: 0.811 Test Loss: 0.659 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 10781506
model size : 46.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.592535018920898
Epoch: 1, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.632 Vali Acc: 0.372 Test Loss: 1.632 Test Acc: 0.372
Validation loss decreased (inf --> -0.372206).  Saving model ...
Epoch: 2 cost time: 2.9720873832702637
Epoch: 2, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.113 Vali Acc: 0.567 Test Loss: 1.113 Test Acc: 0.567
Validation loss decreased (-0.372206 --> -0.566656).  Saving model ...
Epoch: 3 cost time: 1.9188032150268555
Epoch: 3, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.682 Vali Acc: 0.711 Test Loss: 0.682 Test Acc: 0.711
Validation loss decreased (-0.566656 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 2.5118112564086914
Epoch: 4, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.706 Vali Acc: 0.672 Test Loss: 0.706 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.20249080657959
Epoch: 5, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.488 Vali Acc: 0.767 Test Loss: 0.488 Test Acc: 0.767
Validation loss decreased (-0.711104 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 2.9290740489959717
Epoch: 6, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.363 Vali Acc: 0.811 Test Loss: 0.363 Test Acc: 0.811
Validation loss decreased (-0.766662 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 2.6504878997802734
Epoch: 7, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.549 Vali Acc: 0.778 Test Loss: 0.549 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.958637237548828
Epoch: 8, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.578 Vali Acc: 0.794 Test Loss: 0.578 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3175413608551025
Epoch: 9, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.495 Vali Acc: 0.794 Test Loss: 0.495 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.249476194381714
Epoch: 10, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.587 Vali Acc: 0.772 Test Loss: 0.587 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3119027614593506
Epoch: 11, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.439 Vali Acc: 0.822 Test Loss: 0.439 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 3.03279709815979
Epoch: 12, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.338 Vali Acc: 0.850 Test Loss: 0.338 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 3.2913646697998047
Epoch: 13, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.534 Vali Acc: 0.817 Test Loss: 0.534 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1486732959747314
Epoch: 14, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.372 Vali Acc: 0.839 Test Loss: 0.372 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9583871364593506
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.128774642944336
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 2.727987289428711
Epoch: 17, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.414 Vali Acc: 0.844 Test Loss: 0.414 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.470048666000366
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.704896926879883
Epoch: 19, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.382 Vali Acc: 0.867 Test Loss: 0.382 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 20 cost time: 2.9343671798706055
Epoch: 20, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.035484790802002
Epoch: 21, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.384 Vali Acc: 0.856 Test Loss: 0.384 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.834272861480713
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9693541526794434
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.86026668548584
Epoch: 24, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.562 Vali Acc: 0.817 Test Loss: 0.562 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7227604389190674
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 26 cost time: 2.2438743114471436
Epoch: 26, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0695009231567383
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.489758014678955
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.408 Vali Acc: 0.878 Test Loss: 0.408 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.669989585876465
Epoch: 29, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.805781602859497
Epoch: 30, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.492 Vali Acc: 0.878 Test Loss: 0.492 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.72037410736084
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.7094547748565674
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.8045661449432373
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.1464648246765137
Epoch: 34, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.034320116043091
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.419 Vali Acc: 0.878 Test Loss: 0.419 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 10778690
model size : 46.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.349683523178101
Epoch: 1, Steps: 12 | Train Loss: 1.946 Vali Loss: 1.649 Vali Acc: 0.367 Test Loss: 1.649 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 2.87131667137146
Epoch: 2, Steps: 12 | Train Loss: 1.578 Vali Loss: 1.456 Vali Acc: 0.306 Test Loss: 1.456 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1186203956604004
Epoch: 3, Steps: 12 | Train Loss: 0.996 Vali Loss: 0.748 Vali Acc: 0.694 Test Loss: 0.748 Test Acc: 0.694
Validation loss decreased (-0.366650 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 2.9994101524353027
Epoch: 4, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.592 Vali Acc: 0.711 Test Loss: 0.592 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711105).  Saving model ...
Epoch: 5 cost time: 3.3562183380126953
Epoch: 5, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
Validation loss decreased (-0.711105 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 2.940746545791626
Epoch: 6, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.398 Vali Acc: 0.806 Test Loss: 0.398 Test Acc: 0.806
Validation loss decreased (-0.722216 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 3.4130825996398926
Epoch: 7, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.402 Vali Acc: 0.783 Test Loss: 0.402 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.66304349899292
Epoch: 8, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.404 Vali Acc: 0.828 Test Loss: 0.404 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 2.7951483726501465
Epoch: 9, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.503 Vali Acc: 0.806 Test Loss: 0.503 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.507780075073242
Epoch: 10, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 3.273524761199951
Epoch: 11, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 2.613628625869751
Epoch: 12, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.439 Vali Acc: 0.822 Test Loss: 0.439 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.21962308883667
Epoch: 13, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.487 Vali Acc: 0.839 Test Loss: 0.487 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838884).  Saving model ...
Epoch: 14 cost time: 2.923487901687622
Epoch: 14, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.527 Vali Acc: 0.800 Test Loss: 0.527 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.262826681137085
Epoch: 15, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.640 Vali Acc: 0.817 Test Loss: 0.640 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5735628604888916
Epoch: 16, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.454 Vali Acc: 0.872 Test Loss: 0.454 Test Acc: 0.872
Validation loss decreased (-0.838884 --> -0.872218).  Saving model ...
Epoch: 17 cost time: 3.0561134815216064
Epoch: 17, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.92169189453125
Epoch: 18, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.393 Vali Acc: 0.844 Test Loss: 0.393 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2010655403137207
Epoch: 19, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.861 Vali Acc: 0.767 Test Loss: 0.861 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0084965229034424
Epoch: 20, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.7466394901275635
Epoch: 21, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.1171071529388428
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.534111976623535
Epoch: 23, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.622 Vali Acc: 0.778 Test Loss: 0.622 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.588970899581909
Epoch: 24, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.820720672607422
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4703707695007324
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.476 Vali Acc: 0.828 Test Loss: 0.476 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 10775874
model size : 46.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.75302791595459
Epoch: 1, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.682 Vali Acc: 0.272 Test Loss: 1.682 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 2.6448943614959717
Epoch: 2, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.320 Vali Acc: 0.389 Test Loss: 1.320 Test Acc: 0.389
Validation loss decreased (-0.272205 --> -0.388876).  Saving model ...
Epoch: 3 cost time: 3.228393793106079
Epoch: 3, Steps: 12 | Train Loss: 0.949 Vali Loss: 0.811 Vali Acc: 0.744 Test Loss: 0.811 Test Acc: 0.744
Validation loss decreased (-0.388876 --> -0.744436).  Saving model ...
Epoch: 4 cost time: 2.7401885986328125
Epoch: 4, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.521 Vali Acc: 0.772 Test Loss: 0.521 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 2.903559923171997
Epoch: 5, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.438 Vali Acc: 0.806 Test Loss: 0.438 Test Acc: 0.806
Validation loss decreased (-0.772217 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 2.67224383354187
Epoch: 6, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.483 Vali Acc: 0.789 Test Loss: 0.483 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.696305751800537
Epoch: 7, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.412 Vali Acc: 0.794 Test Loss: 0.412 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1098551750183105
Epoch: 8, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.454 Vali Acc: 0.839 Test Loss: 0.454 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838884).  Saving model ...
Epoch: 9 cost time: 2.912696361541748
Epoch: 9, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.421 Vali Acc: 0.839 Test Loss: 0.421 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 2.8468236923217773
Epoch: 10, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.976 Vali Acc: 0.794 Test Loss: 0.976 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6605019569396973
Epoch: 11, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.832422971725464
Epoch: 12, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.368 Vali Acc: 0.856 Test Loss: 0.368 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 2.7227885723114014
Epoch: 13, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4467051029205322
Epoch: 14, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 2.8941586017608643
Epoch: 15, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.442 Vali Acc: 0.839 Test Loss: 0.442 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.869520664215088
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6786692142486572
Epoch: 17, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.330 Vali Acc: 0.856 Test Loss: 0.330 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8534646034240723
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.054488182067871
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1753292083740234
Epoch: 20, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.391 Vali Acc: 0.867 Test Loss: 0.391 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 21 cost time: 2.6661596298217773
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.530 Vali Acc: 0.806 Test Loss: 0.530 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9978559017181396
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.700444221496582
Epoch: 23, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1167001724243164
Epoch: 24, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6111972332000732
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5727052688598633
Epoch: 26, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7124228477478027
Epoch: 27, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.728 Vali Acc: 0.839 Test Loss: 0.728 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.409773826599121
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.539 Vali Acc: 0.861 Test Loss: 0.539 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.812883138656616
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.0235402584075928
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 3.110361099243164
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4490113258361816
Epoch: 32, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.6060941219329834
Epoch: 33, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.5691964626312256
Epoch: 34, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.555819034576416
Epoch: 35, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.633 Vali Acc: 0.839 Test Loss: 0.633 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.948080539703369
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.8551011085510254
Epoch: 37, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.400 Vali Acc: 0.878 Test Loss: 0.400 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 38 cost time: 2.6150524616241455
Epoch: 38, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.931245803833008
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.623823881149292
Epoch: 40, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.477 Vali Acc: 0.878 Test Loss: 0.477 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.725691795349121
Epoch: 41, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.715 Vali Acc: 0.811 Test Loss: 0.715 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.7706034183502197
Epoch: 42, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.847 Vali Acc: 0.850 Test Loss: 0.847 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.8689467906951904
Epoch: 43, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.965461015701294
Epoch: 44, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.573 Vali Acc: 0.883 Test Loss: 0.573 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883328).  Saving model ...
Epoch: 45 cost time: 2.5232203006744385
Epoch: 45, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.797 Vali Acc: 0.822 Test Loss: 0.797 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.786139488220215
Epoch: 46, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.671 Vali Acc: 0.839 Test Loss: 0.671 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.7979562282562256
Epoch: 47, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.792 Vali Acc: 0.817 Test Loss: 0.792 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.003694772720337
Epoch: 48, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.7359113693237305
Epoch: 49, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.533 Vali Acc: 0.878 Test Loss: 0.533 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.9836621284484863
Epoch: 50, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.955817461013794
Epoch: 51, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.615 Vali Acc: 0.889 Test Loss: 0.615 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 52 cost time: 2.979015350341797
Epoch: 52, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.489 Vali Acc: 0.883 Test Loss: 0.489 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.899453639984131
Epoch: 53, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.999 Vali Acc: 0.844 Test Loss: 0.999 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.8469760417938232
Epoch: 54, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.9217989444732666
Epoch: 55, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.731 Vali Acc: 0.833 Test Loss: 0.731 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.724834442138672
Epoch: 56, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.702 Vali Acc: 0.839 Test Loss: 0.702 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.8460187911987305
Epoch: 57, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.639 Vali Acc: 0.878 Test Loss: 0.639 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 2.9131932258605957
Epoch: 58, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.499 Vali Acc: 0.828 Test Loss: 0.499 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.793111801147461
Epoch: 59, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.647 Vali Acc: 0.867 Test Loss: 0.647 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 2.8369741439819336
Epoch: 60, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.755464792251587
Epoch: 61, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 10193346
model size : 43.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.174092769622803
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.925 Vali Acc: 0.300 Test Loss: 1.925 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 2.5738182067871094
Epoch: 2, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.045 Vali Acc: 0.711 Test Loss: 1.045 Test Acc: 0.711
Validation loss decreased (-0.299981 --> -0.711101).  Saving model ...
Epoch: 3 cost time: 2.298919916152954
Epoch: 3, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.776 Vali Acc: 0.683 Test Loss: 0.776 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.669146776199341
Epoch: 4, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.621 Vali Acc: 0.706 Test Loss: 0.621 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6863346099853516
Epoch: 5, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.449 Vali Acc: 0.778 Test Loss: 0.449 Test Acc: 0.778
Validation loss decreased (-0.711101 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 2.764627695083618
Epoch: 6, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.422 Vali Acc: 0.800 Test Loss: 0.422 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 2.726139545440674
Epoch: 7, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
Validation loss decreased (-0.799996 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.8318238258361816
Epoch: 8, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.569 Vali Acc: 0.806 Test Loss: 0.569 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0708417892456055
Epoch: 9, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 2.4235148429870605
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 2.804582357406616
Epoch: 11, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5996596813201904
Epoch: 12, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.354 Vali Acc: 0.844 Test Loss: 0.354 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.526179075241089
Epoch: 13, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.535 Vali Acc: 0.800 Test Loss: 0.535 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.745727062225342
Epoch: 14, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.358 Vali Acc: 0.839 Test Loss: 0.358 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.444340705871582
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.367 Vali Acc: 0.861 Test Loss: 0.367 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.5729711055755615
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0248336791992188
Epoch: 17, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.820939540863037
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.412 Vali Acc: 0.867 Test Loss: 0.412 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 19 cost time: 3.1765475273132324
Epoch: 19, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.366 Vali Acc: 0.856 Test Loss: 0.366 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1896567344665527
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.727 Vali Acc: 0.794 Test Loss: 0.727 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.214080572128296
Epoch: 21, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.0346546173095703
Epoch: 22, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.505 Vali Acc: 0.817 Test Loss: 0.505 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1775474548339844
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.996328115463257
Epoch: 24, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.289391040802002
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.408 Vali Acc: 0.878 Test Loss: 0.408 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 26 cost time: 3.2153615951538086
Epoch: 26, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.114086866378784
Epoch: 27, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.497 Vali Acc: 0.861 Test Loss: 0.497 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.447326898574829
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.0476768016815186
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.516 Vali Acc: 0.839 Test Loss: 0.516 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.864955186843872
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.0239131450653076
Epoch: 31, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.5931594371795654
Epoch: 32, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.7212111949920654
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.760 Vali Acc: 0.828 Test Loss: 0.760 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.5939958095550537
Epoch: 34, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.673882484436035
Epoch: 35, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.750 Vali Acc: 0.822 Test Loss: 0.750 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 10190530
model size : 43.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.1800854206085205
Epoch: 1, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.657 Vali Acc: 0.239 Test Loss: 1.657 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 2.897484540939331
Epoch: 2, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.034 Vali Acc: 0.583 Test Loss: 1.034 Test Acc: 0.583
Validation loss decreased (-0.238872 --> -0.583323).  Saving model ...
Epoch: 3 cost time: 3.1541755199432373
Epoch: 3, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.639 Vali Acc: 0.739 Test Loss: 0.639 Test Acc: 0.739
Validation loss decreased (-0.583323 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 2.9479901790618896
Epoch: 4, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.552 Vali Acc: 0.728 Test Loss: 0.552 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.551403760910034
Epoch: 5, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.617 Vali Acc: 0.750 Test Loss: 0.617 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 2.959688425064087
Epoch: 6, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.541 Vali Acc: 0.817 Test Loss: 0.541 Test Acc: 0.817
Validation loss decreased (-0.749994 --> -0.816661).  Saving model ...
Epoch: 7 cost time: 2.5176360607147217
Epoch: 7, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.671 Vali Acc: 0.800 Test Loss: 0.671 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1697635650634766
Epoch: 8, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.368 Vali Acc: 0.833 Test Loss: 0.368 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 2.810757637023926
Epoch: 9, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.76346755027771
Epoch: 10, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.402 Vali Acc: 0.844 Test Loss: 0.402 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844440).  Saving model ...
Epoch: 11 cost time: 2.8636703491210938
Epoch: 11, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
Validation loss decreased (-0.844440 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 2.465062379837036
Epoch: 12, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.406 Vali Acc: 0.844 Test Loss: 0.406 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6099843978881836
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.371 Vali Acc: 0.856 Test Loss: 0.371 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6405248641967773
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8494889736175537
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 2.7082056999206543
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.560 Vali Acc: 0.817 Test Loss: 0.560 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.804560899734497
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.635 Vali Acc: 0.794 Test Loss: 0.635 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.879870653152466
Epoch: 18, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6332361698150635
Epoch: 19, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.376 Vali Acc: 0.878 Test Loss: 0.376 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 2.413876533508301
Epoch: 20, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.373 Vali Acc: 0.867 Test Loss: 0.373 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.370497703552246
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.834954023361206
Epoch: 22, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.994 Vali Acc: 0.817 Test Loss: 0.994 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.7769038677215576
Epoch: 23, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.433678388595581
Epoch: 24, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.605 Vali Acc: 0.806 Test Loss: 0.605 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7287425994873047
Epoch: 25, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.493 Vali Acc: 0.839 Test Loss: 0.493 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.78332781791687
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.425 Vali Acc: 0.872 Test Loss: 0.425 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5096545219421387
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.817838191986084
Epoch: 28, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.918 Vali Acc: 0.811 Test Loss: 0.918 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.5035147666931152
Epoch: 29, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.409 Vali Acc: 0.861 Test Loss: 0.409 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 10187714
model size : 43.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.803467273712158
Epoch: 1, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.552 Vali Acc: 0.456 Test Loss: 1.552 Test Acc: 0.456
Validation loss decreased (inf --> -0.455540).  Saving model ...
Epoch: 2 cost time: 2.6277272701263428
Epoch: 2, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.246 Vali Acc: 0.711 Test Loss: 1.246 Test Acc: 0.711
Validation loss decreased (-0.455540 --> -0.711099).  Saving model ...
Epoch: 3 cost time: 2.476663827896118
Epoch: 3, Steps: 12 | Train Loss: 0.987 Vali Loss: 0.795 Vali Acc: 0.644 Test Loss: 0.795 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5758256912231445
Epoch: 4, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.750 Vali Acc: 0.689 Test Loss: 0.750 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6113901138305664
Epoch: 5, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.451 Vali Acc: 0.778 Test Loss: 0.451 Test Acc: 0.778
Validation loss decreased (-0.711099 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 2.789381742477417
Epoch: 6, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.421 Vali Acc: 0.811 Test Loss: 0.421 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 2.4845948219299316
Epoch: 7, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.438 Vali Acc: 0.800 Test Loss: 0.438 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.357862710952759
Epoch: 8, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.512 Vali Acc: 0.761 Test Loss: 0.512 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6926445960998535
Epoch: 9, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
Validation loss decreased (-0.811107 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 2.4436709880828857
Epoch: 10, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.396 Vali Acc: 0.844 Test Loss: 0.396 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2865400314331055
Epoch: 11, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.585 Vali Acc: 0.811 Test Loss: 0.585 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5389981269836426
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.420 Vali Acc: 0.828 Test Loss: 0.420 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.382889986038208
Epoch: 13, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.374 Vali Acc: 0.844 Test Loss: 0.374 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7008121013641357
Epoch: 14, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.517861843109131
Epoch: 15, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.732 Vali Acc: 0.789 Test Loss: 0.732 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3988261222839355
Epoch: 16, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.559722423553467
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.285313367843628
Epoch: 18, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.564 Vali Acc: 0.794 Test Loss: 0.564 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1761109828948975
Epoch: 19, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.466 Vali Acc: 0.822 Test Loss: 0.466 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 10184898
model size : 43.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.726335048675537
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.772 Vali Acc: 0.267 Test Loss: 1.772 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 2.9242188930511475
Epoch: 2, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.399 Vali Acc: 0.539 Test Loss: 1.399 Test Acc: 0.539
Validation loss decreased (-0.266649 --> -0.538875).  Saving model ...
Epoch: 3 cost time: 2.6368765830993652
Epoch: 3, Steps: 12 | Train Loss: 1.243 Vali Loss: 0.995 Vali Acc: 0.611 Test Loss: 0.995 Test Acc: 0.611
Validation loss decreased (-0.538875 --> -0.611101).  Saving model ...
Epoch: 4 cost time: 2.699352264404297
Epoch: 4, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.691 Vali Acc: 0.733 Test Loss: 0.691 Test Acc: 0.733
Validation loss decreased (-0.611101 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 2.7839536666870117
Epoch: 5, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.561 Vali Acc: 0.767 Test Loss: 0.561 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 2.633605718612671
Epoch: 6, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.584 Vali Acc: 0.767 Test Loss: 0.584 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0375616550445557
Epoch: 7, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
Validation loss decreased (-0.766661 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 2.849713087081909
Epoch: 8, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.469 Vali Acc: 0.794 Test Loss: 0.469 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.396914482116699
Epoch: 9, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5965054035186768
Epoch: 10, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.83191180229187
Epoch: 11, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883331).  Saving model ...
Epoch: 12 cost time: 2.3365089893341064
Epoch: 12, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.618262767791748
Epoch: 13, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3759825229644775
Epoch: 14, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6234819889068604
Epoch: 15, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5238728523254395
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.382 Vali Acc: 0.839 Test Loss: 0.382 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.5125741958618164
Epoch: 17, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.444 Vali Acc: 0.822 Test Loss: 0.444 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6637074947357178
Epoch: 18, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6179087162017822
Epoch: 19, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6307501792907715
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.372 Vali Acc: 0.872 Test Loss: 0.372 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.3730857372283936
Epoch: 21, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 4810434
model size : 20.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.765820264816284
Epoch: 1, Steps: 12 | Train Loss: 1.956 Vali Loss: 1.814 Vali Acc: 0.228 Test Loss: 1.814 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 2.962144136428833
Epoch: 2, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.436 Vali Acc: 0.389 Test Loss: 1.436 Test Acc: 0.389
Validation loss decreased (-0.227760 --> -0.388875).  Saving model ...
Epoch: 3 cost time: 3.130976676940918
Epoch: 3, Steps: 12 | Train Loss: 1.231 Vali Loss: 0.995 Vali Acc: 0.617 Test Loss: 0.995 Test Acc: 0.617
Validation loss decreased (-0.388875 --> -0.616657).  Saving model ...
Epoch: 4 cost time: 2.522304058074951
Epoch: 4, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.661 Vali Acc: 0.706 Test Loss: 0.661 Test Acc: 0.706
Validation loss decreased (-0.616657 --> -0.705549).  Saving model ...
Epoch: 5 cost time: 3.1759233474731445
Epoch: 5, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.772 Vali Acc: 0.694 Test Loss: 0.772 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1024558544158936
Epoch: 6, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.529 Vali Acc: 0.744 Test Loss: 0.529 Test Acc: 0.744
Validation loss decreased (-0.705549 --> -0.744439).  Saving model ...
Epoch: 7 cost time: 2.120708465576172
Epoch: 7, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
Validation loss decreased (-0.744439 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.6786844730377197
Epoch: 8, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.509 Vali Acc: 0.778 Test Loss: 0.509 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4247310161590576
Epoch: 9, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.455 Vali Acc: 0.800 Test Loss: 0.455 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 1.8845865726470947
Epoch: 10, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822219).  Saving model ...
Epoch: 11 cost time: 1.8249022960662842
Epoch: 11, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 2.1203856468200684
Epoch: 12, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 2.465585231781006
Epoch: 13, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5975632667541504
Epoch: 14, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.359 Vali Acc: 0.817 Test Loss: 0.359 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.440243721008301
Epoch: 15, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.978029489517212
Epoch: 16, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.421 Vali Acc: 0.817 Test Loss: 0.421 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.972689628601074
Epoch: 17, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8063552379608154
Epoch: 18, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.431 Vali Acc: 0.794 Test Loss: 0.431 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9418015480041504
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5124857425689697
Epoch: 20, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.801 Vali Acc: 0.761 Test Loss: 0.801 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5171589851379395
Epoch: 21, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.387 Vali Acc: 0.839 Test Loss: 0.387 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.914600133895874
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.397 Vali Acc: 0.828 Test Loss: 0.397 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 4809026
model size : 20.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.217782020568848
Epoch: 1, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.708 Vali Acc: 0.222 Test Loss: 1.708 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 2.9775733947753906
Epoch: 2, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.324 Vali Acc: 0.544 Test Loss: 1.324 Test Acc: 0.544
Validation loss decreased (-0.222205 --> -0.544431).  Saving model ...
Epoch: 3 cost time: 2.9718966484069824
Epoch: 3, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.035 Vali Acc: 0.556 Test Loss: 1.035 Test Acc: 0.556
Validation loss decreased (-0.544431 --> -0.555545).  Saving model ...
Epoch: 4 cost time: 2.3426058292388916
Epoch: 4, Steps: 12 | Train Loss: 0.820 Vali Loss: 0.676 Vali Acc: 0.678 Test Loss: 0.676 Test Acc: 0.678
Validation loss decreased (-0.555545 --> -0.677771).  Saving model ...
Epoch: 5 cost time: 2.4745607376098633
Epoch: 5, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.504 Vali Acc: 0.778 Test Loss: 0.504 Test Acc: 0.778
Validation loss decreased (-0.677771 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 3.0863869190216064
Epoch: 6, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.478 Vali Acc: 0.772 Test Loss: 0.478 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9940149784088135
Epoch: 7, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.448 Vali Acc: 0.794 Test Loss: 0.448 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 1.975965976715088
Epoch: 8, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
Validation loss decreased (-0.794440 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 2.5902020931243896
Epoch: 9, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2309858798980713
Epoch: 10, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.425 Vali Acc: 0.811 Test Loss: 0.425 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2859060764312744
Epoch: 11, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.451 Vali Acc: 0.828 Test Loss: 0.451 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2102572917938232
Epoch: 12, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.458 Vali Acc: 0.822 Test Loss: 0.458 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5345699787139893
Epoch: 13, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.470 Vali Acc: 0.800 Test Loss: 0.470 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.902499198913574
Epoch: 14, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 2.4522078037261963
Epoch: 15, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 2.674208879470825
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0900495052337646
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.483 Vali Acc: 0.817 Test Loss: 0.483 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6522860527038574
Epoch: 18, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.369 Vali Acc: 0.839 Test Loss: 0.369 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7649686336517334
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.411 Vali Acc: 0.800 Test Loss: 0.411 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2775402069091797
Epoch: 20, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.8559868335723877
Epoch: 21, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7469077110290527
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5866618156433105
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 24 cost time: 3.1003305912017822
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.786848783493042
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8293652534484863
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.967310905456543
Epoch: 27, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.539 Vali Acc: 0.811 Test Loss: 0.539 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.2005529403686523
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883329).  Saving model ...
Epoch: 29 cost time: 2.9879913330078125
Epoch: 29, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.415 Vali Acc: 0.883 Test Loss: 0.415 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6411595344543457
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.820845365524292
Epoch: 31, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.385 Vali Acc: 0.872 Test Loss: 0.385 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.013902425765991
Epoch: 32, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 33 cost time: 2.6699888706207275
Epoch: 33, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8946001529693604
Epoch: 34, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.8064029216766357
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.343 Vali Acc: 0.867 Test Loss: 0.343 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.8456413745880127
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.9208908081054688
Epoch: 37, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.7085623741149902
Epoch: 38, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905553).  Saving model ...
Epoch: 39 cost time: 2.447409152984619
Epoch: 39, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.865321636199951
Epoch: 40, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.572 Vali Acc: 0.817 Test Loss: 0.572 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.106992483139038
Epoch: 41, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.1171224117279053
Epoch: 42, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.4724929332733154
Epoch: 43, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.455 Vali Acc: 0.861 Test Loss: 0.455 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.75810170173645
Epoch: 44, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.520007371902466
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.624 Vali Acc: 0.817 Test Loss: 0.624 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.850101947784424
Epoch: 46, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.460 Vali Acc: 0.867 Test Loss: 0.460 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.4261817932128906
Epoch: 47, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.32417368888855
Epoch: 48, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.435 Vali Acc: 0.856 Test Loss: 0.435 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 4807618
model size : 20.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.708832502365112
Epoch: 1, Steps: 12 | Train Loss: 1.896 Vali Loss: 1.716 Vali Acc: 0.328 Test Loss: 1.716 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 2.817689895629883
Epoch: 2, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.389 Vali Acc: 0.328 Test Loss: 1.389 Test Acc: 0.328
Validation loss decreased (-0.327761 --> -0.327764).  Saving model ...
Epoch: 3 cost time: 2.6939327716827393
Epoch: 3, Steps: 12 | Train Loss: 1.166 Vali Loss: 0.892 Vali Acc: 0.600 Test Loss: 0.892 Test Acc: 0.600
Validation loss decreased (-0.327764 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 2.6139864921569824
Epoch: 4, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.809 Vali Acc: 0.611 Test Loss: 0.809 Test Acc: 0.611
Validation loss decreased (-0.599991 --> -0.611103).  Saving model ...
Epoch: 5 cost time: 2.6369709968566895
Epoch: 5, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
Validation loss decreased (-0.611103 --> -0.716661).  Saving model ...
Epoch: 6 cost time: 2.811711311340332
Epoch: 6, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.461 Vali Acc: 0.778 Test Loss: 0.461 Test Acc: 0.778
Validation loss decreased (-0.716661 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 2.6774678230285645
Epoch: 7, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
Validation loss decreased (-0.777773 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 2.90769362449646
Epoch: 8, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 3.192821741104126
Epoch: 9, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 2.6232008934020996
Epoch: 10, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.397 Vali Acc: 0.833 Test Loss: 0.397 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.616452693939209
Epoch: 11, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.967663049697876
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.493363380432129
Epoch: 13, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.522068500518799
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 3.017566442489624
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.384 Vali Acc: 0.856 Test Loss: 0.384 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9470608234405518
Epoch: 16, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.590 Vali Acc: 0.761 Test Loss: 0.590 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6741652488708496
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.9856009483337402
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.458 Vali Acc: 0.806 Test Loss: 0.458 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0214459896087646
Epoch: 19, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.378 Vali Acc: 0.833 Test Loss: 0.378 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6110644340515137
Epoch: 20, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.307 Vali Acc: 0.833 Test Loss: 0.307 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9010884761810303
Epoch: 21, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.83329439163208
Epoch: 22, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.189741849899292
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.427164077758789
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 4806210
model size : 20.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.201256275177002
Epoch: 1, Steps: 12 | Train Loss: 1.898 Vali Loss: 1.742 Vali Acc: 0.167 Test Loss: 1.742 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 2.651784896850586
Epoch: 2, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.404 Vali Acc: 0.483 Test Loss: 1.404 Test Acc: 0.483
Validation loss decreased (-0.166649 --> -0.483319).  Saving model ...
Epoch: 3 cost time: 2.8479669094085693
Epoch: 3, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.144 Vali Acc: 0.494 Test Loss: 1.144 Test Acc: 0.494
Validation loss decreased (-0.483319 --> -0.494433).  Saving model ...
Epoch: 4 cost time: 2.8540425300598145
Epoch: 4, Steps: 12 | Train Loss: 0.911 Vali Loss: 0.726 Vali Acc: 0.694 Test Loss: 0.726 Test Acc: 0.694
Validation loss decreased (-0.494433 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 3.0793819427490234
Epoch: 5, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.542 Vali Acc: 0.761 Test Loss: 0.542 Test Acc: 0.761
Validation loss decreased (-0.694437 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 2.7464888095855713
Epoch: 6, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8979737758636475
Epoch: 7, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.457 Vali Acc: 0.783 Test Loss: 0.457 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 2.646721601486206
Epoch: 8, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.385 Vali Acc: 0.828 Test Loss: 0.385 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 2.822161912918091
Epoch: 9, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
Validation loss decreased (-0.827774 --> -0.866663).  Saving model ...
Epoch: 10 cost time: 2.8832638263702393
Epoch: 10, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.368 Vali Acc: 0.828 Test Loss: 0.368 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.474229097366333
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.90152645111084
Epoch: 12, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9188339710235596
Epoch: 13, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.412 Vali Acc: 0.806 Test Loss: 0.412 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6372382640838623
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4654734134674072
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.440 Vali Acc: 0.822 Test Loss: 0.440 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1125054359436035
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2970311641693115
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 18 cost time: 2.339282512664795
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.424 Vali Acc: 0.828 Test Loss: 0.424 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.467849016189575
Epoch: 19, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 20 cost time: 2.741393566131592
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8784704208374023
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.782233953475952
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.794124126434326
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.471853256225586
Epoch: 24, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.817084550857544
Epoch: 25, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.398 Vali Acc: 0.844 Test Loss: 0.398 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.692141532897949
Epoch: 26, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.561 Vali Acc: 0.828 Test Loss: 0.561 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.0226266384124756
Epoch: 27, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.9216372966766357
Epoch: 28, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.342 Vali Acc: 0.872 Test Loss: 0.342 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.925631046295166
Epoch: 29, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.437 Vali Acc: 0.872 Test Loss: 0.437 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 3626178
model size : 16.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.521951198577881
Epoch: 1, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.663 Vali Acc: 0.417 Test Loss: 1.663 Test Acc: 0.417
Validation loss decreased (inf --> -0.416650).  Saving model ...
Epoch: 2 cost time: 2.73532772064209
Epoch: 2, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.363 Vali Acc: 0.572 Test Loss: 1.363 Test Acc: 0.572
Validation loss decreased (-0.416650 --> -0.572209).  Saving model ...
Epoch: 3 cost time: 2.5958640575408936
Epoch: 3, Steps: 12 | Train Loss: 1.201 Vali Loss: 0.911 Vali Acc: 0.667 Test Loss: 0.911 Test Acc: 0.667
Validation loss decreased (-0.572209 --> -0.666658).  Saving model ...
Epoch: 4 cost time: 2.733506441116333
Epoch: 4, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.773 Vali Acc: 0.644 Test Loss: 0.773 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7033731937408447
Epoch: 5, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.796 Vali Acc: 0.644 Test Loss: 0.796 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1164581775665283
Epoch: 6, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
Validation loss decreased (-0.666658 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 2.916281223297119
Epoch: 7, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.418 Vali Acc: 0.794 Test Loss: 0.418 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.775813579559326
Epoch: 8, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
Validation loss decreased (-0.794440 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 2.5284292697906494
Epoch: 9, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7346606254577637
Epoch: 10, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5865674018859863
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4296305179595947
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 2.8297951221466064
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 2.767942428588867
Epoch: 14, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.567004442214966
Epoch: 15, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6200613975524902
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 2.8439009189605713
Epoch: 17, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.377 Vali Acc: 0.806 Test Loss: 0.377 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7595126628875732
Epoch: 18, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.444 Vali Acc: 0.844 Test Loss: 0.444 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7458341121673584
Epoch: 19, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2600889205932617
Epoch: 20, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.167952060699463
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.418781280517578
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.338 Vali Acc: 0.878 Test Loss: 0.338 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.1218249797821045
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.842698574066162
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.566408634185791
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.801788568496704
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 3624770
model size : 16.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.569392919540405
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.663 Vali Acc: 0.261 Test Loss: 1.663 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 2.3725709915161133
Epoch: 2, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
Validation loss decreased (-0.261094 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 2.400195360183716
Epoch: 3, Steps: 12 | Train Loss: 1.107 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 2.6786420345306396
Epoch: 4, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.731 Vali Acc: 0.689 Test Loss: 0.731 Test Acc: 0.689
Validation loss decreased (-0.599990 --> -0.688882).  Saving model ...
Epoch: 5 cost time: 3.035872220993042
Epoch: 5, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.614 Vali Acc: 0.689 Test Loss: 0.614 Test Acc: 0.689
Validation loss decreased (-0.688882 --> -0.688883).  Saving model ...
Epoch: 6 cost time: 2.543445587158203
Epoch: 6, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.504 Vali Acc: 0.761 Test Loss: 0.504 Test Acc: 0.761
Validation loss decreased (-0.688883 --> -0.761106).  Saving model ...
Epoch: 7 cost time: 2.8591482639312744
Epoch: 7, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.442 Vali Acc: 0.783 Test Loss: 0.442 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 2.71521258354187
Epoch: 8, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.388 Vali Acc: 0.828 Test Loss: 0.388 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 2.249523639678955
Epoch: 9, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.378 Vali Acc: 0.833 Test Loss: 0.378 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.325866222381592
Epoch: 10, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.379 Vali Acc: 0.839 Test Loss: 0.379 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 2.0865578651428223
Epoch: 11, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 2.4000227451324463
Epoch: 12, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.513 Vali Acc: 0.817 Test Loss: 0.513 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5534589290618896
Epoch: 13, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.593057870864868
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.364 Vali Acc: 0.844 Test Loss: 0.364 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8790109157562256
Epoch: 15, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.807281255722046
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0014114379882812
Epoch: 17, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6438567638397217
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 2.41827130317688
Epoch: 19, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.512 Vali Acc: 0.806 Test Loss: 0.512 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3128459453582764
Epoch: 20, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.522 Vali Acc: 0.811 Test Loss: 0.522 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3582983016967773
Epoch: 21, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.388 Vali Acc: 0.844 Test Loss: 0.388 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7481882572174072
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.7355363368988037
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.317011594772339
Epoch: 24, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.420 Vali Acc: 0.861 Test Loss: 0.420 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 25 cost time: 2.7720539569854736
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.398 Vali Acc: 0.867 Test Loss: 0.398 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 26 cost time: 2.8858184814453125
Epoch: 26, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.470 Vali Acc: 0.822 Test Loss: 0.470 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7255377769470215
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.491 Vali Acc: 0.811 Test Loss: 0.491 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.6937310695648193
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.806 Vali Acc: 0.794 Test Loss: 0.806 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.030834197998047
Epoch: 29, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.460 Vali Acc: 0.839 Test Loss: 0.460 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.5594217777252197
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.8277735710144043
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.488 Vali Acc: 0.861 Test Loss: 0.488 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.5826008319854736
Epoch: 32, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.359 Vali Acc: 0.883 Test Loss: 0.359 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 33 cost time: 2.7412009239196777
Epoch: 33, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.422 Vali Acc: 0.856 Test Loss: 0.422 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.5060973167419434
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.586264133453369
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.355 Vali Acc: 0.872 Test Loss: 0.355 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.664107322692871
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.370 Vali Acc: 0.856 Test Loss: 0.370 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.7409651279449463
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.405 Vali Acc: 0.856 Test Loss: 0.405 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.9806268215179443
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.379 Vali Acc: 0.867 Test Loss: 0.379 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.7725183963775635
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.6136350631713867
Epoch: 40, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.6720707416534424
Epoch: 41, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.441 Vali Acc: 0.856 Test Loss: 0.441 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.7340619564056396
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.469 Vali Acc: 0.828 Test Loss: 0.469 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 3623362
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.208222389221191
Epoch: 1, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.739 Vali Acc: 0.178 Test Loss: 1.739 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 2.5297398567199707
Epoch: 2, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.499 Vali Acc: 0.367 Test Loss: 1.499 Test Acc: 0.367
Validation loss decreased (-0.177760 --> -0.366652).  Saving model ...
Epoch: 3 cost time: 2.462212562561035
Epoch: 3, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
Validation loss decreased (-0.366652 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 2.796023368835449
Epoch: 4, Steps: 12 | Train Loss: 1.009 Vali Loss: 0.855 Vali Acc: 0.644 Test Loss: 0.855 Test Acc: 0.644
Validation loss decreased (-0.466655 --> -0.644436).  Saving model ...
Epoch: 5 cost time: 2.377814531326294
Epoch: 5, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.694 Vali Acc: 0.661 Test Loss: 0.694 Test Acc: 0.661
Validation loss decreased (-0.644436 --> -0.661104).  Saving model ...
Epoch: 6 cost time: 2.619253158569336
Epoch: 6, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.542 Vali Acc: 0.739 Test Loss: 0.542 Test Acc: 0.739
Validation loss decreased (-0.661104 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 2.940929412841797
Epoch: 7, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.440 Vali Acc: 0.806 Test Loss: 0.440 Test Acc: 0.806
Validation loss decreased (-0.738883 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 2.0493924617767334
Epoch: 8, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
Validation loss decreased (-0.805551 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 2.1210615634918213
Epoch: 9, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4139833450317383
Epoch: 10, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6224799156188965
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.446126937866211
Epoch: 12, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.358 Vali Acc: 0.817 Test Loss: 0.358 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.329706907272339
Epoch: 13, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2537362575531006
Epoch: 14, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.333 Vali Acc: 0.806 Test Loss: 0.333 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4898533821105957
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.437 Vali Acc: 0.828 Test Loss: 0.437 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.480191469192505
Epoch: 16, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.481171131134033
Epoch: 17, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.625929355621338
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 3621954
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.015482425689697
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.668 Vali Acc: 0.311 Test Loss: 1.668 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 2.5669877529144287
Epoch: 2, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.341 Vali Acc: 0.561 Test Loss: 1.341 Test Acc: 0.561
Validation loss decreased (-0.311094 --> -0.561098).  Saving model ...
Epoch: 3 cost time: 2.283820867538452
Epoch: 3, Steps: 12 | Train Loss: 1.186 Vali Loss: 0.924 Vali Acc: 0.594 Test Loss: 0.924 Test Acc: 0.594
Validation loss decreased (-0.561098 --> -0.594435).  Saving model ...
Epoch: 4 cost time: 2.1677331924438477
Epoch: 4, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.794 Vali Acc: 0.622 Test Loss: 0.794 Test Acc: 0.622
Validation loss decreased (-0.594435 --> -0.622214).  Saving model ...
Epoch: 5 cost time: 2.096015453338623
Epoch: 5, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
Validation loss decreased (-0.622214 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 2.189476490020752
Epoch: 6, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.577 Vali Acc: 0.739 Test Loss: 0.577 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7001166343688965
Epoch: 7, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.494 Vali Acc: 0.800 Test Loss: 0.494 Test Acc: 0.800
Validation loss decreased (-0.755550 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 3.403017282485962
Epoch: 8, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.403 Vali Acc: 0.789 Test Loss: 0.403 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.024777412414551
Epoch: 9, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
Validation loss decreased (-0.799995 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 2.3453495502471924
Epoch: 10, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.619 Vali Acc: 0.794 Test Loss: 0.619 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.574044704437256
Epoch: 11, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.371838092803955
Epoch: 12, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.498 Vali Acc: 0.806 Test Loss: 0.498 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.203413963317871
Epoch: 13, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.66007661819458
Epoch: 14, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 2.7112348079681396
Epoch: 15, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.609377384185791
Epoch: 16, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.389 Vali Acc: 0.817 Test Loss: 0.389 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.035933256149292
Epoch: 17, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.883481025695801
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.386 Vali Acc: 0.856 Test Loss: 0.386 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.810337781906128
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3944056034088135
Epoch: 20, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3037517070770264
Epoch: 21, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.441 Vali Acc: 0.828 Test Loss: 0.441 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.513514995574951
Epoch: 22, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.6800007820129395
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 24 cost time: 2.6475396156311035
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 2.62186861038208
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.862072467803955
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.898171901702881
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.735703468322754
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.391 Vali Acc: 0.872 Test Loss: 0.391 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.818310499191284
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 2.5785696506500244
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.415 Vali Acc: 0.844 Test Loss: 0.415 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.7309443950653076
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.374 Vali Acc: 0.867 Test Loss: 0.374 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.566467761993408
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.398 Vali Acc: 0.878 Test Loss: 0.398 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.6629831790924072
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.376 Vali Acc: 0.883 Test Loss: 0.376 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.653424024581909
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.479 Vali Acc: 0.883 Test Loss: 0.479 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.5313408374786377
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.642146587371826
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.368 Vali Acc: 0.878 Test Loss: 0.368 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.9231202602386475
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.412 Vali Acc: 0.844 Test Loss: 0.412 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.700427293777466
Epoch: 38, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.399 Vali Acc: 0.872 Test Loss: 0.399 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.8855884075164795
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3034050
model size : 14.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.709944009780884
Epoch: 1, Steps: 12 | Train Loss: 1.850 Vali Loss: 1.727 Vali Acc: 0.328 Test Loss: 1.727 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 2.400979995727539
Epoch: 2, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.496 Vali Acc: 0.444 Test Loss: 1.496 Test Acc: 0.444
Validation loss decreased (-0.327761 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 2.5026028156280518
Epoch: 3, Steps: 12 | Train Loss: 1.413 Vali Loss: 1.168 Vali Acc: 0.633 Test Loss: 1.168 Test Acc: 0.633
Validation loss decreased (-0.444429 --> -0.633322).  Saving model ...
Epoch: 4 cost time: 2.619825601577759
Epoch: 4, Steps: 12 | Train Loss: 1.044 Vali Loss: 0.851 Vali Acc: 0.600 Test Loss: 0.851 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9108777046203613
Epoch: 5, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.698 Vali Acc: 0.733 Test Loss: 0.698 Test Acc: 0.733
Validation loss decreased (-0.633322 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 2.7062172889709473
Epoch: 6, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.542 Vali Acc: 0.733 Test Loss: 0.542 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733328).  Saving model ...
Epoch: 7 cost time: 3.0005104541778564
Epoch: 7, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.407 Vali Acc: 0.806 Test Loss: 0.407 Test Acc: 0.806
Validation loss decreased (-0.733328 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 2.763150453567505
Epoch: 8, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.383 Vali Acc: 0.844 Test Loss: 0.383 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 2.680067777633667
Epoch: 9, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.746695041656494
Epoch: 10, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4304795265197754
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.323324203491211
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 2.007261037826538
Epoch: 13, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.421 Vali Acc: 0.817 Test Loss: 0.421 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1114187240600586
Epoch: 14, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3560776710510254
Epoch: 15, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.460 Vali Acc: 0.806 Test Loss: 0.460 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.161306142807007
Epoch: 16, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.362 Vali Acc: 0.844 Test Loss: 0.362 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0765132904052734
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.513 Vali Acc: 0.811 Test Loss: 0.513 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4552619457244873
Epoch: 18, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 2.4110207557678223
Epoch: 19, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 20 cost time: 2.708944797515869
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 2.3964545726776123
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888885).  Saving model ...
Epoch: 22 cost time: 2.5680642127990723
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9193708896636963
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.349743127822876
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.757591485977173
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.403 Vali Acc: 0.828 Test Loss: 0.403 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5546505451202393
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.6086249351501465
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.431 Vali Acc: 0.839 Test Loss: 0.431 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.449584484100342
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.761481523513794
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.675860643386841
Epoch: 30, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 2.3821654319763184
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.391 Vali Acc: 0.844 Test Loss: 0.391 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3329639434814453
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.091425657272339
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.2967209815979004
Epoch: 34, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9330787658691406
Epoch: 35, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.6495742797851562
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.1346864700317383
Epoch: 37, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.54964017868042
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.056270122528076
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.375 Vali Acc: 0.872 Test Loss: 0.375 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.464658498764038
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 3032642
model size : 14.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.658278226852417
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.790 Vali Acc: 0.283 Test Loss: 1.790 Test Acc: 0.283
Validation loss decreased (inf --> -0.283315).  Saving model ...
Epoch: 2 cost time: 3.00901460647583
Epoch: 2, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.523 Vali Acc: 0.528 Test Loss: 1.523 Test Acc: 0.528
Validation loss decreased (-0.283315 --> -0.527763).  Saving model ...
Epoch: 3 cost time: 2.556303024291992
Epoch: 3, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.172 Vali Acc: 0.683 Test Loss: 1.172 Test Acc: 0.683
Validation loss decreased (-0.527763 --> -0.683322).  Saving model ...
Epoch: 4 cost time: 2.6523056030273438
Epoch: 4, Steps: 12 | Train Loss: 1.016 Vali Loss: 0.828 Vali Acc: 0.650 Test Loss: 0.828 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6767096519470215
Epoch: 5, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.567 Vali Acc: 0.772 Test Loss: 0.567 Test Acc: 0.772
Validation loss decreased (-0.683322 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 2.585096836090088
Epoch: 6, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.454 Vali Acc: 0.800 Test Loss: 0.454 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 2.888601303100586
Epoch: 7, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 2.539177417755127
Epoch: 8, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.454 Vali Acc: 0.789 Test Loss: 0.454 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5709068775177
Epoch: 9, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.393 Vali Acc: 0.817 Test Loss: 0.393 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 2.2752811908721924
Epoch: 10, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.674 Vali Acc: 0.794 Test Loss: 0.674 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6131997108459473
Epoch: 11, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 12 cost time: 2.4535975456237793
Epoch: 12, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.480 Vali Acc: 0.828 Test Loss: 0.480 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827773).  Saving model ...
Epoch: 13 cost time: 2.912177562713623
Epoch: 13, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 2.5323691368103027
Epoch: 14, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.483 Vali Acc: 0.817 Test Loss: 0.483 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6676886081695557
Epoch: 15, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 16 cost time: 2.803764820098877
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 2.682790517807007
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3179471492767334
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6299357414245605
Epoch: 19, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.497 Vali Acc: 0.828 Test Loss: 0.497 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7878661155700684
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.378 Vali Acc: 0.861 Test Loss: 0.378 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.853177070617676
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0794947147369385
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.8597164154052734
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.390 Vali Acc: 0.867 Test Loss: 0.390 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.2197606563568115
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 25 cost time: 2.9213945865631104
Epoch: 25, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.341 Vali Acc: 0.894 Test Loss: 0.341 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 26 cost time: 2.8641934394836426
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.776615858078003
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.388 Vali Acc: 0.872 Test Loss: 0.388 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.841737985610962
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.390 Vali Acc: 0.894 Test Loss: 0.390 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8670403957366943
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9705376625061035
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 31 cost time: 2.327223300933838
Epoch: 31, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.606360673904419
Epoch: 32, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.787121534347534
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.8676719665527344
Epoch: 34, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.396 Vali Acc: 0.878 Test Loss: 0.396 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.801567554473877
Epoch: 35, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.427 Vali Acc: 0.861 Test Loss: 0.427 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.970160484313965
Epoch: 36, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 2.746793508529663
Epoch: 37, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.418 Vali Acc: 0.872 Test Loss: 0.418 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.8531816005706787
Epoch: 38, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.0018832683563232
Epoch: 39, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.642026901245117
Epoch: 40, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.347 Vali Acc: 0.878 Test Loss: 0.347 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.1616697311401367
Epoch: 41, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.401 Vali Acc: 0.872 Test Loss: 0.401 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.7213470935821533
Epoch: 42, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.3162271976470947
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.405 Vali Acc: 0.878 Test Loss: 0.405 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.7710351943969727
Epoch: 44, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.4946651458740234
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 46 cost time: 3.343885660171509
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.775874137878418
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.7255618572235107
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.9985055923461914
Epoch: 49, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.8136513233184814
Epoch: 50, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.826260566711426
Epoch: 51, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.2818002700805664
Epoch: 52, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.894 Test Loss: 0.338 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.1031508445739746
Epoch: 53, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.4538650512695312
Epoch: 54, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.894 Test Loss: 0.348 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.8296990394592285
Epoch: 55, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3031234
model size : 14.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9200432300567627
Epoch: 1, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.740 Vali Acc: 0.356 Test Loss: 1.740 Test Acc: 0.356
Validation loss decreased (inf --> -0.355538).  Saving model ...
Epoch: 2 cost time: 2.216935634613037
Epoch: 2, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.395 Vali Acc: 0.478 Test Loss: 1.395 Test Acc: 0.478
Validation loss decreased (-0.355538 --> -0.477764).  Saving model ...
Epoch: 3 cost time: 2.371260166168213
Epoch: 3, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.060 Vali Acc: 0.628 Test Loss: 1.060 Test Acc: 0.628
Validation loss decreased (-0.477764 --> -0.627767).  Saving model ...
Epoch: 4 cost time: 2.383099317550659
Epoch: 4, Steps: 12 | Train Loss: 0.944 Vali Loss: 0.956 Vali Acc: 0.617 Test Loss: 0.956 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8195767402648926
Epoch: 5, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.675 Vali Acc: 0.711 Test Loss: 0.675 Test Acc: 0.711
Validation loss decreased (-0.627767 --> -0.711104).  Saving model ...
Epoch: 6 cost time: 2.19338059425354
Epoch: 6, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.462 Vali Acc: 0.778 Test Loss: 0.462 Test Acc: 0.778
Validation loss decreased (-0.711104 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 2.681864023208618
Epoch: 7, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.432 Vali Acc: 0.794 Test Loss: 0.432 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.6422524452209473
Epoch: 8, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 1.8937044143676758
Epoch: 9, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.370 Vali Acc: 0.822 Test Loss: 0.370 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 2.417534828186035
Epoch: 10, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 2.3422813415527344
Epoch: 11, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.427 Vali Acc: 0.811 Test Loss: 0.427 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.44006609916687
Epoch: 12, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.06585431098938
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2806191444396973
Epoch: 14, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.780 Vali Acc: 0.772 Test Loss: 0.780 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9328217506408691
Epoch: 15, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.401 Vali Acc: 0.817 Test Loss: 0.401 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2919986248016357
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.401 Vali Acc: 0.839 Test Loss: 0.401 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.122854232788086
Epoch: 17, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 2.314345359802246
Epoch: 18, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3151140213012695
Epoch: 19, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 2.126281261444092
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861107).  Saving model ...
Epoch: 21 cost time: 2.2584853172302246
Epoch: 21, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 2.1490495204925537
Epoch: 22, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.286959409713745
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.573 Vali Acc: 0.800 Test Loss: 0.573 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1013689041137695
Epoch: 24, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.515 Vali Acc: 0.839 Test Loss: 0.515 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4523746967315674
Epoch: 25, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.366 Vali Acc: 0.872 Test Loss: 0.366 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.6458327770233154
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.324 Vali Acc: 0.867 Test Loss: 0.324 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3111462593078613
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.885638952255249
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.4304373264312744
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 30 cost time: 2.4316186904907227
Epoch: 30, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.513364553451538
Epoch: 31, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 2.849747657775879
Epoch: 32, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.464 Vali Acc: 0.867 Test Loss: 0.464 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.636950731277466
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.6153512001037598
Epoch: 34, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.756221294403076
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.458301544189453
Epoch: 36, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.431 Vali Acc: 0.856 Test Loss: 0.431 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.4886555671691895
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.6520721912384033
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.316760301589966
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.1018779277801514
Epoch: 40, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.209059000015259
Epoch: 41, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.450 Vali Acc: 0.861 Test Loss: 0.450 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 3029826
model size : 14.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.181724309921265
Epoch: 1, Steps: 12 | Train Loss: 1.948 Vali Loss: 1.788 Vali Acc: 0.161 Test Loss: 1.788 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 2.765460729598999
Epoch: 2, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.601 Vali Acc: 0.389 Test Loss: 1.601 Test Acc: 0.389
Validation loss decreased (-0.161093 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 2.445929765701294
Epoch: 3, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.187 Vali Acc: 0.517 Test Loss: 1.187 Test Acc: 0.517
Validation loss decreased (-0.388873 --> -0.516655).  Saving model ...
Epoch: 4 cost time: 2.427297830581665
Epoch: 4, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.811 Vali Acc: 0.683 Test Loss: 0.811 Test Acc: 0.683
Validation loss decreased (-0.516655 --> -0.683325).  Saving model ...
Epoch: 5 cost time: 2.4859695434570312
Epoch: 5, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.648 Vali Acc: 0.706 Test Loss: 0.648 Test Acc: 0.706
Validation loss decreased (-0.683325 --> -0.705549).  Saving model ...
Epoch: 6 cost time: 2.6020829677581787
Epoch: 6, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.526 Vali Acc: 0.750 Test Loss: 0.526 Test Acc: 0.750
Validation loss decreased (-0.705549 --> -0.749995).  Saving model ...
Epoch: 7 cost time: 2.4186887741088867
Epoch: 7, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.425 Vali Acc: 0.806 Test Loss: 0.425 Test Acc: 0.806
Validation loss decreased (-0.749995 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 2.6032233238220215
Epoch: 8, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 2.5590085983276367
Epoch: 9, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.560 Vali Acc: 0.772 Test Loss: 0.560 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.56704044342041
Epoch: 10, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.362 Vali Acc: 0.839 Test Loss: 0.362 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 2.603180408477783
Epoch: 11, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855553).  Saving model ...
Epoch: 12 cost time: 2.3216588497161865
Epoch: 12, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 2.6230921745300293
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.435 Vali Acc: 0.817 Test Loss: 0.435 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.296572208404541
Epoch: 14, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7663822174072266
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.311 Vali Acc: 0.844 Test Loss: 0.311 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.092902660369873
Epoch: 16, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6508231163024902
Epoch: 17, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.330 Vali Acc: 0.856 Test Loss: 0.330 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4195640087127686
Epoch: 18, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 2.3809866905212402
Epoch: 19, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.403 Vali Acc: 0.844 Test Loss: 0.403 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.431443691253662
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.396453619003296
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.452043056488037
Epoch: 22, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.443 Vali Acc: 0.839 Test Loss: 0.443 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.193134069442749
Epoch: 23, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.352 Vali Acc: 0.844 Test Loss: 0.352 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3719136714935303
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2456915378570557
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.344 Vali Acc: 0.856 Test Loss: 0.344 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.8003668785095215
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1943538188934326
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.29443097114563
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2737986
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.7283759117126465
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.777 Vali Acc: 0.156 Test Loss: 1.777 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 2.169440984725952
Epoch: 2, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.487 Vali Acc: 0.450 Test Loss: 1.487 Test Acc: 0.450
Validation loss decreased (-0.155538 --> -0.449985).  Saving model ...
Epoch: 3 cost time: 2.773411750793457
Epoch: 3, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.142 Vali Acc: 0.628 Test Loss: 1.142 Test Acc: 0.628
Validation loss decreased (-0.449985 --> -0.627766).  Saving model ...
Epoch: 4 cost time: 2.521470308303833
Epoch: 4, Steps: 12 | Train Loss: 1.032 Vali Loss: 0.883 Vali Acc: 0.650 Test Loss: 0.883 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649991).  Saving model ...
Epoch: 5 cost time: 2.2182493209838867
Epoch: 5, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.735 Vali Acc: 0.722 Test Loss: 0.735 Test Acc: 0.722
Validation loss decreased (-0.649991 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 2.365875720977783
Epoch: 6, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1040444374084473
Epoch: 7, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.444 Vali Acc: 0.794 Test Loss: 0.444 Test Acc: 0.794
Validation loss decreased (-0.722215 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.1888790130615234
Epoch: 8, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.439 Vali Acc: 0.794 Test Loss: 0.439 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 2.2787411212921143
Epoch: 9, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.464 Vali Acc: 0.794 Test Loss: 0.464 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.239903211593628
Epoch: 10, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.464 Vali Acc: 0.811 Test Loss: 0.464 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 2.3276138305664062
Epoch: 11, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.427 Vali Acc: 0.794 Test Loss: 0.427 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3688719272613525
Epoch: 12, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 2.094991683959961
Epoch: 13, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.378 Vali Acc: 0.811 Test Loss: 0.378 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3696775436401367
Epoch: 14, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.443 Vali Acc: 0.783 Test Loss: 0.443 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2893826961517334
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.376 Vali Acc: 0.817 Test Loss: 0.376 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.909821033477783
Epoch: 16, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 2.5083343982696533
Epoch: 17, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.442 Vali Acc: 0.811 Test Loss: 0.442 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.405855178833008
Epoch: 18, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 2.287191867828369
Epoch: 19, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.331 Vali Acc: 0.878 Test Loss: 0.331 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 2.4947147369384766
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.417 Vali Acc: 0.839 Test Loss: 0.417 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.173422336578369
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4088358879089355
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.438 Vali Acc: 0.828 Test Loss: 0.438 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5521724224090576
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.698 Vali Acc: 0.806 Test Loss: 0.698 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2813758850097656
Epoch: 24, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.682 Vali Acc: 0.833 Test Loss: 0.682 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.4628074169158936
Epoch: 25, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.374 Vali Acc: 0.861 Test Loss: 0.374 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.679203510284424
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.412 Vali Acc: 0.844 Test Loss: 0.412 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.4533181190490723
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.605435848236084
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.389 Vali Acc: 0.867 Test Loss: 0.389 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.789149284362793
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.426 Vali Acc: 0.839 Test Loss: 0.426 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2736578
model size : 13.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.611321926116943
Epoch: 1, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.784 Vali Acc: 0.200 Test Loss: 1.784 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 2.5313832759857178
Epoch: 2, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.495 Vali Acc: 0.372 Test Loss: 1.495 Test Acc: 0.372
Validation loss decreased (-0.199982 --> -0.372207).  Saving model ...
Epoch: 3 cost time: 3.5153603553771973
Epoch: 3, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.135 Vali Acc: 0.689 Test Loss: 1.135 Test Acc: 0.689
Validation loss decreased (-0.372207 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 2.9435060024261475
Epoch: 4, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.786 Vali Acc: 0.683 Test Loss: 0.786 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4378609657287598
Epoch: 5, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.605 Vali Acc: 0.761 Test Loss: 0.605 Test Acc: 0.761
Validation loss decreased (-0.688878 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 2.5258100032806396
Epoch: 6, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.494 Vali Acc: 0.750 Test Loss: 0.494 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.785228967666626
Epoch: 7, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.461 Vali Acc: 0.772 Test Loss: 0.461 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772218).  Saving model ...
Epoch: 8 cost time: 2.9613900184631348
Epoch: 8, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
Validation loss decreased (-0.772218 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 2.430131435394287
Epoch: 9, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.368 Vali Acc: 0.833 Test Loss: 0.368 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.329237699508667
Epoch: 10, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4449267387390137
Epoch: 11, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 2.854330062866211
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.376 Vali Acc: 0.828 Test Loss: 0.376 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.341585159301758
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3780157566070557
Epoch: 14, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 2.763566255569458
Epoch: 15, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.35945463180542
Epoch: 16, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.903684377670288
Epoch: 17, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.509272575378418
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.377 Vali Acc: 0.856 Test Loss: 0.377 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.75108003616333
Epoch: 19, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.406 Vali Acc: 0.839 Test Loss: 0.406 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8491361141204834
Epoch: 20, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.668 Vali Acc: 0.806 Test Loss: 0.668 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.253204345703125
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1157398223876953
Epoch: 22, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.436699628829956
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.259248971939087
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 2735170
model size : 13.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.852176904678345
Epoch: 1, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.725 Vali Acc: 0.300 Test Loss: 1.725 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 2.90553617477417
Epoch: 2, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.464 Vali Acc: 0.367 Test Loss: 1.464 Test Acc: 0.367
Validation loss decreased (-0.299983 --> -0.366652).  Saving model ...
Epoch: 3 cost time: 2.7753183841705322
Epoch: 3, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.101 Vali Acc: 0.617 Test Loss: 1.101 Test Acc: 0.617
Validation loss decreased (-0.366652 --> -0.616656).  Saving model ...
Epoch: 4 cost time: 2.872546911239624
Epoch: 4, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.774 Vali Acc: 0.683 Test Loss: 0.774 Test Acc: 0.683
Validation loss decreased (-0.616656 --> -0.683326).  Saving model ...
Epoch: 5 cost time: 2.3847897052764893
Epoch: 5, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.740 Vali Acc: 0.700 Test Loss: 0.740 Test Acc: 0.700
Validation loss decreased (-0.683326 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 2.7412965297698975
Epoch: 6, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.521 Vali Acc: 0.756 Test Loss: 0.521 Test Acc: 0.756
Validation loss decreased (-0.699993 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 2.4509243965148926
Epoch: 7, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.471 Vali Acc: 0.806 Test Loss: 0.471 Test Acc: 0.806
Validation loss decreased (-0.755550 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 2.3634350299835205
Epoch: 8, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.413 Vali Acc: 0.794 Test Loss: 0.413 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.496558904647827
Epoch: 9, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.360 Vali Acc: 0.806 Test Loss: 0.360 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 10 cost time: 2.408428907394409
Epoch: 10, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.805552 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 2.507767677307129
Epoch: 11, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 2.522261381149292
Epoch: 12, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 2.44671630859375
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.264 Vali Acc: 0.867 Test Loss: 0.264 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6042160987854004
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.399 Vali Acc: 0.828 Test Loss: 0.399 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.418196678161621
Epoch: 15, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.603640556335449
Epoch: 16, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 2.327782392501831
Epoch: 17, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.381404161453247
Epoch: 18, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.321 Vali Acc: 0.883 Test Loss: 0.321 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 2.558647871017456
Epoch: 19, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 2.2465755939483643
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.544 Vali Acc: 0.811 Test Loss: 0.544 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.461099863052368
Epoch: 21, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.389 Vali Acc: 0.811 Test Loss: 0.389 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.173417329788208
Epoch: 22, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.195157051086426
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3476436138153076
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7244460582733154
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.402 Vali Acc: 0.839 Test Loss: 0.402 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.867994785308838
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.449 Vali Acc: 0.828 Test Loss: 0.449 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.8311703205108643
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.433 Vali Acc: 0.839 Test Loss: 0.433 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.1674671173095703
Epoch: 28, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3794994354248047
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2733762
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.184097051620483
Epoch: 1, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.661 Vali Acc: 0.333 Test Loss: 1.661 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 2.1538779735565186
Epoch: 2, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.414 Vali Acc: 0.594 Test Loss: 1.414 Test Acc: 0.594
Validation loss decreased (-0.333317 --> -0.594430).  Saving model ...
Epoch: 3 cost time: 2.0488481521606445
Epoch: 3, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.062 Vali Acc: 0.617 Test Loss: 1.062 Test Acc: 0.617
Validation loss decreased (-0.594430 --> -0.616656).  Saving model ...
Epoch: 4 cost time: 2.054831027984619
Epoch: 4, Steps: 12 | Train Loss: 0.987 Vali Loss: 0.762 Vali Acc: 0.689 Test Loss: 0.762 Test Acc: 0.689
Validation loss decreased (-0.616656 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 2.020219326019287
Epoch: 5, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
Validation loss decreased (-0.688881 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 2.076429843902588
Epoch: 6, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.531 Vali Acc: 0.761 Test Loss: 0.531 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 7 cost time: 2.0154502391815186
Epoch: 7, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
Validation loss decreased (-0.761106 --> -0.849996).  Saving model ...
Epoch: 8 cost time: 2.008450984954834
Epoch: 8, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.006237030029297
Epoch: 9, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9065520763397217
Epoch: 10, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.354 Vali Acc: 0.800 Test Loss: 0.354 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3203892707824707
Epoch: 11, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.382 Vali Acc: 0.833 Test Loss: 0.382 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.888608694076538
Epoch: 12, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.360 Vali Acc: 0.828 Test Loss: 0.360 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0515992641448975
Epoch: 13, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.900477409362793
Epoch: 14, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.306 Vali Acc: 0.839 Test Loss: 0.306 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0164682865142822
Epoch: 15, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.378 Vali Acc: 0.833 Test Loss: 0.378 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8396022319793701
Epoch: 16, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.992924690246582
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.391 Vali Acc: 0.817 Test Loss: 0.391 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 1820034
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1368162631988525
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.754 Vali Acc: 0.217 Test Loss: 1.754 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 2.160285472869873
Epoch: 2, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.560 Vali Acc: 0.472 Test Loss: 1.560 Test Acc: 0.472
Validation loss decreased (-0.216649 --> -0.472207).  Saving model ...
Epoch: 3 cost time: 2.1363205909729004
Epoch: 3, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.261 Vali Acc: 0.628 Test Loss: 1.261 Test Acc: 0.628
Validation loss decreased (-0.472207 --> -0.627765).  Saving model ...
Epoch: 4 cost time: 2.1686551570892334
Epoch: 4, Steps: 12 | Train Loss: 1.227 Vali Loss: 0.958 Vali Acc: 0.628 Test Loss: 0.958 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627768).  Saving model ...
Epoch: 5 cost time: 2.2914366722106934
Epoch: 5, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.711 Vali Acc: 0.722 Test Loss: 0.711 Test Acc: 0.722
Validation loss decreased (-0.627768 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 2.4157116413116455
Epoch: 6, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.608 Vali Acc: 0.728 Test Loss: 0.608 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727772).  Saving model ...
Epoch: 7 cost time: 2.578528881072998
Epoch: 7, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.478 Vali Acc: 0.794 Test Loss: 0.478 Test Acc: 0.794
Validation loss decreased (-0.727772 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 1.87898588180542
Epoch: 8, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.424 Vali Acc: 0.806 Test Loss: 0.424 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 2.5422587394714355
Epoch: 9, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.426 Vali Acc: 0.806 Test Loss: 0.426 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.260713815689087
Epoch: 10, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.406 Vali Acc: 0.806 Test Loss: 0.406 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 11 cost time: 2.6653099060058594
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.416 Vali Acc: 0.811 Test Loss: 0.416 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 2.609065294265747
Epoch: 12, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
Validation loss decreased (-0.811107 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 2.5526978969573975
Epoch: 13, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.383 Vali Acc: 0.811 Test Loss: 0.383 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5497732162475586
Epoch: 14, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.355 Vali Acc: 0.856 Test Loss: 0.355 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 2.7531487941741943
Epoch: 15, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.392 Vali Acc: 0.844 Test Loss: 0.392 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.601365089416504
Epoch: 16, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.464498281478882
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.754204273223877
Epoch: 18, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.370 Vali Acc: 0.839 Test Loss: 0.370 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2798609733581543
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.444 Vali Acc: 0.806 Test Loss: 0.444 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1753759384155273
Epoch: 20, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1435608863830566
Epoch: 21, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7617387771606445
Epoch: 22, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.378 Vali Acc: 0.806 Test Loss: 0.378 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.3717620372772217
Epoch: 23, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.9208409786224365
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.400 Vali Acc: 0.839 Test Loss: 0.400 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 1819330
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.804666519165039
Epoch: 1, Steps: 12 | Train Loss: 2.010 Vali Loss: 1.787 Vali Acc: 0.200 Test Loss: 1.787 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 2.305184841156006
Epoch: 2, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.577 Vali Acc: 0.439 Test Loss: 1.577 Test Acc: 0.439
Validation loss decreased (-0.199982 --> -0.438873).  Saving model ...
Epoch: 3 cost time: 2.2391819953918457
Epoch: 3, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.296 Vali Acc: 0.544 Test Loss: 1.296 Test Acc: 0.544
Validation loss decreased (-0.438873 --> -0.544431).  Saving model ...
Epoch: 4 cost time: 2.006395101547241
Epoch: 4, Steps: 12 | Train Loss: 1.172 Vali Loss: 0.957 Vali Acc: 0.683 Test Loss: 0.957 Test Acc: 0.683
Validation loss decreased (-0.544431 --> -0.683324).  Saving model ...
Epoch: 5 cost time: 2.1029067039489746
Epoch: 5, Steps: 12 | Train Loss: 0.937 Vali Loss: 0.706 Vali Acc: 0.733 Test Loss: 0.706 Test Acc: 0.733
Validation loss decreased (-0.683324 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 2.782396078109741
Epoch: 6, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 2.2248096466064453
Epoch: 7, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.476 Vali Acc: 0.789 Test Loss: 0.476 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788884).  Saving model ...
Epoch: 8 cost time: 2.1828701496124268
Epoch: 8, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.460 Vali Acc: 0.794 Test Loss: 0.460 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 2.4854683876037598
Epoch: 9, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.423 Vali Acc: 0.811 Test Loss: 0.423 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 2.3635661602020264
Epoch: 10, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.454 Vali Acc: 0.767 Test Loss: 0.454 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6627097129821777
Epoch: 11, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.392 Vali Acc: 0.828 Test Loss: 0.392 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 2.083670139312744
Epoch: 12, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.450 Vali Acc: 0.800 Test Loss: 0.450 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.268016815185547
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.391 Vali Acc: 0.817 Test Loss: 0.391 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.510380506515503
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2640209197998047
Epoch: 15, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.376 Vali Acc: 0.811 Test Loss: 0.376 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.33740496635437
Epoch: 16, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.981165885925293
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.596 Vali Acc: 0.794 Test Loss: 0.596 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2814042568206787
Epoch: 18, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.502 Vali Acc: 0.806 Test Loss: 0.502 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7910780906677246
Epoch: 19, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0824625492095947
Epoch: 20, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.347 Vali Acc: 0.822 Test Loss: 0.347 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2402234077453613
Epoch: 21, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.440 Vali Acc: 0.811 Test Loss: 0.440 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 1818626
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.270397901535034
Epoch: 1, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.806 Vali Acc: 0.167 Test Loss: 1.806 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 2.0335545539855957
Epoch: 2, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.559 Vali Acc: 0.422 Test Loss: 1.559 Test Acc: 0.422
Validation loss decreased (-0.166649 --> -0.422207).  Saving model ...
Epoch: 3 cost time: 1.8526818752288818
Epoch: 3, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.236 Vali Acc: 0.567 Test Loss: 1.236 Test Acc: 0.567
Validation loss decreased (-0.422207 --> -0.566654).  Saving model ...
Epoch: 4 cost time: 1.8562111854553223
Epoch: 4, Steps: 12 | Train Loss: 1.090 Vali Loss: 0.861 Vali Acc: 0.661 Test Loss: 0.861 Test Acc: 0.661
Validation loss decreased (-0.566654 --> -0.661103).  Saving model ...
Epoch: 5 cost time: 1.7400977611541748
Epoch: 5, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
Validation loss decreased (-0.661103 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 1.9930896759033203
Epoch: 6, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.574 Vali Acc: 0.772 Test Loss: 0.574 Test Acc: 0.772
Validation loss decreased (-0.716660 --> -0.772216).  Saving model ...
Epoch: 7 cost time: 2.0498476028442383
Epoch: 7, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788884).  Saving model ...
Epoch: 8 cost time: 1.8350434303283691
Epoch: 8, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.463 Vali Acc: 0.794 Test Loss: 0.463 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.7876524925231934
Epoch: 9, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.463 Vali Acc: 0.778 Test Loss: 0.463 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9863219261169434
Epoch: 10, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.359 Vali Acc: 0.811 Test Loss: 0.359 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811108).  Saving model ...
Epoch: 11 cost time: 1.8403956890106201
Epoch: 11, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
Validation loss decreased (-0.811108 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 1.9363408088684082
Epoch: 12, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9979655742645264
Epoch: 13, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.356 Vali Acc: 0.806 Test Loss: 0.356 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7716257572174072
Epoch: 14, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 1.6351776123046875
Epoch: 15, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.305 Vali Acc: 0.828 Test Loss: 0.305 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8794989585876465
Epoch: 16, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.422 Vali Acc: 0.806 Test Loss: 0.422 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8491148948669434
Epoch: 17, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8399062156677246
Epoch: 18, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.356 Vali Acc: 0.844 Test Loss: 0.356 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 1.8181548118591309
Epoch: 19, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.307 Vali Acc: 0.839 Test Loss: 0.307 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.052077293395996
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.347 Vali Acc: 0.822 Test Loss: 0.347 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6398890018463135
Epoch: 21, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.298 Vali Acc: 0.844 Test Loss: 0.298 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 1.6286275386810303
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.393 Vali Acc: 0.844 Test Loss: 0.393 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.860959529876709
Epoch: 23, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.449 Vali Acc: 0.806 Test Loss: 0.449 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8523516654968262
Epoch: 24, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.313 Vali Acc: 0.822 Test Loss: 0.313 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6257102489471436
Epoch: 25, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 1.9078834056854248
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.700155258178711
Epoch: 27, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.410 Vali Acc: 0.839 Test Loss: 0.410 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9234390258789062
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.410 Vali Acc: 0.844 Test Loss: 0.410 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8624234199523926
Epoch: 29, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.061379909515381
Epoch: 30, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.388 Vali Acc: 0.856 Test Loss: 0.388 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7669882774353027
Epoch: 31, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.437 Vali Acc: 0.817 Test Loss: 0.437 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.76829195022583
Epoch: 32, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 33 cost time: 1.8684284687042236
Epoch: 33, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.345 Vali Acc: 0.867 Test Loss: 0.345 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 34 cost time: 1.754493236541748
Epoch: 34, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 35 cost time: 1.802257776260376
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.432 Vali Acc: 0.844 Test Loss: 0.432 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9393279552459717
Epoch: 36, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.368 Vali Acc: 0.856 Test Loss: 0.368 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9738421440124512
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.402 Vali Acc: 0.839 Test Loss: 0.402 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7719368934631348
Epoch: 38, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 39 cost time: 1.7121825218200684
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9766154289245605
Epoch: 40, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.4591453075408936
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8017139434814453
Epoch: 42, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.8129136562347412
Epoch: 43, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.355 Vali Acc: 0.856 Test Loss: 0.355 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.7289645671844482
Epoch: 44, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.1861629486083984
Epoch: 45, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.412 Vali Acc: 0.839 Test Loss: 0.412 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.8844819068908691
Epoch: 46, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
Validation loss decreased (-0.877775 --> -0.911108).  Saving model ...
Epoch: 47 cost time: 1.9124507904052734
Epoch: 47, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.379 Vali Acc: 0.872 Test Loss: 0.379 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.0400314331054688
Epoch: 48, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.744718313217163
Epoch: 49, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.380 Vali Acc: 0.856 Test Loss: 0.380 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.186331033706665
Epoch: 50, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.0249996185302734
Epoch: 51, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.0436151027679443
Epoch: 52, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.345 Vali Acc: 0.894 Test Loss: 0.345 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.2668004035949707
Epoch: 53, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.9308803081512451
Epoch: 54, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.380 Vali Acc: 0.872 Test Loss: 0.380 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.8137178421020508
Epoch: 55, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.430 Vali Acc: 0.839 Test Loss: 0.430 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.926304578781128
Epoch: 56, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.359 Vali Acc: 0.867 Test Loss: 0.359 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1817922
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5474770069122314
Epoch: 1, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.726 Vali Acc: 0.261 Test Loss: 1.726 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 2.2793238162994385
Epoch: 2, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.574 Vali Acc: 0.483 Test Loss: 1.574 Test Acc: 0.483
Validation loss decreased (-0.261094 --> -0.483318).  Saving model ...
Epoch: 3 cost time: 2.6315040588378906
Epoch: 3, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.321 Vali Acc: 0.550 Test Loss: 1.321 Test Acc: 0.550
Validation loss decreased (-0.483318 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 2.40118670463562
Epoch: 4, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.014 Vali Acc: 0.656 Test Loss: 1.014 Test Acc: 0.656
Validation loss decreased (-0.549987 --> -0.655545).  Saving model ...
Epoch: 5 cost time: 2.4945437908172607
Epoch: 5, Steps: 12 | Train Loss: 0.948 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
Validation loss decreased (-0.655545 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 3.2208380699157715
Epoch: 6, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.629 Vali Acc: 0.733 Test Loss: 0.629 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733327).  Saving model ...
Epoch: 7 cost time: 2.5514538288116455
Epoch: 7, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.535 Vali Acc: 0.794 Test Loss: 0.535 Test Acc: 0.794
Validation loss decreased (-0.733327 --> -0.794439).  Saving model ...
Epoch: 8 cost time: 2.465517997741699
Epoch: 8, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.475 Vali Acc: 0.750 Test Loss: 0.475 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4261813163757324
Epoch: 9, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.418 Vali Acc: 0.806 Test Loss: 0.418 Test Acc: 0.806
Validation loss decreased (-0.794439 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 2.9200525283813477
Epoch: 10, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.405 Vali Acc: 0.794 Test Loss: 0.405 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3208370208740234
Epoch: 11, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 2.5645809173583984
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.522576332092285
Epoch: 13, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.370 Vali Acc: 0.833 Test Loss: 0.370 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6814370155334473
Epoch: 14, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 2.809488534927368
Epoch: 15, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.407 Vali Acc: 0.844 Test Loss: 0.407 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5544934272766113
Epoch: 16, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3341002464294434
Epoch: 17, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9035286903381348
Epoch: 18, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.77433443069458
Epoch: 19, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.386 Vali Acc: 0.839 Test Loss: 0.386 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.272982358932495
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.383 Vali Acc: 0.806 Test Loss: 0.383 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.005279064178467
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.359 Vali Acc: 0.833 Test Loss: 0.359 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1685707569122314
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.340933322906494
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3173811435699463
Epoch: 24, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.436 Vali Acc: 0.822 Test Loss: 0.436 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1225602
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.708102464675903
Epoch: 1, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.759 Vali Acc: 0.344 Test Loss: 1.759 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 2.1454524993896484
Epoch: 2, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.606 Vali Acc: 0.450 Test Loss: 1.606 Test Acc: 0.450
Validation loss decreased (-0.344427 --> -0.449984).  Saving model ...
Epoch: 3 cost time: 1.9158401489257812
Epoch: 3, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.368 Vali Acc: 0.561 Test Loss: 1.368 Test Acc: 0.561
Validation loss decreased (-0.449984 --> -0.561097).  Saving model ...
Epoch: 4 cost time: 2.129946231842041
Epoch: 4, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.096 Vali Acc: 0.583 Test Loss: 1.096 Test Acc: 0.583
Validation loss decreased (-0.561097 --> -0.583322).  Saving model ...
Epoch: 5 cost time: 2.1193387508392334
Epoch: 5, Steps: 12 | Train Loss: 0.935 Vali Loss: 0.834 Vali Acc: 0.661 Test Loss: 0.834 Test Acc: 0.661
Validation loss decreased (-0.583322 --> -0.661103).  Saving model ...
Epoch: 6 cost time: 1.8893771171569824
Epoch: 6, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.668 Vali Acc: 0.711 Test Loss: 0.668 Test Acc: 0.711
Validation loss decreased (-0.661103 --> -0.711104).  Saving model ...
Epoch: 7 cost time: 1.7706537246704102
Epoch: 7, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.534 Vali Acc: 0.756 Test Loss: 0.534 Test Acc: 0.756
Validation loss decreased (-0.711104 --> -0.755550).  Saving model ...
Epoch: 8 cost time: 2.3337488174438477
Epoch: 8, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.460 Vali Acc: 0.806 Test Loss: 0.460 Test Acc: 0.806
Validation loss decreased (-0.755550 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 1.7926547527313232
Epoch: 9, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.474 Vali Acc: 0.767 Test Loss: 0.474 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4776573181152344
Epoch: 10, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.383 Vali Acc: 0.844 Test Loss: 0.383 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 2.79910945892334
Epoch: 11, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.380 Vali Acc: 0.844 Test Loss: 0.380 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.058608293533325
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.852510690689087
Epoch: 13, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.095529079437256
Epoch: 14, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2787797451019287
Epoch: 15, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 2.3051092624664307
Epoch: 16, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2698185443878174
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 2.723127841949463
Epoch: 18, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.319 Vali Acc: 0.856 Test Loss: 0.319 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.500744581222534
Epoch: 19, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1193766593933105
Epoch: 20, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.353 Vali Acc: 0.861 Test Loss: 0.353 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0378265380859375
Epoch: 21, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9313912391662598
Epoch: 22, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1939377784729004
Epoch: 23, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.382 Vali Acc: 0.828 Test Loss: 0.382 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.95280122756958
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 25 cost time: 2.144155740737915
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.323568820953369
Epoch: 26, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.428 Vali Acc: 0.822 Test Loss: 0.428 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.938129186630249
Epoch: 27, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.383 Vali Acc: 0.872 Test Loss: 0.383 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9485321044921875
Epoch: 28, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2016992568969727
Epoch: 29, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.334 Vali Acc: 0.872 Test Loss: 0.334 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.6574172973632812
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.3850746154785156
Epoch: 31, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.373 Vali Acc: 0.839 Test Loss: 0.373 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.951195240020752
Epoch: 32, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.3399713039398193
Epoch: 33, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.136878490447998
Epoch: 34, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1224898
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.536137580871582
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.743 Vali Acc: 0.200 Test Loss: 1.743 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.575145721435547
Epoch: 2, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.551 Vali Acc: 0.561 Test Loss: 1.551 Test Acc: 0.561
Validation loss decreased (-0.199983 --> -0.561096).  Saving model ...
Epoch: 3 cost time: 2.3929836750030518
Epoch: 3, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.237 Vali Acc: 0.656 Test Loss: 1.237 Test Acc: 0.656
Validation loss decreased (-0.561096 --> -0.655543).  Saving model ...
Epoch: 4 cost time: 2.256077527999878
Epoch: 4, Steps: 12 | Train Loss: 1.136 Vali Loss: 0.933 Vali Acc: 0.661 Test Loss: 0.933 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661102).  Saving model ...
Epoch: 5 cost time: 2.3453307151794434
Epoch: 5, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.759 Vali Acc: 0.683 Test Loss: 0.759 Test Acc: 0.683
Validation loss decreased (-0.661102 --> -0.683326).  Saving model ...
Epoch: 6 cost time: 2.5600738525390625
Epoch: 6, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
Validation loss decreased (-0.683326 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 2.376317024230957
Epoch: 7, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.535 Vali Acc: 0.772 Test Loss: 0.535 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 2.772240161895752
Epoch: 8, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 2.637362480163574
Epoch: 9, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.415 Vali Acc: 0.794 Test Loss: 0.415 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 10 cost time: 3.1206114292144775
Epoch: 10, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.389 Vali Acc: 0.811 Test Loss: 0.389 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 2.393781900405884
Epoch: 11, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.395 Vali Acc: 0.844 Test Loss: 0.395 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844440).  Saving model ...
Epoch: 12 cost time: 2.283485174179077
Epoch: 12, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.430 Vali Acc: 0.817 Test Loss: 0.430 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.023946762084961
Epoch: 13, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.45975661277771
Epoch: 14, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9702181816101074
Epoch: 15, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.425 Vali Acc: 0.822 Test Loss: 0.425 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6264047622680664
Epoch: 16, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.327 Vali Acc: 0.828 Test Loss: 0.327 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2699360847473145
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.360 Vali Acc: 0.828 Test Loss: 0.360 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.115976333618164
Epoch: 18, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.114046096801758
Epoch: 19, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.395 Vali Acc: 0.817 Test Loss: 0.395 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.08378005027771
Epoch: 20, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.343 Vali Acc: 0.811 Test Loss: 0.343 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0112855434417725
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 1224194
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.132692575454712
Epoch: 1, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.709 Vali Acc: 0.333 Test Loss: 1.709 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 2.5818440914154053
Epoch: 2, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.524 Vali Acc: 0.522 Test Loss: 1.524 Test Acc: 0.522
Validation loss decreased (-0.333316 --> -0.522207).  Saving model ...
Epoch: 3 cost time: 2.053828477859497
Epoch: 3, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.253 Vali Acc: 0.594 Test Loss: 1.253 Test Acc: 0.594
Validation loss decreased (-0.522207 --> -0.594432).  Saving model ...
Epoch: 4 cost time: 2.5859055519104004
Epoch: 4, Steps: 12 | Train Loss: 1.206 Vali Loss: 0.953 Vali Acc: 0.683 Test Loss: 0.953 Test Acc: 0.683
Validation loss decreased (-0.594432 --> -0.683324).  Saving model ...
Epoch: 5 cost time: 2.38852858543396
Epoch: 5, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.730 Vali Acc: 0.733 Test Loss: 0.730 Test Acc: 0.733
Validation loss decreased (-0.683324 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 2.4234395027160645
Epoch: 6, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 2.1799564361572266
Epoch: 7, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.473 Vali Acc: 0.794 Test Loss: 0.473 Test Acc: 0.794
Validation loss decreased (-0.761105 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.2234411239624023
Epoch: 8, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.426 Vali Acc: 0.806 Test Loss: 0.426 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 2.491814136505127
Epoch: 9, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.407 Vali Acc: 0.828 Test Loss: 0.407 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 2.5061004161834717
Epoch: 10, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1268043518066406
Epoch: 11, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.361 Vali Acc: 0.817 Test Loss: 0.361 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4917256832122803
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.374 Vali Acc: 0.811 Test Loss: 0.374 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3970985412597656
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.351 Vali Acc: 0.817 Test Loss: 0.351 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8516533374786377
Epoch: 14, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 2.6460468769073486
Epoch: 15, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.368 Vali Acc: 0.828 Test Loss: 0.368 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0625362396240234
Epoch: 16, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3751676082611084
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.487290620803833
Epoch: 18, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2713358402252197
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.334 Vali Acc: 0.856 Test Loss: 0.334 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 2.4302890300750732
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 21 cost time: 1.8418428897857666
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3550851345062256
Epoch: 22, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2237939834594727
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.342 Vali Acc: 0.811 Test Loss: 0.342 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7407634258270264
Epoch: 24, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0307579040527344
Epoch: 25, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.100132465362549
Epoch: 26, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.341 Vali Acc: 0.839 Test Loss: 0.341 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0872862339019775
Epoch: 27, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.364 Vali Acc: 0.844 Test Loss: 0.364 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.393388032913208
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0687966346740723
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.380 Vali Acc: 0.844 Test Loss: 0.380 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.495328664779663
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.359 Vali Acc: 0.833 Test Loss: 0.359 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1223490
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.481601238250732
Epoch: 1, Steps: 12 | Train Loss: 1.967 Vali Loss: 1.766 Vali Acc: 0.306 Test Loss: 1.766 Test Acc: 0.306
Validation loss decreased (inf --> -0.305538).  Saving model ...
Epoch: 2 cost time: 1.9074821472167969
Epoch: 2, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.641 Vali Acc: 0.322 Test Loss: 1.641 Test Acc: 0.322
Validation loss decreased (-0.305538 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 2.045964002609253
Epoch: 3, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.476 Vali Acc: 0.528 Test Loss: 1.476 Test Acc: 0.528
Validation loss decreased (-0.322206 --> -0.527763).  Saving model ...
Epoch: 4 cost time: 2.2777786254882812
Epoch: 4, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.171 Vali Acc: 0.611 Test Loss: 1.171 Test Acc: 0.611
Validation loss decreased (-0.527763 --> -0.611099).  Saving model ...
Epoch: 5 cost time: 2.047056198120117
Epoch: 5, Steps: 12 | Train Loss: 1.112 Vali Loss: 0.875 Vali Acc: 0.717 Test Loss: 0.875 Test Acc: 0.717
Validation loss decreased (-0.611099 --> -0.716658).  Saving model ...
Epoch: 6 cost time: 2.0106256008148193
Epoch: 6, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.676 Vali Acc: 0.722 Test Loss: 0.676 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722215).  Saving model ...
Epoch: 7 cost time: 2.8591725826263428
Epoch: 7, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722217).  Saving model ...
Epoch: 8 cost time: 2.5051817893981934
Epoch: 8, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.524 Vali Acc: 0.806 Test Loss: 0.524 Test Acc: 0.806
Validation loss decreased (-0.722217 --> -0.805550).  Saving model ...
Epoch: 9 cost time: 2.393218755722046
Epoch: 9, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.456 Vali Acc: 0.817 Test Loss: 0.456 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816662).  Saving model ...
Epoch: 10 cost time: 3.3510029315948486
Epoch: 10, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.436 Vali Acc: 0.789 Test Loss: 0.436 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.63041353225708
Epoch: 11, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.394 Vali Acc: 0.817 Test Loss: 0.394 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 1.9819667339324951
Epoch: 12, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
Validation loss decreased (-0.816663 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 2.1488614082336426
Epoch: 13, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.352 Vali Acc: 0.822 Test Loss: 0.352 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2440273761749268
Epoch: 14, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 2.276876449584961
Epoch: 15, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.364 Vali Acc: 0.844 Test Loss: 0.364 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4709420204162598
Epoch: 16, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1750550270080566
Epoch: 17, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 18 cost time: 2.4953832626342773
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.427 Vali Acc: 0.833 Test Loss: 0.427 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0388360023498535
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.352 Vali Acc: 0.844 Test Loss: 0.352 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8335416316986084
Epoch: 20, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8712153434753418
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8942697048187256
Epoch: 22, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.413 Vali Acc: 0.817 Test Loss: 0.413 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.961679220199585
Epoch: 23, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9287667274475098
Epoch: 24, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.171931505203247
Epoch: 25, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7889063358306885
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.387 Vali Acc: 0.844 Test Loss: 0.387 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9700322151184082
Epoch: 27, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 928386
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.439258575439453
Epoch: 1, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.778 Vali Acc: 0.272 Test Loss: 1.778 Test Acc: 0.272
Validation loss decreased (inf --> -0.272204).  Saving model ...
Epoch: 2 cost time: 1.7452476024627686
Epoch: 2, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.619 Vali Acc: 0.511 Test Loss: 1.619 Test Acc: 0.511
Validation loss decreased (-0.272204 --> -0.511095).  Saving model ...
Epoch: 3 cost time: 2.1792213916778564
Epoch: 3, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.340 Vali Acc: 0.650 Test Loss: 1.340 Test Acc: 0.650
Validation loss decreased (-0.511095 --> -0.649987).  Saving model ...
Epoch: 4 cost time: 2.057032823562622
Epoch: 4, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.022 Vali Acc: 0.733 Test Loss: 1.022 Test Acc: 0.733
Validation loss decreased (-0.649987 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 2.0591816902160645
Epoch: 5, Steps: 12 | Train Loss: 0.881 Vali Loss: 0.757 Vali Acc: 0.744 Test Loss: 0.757 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744437).  Saving model ...
Epoch: 6 cost time: 2.0352163314819336
Epoch: 6, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.634 Vali Acc: 0.733 Test Loss: 0.634 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3047099113464355
Epoch: 7, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.541 Vali Acc: 0.728 Test Loss: 0.541 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0559823513031006
Epoch: 8, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.548 Vali Acc: 0.772 Test Loss: 0.548 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 1.8984994888305664
Epoch: 9, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.438 Vali Acc: 0.789 Test Loss: 0.438 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788885).  Saving model ...
Epoch: 10 cost time: 2.267674684524536
Epoch: 10, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.384 Vali Acc: 0.811 Test Loss: 0.384 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 2.1123697757720947
Epoch: 11, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.373 Vali Acc: 0.844 Test Loss: 0.373 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.0424253940582275
Epoch: 12, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.121673822402954
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 2.008657932281494
Epoch: 14, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.82149338722229
Epoch: 15, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.981816291809082
Epoch: 16, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6515603065490723
Epoch: 17, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2160496711730957
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2619211673736572
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.345 Vali Acc: 0.828 Test Loss: 0.345 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9217967987060547
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0502099990844727
Epoch: 21, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.370 Vali Acc: 0.822 Test Loss: 0.370 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.852088451385498
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9293208122253418
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 927682
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.329687595367432
Epoch: 1, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.780 Vali Acc: 0.172 Test Loss: 1.780 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.8406128883361816
Epoch: 2, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.614 Vali Acc: 0.417 Test Loss: 1.614 Test Acc: 0.417
Validation loss decreased (-0.172204 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 1.96262526512146
Epoch: 3, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.392 Vali Acc: 0.589 Test Loss: 1.392 Test Acc: 0.589
Validation loss decreased (-0.416651 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 1.8319838047027588
Epoch: 4, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.129 Vali Acc: 0.628 Test Loss: 1.129 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627766).  Saving model ...
Epoch: 5 cost time: 1.988417148590088
Epoch: 5, Steps: 12 | Train Loss: 1.057 Vali Loss: 0.869 Vali Acc: 0.700 Test Loss: 0.869 Test Acc: 0.700
Validation loss decreased (-0.627766 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 2.0121688842773438
Epoch: 6, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.678 Vali Acc: 0.728 Test Loss: 0.678 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.9004430770874023
Epoch: 7, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.562 Vali Acc: 0.756 Test Loss: 0.562 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755550).  Saving model ...
Epoch: 8 cost time: 2.07497239112854
Epoch: 8, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.7627930641174316
Epoch: 9, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.480 Vali Acc: 0.828 Test Loss: 0.480 Test Acc: 0.828
Validation loss decreased (-0.783328 --> -0.827773).  Saving model ...
Epoch: 10 cost time: 2.0739312171936035
Epoch: 10, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.441 Vali Acc: 0.783 Test Loss: 0.441 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.932617425918579
Epoch: 11, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.403 Vali Acc: 0.822 Test Loss: 0.403 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0073132514953613
Epoch: 12, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 2.291536808013916
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8667662143707275
Epoch: 14, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.385 Vali Acc: 0.811 Test Loss: 0.385 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.91664457321167
Epoch: 15, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 16 cost time: 1.76267671585083
Epoch: 16, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 1.8321001529693604
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.376 Vali Acc: 0.811 Test Loss: 0.376 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9408626556396484
Epoch: 18, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 2.0290443897247314
Epoch: 19, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.031244993209839
Epoch: 20, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 2.1046786308288574
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0493133068084717
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.47216796875
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5718295574188232
Epoch: 24, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.369 Vali Acc: 0.867 Test Loss: 0.369 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.292469024658203
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.371 Vali Acc: 0.856 Test Loss: 0.371 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9151513576507568
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.323 Vali Acc: 0.872 Test Loss: 0.323 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8765013217926025
Epoch: 27, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.117030143737793
Epoch: 28, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0118556022644043
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.352739095687866
Epoch: 30, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 926978
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.3530354499816895
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.703 Vali Acc: 0.317 Test Loss: 1.703 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 2.379826307296753
Epoch: 2, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.547 Vali Acc: 0.517 Test Loss: 1.547 Test Acc: 0.517
Validation loss decreased (-0.316650 --> -0.516651).  Saving model ...
Epoch: 3 cost time: 2.1993539333343506
Epoch: 3, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.328 Vali Acc: 0.594 Test Loss: 1.328 Test Acc: 0.594
Validation loss decreased (-0.516651 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 2.5331876277923584
Epoch: 4, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.075 Vali Acc: 0.633 Test Loss: 1.075 Test Acc: 0.633
Validation loss decreased (-0.594431 --> -0.633323).  Saving model ...
Epoch: 5 cost time: 2.088033676147461
Epoch: 5, Steps: 12 | Train Loss: 1.025 Vali Loss: 0.838 Vali Acc: 0.667 Test Loss: 0.838 Test Acc: 0.667
Validation loss decreased (-0.633323 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 2.027148962020874
Epoch: 6, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.691 Vali Acc: 0.728 Test Loss: 0.691 Test Acc: 0.728
Validation loss decreased (-0.666658 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 2.352001190185547
Epoch: 7, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.571 Vali Acc: 0.739 Test Loss: 0.571 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 2.289280414581299
Epoch: 8, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
Validation loss decreased (-0.738883 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 2.2340331077575684
Epoch: 9, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.421 Vali Acc: 0.806 Test Loss: 0.421 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 2.226318597793579
Epoch: 10, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 2.2797696590423584
Epoch: 11, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.394 Vali Acc: 0.844 Test Loss: 0.394 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.1204888820648193
Epoch: 12, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.375 Vali Acc: 0.850 Test Loss: 0.375 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 2.2480673789978027
Epoch: 13, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.384 Vali Acc: 0.794 Test Loss: 0.384 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1546638011932373
Epoch: 14, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.359 Vali Acc: 0.839 Test Loss: 0.359 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.338008403778076
Epoch: 15, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.368 Vali Acc: 0.833 Test Loss: 0.368 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.437912702560425
Epoch: 16, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.380 Vali Acc: 0.817 Test Loss: 0.380 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1818130016326904
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6554551124572754
Epoch: 18, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 19 cost time: 2.2262723445892334
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 2.6195008754730225
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.347 Vali Acc: 0.833 Test Loss: 0.347 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4630637168884277
Epoch: 21, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.386 Vali Acc: 0.844 Test Loss: 0.386 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4604146480560303
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 2.5339608192443848
Epoch: 23, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4441745281219482
Epoch: 24, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.418 Vali Acc: 0.822 Test Loss: 0.418 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.40315318107605
Epoch: 25, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.177492618560791
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1177139282226562
Epoch: 27, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.402 Vali Acc: 0.856 Test Loss: 0.402 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.75015926361084
Epoch: 28, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3285577297210693
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.6132774353027344
Epoch: 30, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 31 cost time: 2.1321840286254883
Epoch: 31, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 32 cost time: 2.322760581970215
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 33 cost time: 2.7768256664276123
Epoch: 33, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.373 Vali Acc: 0.867 Test Loss: 0.373 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.988447666168213
Epoch: 34, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.383 Vali Acc: 0.839 Test Loss: 0.383 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.6097137928009033
Epoch: 35, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.377 Vali Acc: 0.861 Test Loss: 0.377 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.7384488582611084
Epoch: 36, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.6627678871154785
Epoch: 37, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.4734697341918945
Epoch: 38, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.311 Vali Acc: 0.844 Test Loss: 0.311 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.228067398071289
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.046942710876465
Epoch: 40, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.419 Vali Acc: 0.822 Test Loss: 0.419 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.1143527030944824
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.457 Vali Acc: 0.844 Test Loss: 0.457 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.5484204292297363
Epoch: 42, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.408 Vali Acc: 0.856 Test Loss: 0.408 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 926274
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.898945569992065
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.770 Vali Acc: 0.178 Test Loss: 1.770 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 2.0880656242370605
Epoch: 2, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.653 Vali Acc: 0.378 Test Loss: 1.653 Test Acc: 0.378
Validation loss decreased (-0.177760 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 2.8597304821014404
Epoch: 3, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.499 Vali Acc: 0.500 Test Loss: 1.499 Test Acc: 0.500
Validation loss decreased (-0.377761 --> -0.499985).  Saving model ...
Epoch: 4 cost time: 2.3705153465270996
Epoch: 4, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.214 Vali Acc: 0.656 Test Loss: 1.214 Test Acc: 0.656
Validation loss decreased (-0.499985 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 1.9937498569488525
Epoch: 5, Steps: 12 | Train Loss: 1.108 Vali Loss: 0.942 Vali Acc: 0.700 Test Loss: 0.942 Test Acc: 0.700
Validation loss decreased (-0.655543 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 2.3792715072631836
Epoch: 6, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.714 Vali Acc: 0.706 Test Loss: 0.714 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705548).  Saving model ...
Epoch: 7 cost time: 3.2797863483428955
Epoch: 7, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.639 Vali Acc: 0.739 Test Loss: 0.639 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 2.4829277992248535
Epoch: 8, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.546 Vali Acc: 0.739 Test Loss: 0.546 Test Acc: 0.739
Validation loss decreased (-0.738883 --> -0.738883).  Saving model ...
Epoch: 9 cost time: 2.718517541885376
Epoch: 9, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.524 Vali Acc: 0.806 Test Loss: 0.524 Test Acc: 0.806
Validation loss decreased (-0.738883 --> -0.805550).  Saving model ...
Epoch: 10 cost time: 2.3189303874969482
Epoch: 10, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.450 Vali Acc: 0.789 Test Loss: 0.450 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4029338359832764
Epoch: 11, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.414 Vali Acc: 0.806 Test Loss: 0.414 Test Acc: 0.806
Validation loss decreased (-0.805550 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 2.216980457305908
Epoch: 12, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
Validation loss decreased (-0.805551 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 2.3941688537597656
Epoch: 13, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.391 Vali Acc: 0.839 Test Loss: 0.391 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.245116949081421
Epoch: 14, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.372 Vali Acc: 0.817 Test Loss: 0.372 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6537179946899414
Epoch: 15, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2326791286468506
Epoch: 16, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.446645498275757
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 2.4761135578155518
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 2.5336575508117676
Epoch: 19, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.621403932571411
Epoch: 20, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4626591205596924
Epoch: 21, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.385 Vali Acc: 0.822 Test Loss: 0.385 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1423776149749756
Epoch: 22, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.2107224464416504
Epoch: 23, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7568202018737793
Epoch: 24, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2390549182891846
Epoch: 25, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7662341594696045
Epoch: 26, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.074777603149414
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.384 Vali Acc: 0.839 Test Loss: 0.384 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.0344159603118896
Epoch: 28, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 779778
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.238337993621826
Epoch: 1, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.758 Vali Acc: 0.222 Test Loss: 1.758 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 2.143803119659424
Epoch: 2, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.623 Vali Acc: 0.417 Test Loss: 1.623 Test Acc: 0.417
Validation loss decreased (-0.222205 --> -0.416650).  Saving model ...
Epoch: 3 cost time: 2.416018009185791
Epoch: 3, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.400 Vali Acc: 0.639 Test Loss: 1.400 Test Acc: 0.639
Validation loss decreased (-0.416650 --> -0.638875).  Saving model ...
Epoch: 4 cost time: 2.191568374633789
Epoch: 4, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.108 Vali Acc: 0.661 Test Loss: 1.108 Test Acc: 0.661
Validation loss decreased (-0.638875 --> -0.661100).  Saving model ...
Epoch: 5 cost time: 2.1602938175201416
Epoch: 5, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.826 Vali Acc: 0.678 Test Loss: 0.826 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677770).  Saving model ...
Epoch: 6 cost time: 2.1183433532714844
Epoch: 6, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.655 Vali Acc: 0.700 Test Loss: 0.655 Test Acc: 0.700
Validation loss decreased (-0.677770 --> -0.699993).  Saving model ...
Epoch: 7 cost time: 1.7580246925354004
Epoch: 7, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.544 Vali Acc: 0.772 Test Loss: 0.544 Test Acc: 0.772
Validation loss decreased (-0.699993 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 1.993908405303955
Epoch: 8, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.477 Vali Acc: 0.772 Test Loss: 0.477 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 2.3045449256896973
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.436 Vali Acc: 0.811 Test Loss: 0.436 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 2.635883092880249
Epoch: 10, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.390 Vali Acc: 0.811 Test Loss: 0.390 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 1.940338134765625
Epoch: 11, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.401 Vali Acc: 0.811 Test Loss: 0.401 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9104301929473877
Epoch: 12, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 13 cost time: 1.8188354969024658
Epoch: 13, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.367 Vali Acc: 0.861 Test Loss: 0.367 Test Acc: 0.861
Validation loss decreased (-0.822219 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 1.9076128005981445
Epoch: 14, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8601207733154297
Epoch: 15, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8550398349761963
Epoch: 16, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.399 Vali Acc: 0.811 Test Loss: 0.399 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.928548812866211
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9045705795288086
Epoch: 18, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.329 Vali Acc: 0.844 Test Loss: 0.329 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8265860080718994
Epoch: 19, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1162099838256836
Epoch: 20, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.339 Vali Acc: 0.872 Test Loss: 0.339 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 1.7856521606445312
Epoch: 21, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8647961616516113
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2298474311828613
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 1.8245232105255127
Epoch: 24, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3535666465759277
Epoch: 25, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 26 cost time: 2.3638107776641846
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 27 cost time: 1.989617109298706
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 28 cost time: 2.359070301055908
Epoch: 28, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9408864974975586
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.347 Vali Acc: 0.878 Test Loss: 0.347 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3468523025512695
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.4038312435150146
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.0646135807037354
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.3521745204925537
Epoch: 33, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 34 cost time: 2.0493972301483154
Epoch: 34, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1968705654144287
Epoch: 35, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.338 Vali Acc: 0.878 Test Loss: 0.338 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.358532667160034
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.106579303741455
Epoch: 37, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.37949538230896
Epoch: 38, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.438988208770752
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.223010540008545
Epoch: 40, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.1212475299835205
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.443 Vali Acc: 0.872 Test Loss: 0.443 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.1789207458496094
Epoch: 42, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.432 Vali Acc: 0.872 Test Loss: 0.432 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.1571528911590576
Epoch: 43, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 779074
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.590295791625977
Epoch: 1, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.734 Vali Acc: 0.267 Test Loss: 1.734 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 1.8665931224822998
Epoch: 2, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.629 Vali Acc: 0.472 Test Loss: 1.629 Test Acc: 0.472
Validation loss decreased (-0.266649 --> -0.472206).  Saving model ...
Epoch: 3 cost time: 1.9176371097564697
Epoch: 3, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.422 Vali Acc: 0.567 Test Loss: 1.422 Test Acc: 0.567
Validation loss decreased (-0.472206 --> -0.566652).  Saving model ...
Epoch: 4 cost time: 2.0541844367980957
Epoch: 4, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.162 Vali Acc: 0.561 Test Loss: 1.162 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9432265758514404
Epoch: 5, Steps: 12 | Train Loss: 1.032 Vali Loss: 0.891 Vali Acc: 0.656 Test Loss: 0.891 Test Acc: 0.656
Validation loss decreased (-0.566652 --> -0.655547).  Saving model ...
Epoch: 6 cost time: 2.199488878250122
Epoch: 6, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.742 Vali Acc: 0.650 Test Loss: 0.742 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0937256813049316
Epoch: 7, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
Validation loss decreased (-0.655547 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 2.257530689239502
Epoch: 8, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.529 Vali Acc: 0.772 Test Loss: 0.529 Test Acc: 0.772
Validation loss decreased (-0.716660 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 1.7260031700134277
Epoch: 9, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.463 Vali Acc: 0.789 Test Loss: 0.463 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 2.122042417526245
Epoch: 10, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.418 Vali Acc: 0.822 Test Loss: 0.418 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 3.021182060241699
Epoch: 11, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.542393207550049
Epoch: 12, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.397 Vali Acc: 0.800 Test Loss: 0.397 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9942717552185059
Epoch: 13, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.364 Vali Acc: 0.783 Test Loss: 0.364 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4856655597686768
Epoch: 14, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.585660696029663
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 16 cost time: 1.9611618518829346
Epoch: 16, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.397 Vali Acc: 0.806 Test Loss: 0.397 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.292879819869995
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 2.375288963317871
Epoch: 18, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 1.7324843406677246
Epoch: 19, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1906232833862305
Epoch: 20, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.335 Vali Acc: 0.856 Test Loss: 0.335 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 2.4706482887268066
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3879668712615967
Epoch: 22, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.426 Vali Acc: 0.828 Test Loss: 0.426 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3949480056762695
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.354 Vali Acc: 0.867 Test Loss: 0.354 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 24 cost time: 2.319344997406006
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.335522174835205
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.420 Vali Acc: 0.861 Test Loss: 0.420 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.228747606277466
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.422 Vali Acc: 0.828 Test Loss: 0.422 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0306620597839355
Epoch: 27, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0824801921844482
Epoch: 28, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.446 Vali Acc: 0.828 Test Loss: 0.446 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8785834312438965
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.422 Vali Acc: 0.856 Test Loss: 0.422 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.3348066806793213
Epoch: 30, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.646 Vali Acc: 0.800 Test Loss: 0.646 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.2732338905334473
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.507 Vali Acc: 0.800 Test Loss: 0.507 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8903632164001465
Epoch: 32, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.470 Vali Acc: 0.861 Test Loss: 0.470 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.5066285133361816
Epoch: 33, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.404 Vali Acc: 0.839 Test Loss: 0.404 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 778370
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.951651334762573
Epoch: 1, Steps: 12 | Train Loss: 1.909 Vali Loss: 1.738 Vali Acc: 0.244 Test Loss: 1.738 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 2.658658027648926
Epoch: 2, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.633 Vali Acc: 0.278 Test Loss: 1.633 Test Acc: 0.278
Validation loss decreased (-0.244427 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 2.729698657989502
Epoch: 3, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.388 Vali Acc: 0.578 Test Loss: 1.388 Test Acc: 0.578
Validation loss decreased (-0.277761 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 2.756436586380005
Epoch: 4, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.093 Vali Acc: 0.728 Test Loss: 1.093 Test Acc: 0.728
Validation loss decreased (-0.577764 --> -0.727767).  Saving model ...
Epoch: 5 cost time: 2.0483670234680176
Epoch: 5, Steps: 12 | Train Loss: 1.008 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
Validation loss decreased (-0.727767 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 2.438479423522949
Epoch: 6, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.664 Vali Acc: 0.767 Test Loss: 0.664 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766660).  Saving model ...
Epoch: 7 cost time: 2.7068231105804443
Epoch: 7, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.572 Vali Acc: 0.767 Test Loss: 0.572 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 2.0442817211151123
Epoch: 8, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.481 Vali Acc: 0.783 Test Loss: 0.481 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783329).  Saving model ...
Epoch: 9 cost time: 2.1616909503936768
Epoch: 9, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.474 Vali Acc: 0.778 Test Loss: 0.474 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.217134475708008
Epoch: 10, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.384 Vali Acc: 0.822 Test Loss: 0.384 Test Acc: 0.822
Validation loss decreased (-0.783329 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 2.3141212463378906
Epoch: 11, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.3651888370513916
Epoch: 12, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.377 Vali Acc: 0.844 Test Loss: 0.377 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3227076530456543
Epoch: 13, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 2.7187445163726807
Epoch: 14, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.373 Vali Acc: 0.844 Test Loss: 0.373 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.32267427444458
Epoch: 15, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9413671493530273
Epoch: 16, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 17 cost time: 2.4930617809295654
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 2.250558614730835
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4624102115631104
Epoch: 19, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.845932960510254
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.349 Vali Acc: 0.856 Test Loss: 0.349 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.57181715965271
Epoch: 21, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.379 Vali Acc: 0.839 Test Loss: 0.379 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4449517726898193
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5021705627441406
Epoch: 23, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.273 Vali Acc: 0.861 Test Loss: 0.273 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4487061500549316
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.376983165740967
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0930230617523193
Epoch: 26, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6023759841918945
Epoch: 27, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 777666
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.054864406585693
Epoch: 1, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.746 Vali Acc: 0.261 Test Loss: 1.746 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 2.27441668510437
Epoch: 2, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.644 Vali Acc: 0.422 Test Loss: 1.644 Test Acc: 0.422
Validation loss decreased (-0.261094 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 2.1481239795684814
Epoch: 3, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.423 Vali Acc: 0.550 Test Loss: 1.423 Test Acc: 0.550
Validation loss decreased (-0.422206 --> -0.549986).  Saving model ...
Epoch: 4 cost time: 2.1580960750579834
Epoch: 4, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.549986 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 1.7612016201019287
Epoch: 5, Steps: 12 | Train Loss: 1.026 Vali Loss: 0.854 Vali Acc: 0.739 Test Loss: 0.854 Test Acc: 0.739
Validation loss decreased (-0.699989 --> -0.738880).  Saving model ...
Epoch: 6 cost time: 1.9877302646636963
Epoch: 6, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.702 Vali Acc: 0.728 Test Loss: 0.702 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.199824094772339
Epoch: 7, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.612 Vali Acc: 0.756 Test Loss: 0.612 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755549).  Saving model ...
Epoch: 8 cost time: 2.4148848056793213
Epoch: 8, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 2.301774740219116
Epoch: 9, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.456 Vali Acc: 0.833 Test Loss: 0.456 Test Acc: 0.833
Validation loss decreased (-0.788884 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 2.072092056274414
Epoch: 10, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.437 Vali Acc: 0.811 Test Loss: 0.437 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1101667881011963
Epoch: 11, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 2.2672019004821777
Epoch: 12, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 1.9346287250518799
Epoch: 13, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.853234052658081
Epoch: 14, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.356 Vali Acc: 0.856 Test Loss: 0.356 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 2.335867166519165
Epoch: 15, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3094322681427
Epoch: 16, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 2.025592088699341
Epoch: 17, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.358673095703125
Epoch: 18, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9596827030181885
Epoch: 19, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1529152393341064
Epoch: 20, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4915823936462402
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9857141971588135
Epoch: 22, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.312368869781494
Epoch: 23, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.334 Vali Acc: 0.856 Test Loss: 0.334 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0336110591888428
Epoch: 24, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.002146005630493
Epoch: 25, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866664).  Saving model ...
Epoch: 26 cost time: 2.2546112537384033
Epoch: 26, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 1.773970603942871
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.208366870880127
Epoch: 28, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.151463031768799
Epoch: 29, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.993215799331665
Epoch: 30, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.313 Vali Acc: 0.839 Test Loss: 0.313 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.508476734161377
Epoch: 31, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.4556002616882324
Epoch: 32, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.130376100540161
Epoch: 33, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.281 Vali Acc: 0.856 Test Loss: 0.281 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7755489349365234
Epoch: 34, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.932772159576416
Epoch: 35, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.362 Vali Acc: 0.839 Test Loss: 0.362 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.9273171424865723
Epoch: 36, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.433 Vali Acc: 0.828 Test Loss: 0.433 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 767202
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.696291208267212
Epoch: 1, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.798 Vali Acc: 0.206 Test Loss: 1.798 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 1.7325546741485596
Epoch: 2, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.705 Vali Acc: 0.300 Test Loss: 1.705 Test Acc: 0.300
Validation loss decreased (-0.205538 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.9966082572937012
Epoch: 3, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.527 Vali Acc: 0.389 Test Loss: 1.527 Test Acc: 0.389
Validation loss decreased (-0.299983 --> -0.388874).  Saving model ...
Epoch: 4 cost time: 2.332616090774536
Epoch: 4, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.283 Vali Acc: 0.561 Test Loss: 1.283 Test Acc: 0.561
Validation loss decreased (-0.388874 --> -0.561098).  Saving model ...
Epoch: 5 cost time: 2.456453561782837
Epoch: 5, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.063 Vali Acc: 0.617 Test Loss: 1.063 Test Acc: 0.617
Validation loss decreased (-0.561098 --> -0.616656).  Saving model ...
Epoch: 6 cost time: 2.155703544616699
Epoch: 6, Steps: 12 | Train Loss: 0.964 Vali Loss: 0.878 Vali Acc: 0.689 Test Loss: 0.878 Test Acc: 0.689
Validation loss decreased (-0.616656 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 1.7491161823272705
Epoch: 7, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.744 Vali Acc: 0.744 Test Loss: 0.744 Test Acc: 0.744
Validation loss decreased (-0.688880 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 1.9303557872772217
Epoch: 8, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.616 Vali Acc: 0.744 Test Loss: 0.616 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 2.0468361377716064
Epoch: 9, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
Validation loss decreased (-0.744438 --> -0.788883).  Saving model ...
Epoch: 10 cost time: 1.9995365142822266
Epoch: 10, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.475 Vali Acc: 0.767 Test Loss: 0.475 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.226816415786743
Epoch: 11, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.446 Vali Acc: 0.794 Test Loss: 0.446 Test Acc: 0.794
Validation loss decreased (-0.788883 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 2.2536070346832275
Epoch: 12, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.402 Vali Acc: 0.822 Test Loss: 0.402 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 1.8888590335845947
Epoch: 13, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.373 Vali Acc: 0.844 Test Loss: 0.373 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.7491321563720703
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5142345428466797
Epoch: 15, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.444687604904175
Epoch: 16, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5029067993164062
Epoch: 17, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.352 Vali Acc: 0.828 Test Loss: 0.352 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.260099172592163
Epoch: 18, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 19 cost time: 2.6179816722869873
Epoch: 19, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.029096841812134
Epoch: 20, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.352 Vali Acc: 0.811 Test Loss: 0.352 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4988911151885986
Epoch: 21, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 22 cost time: 2.2118191719055176
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 23 cost time: 2.187122106552124
Epoch: 23, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.306 Vali Acc: 0.839 Test Loss: 0.306 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4753167629241943
Epoch: 24, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.331599712371826
Epoch: 25, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 26 cost time: 2.39418888092041
Epoch: 26, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.299 Vali Acc: 0.844 Test Loss: 0.299 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.253671884536743
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.309 Vali Acc: 0.817 Test Loss: 0.309 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.20404052734375
Epoch: 28, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.275 Vali Acc: 0.850 Test Loss: 0.275 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.742417097091675
Epoch: 29, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.298 Vali Acc: 0.833 Test Loss: 0.298 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.012223482131958
Epoch: 30, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.938878059387207
Epoch: 31, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.545328140258789
Epoch: 32, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.350 Vali Acc: 0.800 Test Loss: 0.350 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.5056064128875732
Epoch: 33, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 34 cost time: 2.400787591934204
Epoch: 34, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.347 Vali Acc: 0.822 Test Loss: 0.347 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.451639413833618
Epoch: 35, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.373 Vali Acc: 0.839 Test Loss: 0.373 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.8539609909057617
Epoch: 36, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.299 Vali Acc: 0.839 Test Loss: 0.299 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.8207972049713135
Epoch: 37, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.351 Vali Acc: 0.817 Test Loss: 0.351 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.932711601257324
Epoch: 38, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.9484543800354004
Epoch: 39, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.307 Vali Acc: 0.839 Test Loss: 0.307 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.1869771480560303
Epoch: 40, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.1320979595184326
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.294 Vali Acc: 0.833 Test Loss: 0.294 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.201923370361328
Epoch: 42, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.3302435874938965
Epoch: 43, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 766850
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.217621088027954
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.768 Vali Acc: 0.172 Test Loss: 1.768 Test Acc: 0.172
Validation loss decreased (inf --> -0.172205).  Saving model ...
Epoch: 2 cost time: 2.1981375217437744
Epoch: 2, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.666 Vali Acc: 0.389 Test Loss: 1.666 Test Acc: 0.389
Validation loss decreased (-0.172205 --> -0.388872).  Saving model ...
Epoch: 3 cost time: 2.4117865562438965
Epoch: 3, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.476 Vali Acc: 0.539 Test Loss: 1.476 Test Acc: 0.539
Validation loss decreased (-0.388872 --> -0.538874).  Saving model ...
Epoch: 4 cost time: 2.280869483947754
Epoch: 4, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.254 Vali Acc: 0.633 Test Loss: 1.254 Test Acc: 0.633
Validation loss decreased (-0.538874 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 2.2771148681640625
Epoch: 5, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 2.180695056915283
Epoch: 6, Steps: 12 | Train Loss: 0.939 Vali Loss: 0.870 Vali Acc: 0.694 Test Loss: 0.870 Test Acc: 0.694
Validation loss decreased (-0.666656 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 1.79439115524292
Epoch: 7, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 2.0598490238189697
Epoch: 8, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.627 Vali Acc: 0.739 Test Loss: 0.627 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738883).  Saving model ...
Epoch: 9 cost time: 2.0464608669281006
Epoch: 9, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.535 Vali Acc: 0.761 Test Loss: 0.535 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 10 cost time: 1.9512217044830322
Epoch: 10, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.482 Vali Acc: 0.800 Test Loss: 0.482 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 1.8528697490692139
Epoch: 11, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.435 Vali Acc: 0.789 Test Loss: 0.435 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9178624153137207
Epoch: 12, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.409 Vali Acc: 0.828 Test Loss: 0.409 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 1.899810791015625
Epoch: 13, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.393 Vali Acc: 0.800 Test Loss: 0.393 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1725800037384033
Epoch: 14, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.929614782333374
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.377 Vali Acc: 0.828 Test Loss: 0.377 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.822213888168335
Epoch: 16, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 17 cost time: 2.072920083999634
Epoch: 17, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7151780128479004
Epoch: 18, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.333 Vali Acc: 0.811 Test Loss: 0.333 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9642524719238281
Epoch: 19, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 20 cost time: 1.8637468814849854
Epoch: 20, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9516479969024658
Epoch: 21, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.084836006164551
Epoch: 22, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9738802909851074
Epoch: 23, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.449 Vali Acc: 0.806 Test Loss: 0.449 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.188788652420044
Epoch: 24, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.408 Vali Acc: 0.811 Test Loss: 0.408 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8199577331542969
Epoch: 25, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2391605377197266
Epoch: 26, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 27 cost time: 1.9221653938293457
Epoch: 27, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.333272695541382
Epoch: 28, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1148393154144287
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 30 cost time: 2.0841915607452393
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.358 Vali Acc: 0.806 Test Loss: 0.358 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.037104845046997
Epoch: 31, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.339087963104248
Epoch: 32, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.312 Vali Acc: 0.839 Test Loss: 0.312 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.3346633911132812
Epoch: 33, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.318 Vali Acc: 0.839 Test Loss: 0.318 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.0362188816070557
Epoch: 34, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.342 Vali Acc: 0.811 Test Loss: 0.342 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.0881423950195312
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.1452033519744873
Epoch: 36, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.367 Vali Acc: 0.817 Test Loss: 0.367 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.149462938308716
Epoch: 37, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.272519111633301
Epoch: 38, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.378 Vali Acc: 0.872 Test Loss: 0.378 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872218).  Saving model ...
Epoch: 39 cost time: 2.0632386207580566
Epoch: 39, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.429 Vali Acc: 0.811 Test Loss: 0.429 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.280636787414551
Epoch: 40, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.383 Vali Acc: 0.856 Test Loss: 0.383 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.470390796661377
Epoch: 41, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.275723695755005
Epoch: 42, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.242856025695801
Epoch: 43, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.024712324142456
Epoch: 44, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.9844446182250977
Epoch: 45, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 46 cost time: 1.9340405464172363
Epoch: 46, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 2.397797107696533
Epoch: 47, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 48 cost time: 2.3188061714172363
Epoch: 48, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.3311572074890137
Epoch: 49, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.2419254779815674
Epoch: 50, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.918816328048706
Epoch: 51, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.0664680004119873
Epoch: 52, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.350 Vali Acc: 0.839 Test Loss: 0.350 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.2052297592163086
Epoch: 53, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.9738469123840332
Epoch: 54, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.99568772315979
Epoch: 55, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.27766489982605
Epoch: 56, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.1085548400878906
Epoch: 57, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 766498
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.556887149810791
Epoch: 1, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.757 Vali Acc: 0.233 Test Loss: 1.757 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 2.589782953262329
Epoch: 2, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.644 Vali Acc: 0.383 Test Loss: 1.644 Test Acc: 0.383
Validation loss decreased (-0.233316 --> -0.383317).  Saving model ...
Epoch: 3 cost time: 2.48738169670105
Epoch: 3, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.462 Vali Acc: 0.578 Test Loss: 1.462 Test Acc: 0.578
Validation loss decreased (-0.383317 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 2.255626916885376
Epoch: 4, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.244 Vali Acc: 0.617 Test Loss: 1.244 Test Acc: 0.617
Validation loss decreased (-0.577763 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 2.0885558128356934
Epoch: 5, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.021 Vali Acc: 0.706 Test Loss: 1.021 Test Acc: 0.706
Validation loss decreased (-0.616654 --> -0.705545).  Saving model ...
Epoch: 6 cost time: 1.9903686046600342
Epoch: 6, Steps: 12 | Train Loss: 1.019 Vali Loss: 0.819 Vali Acc: 0.717 Test Loss: 0.819 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716658).  Saving model ...
Epoch: 7 cost time: 2.347198486328125
Epoch: 7, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 2.0565295219421387
Epoch: 8, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.597 Vali Acc: 0.772 Test Loss: 0.597 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772216).  Saving model ...
Epoch: 9 cost time: 2.587491989135742
Epoch: 9, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 2.4122486114501953
Epoch: 10, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
Validation loss decreased (-0.783328 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 2.1184351444244385
Epoch: 11, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.418 Vali Acc: 0.828 Test Loss: 0.418 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.00875186920166
Epoch: 12, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 1.9613640308380127
Epoch: 13, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.381 Vali Acc: 0.828 Test Loss: 0.381 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.309077739715576
Epoch: 14, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.344 Vali Acc: 0.872 Test Loss: 0.344 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 1.9709653854370117
Epoch: 15, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7311789989471436
Epoch: 16, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1253294944763184
Epoch: 17, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4241652488708496
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.378 Vali Acc: 0.811 Test Loss: 0.378 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7751493453979492
Epoch: 19, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 2.2161428928375244
Epoch: 20, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.312918186187744
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2340567111968994
Epoch: 22, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.611133575439453
Epoch: 23, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2891106605529785
Epoch: 24, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2998623847961426
Epoch: 25, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0567288398742676
Epoch: 26, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.21427059173584
Epoch: 27, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.69533371925354
Epoch: 28, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4712369441986084
Epoch: 29, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 30 cost time: 2.5429465770721436
Epoch: 30, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.350414752960205
Epoch: 31, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.336 Vali Acc: 0.861 Test Loss: 0.336 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.3962907791137695
Epoch: 32, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.183243751525879
Epoch: 33, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.4003729820251465
Epoch: 34, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.9409162998199463
Epoch: 35, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.969099760055542
Epoch: 36, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.1822495460510254
Epoch: 37, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.273 Vali Acc: 0.872 Test Loss: 0.273 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.9147236347198486
Epoch: 38, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.049884796142578
Epoch: 39, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 766146
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.701690196990967
Epoch: 1, Steps: 12 | Train Loss: 1.974 Vali Loss: 1.831 Vali Acc: 0.333 Test Loss: 1.831 Test Acc: 0.333
Validation loss decreased (inf --> -0.333315).  Saving model ...
Epoch: 2 cost time: 2.6610536575317383
Epoch: 2, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.681 Vali Acc: 0.328 Test Loss: 1.681 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7643322944641113
Epoch: 3, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.568 Vali Acc: 0.406 Test Loss: 1.568 Test Acc: 0.406
Validation loss decreased (-0.333315 --> -0.405540).  Saving model ...
Epoch: 4 cost time: 1.9991614818572998
Epoch: 4, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.399 Vali Acc: 0.572 Test Loss: 1.399 Test Acc: 0.572
Validation loss decreased (-0.405540 --> -0.572208).  Saving model ...
Epoch: 5 cost time: 2.223310708999634
Epoch: 5, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.170 Vali Acc: 0.611 Test Loss: 1.170 Test Acc: 0.611
Validation loss decreased (-0.572208 --> -0.611099).  Saving model ...
Epoch: 6 cost time: 2.7902183532714844
Epoch: 6, Steps: 12 | Train Loss: 1.077 Vali Loss: 0.943 Vali Acc: 0.700 Test Loss: 0.943 Test Acc: 0.700
Validation loss decreased (-0.611099 --> -0.699991).  Saving model ...
Epoch: 7 cost time: 2.375260829925537
Epoch: 7, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
Validation loss decreased (-0.699991 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 2.2795913219451904
Epoch: 8, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 2.153883934020996
Epoch: 9, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.239238739013672
Epoch: 10, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.472 Vali Acc: 0.811 Test Loss: 0.472 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 2.612870454788208
Epoch: 11, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.430 Vali Acc: 0.839 Test Loss: 0.430 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 2.221130132675171
Epoch: 12, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3475453853607178
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.387 Vali Acc: 0.844 Test Loss: 0.387 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 2.146341323852539
Epoch: 14, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 2.018143653869629
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.411 Vali Acc: 0.817 Test Loss: 0.411 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.388678550720215
Epoch: 16, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.711338996887207
Epoch: 17, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7066760063171387
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 1.8834545612335205
Epoch: 19, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3040359020233154
Epoch: 20, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 3.3853399753570557
Epoch: 21, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5059032440185547
Epoch: 22, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.464113712310791
Epoch: 23, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4912333488464355
Epoch: 24, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.796152114868164
Epoch: 25, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1454684734344482
Epoch: 26, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.379 Vali Acc: 0.839 Test Loss: 0.379 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.5963616371154785
Epoch: 27, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.6685400009155273
Epoch: 28, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.407 Vali Acc: 0.828 Test Loss: 0.407 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.8851332664489746
Epoch: 29, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.6639935970306396
Epoch: 30, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.418 Vali Acc: 0.817 Test Loss: 0.418 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 467682
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.763763189315796
Epoch: 1, Steps: 12 | Train Loss: 1.984 Vali Loss: 1.828 Vali Acc: 0.078 Test Loss: 1.828 Test Acc: 0.078
Validation loss decreased (inf --> -0.077759).  Saving model ...
Epoch: 2 cost time: 2.491199493408203
Epoch: 2, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.779 Vali Acc: 0.172 Test Loss: 1.779 Test Acc: 0.172
Validation loss decreased (-0.077759 --> -0.172204).  Saving model ...
Epoch: 3 cost time: 2.2495152950286865
Epoch: 3, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.665 Vali Acc: 0.417 Test Loss: 1.665 Test Acc: 0.417
Validation loss decreased (-0.172204 --> -0.416650).  Saving model ...
Epoch: 4 cost time: 2.3122286796569824
Epoch: 4, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.538 Vali Acc: 0.439 Test Loss: 1.538 Test Acc: 0.439
Validation loss decreased (-0.416650 --> -0.438874).  Saving model ...
Epoch: 5 cost time: 2.5370733737945557
Epoch: 5, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.348 Vali Acc: 0.633 Test Loss: 1.348 Test Acc: 0.633
Validation loss decreased (-0.438874 --> -0.633320).  Saving model ...
Epoch: 6 cost time: 2.162466526031494
Epoch: 6, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 2.768219232559204
Epoch: 7, Steps: 12 | Train Loss: 1.054 Vali Loss: 0.930 Vali Acc: 0.683 Test Loss: 0.930 Test Acc: 0.683
Validation loss decreased (-0.649989 --> -0.683324).  Saving model ...
Epoch: 8 cost time: 2.4652299880981445
Epoch: 8, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.789 Vali Acc: 0.711 Test Loss: 0.789 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711103).  Saving model ...
Epoch: 9 cost time: 2.181917667388916
Epoch: 9, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.684 Vali Acc: 0.689 Test Loss: 0.684 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.582280397415161
Epoch: 10, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.606 Vali Acc: 0.733 Test Loss: 0.606 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733327).  Saving model ...
Epoch: 11 cost time: 2.392604112625122
Epoch: 11, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.543 Vali Acc: 0.744 Test Loss: 0.543 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 12 cost time: 2.7421905994415283
Epoch: 12, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.516 Vali Acc: 0.761 Test Loss: 0.516 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 13 cost time: 2.0468735694885254
Epoch: 13, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.462 Vali Acc: 0.800 Test Loss: 0.462 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799995).  Saving model ...
Epoch: 14 cost time: 2.380228042602539
Epoch: 14, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.431 Vali Acc: 0.783 Test Loss: 0.431 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8874902725219727
Epoch: 15, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.430 Vali Acc: 0.811 Test Loss: 0.430 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 1.912034511566162
Epoch: 16, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 17 cost time: 2.3134050369262695
Epoch: 17, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.374 Vali Acc: 0.822 Test Loss: 0.374 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 18 cost time: 2.3232386112213135
Epoch: 18, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.352 Vali Acc: 0.828 Test Loss: 0.352 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 2.824453592300415
Epoch: 19, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 20 cost time: 2.7846457958221436
Epoch: 20, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.344 Vali Acc: 0.839 Test Loss: 0.344 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4523818492889404
Epoch: 21, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.379 Vali Acc: 0.817 Test Loss: 0.379 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5191125869750977
Epoch: 22, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.411550283432007
Epoch: 23, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.726654052734375
Epoch: 24, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.376 Vali Acc: 0.833 Test Loss: 0.376 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8305351734161377
Epoch: 25, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4534378051757812
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 27 cost time: 2.07210111618042
Epoch: 27, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1033527851104736
Epoch: 28, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.311 Vali Acc: 0.844 Test Loss: 0.311 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.6564712524414062
Epoch: 29, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2186200618743896
Epoch: 30, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.7787880897521973
Epoch: 31, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.1142098903656006
Epoch: 32, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.325 Vali Acc: 0.811 Test Loss: 0.325 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.8338475227355957
Epoch: 33, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.316 Vali Acc: 0.822 Test Loss: 0.316 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.33004093170166
Epoch: 34, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.4816806316375732
Epoch: 35, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 2.28047513961792
Epoch: 36, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.548043966293335
Epoch: 37, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.307 Vali Acc: 0.828 Test Loss: 0.307 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.827538251876831
Epoch: 38, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.4087605476379395
Epoch: 39, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 40 cost time: 2.0463197231292725
Epoch: 40, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.342 Vali Acc: 0.856 Test Loss: 0.342 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.3103559017181396
Epoch: 41, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.784512996673584
Epoch: 42, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.342 Vali Acc: 0.844 Test Loss: 0.342 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.1318585872650146
Epoch: 43, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.345 Vali Acc: 0.856 Test Loss: 0.345 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.3487045764923096
Epoch: 44, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.615900993347168
Epoch: 45, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.3688008785247803
Epoch: 46, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.364 Vali Acc: 0.856 Test Loss: 0.364 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.5357089042663574
Epoch: 47, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.422482490539551
Epoch: 48, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.402 Vali Acc: 0.822 Test Loss: 0.402 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.679823398590088
Epoch: 49, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 50 cost time: 2.19316029548645
Epoch: 50, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.375 Vali Acc: 0.850 Test Loss: 0.375 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.2355167865753174
Epoch: 51, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.4426443576812744
Epoch: 52, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.6150686740875244
Epoch: 53, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.3394079208374023
Epoch: 54, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.431016683578491
Epoch: 55, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 2.2626609802246094
Epoch: 56, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.357 Vali Acc: 0.856 Test Loss: 0.357 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 2.360236644744873
Epoch: 57, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.364 Vali Acc: 0.856 Test Loss: 0.364 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 2.250905752182007
Epoch: 58, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.377 Vali Acc: 0.856 Test Loss: 0.377 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 2.46325945854187
Epoch: 59, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 467330
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.0784430503845215
Epoch: 1, Steps: 12 | Train Loss: 1.920 Vali Loss: 1.813 Vali Acc: 0.178 Test Loss: 1.813 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 2.2219862937927246
Epoch: 2, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.718 Vali Acc: 0.322 Test Loss: 1.718 Test Acc: 0.322
Validation loss decreased (-0.177760 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 2.417177200317383
Epoch: 3, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.577 Vali Acc: 0.478 Test Loss: 1.577 Test Acc: 0.478
Validation loss decreased (-0.322205 --> -0.477762).  Saving model ...
Epoch: 4 cost time: 2.4266104698181152
Epoch: 4, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.386 Vali Acc: 0.561 Test Loss: 1.386 Test Acc: 0.561
Validation loss decreased (-0.477762 --> -0.561097).  Saving model ...
Epoch: 5 cost time: 2.81660795211792
Epoch: 5, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.110 Vali Acc: 0.656 Test Loss: 1.110 Test Acc: 0.656
Validation loss decreased (-0.561097 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 2.7203221321105957
Epoch: 6, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.859 Vali Acc: 0.728 Test Loss: 0.859 Test Acc: 0.728
Validation loss decreased (-0.655544 --> -0.727769).  Saving model ...
Epoch: 7 cost time: 2.4297778606414795
Epoch: 7, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.698 Vali Acc: 0.744 Test Loss: 0.698 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 2.5605483055114746
Epoch: 8, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
Validation loss decreased (-0.744437 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 2.039590358734131
Epoch: 9, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
Validation loss decreased (-0.783328 --> -0.822217).  Saving model ...
Epoch: 10 cost time: 2.4787588119506836
Epoch: 10, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.452 Vali Acc: 0.822 Test Loss: 0.452 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 2.2483482360839844
Epoch: 11, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 2.07207989692688
Epoch: 12, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.381 Vali Acc: 0.839 Test Loss: 0.381 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 2.3774898052215576
Epoch: 13, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.384 Vali Acc: 0.822 Test Loss: 0.384 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.523124933242798
Epoch: 14, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.361 Vali Acc: 0.839 Test Loss: 0.361 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 2.6596567630767822
Epoch: 15, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.361 Vali Acc: 0.844 Test Loss: 0.361 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 3.2422025203704834
Epoch: 16, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 2.8468639850616455
Epoch: 17, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0933730602264404
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.299384593963623
Epoch: 19, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8835906982421875
Epoch: 20, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 2.2481796741485596
Epoch: 21, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1705102920532227
Epoch: 22, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.602973461151123
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.329 Vali Acc: 0.822 Test Loss: 0.329 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.412430763244629
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.405709981918335
Epoch: 25, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1602401733398438
Epoch: 26, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.493666648864746
Epoch: 27, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.613348960876465
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.302544116973877
Epoch: 29, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.370 Vali Acc: 0.839 Test Loss: 0.370 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.4119083881378174
Epoch: 30, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 466978
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.3216307163238525
Epoch: 1, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.775 Vali Acc: 0.194 Test Loss: 1.775 Test Acc: 0.194
Validation loss decreased (inf --> -0.194427).  Saving model ...
Epoch: 2 cost time: 2.4531707763671875
Epoch: 2, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.720 Vali Acc: 0.350 Test Loss: 1.720 Test Acc: 0.350
Validation loss decreased (-0.194427 --> -0.349983).  Saving model ...
Epoch: 3 cost time: 1.8615648746490479
Epoch: 3, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.607 Vali Acc: 0.394 Test Loss: 1.607 Test Acc: 0.394
Validation loss decreased (-0.349983 --> -0.394428).  Saving model ...
Epoch: 4 cost time: 2.49385404586792
Epoch: 4, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.417 Vali Acc: 0.539 Test Loss: 1.417 Test Acc: 0.539
Validation loss decreased (-0.394428 --> -0.538875).  Saving model ...
Epoch: 5 cost time: 2.490727663040161
Epoch: 5, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.162 Vali Acc: 0.594 Test Loss: 1.162 Test Acc: 0.594
Validation loss decreased (-0.538875 --> -0.594433).  Saving model ...
Epoch: 6 cost time: 2.2621545791625977
Epoch: 6, Steps: 12 | Train Loss: 1.046 Vali Loss: 0.976 Vali Acc: 0.661 Test Loss: 0.976 Test Acc: 0.661
Validation loss decreased (-0.594433 --> -0.661101).  Saving model ...
Epoch: 7 cost time: 2.631800651550293
Epoch: 7, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.821 Vali Acc: 0.683 Test Loss: 0.821 Test Acc: 0.683
Validation loss decreased (-0.661101 --> -0.683325).  Saving model ...
Epoch: 8 cost time: 2.2561378479003906
Epoch: 8, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.715 Vali Acc: 0.711 Test Loss: 0.715 Test Acc: 0.711
Validation loss decreased (-0.683325 --> -0.711104).  Saving model ...
Epoch: 9 cost time: 2.7720298767089844
Epoch: 9, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.636 Vali Acc: 0.706 Test Loss: 0.636 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6086502075195312
Epoch: 10, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.539 Vali Acc: 0.778 Test Loss: 0.539 Test Acc: 0.778
Validation loss decreased (-0.711104 --> -0.777772).  Saving model ...
Epoch: 11 cost time: 1.888314962387085
Epoch: 11, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.481 Vali Acc: 0.772 Test Loss: 0.481 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0741589069366455
Epoch: 12, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.463 Vali Acc: 0.806 Test Loss: 0.463 Test Acc: 0.806
Validation loss decreased (-0.777772 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 1.9447791576385498
Epoch: 13, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.435 Vali Acc: 0.822 Test Loss: 0.435 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 2.371318817138672
Epoch: 14, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.415 Vali Acc: 0.789 Test Loss: 0.415 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.379422426223755
Epoch: 15, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.395 Vali Acc: 0.800 Test Loss: 0.395 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4332692623138428
Epoch: 16, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.403 Vali Acc: 0.811 Test Loss: 0.403 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6444618701934814
Epoch: 17, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.403 Vali Acc: 0.800 Test Loss: 0.403 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.213787794113159
Epoch: 18, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.404 Vali Acc: 0.789 Test Loss: 0.404 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.518080472946167
Epoch: 19, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.362 Vali Acc: 0.839 Test Loss: 0.362 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 2.1167185306549072
Epoch: 20, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1066575050354004
Epoch: 21, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1543726921081543
Epoch: 22, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.4126052856445312
Epoch: 23, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.262125015258789
Epoch: 24, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.329038143157959
Epoch: 25, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.322 Vali Acc: 0.856 Test Loss: 0.322 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 2.5650808811187744
Epoch: 26, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.388 Vali Acc: 0.789 Test Loss: 0.388 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2394165992736816
Epoch: 27, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2824747562408447
Epoch: 28, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.354 Vali Acc: 0.817 Test Loss: 0.354 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.4113800525665283
Epoch: 29, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.3403732776641846
Epoch: 30, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.326 Vali Acc: 0.817 Test Loss: 0.326 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.812891960144043
Epoch: 31, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.5925121307373047
Epoch: 32, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.403 Vali Acc: 0.800 Test Loss: 0.403 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.3653669357299805
Epoch: 33, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.1148345470428467
Epoch: 34, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.313 Vali Acc: 0.828 Test Loss: 0.313 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.999859094619751
Epoch: 35, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 36 cost time: 1.730065107345581
Epoch: 36, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.999398946762085
Epoch: 37, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.4102025032043457
Epoch: 38, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.108586549758911
Epoch: 39, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.394 Vali Acc: 0.833 Test Loss: 0.394 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.619511604309082
Epoch: 40, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.398 Vali Acc: 0.828 Test Loss: 0.398 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.1784441471099854
Epoch: 41, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.427 Vali Acc: 0.794 Test Loss: 0.427 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.9992480278015137
Epoch: 42, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.346 Vali Acc: 0.833 Test Loss: 0.346 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.793665647506714
Epoch: 43, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.0156102180480957
Epoch: 44, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.433 Vali Acc: 0.800 Test Loss: 0.433 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.4449925422668457
Epoch: 45, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 466626
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.550100564956665
Epoch: 1, Steps: 12 | Train Loss: 1.994 Vali Loss: 1.827 Vali Acc: 0.128 Test Loss: 1.827 Test Acc: 0.128
Validation loss decreased (inf --> -0.127760).  Saving model ...
Epoch: 2 cost time: 2.241002321243286
Epoch: 2, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.723 Vali Acc: 0.239 Test Loss: 1.723 Test Acc: 0.239
Validation loss decreased (-0.127760 --> -0.238872).  Saving model ...
Epoch: 3 cost time: 2.17671275138855
Epoch: 3, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.655 Vali Acc: 0.344 Test Loss: 1.655 Test Acc: 0.344
Validation loss decreased (-0.238872 --> -0.344428).  Saving model ...
Epoch: 4 cost time: 2.1286227703094482
Epoch: 4, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.537 Vali Acc: 0.483 Test Loss: 1.537 Test Acc: 0.483
Validation loss decreased (-0.344428 --> -0.483318).  Saving model ...
Epoch: 5 cost time: 2.3094935417175293
Epoch: 5, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.344 Vali Acc: 0.556 Test Loss: 1.344 Test Acc: 0.556
Validation loss decreased (-0.483318 --> -0.555542).  Saving model ...
Epoch: 6 cost time: 2.328160524368286
Epoch: 6, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.117 Vali Acc: 0.611 Test Loss: 1.117 Test Acc: 0.611
Validation loss decreased (-0.555542 --> -0.611100).  Saving model ...
Epoch: 7 cost time: 2.02268648147583
Epoch: 7, Steps: 12 | Train Loss: 1.093 Vali Loss: 0.926 Vali Acc: 0.667 Test Loss: 0.926 Test Acc: 0.667
Validation loss decreased (-0.611100 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 2.313817024230957
Epoch: 8, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.775 Vali Acc: 0.717 Test Loss: 0.775 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.716659).  Saving model ...
Epoch: 9 cost time: 1.9455859661102295
Epoch: 9, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.670 Vali Acc: 0.750 Test Loss: 0.670 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 2.032287836074829
Epoch: 10, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.575 Vali Acc: 0.778 Test Loss: 0.575 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777772).  Saving model ...
Epoch: 11 cost time: 1.90376877784729
Epoch: 11, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.520 Vali Acc: 0.778 Test Loss: 0.520 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777773).  Saving model ...
Epoch: 12 cost time: 2.2539968490600586
Epoch: 12, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.500 Vali Acc: 0.750 Test Loss: 0.500 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.286752700805664
Epoch: 13, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.455 Vali Acc: 0.817 Test Loss: 0.455 Test Acc: 0.817
Validation loss decreased (-0.777773 --> -0.816662).  Saving model ...
Epoch: 14 cost time: 2.3399171829223633
Epoch: 14, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.427 Vali Acc: 0.783 Test Loss: 0.427 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.166551113128662
Epoch: 15, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.437 Vali Acc: 0.811 Test Loss: 0.437 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1378018856048584
Epoch: 16, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.416 Vali Acc: 0.794 Test Loss: 0.416 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4657254219055176
Epoch: 17, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.849982500076294
Epoch: 18, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.404 Vali Acc: 0.783 Test Loss: 0.404 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.192505121231079
Epoch: 19, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.415 Vali Acc: 0.833 Test Loss: 0.415 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 2.246727466583252
Epoch: 20, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4471447467803955
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 2.651460647583008
Epoch: 22, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 23 cost time: 2.7088205814361572
Epoch: 23, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 24 cost time: 2.826880693435669
Epoch: 24, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849996).  Saving model ...
Epoch: 25 cost time: 2.5492537021636963
Epoch: 25, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8756678104400635
Epoch: 26, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.372 Vali Acc: 0.839 Test Loss: 0.372 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9797570705413818
Epoch: 27, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.378 Vali Acc: 0.811 Test Loss: 0.378 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0782158374786377
Epoch: 28, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.077479600906372
Epoch: 29, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.217360734939575
Epoch: 30, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.427396774291992
Epoch: 31, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.2047667503356934
Epoch: 32, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.112197160720825
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.347 Vali Acc: 0.828 Test Loss: 0.347 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.8573312759399414
Epoch: 34, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 317922
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.866865158081055
Epoch: 1, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.776 Vali Acc: 0.167 Test Loss: 1.776 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 2.155547618865967
Epoch: 2, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.736 Vali Acc: 0.278 Test Loss: 1.736 Test Acc: 0.278
Validation loss decreased (-0.166649 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 2.4747259616851807
Epoch: 3, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.653 Vali Acc: 0.422 Test Loss: 1.653 Test Acc: 0.422
Validation loss decreased (-0.277760 --> -0.422206).  Saving model ...
Epoch: 4 cost time: 2.052312135696411
Epoch: 4, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.532 Vali Acc: 0.500 Test Loss: 1.532 Test Acc: 0.500
Validation loss decreased (-0.422206 --> -0.499985).  Saving model ...
Epoch: 5 cost time: 2.3338241577148438
Epoch: 5, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.350 Vali Acc: 0.578 Test Loss: 1.350 Test Acc: 0.578
Validation loss decreased (-0.499985 --> -0.577764).  Saving model ...
Epoch: 6 cost time: 2.4155020713806152
Epoch: 6, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
Validation loss decreased (-0.577764 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 2.5938217639923096
Epoch: 7, Steps: 12 | Train Loss: 1.075 Vali Loss: 0.888 Vali Acc: 0.706 Test Loss: 0.888 Test Acc: 0.706
Validation loss decreased (-0.649989 --> -0.705547).  Saving model ...
Epoch: 8 cost time: 2.8661575317382812
Epoch: 8, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.736 Vali Acc: 0.733 Test Loss: 0.736 Test Acc: 0.733
Validation loss decreased (-0.705547 --> -0.733326).  Saving model ...
Epoch: 9 cost time: 2.150235652923584
Epoch: 9, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.627 Vali Acc: 0.733 Test Loss: 0.627 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 2.2337875366210938
Epoch: 10, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.545 Vali Acc: 0.772 Test Loss: 0.545 Test Acc: 0.772
Validation loss decreased (-0.733327 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 2.8346920013427734
Epoch: 11, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.492 Vali Acc: 0.800 Test Loss: 0.492 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 2.5398192405700684
Epoch: 12, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.433 Vali Acc: 0.811 Test Loss: 0.433 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 2.229506015777588
Epoch: 13, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 2.019885540008545
Epoch: 14, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.390 Vali Acc: 0.833 Test Loss: 0.390 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 2.35778546333313
Epoch: 15, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 16 cost time: 1.9255950450897217
Epoch: 16, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.346 Vali Acc: 0.833 Test Loss: 0.346 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 2.100296974182129
Epoch: 17, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 2.127232313156128
Epoch: 18, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9654436111450195
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2171719074249268
Epoch: 20, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 2.536919355392456
Epoch: 21, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 22 cost time: 2.474127769470215
Epoch: 22, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.246880292892456
Epoch: 23, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 24 cost time: 1.90621018409729
Epoch: 24, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1657121181488037
Epoch: 25, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9088184833526611
Epoch: 26, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1652255058288574
Epoch: 27, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 2.21285343170166
Epoch: 28, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.281172752380371
Epoch: 29, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.183166980743408
Epoch: 30, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.337 Vali Acc: 0.822 Test Loss: 0.337 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.3774642944335938
Epoch: 31, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.310 Vali Acc: 0.867 Test Loss: 0.310 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.5958237648010254
Epoch: 32, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.323514461517334
Epoch: 33, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.4296579360961914
Epoch: 34, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.0619213581085205
Epoch: 35, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.108912706375122
Epoch: 36, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.335 Vali Acc: 0.817 Test Loss: 0.335 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.2510855197906494
Epoch: 37, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 317570
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.498950481414795
Epoch: 1, Steps: 12 | Train Loss: 1.898 Vali Loss: 1.856 Vali Acc: 0.211 Test Loss: 1.856 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 2.038271903991699
Epoch: 2, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.752 Vali Acc: 0.183 Test Loss: 1.752 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5770986080169678
Epoch: 3, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.630 Vali Acc: 0.383 Test Loss: 1.630 Test Acc: 0.383
Validation loss decreased (-0.211093 --> -0.383317).  Saving model ...
Epoch: 4 cost time: 2.2929470539093018
Epoch: 4, Steps: 12 | Train Loss: 1.629 Vali Loss: 1.490 Vali Acc: 0.450 Test Loss: 1.490 Test Acc: 0.450
Validation loss decreased (-0.383317 --> -0.449985).  Saving model ...
Epoch: 5 cost time: 2.4062631130218506
Epoch: 5, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.304 Vali Acc: 0.561 Test Loss: 1.304 Test Acc: 0.561
Validation loss decreased (-0.449985 --> -0.561098).  Saving model ...
Epoch: 6 cost time: 2.068263053894043
Epoch: 6, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.113 Vali Acc: 0.606 Test Loss: 1.113 Test Acc: 0.606
Validation loss decreased (-0.561098 --> -0.605544).  Saving model ...
Epoch: 7 cost time: 2.305691957473755
Epoch: 7, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.933 Vali Acc: 0.661 Test Loss: 0.933 Test Acc: 0.661
Validation loss decreased (-0.605544 --> -0.661102).  Saving model ...
Epoch: 8 cost time: 2.2931175231933594
Epoch: 8, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.815 Vali Acc: 0.667 Test Loss: 0.815 Test Acc: 0.667
Validation loss decreased (-0.661102 --> -0.666659).  Saving model ...
Epoch: 9 cost time: 2.255852460861206
Epoch: 9, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.711 Vali Acc: 0.694 Test Loss: 0.711 Test Acc: 0.694
Validation loss decreased (-0.666659 --> -0.694437).  Saving model ...
Epoch: 10 cost time: 2.3351144790649414
Epoch: 10, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.620 Vali Acc: 0.761 Test Loss: 0.620 Test Acc: 0.761
Validation loss decreased (-0.694437 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 2.527043342590332
Epoch: 11, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 2.1450977325439453
Epoch: 12, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
Validation loss decreased (-0.761105 --> -0.822217).  Saving model ...
Epoch: 13 cost time: 2.261730194091797
Epoch: 13, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.459 Vali Acc: 0.811 Test Loss: 0.459 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4007506370544434
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.418 Vali Acc: 0.822 Test Loss: 0.418 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 2.496525287628174
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 2.5060527324676514
Epoch: 16, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.382 Vali Acc: 0.839 Test Loss: 0.382 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 2.2555594444274902
Epoch: 17, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.366 Vali Acc: 0.811 Test Loss: 0.366 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1170856952667236
Epoch: 18, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.354 Vali Acc: 0.839 Test Loss: 0.354 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 2.1456613540649414
Epoch: 19, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.355 Vali Acc: 0.867 Test Loss: 0.355 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 20 cost time: 2.207660436630249
Epoch: 20, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.364 Vali Acc: 0.806 Test Loss: 0.364 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.41399884223938
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5682101249694824
Epoch: 22, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.550544261932373
Epoch: 23, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7985591888427734
Epoch: 24, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.424755811691284
Epoch: 25, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.3179636001586914
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.6062369346618652
Epoch: 27, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.326 Vali Acc: 0.828 Test Loss: 0.326 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.3194520473480225
Epoch: 28, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.342 Vali Acc: 0.822 Test Loss: 0.342 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1558449268341064
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 317218
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.901722192764282
Epoch: 1, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.833 Vali Acc: 0.150 Test Loss: 1.833 Test Acc: 0.150
Validation loss decreased (inf --> -0.149982).  Saving model ...
Epoch: 2 cost time: 2.051720380783081
Epoch: 2, Steps: 12 | Train Loss: 1.828 Vali Loss: 1.762 Vali Acc: 0.211 Test Loss: 1.762 Test Acc: 0.211
Validation loss decreased (-0.149982 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 3.1463303565979004
Epoch: 3, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.677 Vali Acc: 0.406 Test Loss: 1.677 Test Acc: 0.406
Validation loss decreased (-0.211093 --> -0.405539).  Saving model ...
Epoch: 4 cost time: 2.6851072311401367
Epoch: 4, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.548 Vali Acc: 0.578 Test Loss: 1.548 Test Acc: 0.578
Validation loss decreased (-0.405539 --> -0.577762).  Saving model ...
Epoch: 5 cost time: 2.0198397636413574
Epoch: 5, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.373 Vali Acc: 0.594 Test Loss: 1.373 Test Acc: 0.594
Validation loss decreased (-0.577762 --> -0.594431).  Saving model ...
Epoch: 6 cost time: 2.554041624069214
Epoch: 6, Steps: 12 | Train Loss: 1.332 Vali Loss: 1.136 Vali Acc: 0.700 Test Loss: 1.136 Test Acc: 0.700
Validation loss decreased (-0.594431 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 2.898240566253662
Epoch: 7, Steps: 12 | Train Loss: 1.122 Vali Loss: 0.920 Vali Acc: 0.667 Test Loss: 0.920 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.204523801803589
Epoch: 8, Steps: 12 | Train Loss: 0.909 Vali Loss: 0.775 Vali Acc: 0.717 Test Loss: 0.775 Test Acc: 0.717
Validation loss decreased (-0.699989 --> -0.716659).  Saving model ...
Epoch: 9 cost time: 3.188833236694336
Epoch: 9, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 2.342665910720825
Epoch: 10, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.561 Vali Acc: 0.744 Test Loss: 0.561 Test Acc: 0.744
Validation loss decreased (-0.722216 --> -0.744439).  Saving model ...
Epoch: 11 cost time: 3.0137276649475098
Epoch: 11, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.499 Vali Acc: 0.811 Test Loss: 0.499 Test Acc: 0.811
Validation loss decreased (-0.744439 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 2.6086180210113525
Epoch: 12, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.451 Vali Acc: 0.800 Test Loss: 0.451 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.686751365661621
Epoch: 13, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.437 Vali Acc: 0.794 Test Loss: 0.437 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.837308883666992
Epoch: 14, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.416 Vali Acc: 0.806 Test Loss: 0.416 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8634607791900635
Epoch: 15, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.380 Vali Acc: 0.806 Test Loss: 0.380 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.648599624633789
Epoch: 16, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 2.897110939025879
Epoch: 17, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 2.527238607406616
Epoch: 18, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0831542015075684
Epoch: 19, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 20 cost time: 3.665120840072632
Epoch: 20, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.314 Vali Acc: 0.833 Test Loss: 0.314 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6872048377990723
Epoch: 21, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.311 Vali Acc: 0.833 Test Loss: 0.311 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3899130821228027
Epoch: 22, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 23 cost time: 2.5224008560180664
Epoch: 23, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2778801918029785
Epoch: 24, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 25 cost time: 3.007753610610962
Epoch: 25, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.955139636993408
Epoch: 26, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0528552532196045
Epoch: 27, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.865424871444702
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 29 cost time: 2.9425315856933594
Epoch: 29, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.723179340362549
Epoch: 30, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.6973719596862793
Epoch: 31, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.299 Vali Acc: 0.839 Test Loss: 0.299 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.6509478092193604
Epoch: 32, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.766082763671875
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.671785831451416
Epoch: 34, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.372 Vali Acc: 0.833 Test Loss: 0.372 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.6135451793670654
Epoch: 35, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.767451286315918
Epoch: 36, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.185990333557129
Epoch: 37, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.6757495403289795
Epoch: 38, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 316866
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.412174463272095
Epoch: 1, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.762 Vali Acc: 0.144 Test Loss: 1.762 Test Acc: 0.144
Validation loss decreased (inf --> -0.144427).  Saving model ...
Epoch: 2 cost time: 2.2076196670532227
Epoch: 2, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.707 Vali Acc: 0.333 Test Loss: 1.707 Test Acc: 0.333
Validation loss decreased (-0.144427 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 3.0405349731445312
Epoch: 3, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.617 Vali Acc: 0.506 Test Loss: 1.617 Test Acc: 0.506
Validation loss decreased (-0.333316 --> -0.505539).  Saving model ...
Epoch: 4 cost time: 2.433062791824341
Epoch: 4, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.466 Vali Acc: 0.550 Test Loss: 1.466 Test Acc: 0.550
Validation loss decreased (-0.505539 --> -0.549985).  Saving model ...
Epoch: 5 cost time: 2.45924973487854
Epoch: 5, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.257 Vali Acc: 0.689 Test Loss: 1.257 Test Acc: 0.689
Validation loss decreased (-0.549985 --> -0.688876).  Saving model ...
Epoch: 6 cost time: 3.0194919109344482
Epoch: 6, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.038 Vali Acc: 0.728 Test Loss: 1.038 Test Acc: 0.728
Validation loss decreased (-0.688876 --> -0.727767).  Saving model ...
Epoch: 7 cost time: 2.787107467651367
Epoch: 7, Steps: 12 | Train Loss: 1.005 Vali Loss: 0.850 Vali Acc: 0.739 Test Loss: 0.850 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738880).  Saving model ...
Epoch: 8 cost time: 2.8021295070648193
Epoch: 8, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.732 Vali Acc: 0.750 Test Loss: 0.732 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 2.3719329833984375
Epoch: 9, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.644 Vali Acc: 0.739 Test Loss: 0.644 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1233162879943848
Epoch: 10, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.573 Vali Acc: 0.772 Test Loss: 0.573 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772216).  Saving model ...
Epoch: 11 cost time: 2.807286262512207
Epoch: 11, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.528 Vali Acc: 0.767 Test Loss: 0.528 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9106321334838867
Epoch: 12, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.472 Vali Acc: 0.794 Test Loss: 0.472 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 2.47499418258667
Epoch: 13, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.440 Vali Acc: 0.783 Test Loss: 0.440 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6591622829437256
Epoch: 14, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.426 Vali Acc: 0.806 Test Loss: 0.426 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 15 cost time: 3.0123233795166016
Epoch: 15, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.408 Vali Acc: 0.828 Test Loss: 0.408 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 2.3328213691711426
Epoch: 16, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.394 Vali Acc: 0.806 Test Loss: 0.394 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1386446952819824
Epoch: 17, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.516998291015625
Epoch: 18, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.445369005203247
Epoch: 19, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1464877128601074
Epoch: 20, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 21 cost time: 2.583467960357666
Epoch: 21, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.335 Vali Acc: 0.833 Test Loss: 0.335 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.31174373626709
Epoch: 22, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.346 Vali Acc: 0.822 Test Loss: 0.346 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7381813526153564
Epoch: 23, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 24 cost time: 2.982642889022827
Epoch: 24, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.979323625564575
Epoch: 25, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.293501615524292
Epoch: 26, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4200849533081055
Epoch: 27, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.6123452186584473
Epoch: 28, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.359 Vali Acc: 0.811 Test Loss: 0.359 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.7483251094818115
Epoch: 29, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.3022875785827637
Epoch: 30, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.731445550918579
Epoch: 31, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.4823639392852783
Epoch: 32, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.367 Vali Acc: 0.817 Test Loss: 0.367 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.50903582572937
Epoch: 33, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 243042
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.420979738235474
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.768 Vali Acc: 0.228 Test Loss: 1.768 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 2.8048417568206787
Epoch: 2, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.717 Vali Acc: 0.294 Test Loss: 1.717 Test Acc: 0.294
Validation loss decreased (-0.227760 --> -0.294427).  Saving model ...
Epoch: 3 cost time: 2.095036268234253
Epoch: 3, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.642 Vali Acc: 0.333 Test Loss: 1.642 Test Acc: 0.333
Validation loss decreased (-0.294427 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 2.4045560359954834
Epoch: 4, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.504 Vali Acc: 0.550 Test Loss: 1.504 Test Acc: 0.550
Validation loss decreased (-0.333317 --> -0.549985).  Saving model ...
Epoch: 5 cost time: 1.9962358474731445
Epoch: 5, Steps: 12 | Train Loss: 1.447 Vali Loss: 1.326 Vali Acc: 0.561 Test Loss: 1.326 Test Acc: 0.561
Validation loss decreased (-0.549985 --> -0.561098).  Saving model ...
Epoch: 6 cost time: 2.0642008781433105
Epoch: 6, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.118 Vali Acc: 0.694 Test Loss: 1.118 Test Acc: 0.694
Validation loss decreased (-0.561098 --> -0.694433).  Saving model ...
Epoch: 7 cost time: 3.091012716293335
Epoch: 7, Steps: 12 | Train Loss: 1.046 Vali Loss: 0.931 Vali Acc: 0.683 Test Loss: 0.931 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.432267427444458
Epoch: 8, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.785 Vali Acc: 0.678 Test Loss: 0.785 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.542818546295166
Epoch: 9, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.663 Vali Acc: 0.728 Test Loss: 0.663 Test Acc: 0.728
Validation loss decreased (-0.694433 --> -0.727771).  Saving model ...
Epoch: 10 cost time: 2.744378089904785
Epoch: 10, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.586 Vali Acc: 0.756 Test Loss: 0.586 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 2.4868152141571045
Epoch: 11, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.518 Vali Acc: 0.761 Test Loss: 0.518 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 12 cost time: 2.8565032482147217
Epoch: 12, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.472 Vali Acc: 0.778 Test Loss: 0.472 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 13 cost time: 2.326201915740967
Epoch: 13, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.446 Vali Acc: 0.811 Test Loss: 0.446 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 2.0650150775909424
Epoch: 14, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.425 Vali Acc: 0.789 Test Loss: 0.425 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0525457859039307
Epoch: 15, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.405 Vali Acc: 0.794 Test Loss: 0.405 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3201961517333984
Epoch: 16, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.388 Vali Acc: 0.800 Test Loss: 0.388 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9716193675994873
Epoch: 17, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.392 Vali Acc: 0.800 Test Loss: 0.392 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3190670013427734
Epoch: 18, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.378 Vali Acc: 0.811 Test Loss: 0.378 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 2.07977294921875
Epoch: 19, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.398 Vali Acc: 0.806 Test Loss: 0.398 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3862357139587402
Epoch: 20, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.350 Vali Acc: 0.817 Test Loss: 0.350 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 21 cost time: 2.6510040760040283
Epoch: 21, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.195460796356201
Epoch: 22, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.338 Vali Acc: 0.806 Test Loss: 0.338 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9588775634765625
Epoch: 23, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 24 cost time: 2.316284656524658
Epoch: 24, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.346 Vali Acc: 0.806 Test Loss: 0.346 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2779347896575928
Epoch: 25, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.362 Vali Acc: 0.806 Test Loss: 0.362 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.726456880569458
Epoch: 26, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.327 Vali Acc: 0.806 Test Loss: 0.327 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.2249765396118164
Epoch: 27, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.943657398223877
Epoch: 28, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0378940105438232
Epoch: 29, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.363 Vali Acc: 0.806 Test Loss: 0.363 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.1107213497161865
Epoch: 30, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.372 Vali Acc: 0.822 Test Loss: 0.372 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 31 cost time: 2.727565288543701
Epoch: 31, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 32 cost time: 2.0992085933685303
Epoch: 32, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.385 Vali Acc: 0.811 Test Loss: 0.385 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.5175352096557617
Epoch: 33, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.412 Vali Acc: 0.811 Test Loss: 0.412 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.527276039123535
Epoch: 34, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.376 Vali Acc: 0.800 Test Loss: 0.376 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.5213146209716797
Epoch: 35, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.411 Vali Acc: 0.800 Test Loss: 0.411 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.7826833724975586
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.4905664920806885
Epoch: 37, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.377 Vali Acc: 0.794 Test Loss: 0.377 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.3855578899383545
Epoch: 38, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.395 Vali Acc: 0.811 Test Loss: 0.395 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.9721884727478027
Epoch: 39, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.408 Vali Acc: 0.783 Test Loss: 0.408 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.091517448425293
Epoch: 40, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.399 Vali Acc: 0.794 Test Loss: 0.399 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.1410579681396484
Epoch: 41, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.409 Vali Acc: 0.800 Test Loss: 0.409 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 242690
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.360788345336914
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.781 Vali Acc: 0.139 Test Loss: 1.781 Test Acc: 0.139
Validation loss decreased (inf --> -0.138871).  Saving model ...
Epoch: 2 cost time: 2.0804293155670166
Epoch: 2, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.702 Vali Acc: 0.317 Test Loss: 1.702 Test Acc: 0.317
Validation loss decreased (-0.138871 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 2.0782065391540527
Epoch: 3, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.604 Vali Acc: 0.489 Test Loss: 1.604 Test Acc: 0.489
Validation loss decreased (-0.316650 --> -0.488873).  Saving model ...
Epoch: 4 cost time: 2.522559881210327
Epoch: 4, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.469 Vali Acc: 0.544 Test Loss: 1.469 Test Acc: 0.544
Validation loss decreased (-0.488873 --> -0.544430).  Saving model ...
Epoch: 5 cost time: 2.3980860710144043
Epoch: 5, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.287 Vali Acc: 0.683 Test Loss: 1.287 Test Acc: 0.683
Validation loss decreased (-0.544430 --> -0.683320).  Saving model ...
Epoch: 6 cost time: 2.118642807006836
Epoch: 6, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.103 Vali Acc: 0.667 Test Loss: 1.103 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6532037258148193
Epoch: 7, Steps: 12 | Train Loss: 1.024 Vali Loss: 0.902 Vali Acc: 0.694 Test Loss: 0.902 Test Acc: 0.694
Validation loss decreased (-0.683320 --> -0.694435).  Saving model ...
Epoch: 8 cost time: 1.6972088813781738
Epoch: 8, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.694435 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 2.2453393936157227
Epoch: 9, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.629 Vali Acc: 0.761 Test Loss: 0.629 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761105).  Saving model ...
Epoch: 10 cost time: 2.1315243244171143
Epoch: 10, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.554 Vali Acc: 0.778 Test Loss: 0.554 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777772).  Saving model ...
Epoch: 11 cost time: 2.186422348022461
Epoch: 11, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783328).  Saving model ...
Epoch: 12 cost time: 2.4130935668945312
Epoch: 12, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.502 Vali Acc: 0.811 Test Loss: 0.502 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811106).  Saving model ...
Epoch: 13 cost time: 1.9190263748168945
Epoch: 13, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.448 Vali Acc: 0.839 Test Loss: 0.448 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838884).  Saving model ...
Epoch: 14 cost time: 2.3515450954437256
Epoch: 14, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.443 Vali Acc: 0.828 Test Loss: 0.443 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7887578010559082
Epoch: 15, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 1.7627346515655518
Epoch: 16, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.363 Vali Acc: 0.839 Test Loss: 0.363 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0793325901031494
Epoch: 17, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 1.9403979778289795
Epoch: 18, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 2.315225839614868
Epoch: 19, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 2.2570302486419678
Epoch: 20, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.304 Vali Acc: 0.883 Test Loss: 0.304 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 2.0083258152008057
Epoch: 21, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8623483180999756
Epoch: 22, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2867746353149414
Epoch: 23, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1857569217681885
Epoch: 24, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1300430297851562
Epoch: 25, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2603259086608887
Epoch: 26, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9580576419830322
Epoch: 27, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.980811357498169
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0813474655151367
Epoch: 29, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.5505523681640625
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 242338
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.310832738876343
Epoch: 1, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.748 Vali Acc: 0.256 Test Loss: 1.748 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 2.084343433380127
Epoch: 2, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.699 Vali Acc: 0.356 Test Loss: 1.699 Test Acc: 0.356
Validation loss decreased (-0.255538 --> -0.355539).  Saving model ...
Epoch: 3 cost time: 2.213815689086914
Epoch: 3, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.628 Vali Acc: 0.433 Test Loss: 1.628 Test Acc: 0.433
Validation loss decreased (-0.355539 --> -0.433317).  Saving model ...
Epoch: 4 cost time: 2.5985970497131348
Epoch: 4, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.516 Vali Acc: 0.506 Test Loss: 1.516 Test Acc: 0.506
Validation loss decreased (-0.433317 --> -0.505540).  Saving model ...
Epoch: 5 cost time: 2.7754065990448
Epoch: 5, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.353 Vali Acc: 0.606 Test Loss: 1.353 Test Acc: 0.606
Validation loss decreased (-0.505540 --> -0.605542).  Saving model ...
Epoch: 6 cost time: 2.2900707721710205
Epoch: 6, Steps: 12 | Train Loss: 1.302 Vali Loss: 1.144 Vali Acc: 0.622 Test Loss: 1.144 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622211).  Saving model ...
Epoch: 7 cost time: 2.450972080230713
Epoch: 7, Steps: 12 | Train Loss: 1.122 Vali Loss: 0.946 Vali Acc: 0.694 Test Loss: 0.946 Test Acc: 0.694
Validation loss decreased (-0.622211 --> -0.694435).  Saving model ...
Epoch: 8 cost time: 2.6959967613220215
Epoch: 8, Steps: 12 | Train Loss: 0.906 Vali Loss: 0.779 Vali Acc: 0.739 Test Loss: 0.779 Test Acc: 0.739
Validation loss decreased (-0.694435 --> -0.738881).  Saving model ...
Epoch: 9 cost time: 2.478419542312622
Epoch: 9, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 2.7435970306396484
Epoch: 10, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.598 Vali Acc: 0.767 Test Loss: 0.598 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 3.0021886825561523
Epoch: 11, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.543 Vali Acc: 0.772 Test Loss: 0.543 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 12 cost time: 1.973980188369751
Epoch: 12, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.497 Vali Acc: 0.772 Test Loss: 0.497 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 13 cost time: 2.005944013595581
Epoch: 13, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.454 Vali Acc: 0.778 Test Loss: 0.454 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 14 cost time: 2.329789638519287
Epoch: 14, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.426 Vali Acc: 0.817 Test Loss: 0.426 Test Acc: 0.817
Validation loss decreased (-0.777773 --> -0.816662).  Saving model ...
Epoch: 15 cost time: 2.1262857913970947
Epoch: 15, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.394 Vali Acc: 0.839 Test Loss: 0.394 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 2.3996572494506836
Epoch: 16, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 2.610380172729492
Epoch: 17, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 2.169062376022339
Epoch: 18, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 19 cost time: 2.445586919784546
Epoch: 19, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 2.6733460426330566
Epoch: 20, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8391542434692383
Epoch: 21, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.831282138824463
Epoch: 22, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 23 cost time: 2.436842918395996
Epoch: 23, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.330 Vali Acc: 0.844 Test Loss: 0.330 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3927500247955322
Epoch: 24, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1134448051452637
Epoch: 25, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 2.2613039016723633
Epoch: 26, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 27 cost time: 1.995713472366333
Epoch: 27, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 2.363149404525757
Epoch: 28, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 2.025327682495117
Epoch: 29, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8256075382232666
Epoch: 30, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.3516366481781006
Epoch: 31, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.306 Vali Acc: 0.872 Test Loss: 0.306 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.235276460647583
Epoch: 32, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.248959541320801
Epoch: 33, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.0367848873138428
Epoch: 34, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.577101469039917
Epoch: 35, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.938162088394165
Epoch: 36, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.6479523181915283
Epoch: 37, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 2.7420654296875
Epoch: 38, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.4777867794036865
Epoch: 39, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.8719711303710938
Epoch: 40, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.0420334339141846
Epoch: 41, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 2.884148359298706
Epoch: 42, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.5108580589294434
Epoch: 43, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.4519078731536865
Epoch: 44, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 45 cost time: 2.4135098457336426
Epoch: 45, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.1255605220794678
Epoch: 46, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.369 Vali Acc: 0.856 Test Loss: 0.369 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.6277871131896973
Epoch: 47, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.9757885932922363
Epoch: 48, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.3325891494750977
Epoch: 49, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.5284852981567383
Epoch: 50, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.1446034908294678
Epoch: 51, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.0594067573547363
Epoch: 52, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.255 Vali Acc: 0.894 Test Loss: 0.255 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 53 cost time: 3.1718106269836426
Epoch: 53, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.293 Vali Acc: 0.844 Test Loss: 0.293 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.0647411346435547
Epoch: 54, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 55 cost time: 3.0890347957611084
Epoch: 55, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.4076244831085205
Epoch: 56, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.857806921005249
Epoch: 57, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.058948278427124
Epoch: 58, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.762057304382324
Epoch: 59, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.482372522354126
Epoch: 60, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.797102451324463
Epoch: 61, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.0509514808654785
Epoch: 62, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 2.501181125640869
Epoch: 63, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 2.459674835205078
Epoch: 64, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 65 cost time: 2.3018250465393066
Epoch: 65, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 66 cost time: 2.4052321910858154
Epoch: 66, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.7628629207611084
Epoch: 67, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.7732903957366943
Epoch: 68, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 69 cost time: 2.6096251010894775
Epoch: 69, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.419001579284668
Epoch: 70, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.387 Vali Acc: 0.839 Test Loss: 0.387 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 2.7919962406158447
Epoch: 71, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.332 Vali Acc: 0.878 Test Loss: 0.332 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 2.7631139755249023
Epoch: 72, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.327 Vali Acc: 0.878 Test Loss: 0.327 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 3.0606114864349365
Epoch: 73, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 2.5383355617523193
Epoch: 74, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 2.647700548171997
Epoch: 75, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 2.4802346229553223
Epoch: 76, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 2.503892183303833
Epoch: 77, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.329 Vali Acc: 0.883 Test Loss: 0.329 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 2.5702695846557617
Epoch: 78, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 241986
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.680496454238892
Epoch: 1, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.678 Vali Acc: 0.339 Test Loss: 1.678 Test Acc: 0.339
Validation loss decreased (inf --> -0.338872).  Saving model ...
Epoch: 2 cost time: 2.169588088989258
Epoch: 2, Steps: 12 | Train Loss: 1.304 Vali Loss: 0.969 Vali Acc: 0.628 Test Loss: 0.969 Test Acc: 0.628
Validation loss decreased (-0.338872 --> -0.627768).  Saving model ...
Epoch: 3 cost time: 2.1780343055725098
Epoch: 3, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.646 Vali Acc: 0.700 Test Loss: 0.646 Test Acc: 0.700
Validation loss decreased (-0.627768 --> -0.699994).  Saving model ...
Epoch: 4 cost time: 2.333211898803711
Epoch: 4, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.776 Vali Acc: 0.750 Test Loss: 0.776 Test Acc: 0.750
Validation loss decreased (-0.699994 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 2.810598611831665
Epoch: 5, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.435 Vali Acc: 0.783 Test Loss: 0.435 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 2.157094717025757
Epoch: 6, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
Validation loss decreased (-0.783329 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.9830090999603271
Epoch: 7, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3834750652313232
Epoch: 8, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.9635992050170898
Epoch: 9, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.413 Vali Acc: 0.822 Test Loss: 0.413 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1487350463867188
Epoch: 10, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.416 Vali Acc: 0.839 Test Loss: 0.416 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.456406831741333
Epoch: 11, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.487 Vali Acc: 0.839 Test Loss: 0.487 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0950493812561035
Epoch: 12, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.562 Vali Acc: 0.806 Test Loss: 0.562 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.329847812652588
Epoch: 13, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855551).  Saving model ...
Epoch: 14 cost time: 2.4842052459716797
Epoch: 14, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.417 Vali Acc: 0.839 Test Loss: 0.417 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7396647930145264
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.386 Vali Acc: 0.844 Test Loss: 0.386 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5705227851867676
Epoch: 16, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.797 Vali Acc: 0.778 Test Loss: 0.797 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3777084350585938
Epoch: 17, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.828 Vali Acc: 0.806 Test Loss: 0.828 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6109578609466553
Epoch: 18, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.773 Vali Acc: 0.789 Test Loss: 0.773 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.365217447280884
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.677 Vali Acc: 0.828 Test Loss: 0.677 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3232245445251465
Epoch: 20, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.465395927429199
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.480 Vali Acc: 0.839 Test Loss: 0.480 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.621648073196411
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.777 Vali Acc: 0.828 Test Loss: 0.777 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1042873859405518
Epoch: 23, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861105).  Saving model ...
Epoch: 24 cost time: 2.022165536880493
Epoch: 24, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.470 Vali Acc: 0.878 Test Loss: 0.470 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877773).  Saving model ...
Epoch: 25 cost time: 2.116931438446045
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.704 Vali Acc: 0.839 Test Loss: 0.704 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4044415950775146
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.110539197921753
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8803520202636719
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9583425521850586
Epoch: 29, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.481 Vali Acc: 0.839 Test Loss: 0.481 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.2976019382476807
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.935173511505127
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.4493744373321533
Epoch: 32, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.668548822402954
Epoch: 33, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.659 Vali Acc: 0.839 Test Loss: 0.659 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.651848793029785
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.768 Vali Acc: 0.828 Test Loss: 0.768 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 11200054
model size : 47.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.368110179901123
Epoch: 1, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.748 Vali Acc: 0.372 Test Loss: 1.748 Test Acc: 0.372
Validation loss decreased (inf --> -0.372205).  Saving model ...
Epoch: 2 cost time: 2.795044422149658
Epoch: 2, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.071 Vali Acc: 0.617 Test Loss: 1.071 Test Acc: 0.617
Validation loss decreased (-0.372205 --> -0.616656).  Saving model ...
Epoch: 3 cost time: 2.765443801879883
Epoch: 3, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.833 Vali Acc: 0.722 Test Loss: 0.833 Test Acc: 0.722
Validation loss decreased (-0.616656 --> -0.722214).  Saving model ...
Epoch: 4 cost time: 2.5659162998199463
Epoch: 4, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.558 Vali Acc: 0.750 Test Loss: 0.558 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 2.3381946086883545
Epoch: 5, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.677590847015381
Epoch: 6, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783327).  Saving model ...
Epoch: 7 cost time: 2.3759868144989014
Epoch: 7, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.413 Vali Acc: 0.822 Test Loss: 0.413 Test Acc: 0.822
Validation loss decreased (-0.783327 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 2.4777584075927734
Epoch: 8, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 2.086426019668579
Epoch: 9, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.434 Vali Acc: 0.811 Test Loss: 0.434 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.553506374359131
Epoch: 10, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.593 Vali Acc: 0.772 Test Loss: 0.593 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.158776044845581
Epoch: 11, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.504 Vali Acc: 0.822 Test Loss: 0.504 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8541512489318848
Epoch: 12, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.447 Vali Acc: 0.839 Test Loss: 0.447 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838884).  Saving model ...
Epoch: 13 cost time: 2.8864965438842773
Epoch: 13, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.498 Vali Acc: 0.811 Test Loss: 0.498 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7608256340026855
Epoch: 14, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.544 Vali Acc: 0.800 Test Loss: 0.544 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4614696502685547
Epoch: 15, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866662).  Saving model ...
Epoch: 16 cost time: 2.4180667400360107
Epoch: 16, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.901 Vali Acc: 0.822 Test Loss: 0.901 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1676628589630127
Epoch: 17, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.540 Vali Acc: 0.839 Test Loss: 0.540 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.356863260269165
Epoch: 18, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.426697015762329
Epoch: 19, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.711 Vali Acc: 0.856 Test Loss: 0.711 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9347128868103027
Epoch: 20, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 2.8782572746276855
Epoch: 21, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.822 Vali Acc: 0.811 Test Loss: 0.822 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3614978790283203
Epoch: 22, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.378 Vali Acc: 0.861 Test Loss: 0.378 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0203423500061035
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.765 Vali Acc: 0.811 Test Loss: 0.765 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7851431369781494
Epoch: 24, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.1136481761932373
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 26 cost time: 2.626055955886841
Epoch: 26, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.825 Vali Acc: 0.828 Test Loss: 0.825 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.846245050430298
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.516993761062622
Epoch: 28, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.902 Vali Acc: 0.833 Test Loss: 0.902 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.5385284423828125
Epoch: 29, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.797 Vali Acc: 0.817 Test Loss: 0.797 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.1884257793426514
Epoch: 30, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.707 Vali Acc: 0.811 Test Loss: 0.707 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.67868709564209
Epoch: 31, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.717 Vali Acc: 0.822 Test Loss: 0.717 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3398571014404297
Epoch: 32, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.915 Vali Acc: 0.811 Test Loss: 0.915 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.214650869369507
Epoch: 33, Steps: 12 | Train Loss: 0.259 Vali Loss: 1.401 Vali Acc: 0.728 Test Loss: 1.401 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.910397529602051
Epoch: 34, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.997 Vali Acc: 0.806 Test Loss: 0.997 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9618537425994873
Epoch: 35, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.764 Vali Acc: 0.839 Test Loss: 0.764 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 11197494
model size : 47.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.699604034423828
Epoch: 1, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.553 Vali Acc: 0.317 Test Loss: 1.553 Test Acc: 0.317
Validation loss decreased (inf --> -0.316651).  Saving model ...
Epoch: 2 cost time: 1.9243495464324951
Epoch: 2, Steps: 12 | Train Loss: 1.287 Vali Loss: 0.924 Vali Acc: 0.639 Test Loss: 0.924 Test Acc: 0.639
Validation loss decreased (-0.316651 --> -0.638880).  Saving model ...
Epoch: 3 cost time: 2.226170778274536
Epoch: 3, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.757 Vali Acc: 0.661 Test Loss: 0.757 Test Acc: 0.661
Validation loss decreased (-0.638880 --> -0.661104).  Saving model ...
Epoch: 4 cost time: 1.6529321670532227
Epoch: 4, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.474 Vali Acc: 0.744 Test Loss: 0.474 Test Acc: 0.744
Validation loss decreased (-0.661104 --> -0.744440).  Saving model ...
Epoch: 5 cost time: 1.9882268905639648
Epoch: 5, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
Validation loss decreased (-0.744440 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 1.88344407081604
Epoch: 6, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.409 Vali Acc: 0.828 Test Loss: 0.409 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.2138888835906982
Epoch: 7, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2620182037353516
Epoch: 8, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.561626672744751
Epoch: 9, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9422266483306885
Epoch: 10, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.510 Vali Acc: 0.817 Test Loss: 0.510 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.261472702026367
Epoch: 11, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.480 Vali Acc: 0.806 Test Loss: 0.480 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.280170202255249
Epoch: 12, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8801264762878418
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.907 Vali Acc: 0.800 Test Loss: 0.907 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.282196283340454
Epoch: 14, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.615 Vali Acc: 0.811 Test Loss: 0.615 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5775623321533203
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.700 Vali Acc: 0.817 Test Loss: 0.700 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.606011390686035
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 11194934
model size : 47.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.949419736862183
Epoch: 1, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.638 Vali Acc: 0.400 Test Loss: 1.638 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 2.117368221282959
Epoch: 2, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.049 Vali Acc: 0.617 Test Loss: 1.049 Test Acc: 0.617
Validation loss decreased (-0.399984 --> -0.616656).  Saving model ...
Epoch: 3 cost time: 2.1132700443267822
Epoch: 3, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.842 Vali Acc: 0.617 Test Loss: 0.842 Test Acc: 0.617
Validation loss decreased (-0.616656 --> -0.616658).  Saving model ...
Epoch: 4 cost time: 2.825183629989624
Epoch: 4, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.697 Vali Acc: 0.672 Test Loss: 0.697 Test Acc: 0.672
Validation loss decreased (-0.616658 --> -0.672215).  Saving model ...
Epoch: 5 cost time: 2.5787739753723145
Epoch: 5, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.569 Vali Acc: 0.750 Test Loss: 0.569 Test Acc: 0.750
Validation loss decreased (-0.672215 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 2.8764336109161377
Epoch: 6, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.413 Vali Acc: 0.817 Test Loss: 0.413 Test Acc: 0.817
Validation loss decreased (-0.749994 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 2.3144009113311768
Epoch: 7, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.487 Vali Acc: 0.789 Test Loss: 0.487 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4371590614318848
Epoch: 8, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 2.5078630447387695
Epoch: 9, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.821 Vali Acc: 0.778 Test Loss: 0.821 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.087780714035034
Epoch: 10, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.379 Vali Acc: 0.856 Test Loss: 0.379 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 2.5083444118499756
Epoch: 11, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.431 Vali Acc: 0.839 Test Loss: 0.431 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.559422254562378
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.420 Vali Acc: 0.828 Test Loss: 0.420 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.172250986099243
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.053170680999756
Epoch: 14, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4710943698883057
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.796 Vali Acc: 0.828 Test Loss: 0.796 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.267766237258911
Epoch: 16, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.471 Vali Acc: 0.839 Test Loss: 0.471 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3358006477355957
Epoch: 17, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3068039417266846
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.556 Vali Acc: 0.839 Test Loss: 0.556 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7510910034179688
Epoch: 19, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.681302070617676
Epoch: 20, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 11192374
model size : 47.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.999100208282471
Epoch: 1, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.648 Vali Acc: 0.294 Test Loss: 1.648 Test Acc: 0.294
Validation loss decreased (inf --> -0.294428).  Saving model ...
Epoch: 2 cost time: 2.3625845909118652
Epoch: 2, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.129 Vali Acc: 0.478 Test Loss: 1.129 Test Acc: 0.478
Validation loss decreased (-0.294428 --> -0.477766).  Saving model ...
Epoch: 3 cost time: 2.3415234088897705
Epoch: 3, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.776 Vali Acc: 0.694 Test Loss: 0.776 Test Acc: 0.694
Validation loss decreased (-0.477766 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 2.600557804107666
Epoch: 4, Steps: 12 | Train Loss: 0.663 Vali Loss: 1.295 Vali Acc: 0.644 Test Loss: 1.295 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.61240816116333
Epoch: 5, Steps: 12 | Train Loss: 0.966 Vali Loss: 0.625 Vali Acc: 0.767 Test Loss: 0.625 Test Acc: 0.767
Validation loss decreased (-0.694437 --> -0.766660).  Saving model ...
Epoch: 6 cost time: 2.7637531757354736
Epoch: 6, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.497 Vali Acc: 0.761 Test Loss: 0.497 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7159013748168945
Epoch: 7, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783327).  Saving model ...
Epoch: 8 cost time: 2.436288356781006
Epoch: 8, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.418 Vali Acc: 0.817 Test Loss: 0.418 Test Acc: 0.817
Validation loss decreased (-0.783327 --> -0.816662).  Saving model ...
Epoch: 9 cost time: 2.6226227283477783
Epoch: 9, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.474 Vali Acc: 0.817 Test Loss: 0.474 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0849993228912354
Epoch: 10, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.360 Vali Acc: 0.856 Test Loss: 0.360 Test Acc: 0.856
Validation loss decreased (-0.816662 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 2.837165355682373
Epoch: 11, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.536 Vali Acc: 0.811 Test Loss: 0.536 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6322357654571533
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.463 Vali Acc: 0.828 Test Loss: 0.463 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.696197509765625
Epoch: 13, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 2.7018039226531982
Epoch: 14, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.611948251724243
Epoch: 15, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.481 Vali Acc: 0.839 Test Loss: 0.481 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6348774433135986
Epoch: 16, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 2.5315072536468506
Epoch: 17, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5376532077789307
Epoch: 18, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.696 Vali Acc: 0.850 Test Loss: 0.696 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6711153984069824
Epoch: 19, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0486059188842773
Epoch: 20, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.502459764480591
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.685059070587158
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4745001792907715
Epoch: 23, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.683 Vali Acc: 0.817 Test Loss: 0.683 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.529693603515625
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.313513994216919
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.5156712532043457
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 9361462
model size : 40.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.323931455612183
Epoch: 1, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.526 Vali Acc: 0.428 Test Loss: 1.526 Test Acc: 0.428
Validation loss decreased (inf --> -0.427763).  Saving model ...
Epoch: 2 cost time: 2.5658116340637207
Epoch: 2, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.173 Vali Acc: 0.561 Test Loss: 1.173 Test Acc: 0.561
Validation loss decreased (-0.427763 --> -0.561099).  Saving model ...
Epoch: 3 cost time: 2.3374276161193848
Epoch: 3, Steps: 12 | Train Loss: 0.986 Vali Loss: 0.801 Vali Acc: 0.650 Test Loss: 0.801 Test Acc: 0.650
Validation loss decreased (-0.561099 --> -0.649992).  Saving model ...
Epoch: 4 cost time: 2.8858656883239746
Epoch: 4, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.679 Vali Acc: 0.717 Test Loss: 0.679 Test Acc: 0.717
Validation loss decreased (-0.649992 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 2.7472405433654785
Epoch: 5, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.422 Vali Acc: 0.806 Test Loss: 0.422 Test Acc: 0.806
Validation loss decreased (-0.716660 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 2.1989636421203613
Epoch: 6, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.710 Vali Acc: 0.789 Test Loss: 0.710 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2970292568206787
Epoch: 7, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.450 Vali Acc: 0.806 Test Loss: 0.450 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3891561031341553
Epoch: 8, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.454 Vali Acc: 0.822 Test Loss: 0.454 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 3.1104440689086914
Epoch: 9, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.394 Vali Acc: 0.856 Test Loss: 0.394 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 2.5624287128448486
Epoch: 10, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.382 Vali Acc: 0.844 Test Loss: 0.382 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.82041072845459
Epoch: 11, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.670 Vali Acc: 0.811 Test Loss: 0.670 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8441717624664307
Epoch: 12, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 2.218331813812256
Epoch: 13, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.383 Vali Acc: 0.867 Test Loss: 0.383 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.435293436050415
Epoch: 14, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8787150382995605
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.885004758834839
Epoch: 16, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.63700008392334
Epoch: 17, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.605 Vali Acc: 0.811 Test Loss: 0.605 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.602121353149414
Epoch: 18, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.498 Vali Acc: 0.839 Test Loss: 0.498 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.503532648086548
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9157898426055908
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.8822736740112305
Epoch: 21, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.666 Vali Acc: 0.828 Test Loss: 0.666 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6938254833221436
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 9358902
model size : 40.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.845158100128174
Epoch: 1, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.421 Vali Acc: 0.533 Test Loss: 1.421 Test Acc: 0.533
Validation loss decreased (inf --> -0.533319).  Saving model ...
Epoch: 2 cost time: 2.335193157196045
Epoch: 2, Steps: 12 | Train Loss: 1.216 Vali Loss: 0.887 Vali Acc: 0.706 Test Loss: 0.887 Test Acc: 0.706
Validation loss decreased (-0.533319 --> -0.705547).  Saving model ...
Epoch: 3 cost time: 2.5162112712860107
Epoch: 3, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.678 Vali Acc: 0.694 Test Loss: 0.678 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.431687116622925
Epoch: 4, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.713 Vali Acc: 0.733 Test Loss: 0.713 Test Acc: 0.733
Validation loss decreased (-0.705547 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.992929458618164
Epoch: 5, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.581 Vali Acc: 0.756 Test Loss: 0.581 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 2.3185336589813232
Epoch: 6, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.525 Vali Acc: 0.772 Test Loss: 0.525 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 2.323458194732666
Epoch: 7, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.367 Vali Acc: 0.844 Test Loss: 0.367 Test Acc: 0.844
Validation loss decreased (-0.772217 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 2.0995516777038574
Epoch: 8, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.490 Vali Acc: 0.767 Test Loss: 0.490 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2538719177246094
Epoch: 9, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
Validation loss decreased (-0.844441 --> -0.894441).  Saving model ...
Epoch: 10 cost time: 2.1960198879241943
Epoch: 10, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3903701305389404
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5587475299835205
Epoch: 12, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.396 Vali Acc: 0.856 Test Loss: 0.396 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6097240447998047
Epoch: 13, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.405 Vali Acc: 0.856 Test Loss: 0.405 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2758169174194336
Epoch: 14, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.507 Vali Acc: 0.800 Test Loss: 0.507 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3616297245025635
Epoch: 15, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.366 Vali Acc: 0.856 Test Loss: 0.366 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.639820098876953
Epoch: 16, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3257806301116943
Epoch: 17, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.445 Vali Acc: 0.867 Test Loss: 0.445 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4910430908203125
Epoch: 18, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.490 Vali Acc: 0.828 Test Loss: 0.490 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.718215227127075
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 9356342
model size : 40.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.657668352127075
Epoch: 1, Steps: 12 | Train Loss: 1.805 Vali Loss: 1.716 Vali Acc: 0.311 Test Loss: 1.716 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 2.1586098670959473
Epoch: 2, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.181 Vali Acc: 0.578 Test Loss: 1.181 Test Acc: 0.578
Validation loss decreased (-0.311094 --> -0.577766).  Saving model ...
Epoch: 3 cost time: 2.5653200149536133
Epoch: 3, Steps: 12 | Train Loss: 0.961 Vali Loss: 0.894 Vali Acc: 0.600 Test Loss: 0.894 Test Acc: 0.600
Validation loss decreased (-0.577766 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 2.41583251953125
Epoch: 4, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.503 Vali Acc: 0.756 Test Loss: 0.503 Test Acc: 0.756
Validation loss decreased (-0.599991 --> -0.755551).  Saving model ...
Epoch: 5 cost time: 2.169766426086426
Epoch: 5, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.443 Vali Acc: 0.772 Test Loss: 0.443 Test Acc: 0.772
Validation loss decreased (-0.755551 --> -0.772218).  Saving model ...
Epoch: 6 cost time: 2.278510570526123
Epoch: 6, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.535 Vali Acc: 0.756 Test Loss: 0.535 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.308570146560669
Epoch: 7, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
Validation loss decreased (-0.772218 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 2.4582130908966064
Epoch: 8, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0589165687561035
Epoch: 9, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.521 Vali Acc: 0.806 Test Loss: 0.521 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4133529663085938
Epoch: 10, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.409 Vali Acc: 0.817 Test Loss: 0.409 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.403059244155884
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.482 Vali Acc: 0.839 Test Loss: 0.482 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838884).  Saving model ...
Epoch: 12 cost time: 2.645313262939453
Epoch: 12, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6531240940093994
Epoch: 13, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.390 Vali Acc: 0.867 Test Loss: 0.390 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 3.0415236949920654
Epoch: 14, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 3.1219372749328613
Epoch: 15, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.800 Vali Acc: 0.817 Test Loss: 0.800 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3425426483154297
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.749401569366455
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.959470510482788
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.354 Vali Acc: 0.872 Test Loss: 0.354 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.598846673965454
Epoch: 19, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.490278720855713
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.017827272415161
Epoch: 21, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2432639598846436
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.429234504699707
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.329432249069214
Epoch: 24, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 9353782
model size : 40.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.900185823440552
Epoch: 1, Steps: 12 | Train Loss: 1.920 Vali Loss: 1.788 Vali Acc: 0.344 Test Loss: 1.788 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 2.6888718605041504
Epoch: 2, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
Validation loss decreased (-0.344427 --> -0.622212).  Saving model ...
Epoch: 3 cost time: 2.556375741958618
Epoch: 3, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.674 Vali Acc: 0.689 Test Loss: 0.674 Test Acc: 0.689
Validation loss decreased (-0.622212 --> -0.688882).  Saving model ...
Epoch: 4 cost time: 2.4211766719818115
Epoch: 4, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.688882 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 2.4873127937316895
Epoch: 5, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.652 Vali Acc: 0.767 Test Loss: 0.652 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 6 cost time: 2.233741521835327
Epoch: 6, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 2.6564087867736816
Epoch: 7, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
Validation loss decreased (-0.783328 --> -0.849996).  Saving model ...
Epoch: 8 cost time: 2.3136231899261475
Epoch: 8, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.454 Vali Acc: 0.811 Test Loss: 0.454 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.627659797668457
Epoch: 9, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.485 Vali Acc: 0.806 Test Loss: 0.485 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.300788164138794
Epoch: 10, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866662).  Saving model ...
Epoch: 11 cost time: 2.3861382007598877
Epoch: 11, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 2.355640411376953
Epoch: 12, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.381 Vali Acc: 0.844 Test Loss: 0.381 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.35201096534729
Epoch: 13, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.397869348526001
Epoch: 14, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3999695777893066
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.637101411819458
Epoch: 16, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.113725423812866
Epoch: 17, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1695303916931152
Epoch: 18, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.701 Vali Acc: 0.833 Test Loss: 0.701 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8402538299560547
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.101864814758301
Epoch: 20, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.542 Vali Acc: 0.839 Test Loss: 0.542 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0765459537506104
Epoch: 21, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 8442166
model size : 37.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.779861211776733
Epoch: 1, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.580 Vali Acc: 0.406 Test Loss: 1.580 Test Acc: 0.406
Validation loss decreased (inf --> -0.405540).  Saving model ...
Epoch: 2 cost time: 2.2664341926574707
Epoch: 2, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.014 Vali Acc: 0.650 Test Loss: 1.014 Test Acc: 0.650
Validation loss decreased (-0.405540 --> -0.649990).  Saving model ...
Epoch: 3 cost time: 2.5017623901367188
Epoch: 3, Steps: 12 | Train Loss: 0.832 Vali Loss: 0.685 Vali Acc: 0.694 Test Loss: 0.685 Test Acc: 0.694
Validation loss decreased (-0.649990 --> -0.694438).  Saving model ...
Epoch: 4 cost time: 2.339505910873413
Epoch: 4, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.782 Vali Acc: 0.717 Test Loss: 0.782 Test Acc: 0.717
Validation loss decreased (-0.694438 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 2.2623465061187744
Epoch: 5, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.597 Vali Acc: 0.756 Test Loss: 0.597 Test Acc: 0.756
Validation loss decreased (-0.716659 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 2.3519275188446045
Epoch: 6, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.712 Vali Acc: 0.750 Test Loss: 0.712 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.725125551223755
Epoch: 7, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
Validation loss decreased (-0.755550 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.362896203994751
Epoch: 8, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.467 Vali Acc: 0.811 Test Loss: 0.467 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9590115547180176
Epoch: 9, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5151524543762207
Epoch: 10, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.600 Vali Acc: 0.811 Test Loss: 0.600 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3837571144104004
Epoch: 11, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 2.4931106567382812
Epoch: 12, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.503 Vali Acc: 0.839 Test Loss: 0.503 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2835261821746826
Epoch: 13, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.396 Vali Acc: 0.844 Test Loss: 0.396 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7333388328552246
Epoch: 14, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.431 Vali Acc: 0.872 Test Loss: 0.431 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.690416097640991
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4582276344299316
Epoch: 16, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.616 Vali Acc: 0.817 Test Loss: 0.616 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2577667236328125
Epoch: 17, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.960 Vali Acc: 0.828 Test Loss: 0.960 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7383177280426025
Epoch: 18, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.842 Vali Acc: 0.811 Test Loss: 0.842 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.580214023590088
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.125492811203003
Epoch: 20, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.808 Vali Acc: 0.811 Test Loss: 0.808 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.199850559234619
Epoch: 21, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.979 Vali Acc: 0.828 Test Loss: 0.979 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 8439606
model size : 37.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9281768798828125
Epoch: 1, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.626 Vali Acc: 0.317 Test Loss: 1.626 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 1.7832798957824707
Epoch: 2, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.037 Vali Acc: 0.661 Test Loss: 1.037 Test Acc: 0.661
Validation loss decreased (-0.316650 --> -0.661101).  Saving model ...
Epoch: 3 cost time: 2.0883660316467285
Epoch: 3, Steps: 12 | Train Loss: 0.897 Vali Loss: 0.796 Vali Acc: 0.639 Test Loss: 0.796 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8216822147369385
Epoch: 4, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.599 Vali Acc: 0.739 Test Loss: 0.599 Test Acc: 0.739
Validation loss decreased (-0.661101 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 2.2167725563049316
Epoch: 5, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.475 Vali Acc: 0.794 Test Loss: 0.475 Test Acc: 0.794
Validation loss decreased (-0.738883 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 2.0364019870758057
Epoch: 6, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.045760154724121
Epoch: 7, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.401 Vali Acc: 0.800 Test Loss: 0.401 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 8 cost time: 1.9084863662719727
Epoch: 8, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 2.0230884552001953
Epoch: 9, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.495 Vali Acc: 0.806 Test Loss: 0.495 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0514936447143555
Epoch: 10, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 2.086071014404297
Epoch: 11, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.470 Vali Acc: 0.806 Test Loss: 0.470 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.425060272216797
Epoch: 12, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.787 Vali Acc: 0.817 Test Loss: 0.787 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3070595264434814
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.240875244140625
Epoch: 14, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.900606393814087
Epoch: 15, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.19356632232666
Epoch: 16, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.49141788482666
Epoch: 17, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.607 Vali Acc: 0.817 Test Loss: 0.607 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.368454694747925
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0751962661743164
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1332664489746094
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.637 Vali Acc: 0.828 Test Loss: 0.637 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 8437046
model size : 37.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1944615840911865
Epoch: 1, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.856 Vali Acc: 0.244 Test Loss: 1.856 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 2.3696324825286865
Epoch: 2, Steps: 12 | Train Loss: 1.485 Vali Loss: 1.019 Vali Acc: 0.583 Test Loss: 1.019 Test Acc: 0.583
Validation loss decreased (-0.244426 --> -0.583323).  Saving model ...
Epoch: 3 cost time: 2.0064151287078857
Epoch: 3, Steps: 12 | Train Loss: 1.014 Vali Loss: 0.717 Vali Acc: 0.650 Test Loss: 0.717 Test Acc: 0.650
Validation loss decreased (-0.583323 --> -0.649993).  Saving model ...
Epoch: 4 cost time: 1.9210801124572754
Epoch: 4, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.656 Vali Acc: 0.694 Test Loss: 0.656 Test Acc: 0.694
Validation loss decreased (-0.649993 --> -0.694438).  Saving model ...
Epoch: 5 cost time: 2.515305757522583
Epoch: 5, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.476 Vali Acc: 0.789 Test Loss: 0.476 Test Acc: 0.789
Validation loss decreased (-0.694438 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 2.5611581802368164
Epoch: 6, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.473 Vali Acc: 0.811 Test Loss: 0.473 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811106).  Saving model ...
Epoch: 7 cost time: 2.176323890686035
Epoch: 7, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.426 Vali Acc: 0.828 Test Loss: 0.426 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 2.266507863998413
Epoch: 8, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.840 Vali Acc: 0.789 Test Loss: 0.840 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0455446243286133
Epoch: 9, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.643 Vali Acc: 0.817 Test Loss: 0.643 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.159299612045288
Epoch: 10, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.648 Vali Acc: 0.817 Test Loss: 0.648 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0890820026397705
Epoch: 11, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.125858783721924
Epoch: 12, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.463 Vali Acc: 0.828 Test Loss: 0.463 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4778623580932617
Epoch: 13, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 2.2219152450561523
Epoch: 14, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 2.174572467803955
Epoch: 15, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.585 Vali Acc: 0.817 Test Loss: 0.585 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2311947345733643
Epoch: 16, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.836648941040039
Epoch: 17, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.709 Vali Acc: 0.822 Test Loss: 0.709 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.652054786682129
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.131507158279419
Epoch: 19, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.162057876586914
Epoch: 20, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.136423110961914
Epoch: 21, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.447 Vali Acc: 0.839 Test Loss: 0.447 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7459797859191895
Epoch: 22, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.702 Vali Acc: 0.822 Test Loss: 0.702 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.263561248779297
Epoch: 23, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.639152765274048
Epoch: 24, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.724 Vali Acc: 0.833 Test Loss: 0.724 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 8434486
model size : 37.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.64194655418396
Epoch: 1, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.628 Vali Acc: 0.356 Test Loss: 1.628 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 2.234044075012207
Epoch: 2, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
Validation loss decreased (-0.355539 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 2.1795427799224854
Epoch: 3, Steps: 12 | Train Loss: 0.981 Vali Loss: 0.773 Vali Acc: 0.739 Test Loss: 0.773 Test Acc: 0.739
Validation loss decreased (-0.599987 --> -0.738881).  Saving model ...
Epoch: 4 cost time: 2.205677032470703
Epoch: 4, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.527 Vali Acc: 0.767 Test Loss: 0.527 Test Acc: 0.767
Validation loss decreased (-0.738881 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 2.050690174102783
Epoch: 5, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.503 Vali Acc: 0.767 Test Loss: 0.503 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 2.1373143196105957
Epoch: 6, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.493 Vali Acc: 0.794 Test Loss: 0.493 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.9583044052124023
Epoch: 7, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.419 Vali Acc: 0.811 Test Loss: 0.419 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 1.8506999015808105
Epoch: 8, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.458 Vali Acc: 0.794 Test Loss: 0.458 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1196019649505615
Epoch: 9, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.604 Vali Acc: 0.806 Test Loss: 0.604 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.03446626663208
Epoch: 10, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 2.1247708797454834
Epoch: 11, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.380 Vali Acc: 0.872 Test Loss: 0.380 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 2.2932000160217285
Epoch: 12, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.755 Vali Acc: 0.800 Test Loss: 0.755 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3731014728546143
Epoch: 13, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9372625350952148
Epoch: 14, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.434 Vali Acc: 0.867 Test Loss: 0.434 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.828484058380127
Epoch: 15, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9446532726287842
Epoch: 16, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.639 Vali Acc: 0.806 Test Loss: 0.639 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.024510622024536
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.514 Vali Acc: 0.839 Test Loss: 0.514 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2730300426483154
Epoch: 18, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0677170753479004
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9797170162200928
Epoch: 20, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6661946773529053
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 7982518
model size : 35.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.765972852706909
Epoch: 1, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.544 Vali Acc: 0.450 Test Loss: 1.544 Test Acc: 0.450
Validation loss decreased (inf --> -0.449985).  Saving model ...
Epoch: 2 cost time: 1.8977742195129395
Epoch: 2, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.186 Vali Acc: 0.650 Test Loss: 1.186 Test Acc: 0.650
Validation loss decreased (-0.449985 --> -0.649988).  Saving model ...
Epoch: 3 cost time: 2.1811320781707764
Epoch: 3, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.851 Vali Acc: 0.611 Test Loss: 0.851 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0290367603302
Epoch: 4, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.786 Vali Acc: 0.661 Test Loss: 0.786 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661103).  Saving model ...
Epoch: 5 cost time: 2.0699517726898193
Epoch: 5, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.514 Vali Acc: 0.750 Test Loss: 0.514 Test Acc: 0.750
Validation loss decreased (-0.661103 --> -0.749995).  Saving model ...
Epoch: 6 cost time: 1.9125399589538574
Epoch: 6, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
Validation loss decreased (-0.749995 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.8974807262420654
Epoch: 7, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.799996 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 2.1964335441589355
Epoch: 8, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.422 Vali Acc: 0.828 Test Loss: 0.422 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8722412586212158
Epoch: 9, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.409 Vali Acc: 0.839 Test Loss: 0.409 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.229736804962158
Epoch: 10, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.016657829284668
Epoch: 11, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.106309413909912
Epoch: 12, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6212728023529053
Epoch: 13, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4412322044372559
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.7058465480804443
Epoch: 15, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 1.5942013263702393
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.860844612121582
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.505 Vali Acc: 0.861 Test Loss: 0.505 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9639954566955566
Epoch: 18, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9960978031158447
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.642 Vali Acc: 0.817 Test Loss: 0.642 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.846083402633667
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.455 Vali Acc: 0.861 Test Loss: 0.455 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1952195167541504
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8993353843688965
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.082028865814209
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.761 Vali Acc: 0.828 Test Loss: 0.761 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2500100135803223
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.733 Vali Acc: 0.850 Test Loss: 0.733 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0033562183380127
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 7979958
model size : 35.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.429744243621826
Epoch: 1, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.572 Vali Acc: 0.311 Test Loss: 1.572 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 2.3362178802490234
Epoch: 2, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.077 Vali Acc: 0.539 Test Loss: 1.077 Test Acc: 0.539
Validation loss decreased (-0.311095 --> -0.538878).  Saving model ...
Epoch: 3 cost time: 2.720707893371582
Epoch: 3, Steps: 12 | Train Loss: 0.837 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
Validation loss decreased (-0.538878 --> -0.649990).  Saving model ...
Epoch: 4 cost time: 2.7283499240875244
Epoch: 4, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
Validation loss decreased (-0.649990 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 2.4948267936706543
Epoch: 5, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.712 Vali Acc: 0.728 Test Loss: 0.712 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 2.509584665298462
Epoch: 6, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.480 Vali Acc: 0.811 Test Loss: 0.480 Test Acc: 0.811
Validation loss decreased (-0.727771 --> -0.811106).  Saving model ...
Epoch: 7 cost time: 2.443161725997925
Epoch: 7, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.566 Vali Acc: 0.800 Test Loss: 0.566 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.886662483215332
Epoch: 8, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
Validation loss decreased (-0.811106 --> -0.855553).  Saving model ...
Epoch: 9 cost time: 3.1066389083862305
Epoch: 9, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 2.44254994392395
Epoch: 10, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.384 Vali Acc: 0.844 Test Loss: 0.384 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4968690872192383
Epoch: 11, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.026564121246338
Epoch: 12, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.301626443862915
Epoch: 13, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.05076003074646
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.270232915878296
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8964171409606934
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8647196292877197
Epoch: 17, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9783432483673096
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.031 Vali Acc: 0.789 Test Loss: 1.031 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3769631385803223
Epoch: 19, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866662).  Saving model ...
Epoch: 20 cost time: 3.0186359882354736
Epoch: 20, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.434 Vali Acc: 0.867 Test Loss: 0.434 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 2.248561143875122
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.810 Vali Acc: 0.822 Test Loss: 0.810 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4395244121551514
Epoch: 22, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0168724060058594
Epoch: 23, Steps: 12 | Train Loss: 0.371 Vali Loss: 1.243 Vali Acc: 0.822 Test Loss: 1.243 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2764782905578613
Epoch: 24, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.921154499053955
Epoch: 25, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.934 Vali Acc: 0.756 Test Loss: 0.934 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.226560115814209
Epoch: 26, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.771 Vali Acc: 0.844 Test Loss: 0.771 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.268547534942627
Epoch: 27, Steps: 12 | Train Loss: 0.262 Vali Loss: 1.186 Vali Acc: 0.789 Test Loss: 1.186 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.4653351306915283
Epoch: 28, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.769 Vali Acc: 0.811 Test Loss: 0.769 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.702735424041748
Epoch: 29, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.896 Vali Acc: 0.817 Test Loss: 0.896 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.6857316493988037
Epoch: 30, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.951 Vali Acc: 0.783 Test Loss: 0.951 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 7977398
model size : 35.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.269817590713501
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.589 Vali Acc: 0.322 Test Loss: 1.589 Test Acc: 0.322
Validation loss decreased (inf --> -0.322206).  Saving model ...
Epoch: 2 cost time: 2.5359749794006348
Epoch: 2, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.189 Vali Acc: 0.367 Test Loss: 1.189 Test Acc: 0.367
Validation loss decreased (-0.322206 --> -0.366655).  Saving model ...
Epoch: 3 cost time: 1.8679680824279785
Epoch: 3, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.289 Vali Acc: 0.528 Test Loss: 1.289 Test Acc: 0.528
Validation loss decreased (-0.366655 --> -0.527765).  Saving model ...
Epoch: 4 cost time: 2.577366828918457
Epoch: 4, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.593 Vali Acc: 0.761 Test Loss: 0.593 Test Acc: 0.761
Validation loss decreased (-0.527765 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 2.355116605758667
Epoch: 5, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1611826419830322
Epoch: 6, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.645 Vali Acc: 0.761 Test Loss: 0.645 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2022900581359863
Epoch: 7, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.482 Vali Acc: 0.811 Test Loss: 0.482 Test Acc: 0.811
Validation loss decreased (-0.761105 --> -0.811106).  Saving model ...
Epoch: 8 cost time: 2.2456181049346924
Epoch: 8, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.437 Vali Acc: 0.822 Test Loss: 0.437 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 2.1452767848968506
Epoch: 9, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.421 Vali Acc: 0.822 Test Loss: 0.421 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 2.330815076828003
Epoch: 10, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.365 Vali Acc: 0.844 Test Loss: 0.365 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 2.6476712226867676
Epoch: 11, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 2.199995279312134
Epoch: 12, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.423 Vali Acc: 0.856 Test Loss: 0.423 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8173267841339111
Epoch: 13, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.403 Vali Acc: 0.861 Test Loss: 0.403 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 2.2797720432281494
Epoch: 14, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.498 Vali Acc: 0.861 Test Loss: 0.498 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6999754905700684
Epoch: 15, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5433969497680664
Epoch: 16, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5295586585998535
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.621 Vali Acc: 0.817 Test Loss: 0.621 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7548491954803467
Epoch: 18, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 2.077742099761963
Epoch: 19, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.743 Vali Acc: 0.833 Test Loss: 0.743 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3390424251556396
Epoch: 20, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.552 Vali Acc: 0.839 Test Loss: 0.552 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2662088871002197
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 22 cost time: 2.4935715198516846
Epoch: 22, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.830 Vali Acc: 0.833 Test Loss: 0.830 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.557609796524048
Epoch: 23, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2817912101745605
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.733 Vali Acc: 0.844 Test Loss: 0.733 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0025243759155273
Epoch: 25, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.6366186141967773
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.814070701599121
Epoch: 27, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1256861686706543
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.745 Vali Acc: 0.811 Test Loss: 0.745 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.512617588043213
Epoch: 29, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.551365375518799
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.891 Vali Acc: 0.828 Test Loss: 0.891 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.6001389026641846
Epoch: 31, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.843 Vali Acc: 0.833 Test Loss: 0.843 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 7974838
model size : 35.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.297527551651001
Epoch: 1, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.781 Vali Acc: 0.172 Test Loss: 1.781 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 2.160086154937744
Epoch: 2, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.391 Vali Acc: 0.539 Test Loss: 1.391 Test Acc: 0.539
Validation loss decreased (-0.172204 --> -0.538875).  Saving model ...
Epoch: 3 cost time: 2.029517412185669
Epoch: 3, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.087 Vali Acc: 0.561 Test Loss: 1.087 Test Acc: 0.561
Validation loss decreased (-0.538875 --> -0.561100).  Saving model ...
Epoch: 4 cost time: 1.849364995956421
Epoch: 4, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.763 Vali Acc: 0.622 Test Loss: 0.763 Test Acc: 0.622
Validation loss decreased (-0.561100 --> -0.622215).  Saving model ...
Epoch: 5 cost time: 1.9543344974517822
Epoch: 5, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.574 Vali Acc: 0.750 Test Loss: 0.574 Test Acc: 0.750
Validation loss decreased (-0.622215 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.9997873306274414
Epoch: 6, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1459667682647705
Epoch: 7, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.476 Vali Acc: 0.772 Test Loss: 0.476 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 2.5300896167755127
Epoch: 8, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.710 Vali Acc: 0.750 Test Loss: 0.710 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1829423904418945
Epoch: 9, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.560 Vali Acc: 0.778 Test Loss: 0.560 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 2.0048978328704834
Epoch: 10, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.387 Vali Acc: 0.806 Test Loss: 0.387 Test Acc: 0.806
Validation loss decreased (-0.777772 --> -0.805552).  Saving model ...
Epoch: 11 cost time: 1.5417954921722412
Epoch: 11, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.356 Vali Acc: 0.833 Test Loss: 0.356 Test Acc: 0.833
Validation loss decreased (-0.805552 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 2.192107677459717
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.496 Vali Acc: 0.794 Test Loss: 0.496 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.278104066848755
Epoch: 13, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.493 Vali Acc: 0.794 Test Loss: 0.493 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8698701858520508
Epoch: 14, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 2.1066765785217285
Epoch: 15, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.535 Vali Acc: 0.806 Test Loss: 0.535 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1790988445281982
Epoch: 16, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.463 Vali Acc: 0.828 Test Loss: 0.463 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1769328117370605
Epoch: 17, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.618 Vali Acc: 0.794 Test Loss: 0.618 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0632033348083496
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 2.3952159881591797
Epoch: 19, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3303892612457275
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.430 Vali Acc: 0.856 Test Loss: 0.430 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0523574352264404
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.521 Vali Acc: 0.839 Test Loss: 0.521 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9905297756195068
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.2216737270355225
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.400 Vali Acc: 0.872 Test Loss: 0.400 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9647455215454102
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.388 Vali Acc: 0.878 Test Loss: 0.388 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8263494968414307
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2751452922821045
Epoch: 26, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.2544708251953125
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.423 Vali Acc: 0.856 Test Loss: 0.423 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.2141060829162598
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 3768630
model size : 16.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.273289203643799
Epoch: 1, Steps: 12 | Train Loss: 1.965 Vali Loss: 1.784 Vali Acc: 0.228 Test Loss: 1.784 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 2.13789963722229
Epoch: 2, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.452 Vali Acc: 0.394 Test Loss: 1.452 Test Acc: 0.394
Validation loss decreased (-0.227760 --> -0.394430).  Saving model ...
Epoch: 3 cost time: 2.2107794284820557
Epoch: 3, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.126 Vali Acc: 0.589 Test Loss: 1.126 Test Acc: 0.589
Validation loss decreased (-0.394430 --> -0.588878).  Saving model ...
Epoch: 4 cost time: 1.9437980651855469
Epoch: 4, Steps: 12 | Train Loss: 0.950 Vali Loss: 0.761 Vali Acc: 0.650 Test Loss: 0.761 Test Acc: 0.650
Validation loss decreased (-0.588878 --> -0.649992).  Saving model ...
Epoch: 5 cost time: 2.103127956390381
Epoch: 5, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.861 Vali Acc: 0.683 Test Loss: 0.861 Test Acc: 0.683
Validation loss decreased (-0.649992 --> -0.683325).  Saving model ...
Epoch: 6 cost time: 2.366976022720337
Epoch: 6, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.606 Vali Acc: 0.711 Test Loss: 0.606 Test Acc: 0.711
Validation loss decreased (-0.683325 --> -0.711105).  Saving model ...
Epoch: 7 cost time: 2.0313401222229004
Epoch: 7, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.544 Vali Acc: 0.744 Test Loss: 0.544 Test Acc: 0.744
Validation loss decreased (-0.711105 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 1.9939134120941162
Epoch: 8, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.413 Vali Acc: 0.817 Test Loss: 0.413 Test Acc: 0.817
Validation loss decreased (-0.744439 --> -0.816663).  Saving model ...
Epoch: 9 cost time: 2.3890154361724854
Epoch: 9, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 2.2262871265411377
Epoch: 10, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0520989894866943
Epoch: 11, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.645 Vali Acc: 0.794 Test Loss: 0.645 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.072115898132324
Epoch: 12, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 2.2535438537597656
Epoch: 13, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.385 Vali Acc: 0.822 Test Loss: 0.385 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.080044984817505
Epoch: 14, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.458 Vali Acc: 0.817 Test Loss: 0.458 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7619202136993408
Epoch: 15, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.407 Vali Acc: 0.844 Test Loss: 0.407 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.400052785873413
Epoch: 16, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.424 Vali Acc: 0.856 Test Loss: 0.424 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8213543891906738
Epoch: 17, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8393492698669434
Epoch: 18, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3836982250213623
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.533 Vali Acc: 0.817 Test Loss: 0.533 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.135526657104492
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8931944370269775
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 22 cost time: 1.9223718643188477
Epoch: 22, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.579 Vali Acc: 0.800 Test Loss: 0.579 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.024792194366455
Epoch: 23, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9951705932617188
Epoch: 24, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 25 cost time: 2.0820202827453613
Epoch: 25, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.382 Vali Acc: 0.889 Test Loss: 0.382 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888885).  Saving model ...
Epoch: 26 cost time: 2.2566616535186768
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.366 Vali Acc: 0.883 Test Loss: 0.366 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2193050384521484
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.470 Vali Acc: 0.861 Test Loss: 0.470 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4352896213531494
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3186018466949463
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.476 Vali Acc: 0.872 Test Loss: 0.476 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.568347930908203
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.276237964630127
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.03912353515625
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.460 Vali Acc: 0.867 Test Loss: 0.460 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8982927799224854
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.429633617401123
Epoch: 34, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.1361842155456543
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.851 Vali Acc: 0.778 Test Loss: 0.851 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 3767350
model size : 16.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.666775941848755
Epoch: 1, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.725 Vali Acc: 0.178 Test Loss: 1.725 Test Acc: 0.178
Validation loss decreased (inf --> -0.177761).  Saving model ...
Epoch: 2 cost time: 2.2183613777160645
Epoch: 2, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.390 Vali Acc: 0.561 Test Loss: 1.390 Test Acc: 0.561
Validation loss decreased (-0.177761 --> -0.561097).  Saving model ...
Epoch: 3 cost time: 2.429370403289795
Epoch: 3, Steps: 12 | Train Loss: 1.144 Vali Loss: 0.949 Vali Acc: 0.656 Test Loss: 0.949 Test Acc: 0.656
Validation loss decreased (-0.561097 --> -0.655546).  Saving model ...
Epoch: 4 cost time: 1.9852266311645508
Epoch: 4, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.730 Vali Acc: 0.694 Test Loss: 0.730 Test Acc: 0.694
Validation loss decreased (-0.655546 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 2.024991273880005
Epoch: 5, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.594 Vali Acc: 0.739 Test Loss: 0.594 Test Acc: 0.739
Validation loss decreased (-0.694437 --> -0.738883).  Saving model ...
Epoch: 6 cost time: 2.196524143218994
Epoch: 6, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.607 Vali Acc: 0.756 Test Loss: 0.607 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 2.100813865661621
Epoch: 7, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.402 Vali Acc: 0.800 Test Loss: 0.402 Test Acc: 0.800
Validation loss decreased (-0.755549 --> -0.799996).  Saving model ...
Epoch: 8 cost time: 2.1143524646759033
Epoch: 8, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.406 Vali Acc: 0.822 Test Loss: 0.406 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 2.1666476726531982
Epoch: 9, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
Validation loss decreased (-0.822218 --> -0.866663).  Saving model ...
Epoch: 10 cost time: 2.4091999530792236
Epoch: 10, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2619192600250244
Epoch: 11, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.352 Vali Acc: 0.856 Test Loss: 0.352 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1023037433624268
Epoch: 12, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.403 Vali Acc: 0.828 Test Loss: 0.403 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3271849155426025
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.360 Vali Acc: 0.844 Test Loss: 0.360 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7087249755859375
Epoch: 14, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.9821679592132568
Epoch: 15, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.327805280685425
Epoch: 16, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 1.8336355686187744
Epoch: 17, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.479905128479004
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7406179904937744
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.443 Vali Acc: 0.839 Test Loss: 0.443 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.196537971496582
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.361 Vali Acc: 0.878 Test Loss: 0.361 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2542998790740967
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.585 Vali Acc: 0.839 Test Loss: 0.585 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.091750144958496
Epoch: 22, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.475 Vali Acc: 0.839 Test Loss: 0.475 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6004753112792969
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.328 Vali Acc: 0.878 Test Loss: 0.328 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0317602157592773
Epoch: 24, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7185537815093994
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.352 Vali Acc: 0.872 Test Loss: 0.352 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6875929832458496
Epoch: 26, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 3766070
model size : 16.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.41339635848999
Epoch: 1, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.713 Vali Acc: 0.211 Test Loss: 1.713 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 2.8326380252838135
Epoch: 2, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.367 Vali Acc: 0.478 Test Loss: 1.367 Test Acc: 0.478
Validation loss decreased (-0.211094 --> -0.477764).  Saving model ...
Epoch: 3 cost time: 2.9348809719085693
Epoch: 3, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
Validation loss decreased (-0.477764 --> -0.622212).  Saving model ...
Epoch: 4 cost time: 1.9552459716796875
Epoch: 4, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.766 Vali Acc: 0.656 Test Loss: 0.766 Test Acc: 0.656
Validation loss decreased (-0.622212 --> -0.655548).  Saving model ...
Epoch: 5 cost time: 2.24672794342041
Epoch: 5, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
Validation loss decreased (-0.655548 --> -0.716661).  Saving model ...
Epoch: 6 cost time: 2.952826738357544
Epoch: 6, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.546 Vali Acc: 0.739 Test Loss: 0.546 Test Acc: 0.739
Validation loss decreased (-0.716661 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 2.249830722808838
Epoch: 7, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.434 Vali Acc: 0.811 Test Loss: 0.434 Test Acc: 0.811
Validation loss decreased (-0.738883 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 2.6583733558654785
Epoch: 8, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.416 Vali Acc: 0.822 Test Loss: 0.416 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 2.426016092300415
Epoch: 9, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.425 Vali Acc: 0.844 Test Loss: 0.425 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844440).  Saving model ...
Epoch: 10 cost time: 2.6764395236968994
Epoch: 10, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 2.531595230102539
Epoch: 11, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4599997997283936
Epoch: 12, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.905973434448242
Epoch: 13, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.367 Vali Acc: 0.839 Test Loss: 0.367 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5687642097473145
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 2.4666152000427246
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.399 Vali Acc: 0.839 Test Loss: 0.399 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.813420295715332
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6145195960998535
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.452 Vali Acc: 0.844 Test Loss: 0.452 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3185484409332275
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.364 Vali Acc: 0.844 Test Loss: 0.364 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.835498571395874
Epoch: 19, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.449061155319214
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.356 Vali Acc: 0.867 Test Loss: 0.356 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.480050563812256
Epoch: 21, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.274777412414551
Epoch: 22, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.402 Vali Acc: 0.861 Test Loss: 0.402 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.0823018550872803
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.419 Vali Acc: 0.856 Test Loss: 0.419 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.707489490509033
Epoch: 24, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.443 Vali Acc: 0.867 Test Loss: 0.443 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 3764790
model size : 16.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.9205217361450195
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.721 Vali Acc: 0.300 Test Loss: 1.721 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 2.161496162414551
Epoch: 2, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.345 Vali Acc: 0.572 Test Loss: 1.345 Test Acc: 0.572
Validation loss decreased (-0.299983 --> -0.572209).  Saving model ...
Epoch: 3 cost time: 2.5647542476654053
Epoch: 3, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.017 Vali Acc: 0.656 Test Loss: 1.017 Test Acc: 0.656
Validation loss decreased (-0.572209 --> -0.655545).  Saving model ...
Epoch: 4 cost time: 1.9628965854644775
Epoch: 4, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
Validation loss decreased (-0.655545 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 2.2785143852233887
Epoch: 5, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.583 Vali Acc: 0.778 Test Loss: 0.583 Test Acc: 0.778
Validation loss decreased (-0.716660 --> -0.777772).  Saving model ...
Epoch: 6 cost time: 2.1413183212280273
Epoch: 6, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.496 Vali Acc: 0.778 Test Loss: 0.496 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 2.2018344402313232
Epoch: 7, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.429 Vali Acc: 0.789 Test Loss: 0.429 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 8 cost time: 1.6574299335479736
Epoch: 8, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.600 Vali Acc: 0.794 Test Loss: 0.600 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 1.6382739543914795
Epoch: 9, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.395 Vali Acc: 0.811 Test Loss: 0.395 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 1.5978491306304932
Epoch: 10, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.491 Vali Acc: 0.817 Test Loss: 0.491 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 1.786830186843872
Epoch: 11, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.382 Vali Acc: 0.817 Test Loss: 0.382 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 1.5509400367736816
Epoch: 12, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.399 Vali Acc: 0.811 Test Loss: 0.399 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2376153469085693
Epoch: 13, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.418 Vali Acc: 0.811 Test Loss: 0.418 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.225330114364624
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
Validation loss decreased (-0.816663 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.9010939598083496
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8963115215301514
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.941915512084961
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.9695789813995361
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.913203477859497
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6177496910095215
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.355 Vali Acc: 0.878 Test Loss: 0.355 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1335103511810303
Epoch: 21, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.842 Vali Acc: 0.817 Test Loss: 0.842 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0487940311431885
Epoch: 22, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8220586776733398
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8520033359527588
Epoch: 24, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.358 Vali Acc: 0.856 Test Loss: 0.358 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2104029655456543
Epoch: 25, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.508061170578003
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.392 Vali Acc: 0.872 Test Loss: 0.392 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.557553291320801
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.528 Vali Acc: 0.806 Test Loss: 0.528 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 2847542
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.354265451431274
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.679 Vali Acc: 0.350 Test Loss: 1.679 Test Acc: 0.350
Validation loss decreased (inf --> -0.349983).  Saving model ...
Epoch: 2 cost time: 2.4731736183166504
Epoch: 2, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.313 Vali Acc: 0.561 Test Loss: 1.313 Test Acc: 0.561
Validation loss decreased (-0.349983 --> -0.561098).  Saving model ...
Epoch: 3 cost time: 2.2564408779144287
Epoch: 3, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.023 Vali Acc: 0.617 Test Loss: 1.023 Test Acc: 0.617
Validation loss decreased (-0.561098 --> -0.616656).  Saving model ...
Epoch: 4 cost time: 2.224029779434204
Epoch: 4, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.868 Vali Acc: 0.622 Test Loss: 0.868 Test Acc: 0.622
Validation loss decreased (-0.616656 --> -0.622214).  Saving model ...
Epoch: 5 cost time: 2.671565532684326
Epoch: 5, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
Validation loss decreased (-0.622214 --> -0.716661).  Saving model ...
Epoch: 6 cost time: 2.091953754425049
Epoch: 6, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.497 Vali Acc: 0.767 Test Loss: 0.497 Test Acc: 0.767
Validation loss decreased (-0.716661 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 1.9317257404327393
Epoch: 7, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.418 Vali Acc: 0.806 Test Loss: 0.418 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 2.12580943107605
Epoch: 8, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 2.6321401596069336
Epoch: 9, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.392 Vali Acc: 0.844 Test Loss: 0.392 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 2.7099990844726562
Epoch: 10, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.361 Vali Acc: 0.839 Test Loss: 0.361 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7085812091827393
Epoch: 11, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 2.201692819595337
Epoch: 12, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2789459228515625
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.379 Vali Acc: 0.839 Test Loss: 0.379 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.507032632827759
Epoch: 14, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.389 Vali Acc: 0.844 Test Loss: 0.389 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9363956451416016
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.384 Vali Acc: 0.828 Test Loss: 0.384 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3719260692596436
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.596 Vali Acc: 0.794 Test Loss: 0.596 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.876349449157715
Epoch: 17, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.818 Vali Acc: 0.811 Test Loss: 0.818 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.29129695892334
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3784263134002686
Epoch: 19, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.746732234954834
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.471 Vali Acc: 0.828 Test Loss: 0.471 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.645589828491211
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.623 Vali Acc: 0.817 Test Loss: 0.623 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 2846262
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.668994426727295
Epoch: 1, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.656 Vali Acc: 0.261 Test Loss: 1.656 Test Acc: 0.261
Validation loss decreased (inf --> -0.261095).  Saving model ...
Epoch: 2 cost time: 2.7742323875427246
Epoch: 2, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.341 Vali Acc: 0.594 Test Loss: 1.341 Test Acc: 0.594
Validation loss decreased (-0.261095 --> -0.594431).  Saving model ...
Epoch: 3 cost time: 2.403278112411499
Epoch: 3, Steps: 12 | Train Loss: 1.180 Vali Loss: 0.989 Vali Acc: 0.600 Test Loss: 0.989 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 2.880260944366455
Epoch: 4, Steps: 12 | Train Loss: 0.971 Vali Loss: 0.805 Vali Acc: 0.667 Test Loss: 0.805 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666659).  Saving model ...
Epoch: 5 cost time: 2.7309601306915283
Epoch: 5, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.632 Vali Acc: 0.694 Test Loss: 0.632 Test Acc: 0.694
Validation loss decreased (-0.666659 --> -0.694438).  Saving model ...
Epoch: 6 cost time: 2.4504244327545166
Epoch: 6, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.624 Vali Acc: 0.733 Test Loss: 0.624 Test Acc: 0.733
Validation loss decreased (-0.694438 --> -0.733327).  Saving model ...
Epoch: 7 cost time: 2.4114677906036377
Epoch: 7, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.441 Vali Acc: 0.794 Test Loss: 0.441 Test Acc: 0.794
Validation loss decreased (-0.733327 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.546269416809082
Epoch: 8, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.410 Vali Acc: 0.839 Test Loss: 0.410 Test Acc: 0.839
Validation loss decreased (-0.794440 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 2.2757906913757324
Epoch: 9, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.457 Vali Acc: 0.778 Test Loss: 0.457 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1573073863983154
Epoch: 10, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 2.5876104831695557
Epoch: 11, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6661860942840576
Epoch: 12, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.437 Vali Acc: 0.822 Test Loss: 0.437 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5797600746154785
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3467495441436768
Epoch: 14, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.226240634918213
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.401 Vali Acc: 0.844 Test Loss: 0.401 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.244370698928833
Epoch: 16, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.187598705291748
Epoch: 17, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 2.5732717514038086
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 19 cost time: 2.7807834148406982
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.650243043899536
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 21 cost time: 2.1680080890655518
Epoch: 21, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2784876823425293
Epoch: 22, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 23 cost time: 2.3710975646972656
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.486 Vali Acc: 0.861 Test Loss: 0.486 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1845157146453857
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.385 Vali Acc: 0.856 Test Loss: 0.385 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.263608455657959
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.457 Vali Acc: 0.867 Test Loss: 0.457 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.375917911529541
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.466 Vali Acc: 0.861 Test Loss: 0.466 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5262396335601807
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.771841049194336
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3116378784179688
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.518850803375244
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.4822254180908203
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.716 Vali Acc: 0.828 Test Loss: 0.716 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.511854410171509
Epoch: 32, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 2844982
model size : 13.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.736275911331177
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.669 Vali Acc: 0.244 Test Loss: 1.669 Test Acc: 0.244
Validation loss decreased (inf --> -0.244428).  Saving model ...
Epoch: 2 cost time: 2.2485358715057373
Epoch: 2, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.374 Vali Acc: 0.550 Test Loss: 1.374 Test Acc: 0.550
Validation loss decreased (-0.244428 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 2.339195728302002
Epoch: 3, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.080 Vali Acc: 0.606 Test Loss: 1.080 Test Acc: 0.606
Validation loss decreased (-0.549986 --> -0.605545).  Saving model ...
Epoch: 4 cost time: 1.9047126770019531
Epoch: 4, Steps: 12 | Train Loss: 0.970 Vali Loss: 0.972 Vali Acc: 0.661 Test Loss: 0.972 Test Acc: 0.661
Validation loss decreased (-0.605545 --> -0.661101).  Saving model ...
Epoch: 5 cost time: 2.3618831634521484
Epoch: 5, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.660 Vali Acc: 0.700 Test Loss: 0.660 Test Acc: 0.700
Validation loss decreased (-0.661101 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 2.4262173175811768
Epoch: 6, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.629 Vali Acc: 0.689 Test Loss: 0.629 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0078368186950684
Epoch: 7, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.501 Vali Acc: 0.744 Test Loss: 0.501 Test Acc: 0.744
Validation loss decreased (-0.699993 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 2.0988988876342773
Epoch: 8, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.488 Vali Acc: 0.794 Test Loss: 0.488 Test Acc: 0.794
Validation loss decreased (-0.744439 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 2.53682541847229
Epoch: 9, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.482 Vali Acc: 0.806 Test Loss: 0.482 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 1.8372986316680908
Epoch: 10, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.409 Vali Acc: 0.789 Test Loss: 0.409 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.977426290512085
Epoch: 11, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.404 Vali Acc: 0.806 Test Loss: 0.404 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 12 cost time: 2.2080283164978027
Epoch: 12, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
Validation loss decreased (-0.805552 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 2.2713234424591064
Epoch: 13, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8170433044433594
Epoch: 14, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 1.8557014465332031
Epoch: 15, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.403 Vali Acc: 0.839 Test Loss: 0.403 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7230992317199707
Epoch: 16, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0568549633026123
Epoch: 17, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.77693772315979
Epoch: 18, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.434 Vali Acc: 0.817 Test Loss: 0.434 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0768823623657227
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.878544807434082
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.429 Vali Acc: 0.856 Test Loss: 0.429 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0671961307525635
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 1.8661699295043945
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.391 Vali Acc: 0.867 Test Loss: 0.391 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.051614284515381
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1266891956329346
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0329244136810303
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.393 Vali Acc: 0.878 Test Loss: 0.393 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.570167303085327
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 2.407958507537842
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1937170028686523
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8059260845184326
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.481 Vali Acc: 0.883 Test Loss: 0.481 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.868055820465088
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9421288967132568
Epoch: 31, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.2939140796661377
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9506757259368896
Epoch: 33, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.416 Vali Acc: 0.872 Test Loss: 0.416 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.768294334411621
Epoch: 34, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.387 Vali Acc: 0.894 Test Loss: 0.387 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.1453256607055664
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.5111594200134277
Epoch: 36, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 2843702
model size : 13.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.214216709136963
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.731 Vali Acc: 0.178 Test Loss: 1.731 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 2.3655648231506348
Epoch: 2, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.437 Vali Acc: 0.433 Test Loss: 1.437 Test Acc: 0.433
Validation loss decreased (-0.177760 --> -0.433319).  Saving model ...
Epoch: 3 cost time: 2.3077239990234375
Epoch: 3, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.044 Vali Acc: 0.644 Test Loss: 1.044 Test Acc: 0.644
Validation loss decreased (-0.433319 --> -0.644434).  Saving model ...
Epoch: 4 cost time: 2.386535406112671
Epoch: 4, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.782 Vali Acc: 0.717 Test Loss: 0.782 Test Acc: 0.717
Validation loss decreased (-0.644434 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 2.564619541168213
Epoch: 5, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.596 Vali Acc: 0.767 Test Loss: 0.596 Test Acc: 0.767
Validation loss decreased (-0.716659 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 2.5492148399353027
Epoch: 6, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.756 Vali Acc: 0.656 Test Loss: 0.756 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.770988941192627
Epoch: 7, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783328).  Saving model ...
Epoch: 8 cost time: 2.637035369873047
Epoch: 8, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.413 Vali Acc: 0.806 Test Loss: 0.413 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 2.6268703937530518
Epoch: 9, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.438 Vali Acc: 0.800 Test Loss: 0.438 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.408029317855835
Epoch: 10, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8606324195861816
Epoch: 11, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.432 Vali Acc: 0.811 Test Loss: 0.432 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 2.1937005519866943
Epoch: 12, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.538 Vali Acc: 0.794 Test Loss: 0.538 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.674966812133789
Epoch: 13, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.341 Vali Acc: 0.839 Test Loss: 0.341 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 2.713388681411743
Epoch: 14, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.362 Vali Acc: 0.878 Test Loss: 0.362 Test Acc: 0.878
Validation loss decreased (-0.838885 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 2.189607620239258
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9624783992767334
Epoch: 16, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.801032066345215
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3430888652801514
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.082223653793335
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.0219931602478027
Epoch: 20, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.304 Vali Acc: 0.883 Test Loss: 0.304 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 2.892216205596924
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1972007751464844
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.405 Vali Acc: 0.872 Test Loss: 0.405 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7540228366851807
Epoch: 23, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.807 Vali Acc: 0.789 Test Loss: 0.807 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.897315740585327
Epoch: 24, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6090986728668213
Epoch: 25, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.834 Vali Acc: 0.806 Test Loss: 0.834 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.9134702682495117
Epoch: 26, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.586923122406006
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.715397834777832
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.428 Vali Acc: 0.894 Test Loss: 0.428 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894440).  Saving model ...
Epoch: 29 cost time: 2.3570797443389893
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894441).  Saving model ...
Epoch: 30 cost time: 2.6263813972473145
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911108).  Saving model ...
Epoch: 31 cost time: 2.468045473098755
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4640114307403564
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.515918493270874
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.3603780269622803
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.6667490005493164
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.380 Vali Acc: 0.867 Test Loss: 0.380 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.5680246353149414
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.411 Vali Acc: 0.867 Test Loss: 0.411 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.510774612426758
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.423 Vali Acc: 0.878 Test Loss: 0.423 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.7421998977661133
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.468 Vali Acc: 0.856 Test Loss: 0.468 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.7097814083099365
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.7908244132995605
Epoch: 40, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.515 Vali Acc: 0.839 Test Loss: 0.515 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 2386998
model size : 11.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.890169620513916
Epoch: 1, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.746 Vali Acc: 0.306 Test Loss: 1.746 Test Acc: 0.306
Validation loss decreased (inf --> -0.305538).  Saving model ...
Epoch: 2 cost time: 1.9309284687042236
Epoch: 2, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.489 Vali Acc: 0.511 Test Loss: 1.489 Test Acc: 0.511
Validation loss decreased (-0.305538 --> -0.511096).  Saving model ...
Epoch: 3 cost time: 1.9496972560882568
Epoch: 3, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.108 Vali Acc: 0.689 Test Loss: 1.108 Test Acc: 0.689
Validation loss decreased (-0.511096 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 1.8774549961090088
Epoch: 4, Steps: 12 | Train Loss: 1.010 Vali Loss: 0.894 Vali Acc: 0.628 Test Loss: 0.894 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3704943656921387
Epoch: 5, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.757 Vali Acc: 0.661 Test Loss: 0.757 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.138150453567505
Epoch: 6, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 2.039234161376953
Epoch: 7, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.466 Vali Acc: 0.767 Test Loss: 0.466 Test Acc: 0.767
Validation loss decreased (-0.722216 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 1.9629418849945068
Epoch: 8, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.478 Vali Acc: 0.767 Test Loss: 0.478 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.06308650970459
Epoch: 9, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.718 Vali Acc: 0.794 Test Loss: 0.718 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794437).  Saving model ...
Epoch: 10 cost time: 1.9283106327056885
Epoch: 10, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.438 Vali Acc: 0.806 Test Loss: 0.438 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.9795095920562744
Epoch: 11, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 2.2301323413848877
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838886).  Saving model ...
Epoch: 13 cost time: 1.8590877056121826
Epoch: 13, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.385 Vali Acc: 0.817 Test Loss: 0.385 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.251171827316284
Epoch: 14, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.274 Vali Acc: 0.867 Test Loss: 0.274 Test Acc: 0.867
Validation loss decreased (-0.838886 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 1.9045493602752686
Epoch: 15, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.419 Vali Acc: 0.872 Test Loss: 0.419 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 2.2816073894500732
Epoch: 16, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.383 Vali Acc: 0.878 Test Loss: 0.383 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 2.2020795345306396
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.345 Vali Acc: 0.867 Test Loss: 0.345 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.27074933052063
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.877774 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.254542589187622
Epoch: 19, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.289414167404175
Epoch: 20, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.479297399520874
Epoch: 21, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.374 Vali Acc: 0.883 Test Loss: 0.374 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2637953758239746
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3380589485168457
Epoch: 23, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.211280107498169
Epoch: 24, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.388 Vali Acc: 0.878 Test Loss: 0.388 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.281076669692993
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1447925567626953
Epoch: 26, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.431 Vali Acc: 0.872 Test Loss: 0.431 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1713361740112305
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.387 Vali Acc: 0.867 Test Loss: 0.387 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.1837570667266846
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 2385718
model size : 11.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.919222116470337
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.731 Vali Acc: 0.189 Test Loss: 1.731 Test Acc: 0.189
Validation loss decreased (inf --> -0.188872).  Saving model ...
Epoch: 2 cost time: 1.943213939666748
Epoch: 2, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.439 Vali Acc: 0.494 Test Loss: 1.439 Test Acc: 0.494
Validation loss decreased (-0.188872 --> -0.494430).  Saving model ...
Epoch: 3 cost time: 2.1483383178710938
Epoch: 3, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
Validation loss decreased (-0.494430 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 2.181974411010742
Epoch: 4, Steps: 12 | Train Loss: 1.047 Vali Loss: 0.781 Vali Acc: 0.694 Test Loss: 0.781 Test Acc: 0.694
Validation loss decreased (-0.649989 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 2.1122210025787354
Epoch: 5, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.604 Vali Acc: 0.700 Test Loss: 0.604 Test Acc: 0.700
Validation loss decreased (-0.694437 --> -0.699994).  Saving model ...
Epoch: 6 cost time: 2.110578775405884
Epoch: 6, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.594 Vali Acc: 0.761 Test Loss: 0.594 Test Acc: 0.761
Validation loss decreased (-0.699994 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 2.212489604949951
Epoch: 7, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.413 Vali Acc: 0.783 Test Loss: 0.413 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 2.0582356452941895
Epoch: 8, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.431 Vali Acc: 0.778 Test Loss: 0.431 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.575117826461792
Epoch: 9, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.507 Vali Acc: 0.778 Test Loss: 0.507 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6550188064575195
Epoch: 10, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.479 Vali Acc: 0.811 Test Loss: 0.479 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 2.238365411758423
Epoch: 11, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 1.985672950744629
Epoch: 12, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 2.281801223754883
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1963253021240234
Epoch: 14, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 1.6364877223968506
Epoch: 15, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.420069456100464
Epoch: 16, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.458 Vali Acc: 0.817 Test Loss: 0.458 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2279303073883057
Epoch: 17, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.003913640975952
Epoch: 18, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.376 Vali Acc: 0.856 Test Loss: 0.376 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 1.8654122352600098
Epoch: 19, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 1.9489667415618896
Epoch: 20, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8753035068511963
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0616724491119385
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 2.347707509994507
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.312 Vali Acc: 0.872 Test Loss: 0.312 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.313979387283325
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4984917640686035
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.613 Vali Acc: 0.817 Test Loss: 0.613 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.6145975589752197
Epoch: 26, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.355 Vali Acc: 0.872 Test Loss: 0.355 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.522305727005005
Epoch: 27, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.804 Vali Acc: 0.806 Test Loss: 0.804 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.4047563076019287
Epoch: 28, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.453 Vali Acc: 0.872 Test Loss: 0.453 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.4572529792785645
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.824984073638916
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.396 Vali Acc: 0.856 Test Loss: 0.396 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.4729225635528564
Epoch: 31, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.1438496112823486
Epoch: 32, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2384438
model size : 11.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.315227270126343
Epoch: 1, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.805 Vali Acc: 0.200 Test Loss: 1.805 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 2.8616747856140137
Epoch: 2, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.480 Vali Acc: 0.478 Test Loss: 1.480 Test Acc: 0.478
Validation loss decreased (-0.199982 --> -0.477763).  Saving model ...
Epoch: 3 cost time: 2.0652358531951904
Epoch: 3, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.139 Vali Acc: 0.644 Test Loss: 1.139 Test Acc: 0.644
Validation loss decreased (-0.477763 --> -0.644433).  Saving model ...
Epoch: 4 cost time: 2.2746686935424805
Epoch: 4, Steps: 12 | Train Loss: 0.972 Vali Loss: 0.865 Vali Acc: 0.633 Test Loss: 0.865 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2445621490478516
Epoch: 5, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
Validation loss decreased (-0.644433 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 2.3892617225646973
Epoch: 6, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.609 Vali Acc: 0.767 Test Loss: 0.609 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 2.580846071243286
Epoch: 7, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.510 Vali Acc: 0.756 Test Loss: 0.510 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4462387561798096
Epoch: 8, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.521 Vali Acc: 0.772 Test Loss: 0.521 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 2.446565866470337
Epoch: 9, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.449 Vali Acc: 0.822 Test Loss: 0.449 Test Acc: 0.822
Validation loss decreased (-0.772217 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 2.0084280967712402
Epoch: 10, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.371 Vali Acc: 0.817 Test Loss: 0.371 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.456770181655884
Epoch: 11, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.574 Vali Acc: 0.794 Test Loss: 0.574 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8888585567474365
Epoch: 12, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.428 Vali Acc: 0.839 Test Loss: 0.428 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 2.2522072792053223
Epoch: 13, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 2.542051315307617
Epoch: 14, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.421 Vali Acc: 0.817 Test Loss: 0.421 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.543649196624756
Epoch: 15, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.581915855407715
Epoch: 16, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 2.606356620788574
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.384 Vali Acc: 0.872 Test Loss: 0.384 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872218).  Saving model ...
Epoch: 18 cost time: 2.362318754196167
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.512 Vali Acc: 0.811 Test Loss: 0.512 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.157140016555786
Epoch: 19, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.757636308670044
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1981632709503174
Epoch: 21, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4291741847991943
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5194318294525146
Epoch: 23, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.433 Vali Acc: 0.867 Test Loss: 0.433 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1320812702178955
Epoch: 24, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.494940996170044
Epoch: 25, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.631760358810425
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.426 Vali Acc: 0.839 Test Loss: 0.426 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.712759494781494
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.592 Vali Acc: 0.811 Test Loss: 0.592 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 2383158
model size : 11.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.309149742126465
Epoch: 1, Steps: 12 | Train Loss: 1.907 Vali Loss: 1.766 Vali Acc: 0.289 Test Loss: 1.766 Test Acc: 0.289
Validation loss decreased (inf --> -0.288871).  Saving model ...
Epoch: 2 cost time: 1.9665369987487793
Epoch: 2, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.544 Vali Acc: 0.356 Test Loss: 1.544 Test Acc: 0.356
Validation loss decreased (-0.288871 --> -0.355540).  Saving model ...
Epoch: 3 cost time: 2.2893340587615967
Epoch: 3, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.286 Vali Acc: 0.672 Test Loss: 1.286 Test Acc: 0.672
Validation loss decreased (-0.355540 --> -0.672209).  Saving model ...
Epoch: 4 cost time: 2.0960941314697266
Epoch: 4, Steps: 12 | Train Loss: 1.115 Vali Loss: 0.846 Vali Acc: 0.717 Test Loss: 0.846 Test Acc: 0.717
Validation loss decreased (-0.672209 --> -0.716658).  Saving model ...
Epoch: 5 cost time: 2.036996364593506
Epoch: 5, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.659 Vali Acc: 0.722 Test Loss: 0.659 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 1.6606802940368652
Epoch: 6, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.551 Vali Acc: 0.778 Test Loss: 0.551 Test Acc: 0.778
Validation loss decreased (-0.722216 --> -0.777772).  Saving model ...
Epoch: 7 cost time: 2.289484977722168
Epoch: 7, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.489 Vali Acc: 0.772 Test Loss: 0.489 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0459353923797607
Epoch: 8, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.501 Vali Acc: 0.744 Test Loss: 0.501 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1642906665802
Epoch: 9, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
Validation loss decreased (-0.777772 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 2.3696837425231934
Epoch: 10, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 1.9588818550109863
Epoch: 11, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.339 Vali Acc: 0.883 Test Loss: 0.339 Test Acc: 0.883
Validation loss decreased (-0.833330 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 2.005197286605835
Epoch: 12, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.331 Vali Acc: 0.872 Test Loss: 0.331 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.123171806335449
Epoch: 13, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4198405742645264
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.506944417953491
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1505069732666016
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0191664695739746
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9737417697906494
Epoch: 18, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.329 Vali Acc: 0.872 Test Loss: 0.329 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.392136812210083
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3012380599975586
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.409 Vali Acc: 0.861 Test Loss: 0.409 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3284218311309814
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 2.235987424850464
Epoch: 22, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.450117349624634
Epoch: 23, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9632360935211182
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2823872566223145
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.326 Vali Acc: 0.867 Test Loss: 0.326 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.130396604537964
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.579169273376465
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.409 Vali Acc: 0.878 Test Loss: 0.409 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.6227498054504395
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.394 Vali Acc: 0.878 Test Loss: 0.394 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.663328170776367
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7443158626556396
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.532 Vali Acc: 0.883 Test Loss: 0.532 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9700884819030762
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2156726
model size : 10.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.320425748825073
Epoch: 1, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.668 Vali Acc: 0.383 Test Loss: 1.668 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 1.9678075313568115
Epoch: 2, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.392 Vali Acc: 0.578 Test Loss: 1.392 Test Acc: 0.578
Validation loss decreased (-0.383317 --> -0.577764).  Saving model ...
Epoch: 3 cost time: 2.3514492511749268
Epoch: 3, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.063 Vali Acc: 0.606 Test Loss: 1.063 Test Acc: 0.606
Validation loss decreased (-0.577764 --> -0.605545).  Saving model ...
Epoch: 4 cost time: 2.091979503631592
Epoch: 4, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.801 Vali Acc: 0.700 Test Loss: 0.801 Test Acc: 0.700
Validation loss decreased (-0.605545 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 2.2445428371429443
Epoch: 5, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.723 Vali Acc: 0.672 Test Loss: 0.723 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9865913391113281
Epoch: 6, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.552 Vali Acc: 0.750 Test Loss: 0.552 Test Acc: 0.750
Validation loss decreased (-0.699992 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.877636194229126
Epoch: 7, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 8 cost time: 2.1801869869232178
Epoch: 8, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.487 Vali Acc: 0.756 Test Loss: 0.487 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4164583683013916
Epoch: 9, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.426 Vali Acc: 0.794 Test Loss: 0.426 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 10 cost time: 1.997194766998291
Epoch: 10, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.117799758911133
Epoch: 11, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.502 Vali Acc: 0.800 Test Loss: 0.502 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 2.354804039001465
Epoch: 12, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.442 Vali Acc: 0.822 Test Loss: 0.442 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 2.4257681369781494
Epoch: 13, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.468 Vali Acc: 0.800 Test Loss: 0.468 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9027354717254639
Epoch: 14, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.415 Vali Acc: 0.828 Test Loss: 0.415 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.8889968395233154
Epoch: 15, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.484 Vali Acc: 0.806 Test Loss: 0.484 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.018690347671509
Epoch: 16, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
Validation loss decreased (-0.827774 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 1.897989273071289
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.418 Vali Acc: 0.822 Test Loss: 0.418 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9218006134033203
Epoch: 18, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.767225742340088
Epoch: 19, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8954405784606934
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.414 Vali Acc: 0.844 Test Loss: 0.414 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7731833457946777
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2989296913146973
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.173107624053955
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.756 Vali Acc: 0.767 Test Loss: 0.756 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.1853713989257812
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.489 Vali Acc: 0.861 Test Loss: 0.489 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2693166732788086
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.403 Vali Acc: 0.867 Test Loss: 0.403 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.445850133895874
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.411 Vali Acc: 0.856 Test Loss: 0.411 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2155446
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.615547180175781
Epoch: 1, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.713 Vali Acc: 0.239 Test Loss: 1.713 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 2.0022354125976562
Epoch: 2, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.441 Vali Acc: 0.583 Test Loss: 1.441 Test Acc: 0.583
Validation loss decreased (-0.238872 --> -0.583319).  Saving model ...
Epoch: 3 cost time: 2.2254886627197266
Epoch: 3, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.110 Vali Acc: 0.506 Test Loss: 1.110 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.380343437194824
Epoch: 4, Steps: 12 | Train Loss: 0.906 Vali Loss: 0.800 Vali Acc: 0.711 Test Loss: 0.800 Test Acc: 0.711
Validation loss decreased (-0.583319 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 2.2747764587402344
Epoch: 5, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.656 Vali Acc: 0.733 Test Loss: 0.656 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 2.269193172454834
Epoch: 6, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.568 Vali Acc: 0.728 Test Loss: 0.568 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4808292388916016
Epoch: 7, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.451 Vali Acc: 0.789 Test Loss: 0.451 Test Acc: 0.789
Validation loss decreased (-0.733327 --> -0.788884).  Saving model ...
Epoch: 8 cost time: 2.014268636703491
Epoch: 8, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.491 Vali Acc: 0.767 Test Loss: 0.491 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8255622386932373
Epoch: 9, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.473 Vali Acc: 0.783 Test Loss: 0.473 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2677929401397705
Epoch: 10, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 2.035537004470825
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.8680222034454346
Epoch: 12, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.321 Vali Acc: 0.883 Test Loss: 0.321 Test Acc: 0.883
Validation loss decreased (-0.833330 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 2.265352487564087
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.440 Vali Acc: 0.833 Test Loss: 0.440 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8674778938293457
Epoch: 14, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.22298002243042
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.232517719268799
Epoch: 16, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2260727882385254
Epoch: 17, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.349 Vali Acc: 0.856 Test Loss: 0.349 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.148977518081665
Epoch: 18, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.088059902191162
Epoch: 19, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.587 Vali Acc: 0.833 Test Loss: 0.587 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.244296073913574
Epoch: 20, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.434 Vali Acc: 0.861 Test Loss: 0.434 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.040628671646118
Epoch: 21, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 2.517517566680908
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 2.2578070163726807
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.409 Vali Acc: 0.878 Test Loss: 0.409 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.508363962173462
Epoch: 24, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1292202472686768
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9573328495025635
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.398 Vali Acc: 0.883 Test Loss: 0.398 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8284742832183838
Epoch: 27, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 2.1580517292022705
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.472475290298462
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3728370666503906
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.1729774475097656
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.375 Vali Acc: 0.867 Test Loss: 0.375 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8479113578796387
Epoch: 32, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.365 Vali Acc: 0.867 Test Loss: 0.365 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.2209184169769287
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.943633794784546
Epoch: 34, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.9610493183135986
Epoch: 35, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.8294737339019775
Epoch: 36, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.2162153720855713
Epoch: 37, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2154166
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6550676822662354
Epoch: 1, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.809 Vali Acc: 0.167 Test Loss: 1.809 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 2.2171287536621094
Epoch: 2, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.516 Vali Acc: 0.456 Test Loss: 1.516 Test Acc: 0.456
Validation loss decreased (-0.166649 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 1.8655519485473633
Epoch: 3, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.312 Vali Acc: 0.406 Test Loss: 1.312 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7011752128601074
Epoch: 4, Steps: 12 | Train Loss: 1.139 Vali Loss: 0.867 Vali Acc: 0.622 Test Loss: 0.867 Test Acc: 0.622
Validation loss decreased (-0.455540 --> -0.622214).  Saving model ...
Epoch: 5 cost time: 1.7697656154632568
Epoch: 5, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.710 Vali Acc: 0.689 Test Loss: 0.710 Test Acc: 0.689
Validation loss decreased (-0.622214 --> -0.688882).  Saving model ...
Epoch: 6 cost time: 1.9397814273834229
Epoch: 6, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.614 Vali Acc: 0.706 Test Loss: 0.614 Test Acc: 0.706
Validation loss decreased (-0.688882 --> -0.705549).  Saving model ...
Epoch: 7 cost time: 2.3772172927856445
Epoch: 7, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.452 Vali Acc: 0.794 Test Loss: 0.452 Test Acc: 0.794
Validation loss decreased (-0.705549 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.0657479763031006
Epoch: 8, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.401 Vali Acc: 0.811 Test Loss: 0.401 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 2.140613079071045
Epoch: 9, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.386 Vali Acc: 0.828 Test Loss: 0.386 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 2.045135974884033
Epoch: 10, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.797377586364746
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 2.1467578411102295
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.457 Vali Acc: 0.817 Test Loss: 0.457 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.924814224243164
Epoch: 13, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.442 Vali Acc: 0.811 Test Loss: 0.442 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.36538028717041
Epoch: 14, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 1.682436466217041
Epoch: 15, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.8657259941101074
Epoch: 16, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 2.3612756729125977
Epoch: 17, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6333746910095215
Epoch: 18, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.365 Vali Acc: 0.872 Test Loss: 0.365 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 1.9133894443511963
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.388 Vali Acc: 0.878 Test Loss: 0.388 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 2.7477059364318848
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.284745931625366
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 2.0100834369659424
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2093257904052734
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2810332775115967
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.6623730659484863
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.379 Vali Acc: 0.883 Test Loss: 0.379 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 26 cost time: 1.9858055114746094
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.441 Vali Acc: 0.861 Test Loss: 0.441 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2951769828796387
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 2.2566542625427246
Epoch: 28, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.444 Vali Acc: 0.872 Test Loss: 0.444 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.323349952697754
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.166412115097046
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.915328025817871
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.1621036529541016
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.437 Vali Acc: 0.861 Test Loss: 0.437 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.9465320110321045
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.0642709732055664
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.728456735610962
Epoch: 35, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.098496437072754
Epoch: 36, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.493 Vali Acc: 0.883 Test Loss: 0.493 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.323085069656372
Epoch: 37, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.424 Vali Acc: 0.878 Test Loss: 0.424 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2152886
model size : 10.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.252302885055542
Epoch: 1, Steps: 12 | Train Loss: 1.850 Vali Loss: 1.806 Vali Acc: 0.167 Test Loss: 1.806 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 2.0151524543762207
Epoch: 2, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.586 Vali Acc: 0.450 Test Loss: 1.586 Test Acc: 0.450
Validation loss decreased (-0.166649 --> -0.449984).  Saving model ...
Epoch: 3 cost time: 1.8403568267822266
Epoch: 3, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.332 Vali Acc: 0.544 Test Loss: 1.332 Test Acc: 0.544
Validation loss decreased (-0.449984 --> -0.544431).  Saving model ...
Epoch: 4 cost time: 1.9959757328033447
Epoch: 4, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
Validation loss decreased (-0.544431 --> -0.649990).  Saving model ...
Epoch: 5 cost time: 1.8574323654174805
Epoch: 5, Steps: 12 | Train Loss: 0.999 Vali Loss: 0.859 Vali Acc: 0.644 Test Loss: 0.859 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2563893795013428
Epoch: 6, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.779 Vali Acc: 0.728 Test Loss: 0.779 Test Acc: 0.728
Validation loss decreased (-0.649990 --> -0.727770).  Saving model ...
Epoch: 7 cost time: 2.0527830123901367
Epoch: 7, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.617 Vali Acc: 0.756 Test Loss: 0.617 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755549).  Saving model ...
Epoch: 8 cost time: 2.053511142730713
Epoch: 8, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.460 Vali Acc: 0.789 Test Loss: 0.460 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 2.414512872695923
Epoch: 9, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.386 Vali Acc: 0.844 Test Loss: 0.386 Test Acc: 0.844
Validation loss decreased (-0.788884 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 2.595057725906372
Epoch: 10, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.379 Vali Acc: 0.794 Test Loss: 0.379 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9982047080993652
Epoch: 11, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.425 Vali Acc: 0.794 Test Loss: 0.425 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2883899211883545
Epoch: 12, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.383 Vali Acc: 0.817 Test Loss: 0.383 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5504467487335205
Epoch: 13, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1668403148651123
Epoch: 14, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.330 Vali Acc: 0.844 Test Loss: 0.330 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 2.3874380588531494
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 2.7960591316223145
Epoch: 16, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.070617914199829
Epoch: 17, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.340 Vali Acc: 0.833 Test Loss: 0.340 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0342891216278076
Epoch: 18, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.20198130607605
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.298729419708252
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 2.0011589527130127
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.399 Vali Acc: 0.828 Test Loss: 0.399 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7833824157714844
Epoch: 22, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.396 Vali Acc: 0.839 Test Loss: 0.396 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.459003210067749
Epoch: 23, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.355 Vali Acc: 0.856 Test Loss: 0.355 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 1.9264559745788574
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7025330066680908
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 26 cost time: 1.8885953426361084
Epoch: 26, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.365 Vali Acc: 0.817 Test Loss: 0.365 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3949825763702393
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.411 Vali Acc: 0.844 Test Loss: 0.411 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.198124408721924
Epoch: 28, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1621768474578857
Epoch: 29, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.306043863296509
Epoch: 30, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9673256874084473
Epoch: 31, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1196935176849365
Epoch: 32, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.443 Vali Acc: 0.839 Test Loss: 0.443 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.554403066635132
Epoch: 33, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.629085063934326
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.488 Vali Acc: 0.817 Test Loss: 0.488 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8491742610931396
Epoch: 35, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.346 Vali Acc: 0.861 Test Loss: 0.346 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 36 cost time: 2.0740091800689697
Epoch: 36, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.407 Vali Acc: 0.844 Test Loss: 0.407 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.3198540210723877
Epoch: 37, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.014287233352661
Epoch: 38, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.416 Vali Acc: 0.856 Test Loss: 0.416 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.488623857498169
Epoch: 39, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888885).  Saving model ...
Epoch: 40 cost time: 2.172053337097168
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.549 Vali Acc: 0.839 Test Loss: 0.549 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9718263149261475
Epoch: 41, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.396 Vali Acc: 0.878 Test Loss: 0.396 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.2973556518554688
Epoch: 42, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.426 Vali Acc: 0.867 Test Loss: 0.426 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.1424639225006104
Epoch: 43, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.406 Vali Acc: 0.867 Test Loss: 0.406 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.0592541694641113
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.3697540760040283
Epoch: 45, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.9850342273712158
Epoch: 46, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.0692298412323
Epoch: 47, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.1094353199005127
Epoch: 48, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.460 Vali Acc: 0.839 Test Loss: 0.460 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.4461958408355713
Epoch: 49, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1429174
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.193551301956177
Epoch: 1, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.723 Vali Acc: 0.256 Test Loss: 1.723 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 1.972702980041504
Epoch: 2, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.546 Vali Acc: 0.422 Test Loss: 1.546 Test Acc: 0.422
Validation loss decreased (-0.255538 --> -0.422207).  Saving model ...
Epoch: 3 cost time: 2.3757824897766113
Epoch: 3, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.299 Vali Acc: 0.644 Test Loss: 1.299 Test Acc: 0.644
Validation loss decreased (-0.422207 --> -0.644431).  Saving model ...
Epoch: 4 cost time: 1.9678053855895996
Epoch: 4, Steps: 12 | Train Loss: 1.207 Vali Loss: 0.981 Vali Acc: 0.622 Test Loss: 0.981 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.193981647491455
Epoch: 5, Steps: 12 | Train Loss: 0.913 Vali Loss: 0.748 Vali Acc: 0.728 Test Loss: 0.748 Test Acc: 0.728
Validation loss decreased (-0.644431 --> -0.727770).  Saving model ...
Epoch: 6 cost time: 2.220445156097412
Epoch: 6, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.716 Vali Acc: 0.694 Test Loss: 0.716 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2071292400360107
Epoch: 7, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.535 Vali Acc: 0.756 Test Loss: 0.535 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755550).  Saving model ...
Epoch: 8 cost time: 1.8015177249908447
Epoch: 8, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.517 Vali Acc: 0.778 Test Loss: 0.517 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.740563154220581
Epoch: 9, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.477 Vali Acc: 0.772 Test Loss: 0.477 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6732873916625977
Epoch: 10, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.460 Vali Acc: 0.794 Test Loss: 0.460 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.7142722606658936
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.384 Vali Acc: 0.800 Test Loss: 0.384 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 1.7737221717834473
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.423 Vali Acc: 0.811 Test Loss: 0.423 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 2.1103572845458984
Epoch: 13, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.382 Vali Acc: 0.833 Test Loss: 0.382 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 1.9315621852874756
Epoch: 14, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.392 Vali Acc: 0.817 Test Loss: 0.392 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9487767219543457
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.852834939956665
Epoch: 16, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9088859558105469
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.976578712463379
Epoch: 18, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.337 Vali Acc: 0.811 Test Loss: 0.337 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9752357006072998
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 20 cost time: 2.538515329360962
Epoch: 20, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.91276216506958
Epoch: 21, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.403 Vali Acc: 0.839 Test Loss: 0.403 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9700431823730469
Epoch: 22, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7624144554138184
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.354 Vali Acc: 0.844 Test Loss: 0.354 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8116238117218018
Epoch: 24, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 25 cost time: 1.9222090244293213
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.355 Vali Acc: 0.867 Test Loss: 0.355 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 26 cost time: 1.7358288764953613
Epoch: 26, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 27 cost time: 1.948754072189331
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7877836227416992
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1052920818328857
Epoch: 29, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.457982301712036
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.0609729290008545
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888885).  Saving model ...
Epoch: 32 cost time: 1.9079298973083496
Epoch: 32, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.328 Vali Acc: 0.867 Test Loss: 0.328 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9955823421478271
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7929892539978027
Epoch: 34, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.920468807220459
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.388 Vali Acc: 0.878 Test Loss: 0.388 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.057128429412842
Epoch: 36, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.463 Vali Acc: 0.817 Test Loss: 0.463 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.371880531311035
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.226336717605591
Epoch: 38, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.448329210281372
Epoch: 39, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.416 Vali Acc: 0.867 Test Loss: 0.416 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.3246734142303467
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.388 Vali Acc: 0.867 Test Loss: 0.388 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.5978682041168213
Epoch: 41, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.347 Vali Acc: 0.878 Test Loss: 0.347 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1428534
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.428610563278198
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.728 Vali Acc: 0.283 Test Loss: 1.728 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 1.9612934589385986
Epoch: 2, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.440 Vali Acc: 0.572 Test Loss: 1.440 Test Acc: 0.572
Validation loss decreased (-0.283316 --> -0.572208).  Saving model ...
Epoch: 3 cost time: 1.6063344478607178
Epoch: 3, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.100 Vali Acc: 0.706 Test Loss: 1.100 Test Acc: 0.706
Validation loss decreased (-0.572208 --> -0.705545).  Saving model ...
Epoch: 4 cost time: 2.0706005096435547
Epoch: 4, Steps: 12 | Train Loss: 1.001 Vali Loss: 0.849 Vali Acc: 0.683 Test Loss: 0.849 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.063044786453247
Epoch: 5, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.707 Vali Acc: 0.694 Test Loss: 0.707 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.81449556350708
Epoch: 6, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.636 Vali Acc: 0.706 Test Loss: 0.636 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705549).  Saving model ...
Epoch: 7 cost time: 1.956416368484497
Epoch: 7, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.518 Vali Acc: 0.767 Test Loss: 0.518 Test Acc: 0.767
Validation loss decreased (-0.705549 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.9540119171142578
Epoch: 8, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.461 Vali Acc: 0.811 Test Loss: 0.461 Test Acc: 0.811
Validation loss decreased (-0.766661 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 1.9630403518676758
Epoch: 9, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.457 Vali Acc: 0.811 Test Loss: 0.457 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 2.0244064331054688
Epoch: 10, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 2.21321964263916
Epoch: 11, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.418 Vali Acc: 0.778 Test Loss: 0.418 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.803528070449829
Epoch: 12, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.455 Vali Acc: 0.817 Test Loss: 0.455 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.084939479827881
Epoch: 13, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9693524837493896
Epoch: 14, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.371 Vali Acc: 0.839 Test Loss: 0.371 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 1.7825798988342285
Epoch: 15, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.051914691925049
Epoch: 16, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.433 Vali Acc: 0.806 Test Loss: 0.433 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.966245412826538
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.434 Vali Acc: 0.828 Test Loss: 0.434 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2674474716186523
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.471 Vali Acc: 0.794 Test Loss: 0.471 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9856815338134766
Epoch: 19, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.029954671859741
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2120425701141357
Epoch: 21, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.818448781967163
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.147616147994995
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.427 Vali Acc: 0.822 Test Loss: 0.427 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9756205081939697
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 25 cost time: 2.093841552734375
Epoch: 25, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.362 Vali Acc: 0.856 Test Loss: 0.362 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 1.826490879058838
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0530848503112793
Epoch: 27, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.524 Vali Acc: 0.811 Test Loss: 0.524 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.3259875774383545
Epoch: 28, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.466 Vali Acc: 0.861 Test Loss: 0.466 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 1.9771013259887695
Epoch: 29, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7770800590515137
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.408247470855713
Epoch: 31, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.483 Vali Acc: 0.856 Test Loss: 0.483 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.763946771621704
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8574483394622803
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.423 Vali Acc: 0.856 Test Loss: 0.423 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.8592643737792969
Epoch: 34, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.0494086742401123
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.409 Vali Acc: 0.839 Test Loss: 0.409 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.959991455078125
Epoch: 36, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.429 Vali Acc: 0.856 Test Loss: 0.429 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.6829004287719727
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.423 Vali Acc: 0.839 Test Loss: 0.423 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.1495096683502197
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.418 Vali Acc: 0.833 Test Loss: 0.418 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1427894
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.54546594619751
Epoch: 1, Steps: 12 | Train Loss: 1.939 Vali Loss: 1.778 Vali Acc: 0.200 Test Loss: 1.778 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 2.075894594192505
Epoch: 2, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.589 Vali Acc: 0.339 Test Loss: 1.589 Test Acc: 0.339
Validation loss decreased (-0.199982 --> -0.338873).  Saving model ...
Epoch: 3 cost time: 1.8585360050201416
Epoch: 3, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.348 Vali Acc: 0.556 Test Loss: 1.348 Test Acc: 0.556
Validation loss decreased (-0.338873 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 1.6215436458587646
Epoch: 4, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.010 Vali Acc: 0.650 Test Loss: 1.010 Test Acc: 0.650
Validation loss decreased (-0.555542 --> -0.649990).  Saving model ...
Epoch: 5 cost time: 1.6252553462982178
Epoch: 5, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.021 Vali Acc: 0.583 Test Loss: 1.021 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9841105937957764
Epoch: 6, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.800 Vali Acc: 0.706 Test Loss: 0.800 Test Acc: 0.706
Validation loss decreased (-0.649990 --> -0.705548).  Saving model ...
Epoch: 7 cost time: 1.7884058952331543
Epoch: 7, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.635 Vali Acc: 0.733 Test Loss: 0.635 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733327).  Saving model ...
Epoch: 8 cost time: 1.946120262145996
Epoch: 8, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.509 Vali Acc: 0.750 Test Loss: 0.509 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749995).  Saving model ...
Epoch: 9 cost time: 1.8568575382232666
Epoch: 9, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.494 Vali Acc: 0.800 Test Loss: 0.494 Test Acc: 0.800
Validation loss decreased (-0.749995 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 2.163492441177368
Epoch: 10, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.507 Vali Acc: 0.761 Test Loss: 0.507 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1324069499969482
Epoch: 11, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.402 Vali Acc: 0.811 Test Loss: 0.402 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 2.1046221256256104
Epoch: 12, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.447 Vali Acc: 0.811 Test Loss: 0.447 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8364744186401367
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.425 Vali Acc: 0.789 Test Loss: 0.425 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2036330699920654
Epoch: 14, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.434 Vali Acc: 0.822 Test Loss: 0.434 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 1.8859467506408691
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.383 Vali Acc: 0.806 Test Loss: 0.383 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.810605525970459
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.405 Vali Acc: 0.811 Test Loss: 0.405 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0770466327667236
Epoch: 17, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.107445478439331
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.421 Vali Acc: 0.817 Test Loss: 0.421 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9499952793121338
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9244396686553955
Epoch: 20, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.445 Vali Acc: 0.811 Test Loss: 0.445 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0215001106262207
Epoch: 21, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 1.8367395401000977
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.428 Vali Acc: 0.800 Test Loss: 0.428 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2563695907592773
Epoch: 23, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.345 Vali Acc: 0.828 Test Loss: 0.345 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.673795461654663
Epoch: 24, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.9525620937347412
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3193399906158447
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.422 Vali Acc: 0.817 Test Loss: 0.422 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0141875743865967
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.467 Vali Acc: 0.811 Test Loss: 0.467 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8209924697875977
Epoch: 28, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 29 cost time: 2.199622631072998
Epoch: 29, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8317582607269287
Epoch: 30, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.441 Vali Acc: 0.828 Test Loss: 0.441 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.980496883392334
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.820652961730957
Epoch: 32, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.015758991241455
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.0848031044006348
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.418 Vali Acc: 0.839 Test Loss: 0.418 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.3957414627075195
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.8682599067687988
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.427 Vali Acc: 0.839 Test Loss: 0.427 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.722719669342041
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.7232913970947266
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 1427254
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.903088331222534
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.702 Vali Acc: 0.294 Test Loss: 1.702 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 1.5755796432495117
Epoch: 2, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.538 Vali Acc: 0.533 Test Loss: 1.538 Test Acc: 0.533
Validation loss decreased (-0.294427 --> -0.533318).  Saving model ...
Epoch: 3 cost time: 1.8351695537567139
Epoch: 3, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.277 Vali Acc: 0.633 Test Loss: 1.277 Test Acc: 0.633
Validation loss decreased (-0.533318 --> -0.633321).  Saving model ...
Epoch: 4 cost time: 1.998833417892456
Epoch: 4, Steps: 12 | Train Loss: 1.172 Vali Loss: 0.996 Vali Acc: 0.667 Test Loss: 0.996 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 1.8537769317626953
Epoch: 5, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.751 Vali Acc: 0.728 Test Loss: 0.751 Test Acc: 0.728
Validation loss decreased (-0.666657 --> -0.727770).  Saving model ...
Epoch: 6 cost time: 1.7784147262573242
Epoch: 6, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7170488834381104
Epoch: 7, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.560 Vali Acc: 0.767 Test Loss: 0.560 Test Acc: 0.767
Validation loss decreased (-0.727770 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.88755464553833
Epoch: 8, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.6649014949798584
Epoch: 9, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.487 Vali Acc: 0.778 Test Loss: 0.487 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9903650283813477
Epoch: 10, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
Validation loss decreased (-0.783328 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 2.0519466400146484
Epoch: 11, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.450 Vali Acc: 0.811 Test Loss: 0.450 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7327229976654053
Epoch: 12, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.406 Vali Acc: 0.833 Test Loss: 0.406 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 1.9485478401184082
Epoch: 13, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.389 Vali Acc: 0.828 Test Loss: 0.389 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0764501094818115
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.292773485183716
Epoch: 15, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.554 Vali Acc: 0.811 Test Loss: 0.554 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9764282703399658
Epoch: 16, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.402 Vali Acc: 0.844 Test Loss: 0.402 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 17 cost time: 2.2255849838256836
Epoch: 17, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 1.737473964691162
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.502 Vali Acc: 0.828 Test Loss: 0.502 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7290279865264893
Epoch: 19, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.425 Vali Acc: 0.844 Test Loss: 0.425 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.94486403465271
Epoch: 20, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
Validation loss decreased (-0.849996 --> -0.877774).  Saving model ...
Epoch: 21 cost time: 2.072092056274414
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9390265941619873
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.969559669494629
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7497527599334717
Epoch: 24, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9518399238586426
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0436270236968994
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2477869987487793
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.3600621223449707
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 1.9214301109313965
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8329944610595703
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.126013994216919
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.377 Vali Acc: 0.856 Test Loss: 0.377 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0118231773376465
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.9595801830291748
Epoch: 33, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.450 Vali Acc: 0.883 Test Loss: 0.450 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.132495403289795
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.377 Vali Acc: 0.883 Test Loss: 0.377 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.1711134910583496
Epoch: 35, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.7383809089660645
Epoch: 36, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.380 Vali Acc: 0.872 Test Loss: 0.380 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.6735754013061523
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.386 Vali Acc: 0.844 Test Loss: 0.386 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.7151820659637451
Epoch: 38, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.378 Vali Acc: 0.872 Test Loss: 0.378 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 966838
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.729120492935181
Epoch: 1, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.722 Vali Acc: 0.283 Test Loss: 1.722 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 2.3076164722442627
Epoch: 2, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.542 Vali Acc: 0.456 Test Loss: 1.542 Test Acc: 0.456
Validation loss decreased (-0.283316 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 2.2335901260375977
Epoch: 3, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.267 Vali Acc: 0.672 Test Loss: 1.267 Test Acc: 0.672
Validation loss decreased (-0.455540 --> -0.672210).  Saving model ...
Epoch: 4 cost time: 2.392055034637451
Epoch: 4, Steps: 12 | Train Loss: 1.184 Vali Loss: 0.978 Vali Acc: 0.661 Test Loss: 0.978 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6306960582733154
Epoch: 5, Steps: 12 | Train Loss: 0.881 Vali Loss: 0.756 Vali Acc: 0.706 Test Loss: 0.756 Test Acc: 0.706
Validation loss decreased (-0.672210 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 2.262979745864868
Epoch: 6, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.658 Vali Acc: 0.739 Test Loss: 0.658 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738882).  Saving model ...
Epoch: 7 cost time: 2.829362154006958
Epoch: 7, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.599 Vali Acc: 0.728 Test Loss: 0.599 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.243675470352173
Epoch: 8, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.533 Vali Acc: 0.767 Test Loss: 0.533 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766661).  Saving model ...
Epoch: 9 cost time: 1.8061180114746094
Epoch: 9, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.472 Vali Acc: 0.794 Test Loss: 0.472 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794440).  Saving model ...
Epoch: 10 cost time: 2.3445448875427246
Epoch: 10, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.432 Vali Acc: 0.806 Test Loss: 0.432 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.9875614643096924
Epoch: 11, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.461 Vali Acc: 0.800 Test Loss: 0.461 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.248804807662964
Epoch: 12, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.532 Vali Acc: 0.806 Test Loss: 0.532 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.323031425476074
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.385 Vali Acc: 0.817 Test Loss: 0.385 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 14 cost time: 2.1056647300720215
Epoch: 14, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.389 Vali Acc: 0.811 Test Loss: 0.389 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1014199256896973
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 1.965766191482544
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 17 cost time: 2.3974931240081787
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.969677448272705
Epoch: 18, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.855928897857666
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.449 Vali Acc: 0.844 Test Loss: 0.449 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0694448947906494
Epoch: 20, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.451 Vali Acc: 0.828 Test Loss: 0.451 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.523465633392334
Epoch: 21, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.404 Vali Acc: 0.844 Test Loss: 0.404 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5455875396728516
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.382 Vali Acc: 0.839 Test Loss: 0.382 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8654541969299316
Epoch: 23, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.370 Vali Acc: 0.856 Test Loss: 0.370 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 2.1928911209106445
Epoch: 24, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.396 Vali Acc: 0.839 Test Loss: 0.396 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8372516632080078
Epoch: 25, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.407 Vali Acc: 0.856 Test Loss: 0.407 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7225539684295654
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.409 Vali Acc: 0.844 Test Loss: 0.409 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3170523643493652
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 28 cost time: 1.7530572414398193
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7763445377349854
Epoch: 29, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.582 Vali Acc: 0.811 Test Loss: 0.582 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7917351722717285
Epoch: 30, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.1517693996429443
Epoch: 31, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.415 Vali Acc: 0.867 Test Loss: 0.415 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 32 cost time: 2.1724584102630615
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.128453016281128
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888885).  Saving model ...
Epoch: 34 cost time: 1.8915977478027344
Epoch: 34, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.389 Vali Acc: 0.878 Test Loss: 0.389 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0339086055755615
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.9290401935577393
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.408 Vali Acc: 0.878 Test Loss: 0.408 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.9481010437011719
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.40639591217041
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.126544713973999
Epoch: 39, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.031151294708252
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.436 Vali Acc: 0.867 Test Loss: 0.436 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.4168388843536377
Epoch: 41, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.373 Vali Acc: 0.872 Test Loss: 0.373 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.233856439590454
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.371 Vali Acc: 0.878 Test Loss: 0.371 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.1377501487731934
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 966198
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.3236167430877686
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.715 Vali Acc: 0.256 Test Loss: 1.715 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 2.277144193649292
Epoch: 2, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.526 Vali Acc: 0.439 Test Loss: 1.526 Test Acc: 0.439
Validation loss decreased (-0.255538 --> -0.438874).  Saving model ...
Epoch: 3 cost time: 2.53222393989563
Epoch: 3, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.297 Vali Acc: 0.600 Test Loss: 1.297 Test Acc: 0.600
Validation loss decreased (-0.438874 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 2.1865170001983643
Epoch: 4, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.034 Vali Acc: 0.644 Test Loss: 1.034 Test Acc: 0.644
Validation loss decreased (-0.599987 --> -0.644434).  Saving model ...
Epoch: 5 cost time: 1.7723395824432373
Epoch: 5, Steps: 12 | Train Loss: 0.923 Vali Loss: 0.870 Vali Acc: 0.683 Test Loss: 0.870 Test Acc: 0.683
Validation loss decreased (-0.644434 --> -0.683325).  Saving model ...
Epoch: 6 cost time: 1.836486577987671
Epoch: 6, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
Validation loss decreased (-0.683325 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 2.4950814247131348
Epoch: 7, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.623 Vali Acc: 0.728 Test Loss: 0.623 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4019722938537598
Epoch: 8, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.516 Vali Acc: 0.750 Test Loss: 0.516 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749995).  Saving model ...
Epoch: 9 cost time: 1.916450023651123
Epoch: 9, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.509 Vali Acc: 0.761 Test Loss: 0.509 Test Acc: 0.761
Validation loss decreased (-0.749995 --> -0.761106).  Saving model ...
Epoch: 10 cost time: 2.0716772079467773
Epoch: 10, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.403 Vali Acc: 0.828 Test Loss: 0.403 Test Acc: 0.828
Validation loss decreased (-0.761106 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 2.0879714488983154
Epoch: 11, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 2.001253843307495
Epoch: 12, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.360 Vali Acc: 0.828 Test Loss: 0.360 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 2.257187604904175
Epoch: 13, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 2.00947642326355
Epoch: 14, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3882076740264893
Epoch: 15, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 2.5994932651519775
Epoch: 16, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.407 Vali Acc: 0.822 Test Loss: 0.407 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.256375551223755
Epoch: 17, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.351 Vali Acc: 0.817 Test Loss: 0.351 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0932528972625732
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2661547660827637
Epoch: 19, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.375 Vali Acc: 0.867 Test Loss: 0.375 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 20 cost time: 2.425588369369507
Epoch: 20, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.319 Vali Acc: 0.844 Test Loss: 0.319 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0230298042297363
Epoch: 21, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.364 Vali Acc: 0.878 Test Loss: 0.364 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 22 cost time: 2.715240240097046
Epoch: 22, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9796106815338135
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.792555332183838
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.391801357269287
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.459 Vali Acc: 0.861 Test Loss: 0.459 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.3963897228240967
Epoch: 26, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.433 Vali Acc: 0.817 Test Loss: 0.433 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.095527172088623
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7494761943817139
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.409 Vali Acc: 0.867 Test Loss: 0.409 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.3000519275665283
Epoch: 29, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.3188865184783936
Epoch: 30, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.349 Vali Acc: 0.883 Test Loss: 0.349 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 31 cost time: 2.113372325897217
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.543123960494995
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.434 Vali Acc: 0.878 Test Loss: 0.434 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.160670757293701
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.386 Vali Acc: 0.856 Test Loss: 0.386 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0698354244232178
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.139193296432495
Epoch: 35, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.505 Vali Acc: 0.839 Test Loss: 0.505 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.6858255863189697
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.437 Vali Acc: 0.856 Test Loss: 0.437 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.1177875995635986
Epoch: 37, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.4371092319488525
Epoch: 38, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 39 cost time: 3.365945339202881
Epoch: 39, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9380731582641602
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.403 Vali Acc: 0.894 Test Loss: 0.403 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 41 cost time: 1.9768633842468262
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.8747706413269043
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.348 Vali Acc: 0.894 Test Loss: 0.348 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894441).  Saving model ...
Epoch: 43 cost time: 2.2731149196624756
Epoch: 43, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 2.1086885929107666
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.485243082046509
Epoch: 45, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.463 Vali Acc: 0.867 Test Loss: 0.463 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.2257347106933594
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.431 Vali Acc: 0.872 Test Loss: 0.431 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.4799463748931885
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.3582606315612793
Epoch: 48, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.5515024662017822
Epoch: 49, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.416 Vali Acc: 0.878 Test Loss: 0.416 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.004354953765869
Epoch: 50, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.789794921875
Epoch: 51, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.7204062938690186
Epoch: 52, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.8611421585083008
Epoch: 53, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 965558
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.604936122894287
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.714 Vali Acc: 0.278 Test Loss: 1.714 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 2.4239063262939453
Epoch: 2, Steps: 12 | Train Loss: 1.697 Vali Loss: 1.529 Vali Acc: 0.539 Test Loss: 1.529 Test Acc: 0.539
Validation loss decreased (-0.277761 --> -0.538874).  Saving model ...
Epoch: 3 cost time: 1.8917014598846436
Epoch: 3, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.305 Vali Acc: 0.528 Test Loss: 1.305 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1013238430023193
Epoch: 4, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.048 Vali Acc: 0.644 Test Loss: 1.048 Test Acc: 0.644
Validation loss decreased (-0.538874 --> -0.644434).  Saving model ...
Epoch: 5 cost time: 1.88299560546875
Epoch: 5, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.828 Vali Acc: 0.667 Test Loss: 0.828 Test Acc: 0.667
Validation loss decreased (-0.644434 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.951395034790039
Epoch: 6, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.688 Vali Acc: 0.667 Test Loss: 0.688 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666660).  Saving model ...
Epoch: 7 cost time: 2.431867837905884
Epoch: 7, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.607 Vali Acc: 0.733 Test Loss: 0.607 Test Acc: 0.733
Validation loss decreased (-0.666660 --> -0.733327).  Saving model ...
Epoch: 8 cost time: 2.9345340728759766
Epoch: 8, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.498 Vali Acc: 0.778 Test Loss: 0.498 Test Acc: 0.778
Validation loss decreased (-0.733327 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 2.0903677940368652
Epoch: 9, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.433 Vali Acc: 0.789 Test Loss: 0.433 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 10 cost time: 2.0368804931640625
Epoch: 10, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.418 Vali Acc: 0.833 Test Loss: 0.418 Test Acc: 0.833
Validation loss decreased (-0.788885 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 1.8655426502227783
Epoch: 11, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5868470668792725
Epoch: 12, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.421 Vali Acc: 0.811 Test Loss: 0.421 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1166155338287354
Epoch: 13, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.390 Vali Acc: 0.828 Test Loss: 0.390 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3355705738067627
Epoch: 14, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.391 Vali Acc: 0.811 Test Loss: 0.391 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4627461433410645
Epoch: 15, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.347 Vali Acc: 0.833 Test Loss: 0.347 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 16 cost time: 2.4364566802978516
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.338 Vali Acc: 0.872 Test Loss: 0.338 Test Acc: 0.872
Validation loss decreased (-0.833330 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 2.15203857421875
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 2.486372709274292
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.410 Vali Acc: 0.844 Test Loss: 0.410 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9485218524932861
Epoch: 19, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9145147800445557
Epoch: 20, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.456585168838501
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.355 Vali Acc: 0.856 Test Loss: 0.355 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.263315439224243
Epoch: 22, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9982531070709229
Epoch: 23, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1969943046569824
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 25 cost time: 1.6229498386383057
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9608452320098877
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1746506690979004
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.078606367111206
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6840732097625732
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.421 Vali Acc: 0.872 Test Loss: 0.421 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.30138897895813
Epoch: 30, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.353 Vali Acc: 0.872 Test Loss: 0.353 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.6815595626831055
Epoch: 31, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.3599843978881836
Epoch: 32, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.360 Vali Acc: 0.872 Test Loss: 0.360 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.3737854957580566
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.561434745788574
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 964918
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9999732971191406
Epoch: 1, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.747 Vali Acc: 0.233 Test Loss: 1.747 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.67555832862854
Epoch: 2, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.571 Vali Acc: 0.556 Test Loss: 1.571 Test Acc: 0.556
Validation loss decreased (-0.233316 --> -0.555540).  Saving model ...
Epoch: 3 cost time: 2.2766993045806885
Epoch: 3, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.351 Vali Acc: 0.644 Test Loss: 1.351 Test Acc: 0.644
Validation loss decreased (-0.555540 --> -0.644431).  Saving model ...
Epoch: 4 cost time: 1.825019121170044
Epoch: 4, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.092 Vali Acc: 0.650 Test Loss: 1.092 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 1.833925485610962
Epoch: 5, Steps: 12 | Train Loss: 1.010 Vali Loss: 0.831 Vali Acc: 0.694 Test Loss: 0.831 Test Acc: 0.694
Validation loss decreased (-0.649989 --> -0.694436).  Saving model ...
Epoch: 6 cost time: 2.297006368637085
Epoch: 6, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.719 Vali Acc: 0.728 Test Loss: 0.719 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.7771687507629395
Epoch: 7, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.592 Vali Acc: 0.739 Test Loss: 0.592 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 1.5042064189910889
Epoch: 8, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
Validation loss decreased (-0.738883 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.6866905689239502
Epoch: 9, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.500 Vali Acc: 0.756 Test Loss: 0.500 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2138593196868896
Epoch: 10, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.458 Vali Acc: 0.778 Test Loss: 0.458 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0880556106567383
Epoch: 11, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.516 Vali Acc: 0.778 Test Loss: 0.516 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8883676528930664
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.395 Vali Acc: 0.839 Test Loss: 0.395 Test Acc: 0.839
Validation loss decreased (-0.783328 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 1.7840213775634766
Epoch: 13, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.350 Vali Acc: 0.794 Test Loss: 0.350 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6701030731201172
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.6895561218261719
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1042585372924805
Epoch: 16, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9262793064117432
Epoch: 17, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.92634916305542
Epoch: 18, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.344 Vali Acc: 0.850 Test Loss: 0.344 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8636016845703125
Epoch: 19, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.183476686477661
Epoch: 20, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.699761152267456
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.406 Vali Acc: 0.828 Test Loss: 0.406 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9684014320373535
Epoch: 22, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.436 Vali Acc: 0.817 Test Loss: 0.436 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2204437255859375
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.336 Vali Acc: 0.822 Test Loss: 0.336 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0117099285125732
Epoch: 24, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.34384822845459
Epoch: 25, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.469 Vali Acc: 0.817 Test Loss: 0.469 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2472994327545166
Epoch: 26, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.349 Vali Acc: 0.844 Test Loss: 0.349 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8456811904907227
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.419 Vali Acc: 0.839 Test Loss: 0.419 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 735670
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.023776531219482
Epoch: 1, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.736 Vali Acc: 0.261 Test Loss: 1.736 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 3.0945212841033936
Epoch: 2, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.561 Vali Acc: 0.544 Test Loss: 1.561 Test Acc: 0.544
Validation loss decreased (-0.261094 --> -0.544429).  Saving model ...
Epoch: 3 cost time: 2.571197986602783
Epoch: 3, Steps: 12 | Train Loss: 1.495 Vali Loss: 1.314 Vali Acc: 0.672 Test Loss: 1.314 Test Acc: 0.672
Validation loss decreased (-0.544429 --> -0.672209).  Saving model ...
Epoch: 4 cost time: 2.760948657989502
Epoch: 4, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.055 Vali Acc: 0.744 Test Loss: 1.055 Test Acc: 0.744
Validation loss decreased (-0.672209 --> -0.744434).  Saving model ...
Epoch: 5 cost time: 3.3105077743530273
Epoch: 5, Steps: 12 | Train Loss: 0.960 Vali Loss: 0.884 Vali Acc: 0.661 Test Loss: 0.884 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.447930335998535
Epoch: 6, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.699 Vali Acc: 0.744 Test Loss: 0.699 Test Acc: 0.744
Validation loss decreased (-0.744434 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 2.439441442489624
Epoch: 7, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.555 Vali Acc: 0.733 Test Loss: 0.555 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.134082555770874
Epoch: 8, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.520 Vali Acc: 0.778 Test Loss: 0.520 Test Acc: 0.778
Validation loss decreased (-0.744437 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.9416475296020508
Epoch: 9, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.458 Vali Acc: 0.806 Test Loss: 0.458 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 2.1192100048065186
Epoch: 10, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.420 Vali Acc: 0.800 Test Loss: 0.420 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4495863914489746
Epoch: 11, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.1132965087890625
Epoch: 12, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2561280727386475
Epoch: 13, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1635189056396484
Epoch: 14, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.341 Vali Acc: 0.850 Test Loss: 0.341 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 1.9888324737548828
Epoch: 15, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.344 Vali Acc: 0.839 Test Loss: 0.344 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0557870864868164
Epoch: 16, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1157054901123047
Epoch: 17, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.356 Vali Acc: 0.856 Test Loss: 0.356 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 1.7588789463043213
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.359 Vali Acc: 0.844 Test Loss: 0.359 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1141960620880127
Epoch: 19, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.393 Vali Acc: 0.822 Test Loss: 0.393 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6765236854553223
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.379 Vali Acc: 0.856 Test Loss: 0.379 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9045579433441162
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 22 cost time: 1.8455708026885986
Epoch: 22, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3450803756713867
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0354225635528564
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 2.1758384704589844
Epoch: 25, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1265528202056885
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7709131240844727
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.456132173538208
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.3932671546936035
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.7841742038726807
Epoch: 30, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.366 Vali Acc: 0.872 Test Loss: 0.366 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.6498899459838867
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.663679599761963
Epoch: 32, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.4437782764434814
Epoch: 33, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.385 Vali Acc: 0.856 Test Loss: 0.385 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.235769748687744
Epoch: 34, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 735030
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.427249193191528
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.768 Vali Acc: 0.244 Test Loss: 1.768 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 2.0871658325195312
Epoch: 2, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.579 Vali Acc: 0.383 Test Loss: 1.579 Test Acc: 0.383
Validation loss decreased (-0.244427 --> -0.383318).  Saving model ...
Epoch: 3 cost time: 2.041447401046753
Epoch: 3, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.367 Vali Acc: 0.572 Test Loss: 1.367 Test Acc: 0.572
Validation loss decreased (-0.383318 --> -0.572209).  Saving model ...
Epoch: 4 cost time: 2.963595390319824
Epoch: 4, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.055 Vali Acc: 0.644 Test Loss: 1.055 Test Acc: 0.644
Validation loss decreased (-0.572209 --> -0.644434).  Saving model ...
Epoch: 5 cost time: 2.215276002883911
Epoch: 5, Steps: 12 | Train Loss: 1.002 Vali Loss: 0.829 Vali Acc: 0.672 Test Loss: 0.829 Test Acc: 0.672
Validation loss decreased (-0.644434 --> -0.672214).  Saving model ...
Epoch: 6 cost time: 1.9841299057006836
Epoch: 6, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.676 Vali Acc: 0.717 Test Loss: 0.676 Test Acc: 0.717
Validation loss decreased (-0.672214 --> -0.716660).  Saving model ...
Epoch: 7 cost time: 2.6929426193237305
Epoch: 7, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.607 Vali Acc: 0.744 Test Loss: 0.607 Test Acc: 0.744
Validation loss decreased (-0.716660 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 2.2787113189697266
Epoch: 8, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.510 Vali Acc: 0.767 Test Loss: 0.510 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766662).  Saving model ...
Epoch: 9 cost time: 2.2339282035827637
Epoch: 9, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.518 Vali Acc: 0.744 Test Loss: 0.518 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6894381046295166
Epoch: 10, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.431 Vali Acc: 0.806 Test Loss: 0.431 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.9322974681854248
Epoch: 11, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.399 Vali Acc: 0.800 Test Loss: 0.399 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0179293155670166
Epoch: 12, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.463 Vali Acc: 0.778 Test Loss: 0.463 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.208773374557495
Epoch: 13, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.372 Vali Acc: 0.800 Test Loss: 0.372 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8394455909729004
Epoch: 14, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.8999557495117188
Epoch: 15, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.471 Vali Acc: 0.794 Test Loss: 0.471 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6390364170074463
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.345 Vali Acc: 0.806 Test Loss: 0.345 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.170698881149292
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.175548791885376
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 2.463949680328369
Epoch: 19, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.342 Vali Acc: 0.839 Test Loss: 0.342 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 2.2087619304656982
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0382080078125
Epoch: 21, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 22 cost time: 2.023611545562744
Epoch: 22, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.11369252204895
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.574899673461914
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4055697917938232
Epoch: 25, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5098538398742676
Epoch: 26, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.407979965209961
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9448246955871582
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1967248916625977
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.391751289367676
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.379 Vali Acc: 0.856 Test Loss: 0.379 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.825317144393921
Epoch: 31, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.394 Vali Acc: 0.844 Test Loss: 0.394 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 734390
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.592266798019409
Epoch: 1, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.736 Vali Acc: 0.256 Test Loss: 1.736 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 2.470458745956421
Epoch: 2, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.605 Vali Acc: 0.467 Test Loss: 1.605 Test Acc: 0.467
Validation loss decreased (-0.255538 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 1.8669748306274414
Epoch: 3, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.369 Vali Acc: 0.583 Test Loss: 1.369 Test Acc: 0.583
Validation loss decreased (-0.466651 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 2.1276025772094727
Epoch: 4, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.106 Vali Acc: 0.617 Test Loss: 1.106 Test Acc: 0.617
Validation loss decreased (-0.583320 --> -0.616656).  Saving model ...
Epoch: 5 cost time: 1.7777886390686035
Epoch: 5, Steps: 12 | Train Loss: 1.017 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
Validation loss decreased (-0.616656 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 1.7129652500152588
Epoch: 6, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.795 Vali Acc: 0.628 Test Loss: 0.795 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1917343139648438
Epoch: 7, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.640 Vali Acc: 0.744 Test Loss: 0.640 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 2.055654764175415
Epoch: 8, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.552 Vali Acc: 0.733 Test Loss: 0.552 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8846631050109863
Epoch: 9, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
Validation loss decreased (-0.744438 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 2.3013031482696533
Epoch: 10, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.431 Vali Acc: 0.817 Test Loss: 0.431 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 1.817368984222412
Epoch: 11, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.432 Vali Acc: 0.806 Test Loss: 0.432 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.728898048400879
Epoch: 12, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822219).  Saving model ...
Epoch: 13 cost time: 2.232604503631592
Epoch: 13, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.380 Vali Acc: 0.806 Test Loss: 0.380 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.802992105484009
Epoch: 14, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4291296005249023
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
Validation loss decreased (-0.822219 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 2.102360248565674
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.402 Vali Acc: 0.839 Test Loss: 0.402 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.045389413833618
Epoch: 17, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0373375415802
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.540306568145752
Epoch: 19, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.381 Vali Acc: 0.806 Test Loss: 0.381 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1938858032226562
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.375 Vali Acc: 0.850 Test Loss: 0.375 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3126792907714844
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.81754207611084
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.205284595489502
Epoch: 23, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.402 Vali Acc: 0.861 Test Loss: 0.402 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2253940105438232
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 25 cost time: 2.3051598072052
Epoch: 25, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.865976333618164
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.375141143798828
Epoch: 27, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.393 Vali Acc: 0.839 Test Loss: 0.393 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0941598415374756
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.383 Vali Acc: 0.856 Test Loss: 0.383 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5968189239501953
Epoch: 29, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8590996265411377
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9402861595153809
Epoch: 31, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.369 Vali Acc: 0.867 Test Loss: 0.369 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.662264108657837
Epoch: 32, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 33 cost time: 1.7506060600280762
Epoch: 33, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9654054641723633
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888885).  Saving model ...
Epoch: 35 cost time: 1.949239730834961
Epoch: 35, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.342 Vali Acc: 0.878 Test Loss: 0.342 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.2256603240966797
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.396 Vali Acc: 0.872 Test Loss: 0.396 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9706840515136719
Epoch: 37, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.362 Vali Acc: 0.878 Test Loss: 0.362 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8681378364562988
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.8535776138305664
Epoch: 39, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.378 Vali Acc: 0.856 Test Loss: 0.378 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.8628361225128174
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.341 Vali Acc: 0.872 Test Loss: 0.341 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.7968742847442627
Epoch: 41, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.400 Vali Acc: 0.878 Test Loss: 0.400 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.8101489543914795
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.7299659252166748
Epoch: 43, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.7185695171356201
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 733750
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.769474506378174
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.736 Vali Acc: 0.261 Test Loss: 1.736 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 1.8105368614196777
Epoch: 2, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.575 Vali Acc: 0.472 Test Loss: 1.575 Test Acc: 0.472
Validation loss decreased (-0.261094 --> -0.472206).  Saving model ...
Epoch: 3 cost time: 2.0841517448425293
Epoch: 3, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.381 Vali Acc: 0.606 Test Loss: 1.381 Test Acc: 0.606
Validation loss decreased (-0.472206 --> -0.605542).  Saving model ...
Epoch: 4 cost time: 2.904250144958496
Epoch: 4, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.128 Vali Acc: 0.644 Test Loss: 1.128 Test Acc: 0.644
Validation loss decreased (-0.605542 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 2.401519775390625
Epoch: 5, Steps: 12 | Train Loss: 1.026 Vali Loss: 0.895 Vali Acc: 0.656 Test Loss: 0.895 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655547).  Saving model ...
Epoch: 6 cost time: 2.082214832305908
Epoch: 6, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.772 Vali Acc: 0.689 Test Loss: 0.772 Test Acc: 0.689
Validation loss decreased (-0.655547 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 2.257449150085449
Epoch: 7, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.693 Vali Acc: 0.728 Test Loss: 0.693 Test Acc: 0.728
Validation loss decreased (-0.688881 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 3.651458501815796
Epoch: 8, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8891706466674805
Epoch: 9, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.501 Vali Acc: 0.750 Test Loss: 0.501 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749995).  Saving model ...
Epoch: 10 cost time: 2.018934726715088
Epoch: 10, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.455 Vali Acc: 0.767 Test Loss: 0.455 Test Acc: 0.767
Validation loss decreased (-0.749995 --> -0.766662).  Saving model ...
Epoch: 11 cost time: 2.2883381843566895
Epoch: 11, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.431 Vali Acc: 0.794 Test Loss: 0.431 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 2.011171579360962
Epoch: 12, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.406 Vali Acc: 0.822 Test Loss: 0.406 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 1.8855164051055908
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.412 Vali Acc: 0.822 Test Loss: 0.412 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.219223737716675
Epoch: 14, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2386600971221924
Epoch: 15, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 16 cost time: 2.3053812980651855
Epoch: 16, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.395 Vali Acc: 0.828 Test Loss: 0.395 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9549319744110107
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 2.181382894515991
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.423 Vali Acc: 0.856 Test Loss: 0.423 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855551).  Saving model ...
Epoch: 19 cost time: 2.538567304611206
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.619 Vali Acc: 0.811 Test Loss: 0.619 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7866950035095215
Epoch: 20, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9989135265350342
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8037493228912354
Epoch: 22, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.556093692779541
Epoch: 23, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1735329627990723
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.370 Vali Acc: 0.867 Test Loss: 0.370 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866663).  Saving model ...
Epoch: 25 cost time: 2.16120982170105
Epoch: 25, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.390 Vali Acc: 0.856 Test Loss: 0.390 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.14395809173584
Epoch: 26, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.408 Vali Acc: 0.839 Test Loss: 0.408 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.218259334564209
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.414 Vali Acc: 0.856 Test Loss: 0.414 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.4008498191833496
Epoch: 28, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0173802375793457
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9968855381011963
Epoch: 30, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6378569602966309
Epoch: 31, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7997000217437744
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.458 Vali Acc: 0.839 Test Loss: 0.458 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.5961732864379883
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9344017505645752
Epoch: 34, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.456 Vali Acc: 0.833 Test Loss: 0.456 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 620086
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.941377639770508
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.759 Vali Acc: 0.206 Test Loss: 1.759 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 1.753873348236084
Epoch: 2, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.600 Vali Acc: 0.433 Test Loss: 1.600 Test Acc: 0.433
Validation loss decreased (-0.205538 --> -0.433317).  Saving model ...
Epoch: 3 cost time: 1.5875275135040283
Epoch: 3, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.402 Vali Acc: 0.639 Test Loss: 1.402 Test Acc: 0.639
Validation loss decreased (-0.433317 --> -0.638875).  Saving model ...
Epoch: 4 cost time: 1.457024335861206
Epoch: 4, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.121 Vali Acc: 0.706 Test Loss: 1.121 Test Acc: 0.706
Validation loss decreased (-0.638875 --> -0.705544).  Saving model ...
Epoch: 5 cost time: 1.8169822692871094
Epoch: 5, Steps: 12 | Train Loss: 1.001 Vali Loss: 0.888 Vali Acc: 0.639 Test Loss: 0.888 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9597938060760498
Epoch: 6, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.663 Vali Acc: 0.767 Test Loss: 0.663 Test Acc: 0.767
Validation loss decreased (-0.705544 --> -0.766660).  Saving model ...
Epoch: 7 cost time: 1.7480964660644531
Epoch: 7, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.571 Vali Acc: 0.733 Test Loss: 0.571 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8738713264465332
Epoch: 8, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.505 Vali Acc: 0.800 Test Loss: 0.505 Test Acc: 0.800
Validation loss decreased (-0.766660 --> -0.799995).  Saving model ...
Epoch: 9 cost time: 1.8156487941741943
Epoch: 9, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.457 Vali Acc: 0.817 Test Loss: 0.457 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816662).  Saving model ...
Epoch: 10 cost time: 1.565659761428833
Epoch: 10, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.433 Vali Acc: 0.794 Test Loss: 0.433 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.34958553314209
Epoch: 11, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.689523458480835
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 2.2625293731689453
Epoch: 13, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7680280208587646
Epoch: 14, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.370 Vali Acc: 0.856 Test Loss: 0.370 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 1.7424290180206299
Epoch: 15, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6576170921325684
Epoch: 16, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.390 Vali Acc: 0.828 Test Loss: 0.390 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5350182056427002
Epoch: 17, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.9217045307159424
Epoch: 18, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.372 Vali Acc: 0.833 Test Loss: 0.372 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3017079830169678
Epoch: 19, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.945113182067871
Epoch: 20, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.341 Vali Acc: 0.850 Test Loss: 0.341 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9726459980010986
Epoch: 21, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8683490753173828
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8202612400054932
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.362 Vali Acc: 0.856 Test Loss: 0.362 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1089751720428467
Epoch: 24, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.512 Vali Acc: 0.811 Test Loss: 0.512 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0983173847198486
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.357 Vali Acc: 0.872 Test Loss: 0.357 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 26 cost time: 1.8539583683013916
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8250689506530762
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5965676307678223
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.380 Vali Acc: 0.844 Test Loss: 0.380 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.625370979309082
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.413 Vali Acc: 0.856 Test Loss: 0.413 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6211020946502686
Epoch: 30, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.381 Vali Acc: 0.839 Test Loss: 0.381 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9661600589752197
Epoch: 31, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.345 Vali Acc: 0.856 Test Loss: 0.345 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7099454402923584
Epoch: 32, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8970990180969238
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.744976282119751
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8500416278839111
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.436 Vali Acc: 0.856 Test Loss: 0.436 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 619446
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.486636161804199
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.759 Vali Acc: 0.183 Test Loss: 1.759 Test Acc: 0.183
Validation loss decreased (inf --> -0.183316).  Saving model ...
Epoch: 2 cost time: 1.9165880680084229
Epoch: 2, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.625 Vali Acc: 0.439 Test Loss: 1.625 Test Acc: 0.439
Validation loss decreased (-0.183316 --> -0.438873).  Saving model ...
Epoch: 3 cost time: 2.130362033843994
Epoch: 3, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.443 Vali Acc: 0.561 Test Loss: 1.443 Test Acc: 0.561
Validation loss decreased (-0.438873 --> -0.561097).  Saving model ...
Epoch: 4 cost time: 1.8735110759735107
Epoch: 4, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.164 Vali Acc: 0.628 Test Loss: 1.164 Test Acc: 0.628
Validation loss decreased (-0.561097 --> -0.627766).  Saving model ...
Epoch: 5 cost time: 1.9884042739868164
Epoch: 5, Steps: 12 | Train Loss: 1.067 Vali Loss: 0.918 Vali Acc: 0.678 Test Loss: 0.918 Test Acc: 0.678
Validation loss decreased (-0.627766 --> -0.677769).  Saving model ...
Epoch: 6 cost time: 1.8432364463806152
Epoch: 6, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.799 Vali Acc: 0.650 Test Loss: 0.799 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.93635892868042
Epoch: 7, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.687 Vali Acc: 0.694 Test Loss: 0.687 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694438).  Saving model ...
Epoch: 8 cost time: 2.116354465484619
Epoch: 8, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.568 Vali Acc: 0.761 Test Loss: 0.568 Test Acc: 0.761
Validation loss decreased (-0.694438 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 1.9320974349975586
Epoch: 9, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.516 Vali Acc: 0.800 Test Loss: 0.516 Test Acc: 0.800
Validation loss decreased (-0.761105 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 2.4250762462615967
Epoch: 10, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8608391284942627
Epoch: 11, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.450 Vali Acc: 0.794 Test Loss: 0.450 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7886950969696045
Epoch: 12, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.391 Vali Acc: 0.811 Test Loss: 0.391 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 2.063035249710083
Epoch: 13, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 2.1853418350219727
Epoch: 14, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 2.135556697845459
Epoch: 15, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 2.394298553466797
Epoch: 16, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0537023544311523
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.409 Vali Acc: 0.811 Test Loss: 0.409 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9821233749389648
Epoch: 18, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.431 Vali Acc: 0.817 Test Loss: 0.431 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8248116970062256
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.465 Vali Acc: 0.817 Test Loss: 0.465 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.507598400115967
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.410 Vali Acc: 0.828 Test Loss: 0.410 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8149385452270508
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.386 Vali Acc: 0.844 Test Loss: 0.386 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 2.0502634048461914
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 1.9007372856140137
Epoch: 23, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1004278659820557
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.490 Vali Acc: 0.811 Test Loss: 0.490 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.25441312789917
Epoch: 25, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.774613618850708
Epoch: 26, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9023308753967285
Epoch: 27, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.506 Vali Acc: 0.806 Test Loss: 0.506 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.716371774673462
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.411 Vali Acc: 0.844 Test Loss: 0.411 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3829493522644043
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.409 Vali Acc: 0.856 Test Loss: 0.409 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 30 cost time: 2.1590147018432617
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.417 Vali Acc: 0.867 Test Loss: 0.417 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866663).  Saving model ...
Epoch: 31 cost time: 2.243910551071167
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7161507606506348
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.369 Vali Acc: 0.883 Test Loss: 0.369 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 33 cost time: 1.5482659339904785
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.434 Vali Acc: 0.856 Test Loss: 0.434 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6460459232330322
Epoch: 34, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.472 Vali Acc: 0.811 Test Loss: 0.472 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.004462480545044
Epoch: 35, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.445 Vali Acc: 0.867 Test Loss: 0.445 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8685634136199951
Epoch: 36, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.781102180480957
Epoch: 37, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.458 Vali Acc: 0.861 Test Loss: 0.458 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.3595027923583984
Epoch: 38, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.66849684715271
Epoch: 39, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.0325911045074463
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.0435972213745117
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.2758631706237793
Epoch: 42, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.382 Vali Acc: 0.883 Test Loss: 0.382 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 618806
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.692995309829712
Epoch: 1, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.735 Vali Acc: 0.317 Test Loss: 1.735 Test Acc: 0.317
Validation loss decreased (inf --> -0.316649).  Saving model ...
Epoch: 2 cost time: 2.120184898376465
Epoch: 2, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.591 Vali Acc: 0.544 Test Loss: 1.591 Test Acc: 0.544
Validation loss decreased (-0.316649 --> -0.544429).  Saving model ...
Epoch: 3 cost time: 1.8853437900543213
Epoch: 3, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.414 Vali Acc: 0.589 Test Loss: 1.414 Test Acc: 0.589
Validation loss decreased (-0.544429 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 2.286093235015869
Epoch: 4, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.185 Vali Acc: 0.606 Test Loss: 1.185 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605544).  Saving model ...
Epoch: 5 cost time: 2.1740448474884033
Epoch: 5, Steps: 12 | Train Loss: 1.134 Vali Loss: 0.918 Vali Acc: 0.689 Test Loss: 0.918 Test Acc: 0.689
Validation loss decreased (-0.605544 --> -0.688880).  Saving model ...
Epoch: 6 cost time: 2.475022077560425
Epoch: 6, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.723 Vali Acc: 0.711 Test Loss: 0.723 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711104).  Saving model ...
Epoch: 7 cost time: 2.069472074508667
Epoch: 7, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.595 Vali Acc: 0.767 Test Loss: 0.595 Test Acc: 0.767
Validation loss decreased (-0.711104 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 2.7078850269317627
Epoch: 8, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.514 Vali Acc: 0.772 Test Loss: 0.514 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 2.0446815490722656
Epoch: 9, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 2.0310230255126953
Epoch: 10, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.482 Vali Acc: 0.772 Test Loss: 0.482 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8641314506530762
Epoch: 11, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.422 Vali Acc: 0.806 Test Loss: 0.422 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 2.3384108543395996
Epoch: 12, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.417 Vali Acc: 0.794 Test Loss: 0.417 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3387694358825684
Epoch: 13, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.434 Vali Acc: 0.811 Test Loss: 0.434 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 2.3061695098876953
Epoch: 14, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.405 Vali Acc: 0.817 Test Loss: 0.405 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 2.1293020248413086
Epoch: 15, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 1.8358128070831299
Epoch: 16, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 2.62060284614563
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 18 cost time: 2.5256943702697754
Epoch: 18, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.413 Vali Acc: 0.817 Test Loss: 0.413 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.204043388366699
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844440).  Saving model ...
Epoch: 20 cost time: 1.8391978740692139
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.367 Vali Acc: 0.828 Test Loss: 0.367 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.107818603515625
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.452 Vali Acc: 0.828 Test Loss: 0.452 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.790024518966675
Epoch: 22, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 2.337531089782715
Epoch: 23, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.330 Vali Acc: 0.878 Test Loss: 0.330 Test Acc: 0.878
Validation loss decreased (-0.849996 --> -0.877774).  Saving model ...
Epoch: 24 cost time: 1.634115219116211
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.411 Vali Acc: 0.844 Test Loss: 0.411 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5847771167755127
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.348839521408081
Epoch: 26, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.6686289310455322
Epoch: 27, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.403 Vali Acc: 0.872 Test Loss: 0.403 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.646733045578003
Epoch: 28, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9598402976989746
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.409 Vali Acc: 0.856 Test Loss: 0.409 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.0577311515808105
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.346 Vali Acc: 0.872 Test Loss: 0.346 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.102421760559082
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.315492868423462
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.394 Vali Acc: 0.861 Test Loss: 0.394 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.7580785751342773
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.421 Vali Acc: 0.861 Test Loss: 0.421 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 618166
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.393226146697998
Epoch: 1, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.716 Vali Acc: 0.228 Test Loss: 1.716 Test Acc: 0.228
Validation loss decreased (inf --> -0.227761).  Saving model ...
Epoch: 2 cost time: 1.9831962585449219
Epoch: 2, Steps: 12 | Train Loss: 1.707 Vali Loss: 1.562 Vali Acc: 0.500 Test Loss: 1.562 Test Acc: 0.500
Validation loss decreased (-0.227761 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.7619445323944092
Epoch: 3, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.358 Vali Acc: 0.622 Test Loss: 1.358 Test Acc: 0.622
Validation loss decreased (-0.499984 --> -0.622209).  Saving model ...
Epoch: 4 cost time: 2.13765025138855
Epoch: 4, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.107 Vali Acc: 0.650 Test Loss: 1.107 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 1.9851443767547607
Epoch: 5, Steps: 12 | Train Loss: 1.037 Vali Loss: 0.895 Vali Acc: 0.678 Test Loss: 0.895 Test Acc: 0.678
Validation loss decreased (-0.649989 --> -0.677769).  Saving model ...
Epoch: 6 cost time: 1.925288200378418
Epoch: 6, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.781 Vali Acc: 0.717 Test Loss: 0.781 Test Acc: 0.717
Validation loss decreased (-0.677769 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 1.748091697692871
Epoch: 7, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.669 Vali Acc: 0.722 Test Loss: 0.669 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 1.7230281829833984
Epoch: 8, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.9958701133728027
Epoch: 9, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.543 Vali Acc: 0.767 Test Loss: 0.543 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 1.468480110168457
Epoch: 10, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.532 Vali Acc: 0.761 Test Loss: 0.532 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7888987064361572
Epoch: 11, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.455 Vali Acc: 0.794 Test Loss: 0.455 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 1.7551517486572266
Epoch: 12, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.421 Vali Acc: 0.817 Test Loss: 0.421 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 1.9671874046325684
Epoch: 13, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.403 Vali Acc: 0.811 Test Loss: 0.403 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7582015991210938
Epoch: 14, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.393 Vali Acc: 0.822 Test Loss: 0.393 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 1.81223726272583
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 16 cost time: 1.8441247940063477
Epoch: 16, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 2.0544912815093994
Epoch: 17, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.330 Vali Acc: 0.844 Test Loss: 0.330 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 2.015742540359497
Epoch: 18, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.415 Vali Acc: 0.811 Test Loss: 0.415 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6977040767669678
Epoch: 19, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6615393161773682
Epoch: 20, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.429 Vali Acc: 0.800 Test Loss: 0.429 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0092458724975586
Epoch: 21, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.117351770401001
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.344 Vali Acc: 0.839 Test Loss: 0.344 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.636850595474243
Epoch: 23, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0873706340789795
Epoch: 24, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.328 Vali Acc: 0.828 Test Loss: 0.328 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8491201400756836
Epoch: 25, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 26 cost time: 2.1072161197662354
Epoch: 26, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 27 cost time: 2.030987024307251
Epoch: 27, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2467238903045654
Epoch: 28, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.379 Vali Acc: 0.839 Test Loss: 0.379 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.234848737716675
Epoch: 29, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.460 Vali Acc: 0.839 Test Loss: 0.460 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9335768222808838
Epoch: 30, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.379 Vali Acc: 0.828 Test Loss: 0.379 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.43696665763855
Epoch: 31, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.520555019378662
Epoch: 32, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.329 Vali Acc: 0.861 Test Loss: 0.329 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 33 cost time: 2.12569522857666
Epoch: 33, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.6051950454711914
Epoch: 34, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.0629115104675293
Epoch: 35, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.398 Vali Acc: 0.844 Test Loss: 0.398 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8201992511749268
Epoch: 36, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.405 Vali Acc: 0.833 Test Loss: 0.405 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.927884817123413
Epoch: 37, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.824918270111084
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.926603078842163
Epoch: 39, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.365 Vali Acc: 0.856 Test Loss: 0.365 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.2512428760528564
Epoch: 40, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.227752208709717
Epoch: 41, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.389 Vali Acc: 0.856 Test Loss: 0.389 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.7475244998931885
Epoch: 42, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 603510
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.379452228546143
Epoch: 1, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.715 Vali Acc: 0.278 Test Loss: 1.715 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 2.1622531414031982
Epoch: 2, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.578 Vali Acc: 0.461 Test Loss: 1.578 Test Acc: 0.461
Validation loss decreased (-0.277761 --> -0.461095).  Saving model ...
Epoch: 3 cost time: 2.071269989013672
Epoch: 3, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.401 Vali Acc: 0.517 Test Loss: 1.401 Test Acc: 0.517
Validation loss decreased (-0.461095 --> -0.516653).  Saving model ...
Epoch: 4 cost time: 2.2570531368255615
Epoch: 4, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.194 Vali Acc: 0.556 Test Loss: 1.194 Test Acc: 0.556
Validation loss decreased (-0.516653 --> -0.555544).  Saving model ...
Epoch: 5 cost time: 2.63787579536438
Epoch: 5, Steps: 12 | Train Loss: 1.110 Vali Loss: 0.956 Vali Acc: 0.583 Test Loss: 0.956 Test Acc: 0.583
Validation loss decreased (-0.555544 --> -0.583324).  Saving model ...
Epoch: 6 cost time: 2.3834455013275146
Epoch: 6, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.813 Vali Acc: 0.678 Test Loss: 0.813 Test Acc: 0.678
Validation loss decreased (-0.583324 --> -0.677770).  Saving model ...
Epoch: 7 cost time: 2.1084189414978027
Epoch: 7, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.676 Vali Acc: 0.744 Test Loss: 0.676 Test Acc: 0.744
Validation loss decreased (-0.677770 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 1.9880077838897705
Epoch: 8, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.588 Vali Acc: 0.772 Test Loss: 0.588 Test Acc: 0.772
Validation loss decreased (-0.744438 --> -0.772216).  Saving model ...
Epoch: 9 cost time: 2.774980306625366
Epoch: 9, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.496 Vali Acc: 0.806 Test Loss: 0.496 Test Acc: 0.806
Validation loss decreased (-0.772216 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 2.396070718765259
Epoch: 10, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.463 Vali Acc: 0.811 Test Loss: 0.463 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 2.2098541259765625
Epoch: 11, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 2.601849317550659
Epoch: 12, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 1.97403883934021
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4284491539001465
Epoch: 14, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 3.5737967491149902
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5718424320220947
Epoch: 16, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 2.1754934787750244
Epoch: 17, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.408 Vali Acc: 0.811 Test Loss: 0.408 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2580597400665283
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.352 Vali Acc: 0.828 Test Loss: 0.352 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5126230716705322
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8470044136047363
Epoch: 20, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.47261643409729
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2299399375915527
Epoch: 22, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.392 Vali Acc: 0.817 Test Loss: 0.392 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.8377952575683594
Epoch: 23, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.418 Vali Acc: 0.839 Test Loss: 0.418 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7526612281799316
Epoch: 24, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.401 Vali Acc: 0.839 Test Loss: 0.401 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.3135879039764404
Epoch: 25, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.403 Vali Acc: 0.828 Test Loss: 0.403 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.184030532836914
Epoch: 26, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 603190
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.308950662612915
Epoch: 1, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.715 Vali Acc: 0.311 Test Loss: 1.715 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 1.948045253753662
Epoch: 2, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.581 Vali Acc: 0.506 Test Loss: 1.581 Test Acc: 0.506
Validation loss decreased (-0.311094 --> -0.505540).  Saving model ...
Epoch: 3 cost time: 2.0500400066375732
Epoch: 3, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.367 Vali Acc: 0.522 Test Loss: 1.367 Test Acc: 0.522
Validation loss decreased (-0.505540 --> -0.522209).  Saving model ...
Epoch: 4 cost time: 2.2070672512054443
Epoch: 4, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.094 Vali Acc: 0.683 Test Loss: 1.094 Test Acc: 0.683
Validation loss decreased (-0.522209 --> -0.683322).  Saving model ...
Epoch: 5 cost time: 2.067772626876831
Epoch: 5, Steps: 12 | Train Loss: 0.978 Vali Loss: 0.870 Vali Acc: 0.694 Test Loss: 0.870 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694436).  Saving model ...
Epoch: 6 cost time: 2.0120725631713867
Epoch: 6, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.724 Vali Acc: 0.706 Test Loss: 0.724 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705548).  Saving model ...
Epoch: 7 cost time: 2.0210676193237305
Epoch: 7, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.619 Vali Acc: 0.739 Test Loss: 0.619 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 1.8644907474517822
Epoch: 8, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.538 Vali Acc: 0.761 Test Loss: 0.538 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 1.8570871353149414
Epoch: 9, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.483 Vali Acc: 0.772 Test Loss: 0.483 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772217).  Saving model ...
Epoch: 10 cost time: 1.894827127456665
Epoch: 10, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.440 Vali Acc: 0.783 Test Loss: 0.440 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 2.4041757583618164
Epoch: 11, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.399 Vali Acc: 0.800 Test Loss: 0.399 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 1.9846060276031494
Epoch: 12, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 2.068591356277466
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 2.2773895263671875
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.350 Vali Acc: 0.822 Test Loss: 0.350 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.251291513442993
Epoch: 15, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.336 Vali Acc: 0.817 Test Loss: 0.336 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6718788146972656
Epoch: 16, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.345 Vali Acc: 0.806 Test Loss: 0.345 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0528697967529297
Epoch: 17, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.360 Vali Acc: 0.811 Test Loss: 0.360 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1224365234375
Epoch: 18, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.172680616378784
Epoch: 19, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.383 Vali Acc: 0.817 Test Loss: 0.383 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.219799757003784
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.412 Vali Acc: 0.811 Test Loss: 0.412 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.94822096824646
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.359 Vali Acc: 0.817 Test Loss: 0.359 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.203521490097046
Epoch: 22, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 2.0792572498321533
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.376 Vali Acc: 0.817 Test Loss: 0.376 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.192028760910034
Epoch: 24, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1371045112609863
Epoch: 25, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.346 Vali Acc: 0.817 Test Loss: 0.346 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.223116397857666
Epoch: 26, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.415 Vali Acc: 0.806 Test Loss: 0.415 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.6782591342926025
Epoch: 27, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.378 Vali Acc: 0.778 Test Loss: 0.378 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9503967761993408
Epoch: 28, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.429 Vali Acc: 0.811 Test Loss: 0.429 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9892332553863525
Epoch: 29, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.374 Vali Acc: 0.833 Test Loss: 0.374 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9468936920166016
Epoch: 30, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.376 Vali Acc: 0.811 Test Loss: 0.376 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.1001498699188232
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.384 Vali Acc: 0.811 Test Loss: 0.384 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.2998292446136475
Epoch: 32, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 602870
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.449826240539551
Epoch: 1, Steps: 12 | Train Loss: 1.964 Vali Loss: 1.760 Vali Acc: 0.183 Test Loss: 1.760 Test Acc: 0.183
Validation loss decreased (inf --> -0.183316).  Saving model ...
Epoch: 2 cost time: 1.852893352508545
Epoch: 2, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.664 Vali Acc: 0.439 Test Loss: 1.664 Test Acc: 0.439
Validation loss decreased (-0.183316 --> -0.438872).  Saving model ...
Epoch: 3 cost time: 2.4215946197509766
Epoch: 3, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.508 Vali Acc: 0.600 Test Loss: 1.508 Test Acc: 0.600
Validation loss decreased (-0.438872 --> -0.599985).  Saving model ...
Epoch: 4 cost time: 2.2314319610595703
Epoch: 4, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.279 Vali Acc: 0.683 Test Loss: 1.279 Test Acc: 0.683
Validation loss decreased (-0.599985 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 2.1019458770751953
Epoch: 5, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.040 Vali Acc: 0.628 Test Loss: 1.040 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9325282573699951
Epoch: 6, Steps: 12 | Train Loss: 0.944 Vali Loss: 0.854 Vali Acc: 0.700 Test Loss: 0.854 Test Acc: 0.700
Validation loss decreased (-0.683321 --> -0.699991).  Saving model ...
Epoch: 7 cost time: 2.2058255672454834
Epoch: 7, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 1.805635929107666
Epoch: 8, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.625 Vali Acc: 0.778 Test Loss: 0.625 Test Acc: 0.778
Validation loss decreased (-0.722215 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 2.4578065872192383
Epoch: 9, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.572 Vali Acc: 0.800 Test Loss: 0.572 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 2.3662302494049072
Epoch: 10, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2268481254577637
Epoch: 11, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.415 Vali Acc: 0.822 Test Loss: 0.415 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 2.170410633087158
Epoch: 12, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.379 Vali Acc: 0.828 Test Loss: 0.379 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 2.212383985519409
Epoch: 13, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2196993827819824
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 2.2121543884277344
Epoch: 15, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.140061855316162
Epoch: 16, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.365 Vali Acc: 0.811 Test Loss: 0.365 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.699791669845581
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.386 Vali Acc: 0.833 Test Loss: 0.386 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8687658309936523
Epoch: 18, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1322085857391357
Epoch: 19, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.324 Vali Acc: 0.806 Test Loss: 0.324 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8505878448486328
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.094113349914551
Epoch: 21, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.4322123527526855
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.324 Vali Acc: 0.844 Test Loss: 0.324 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.149376153945923
Epoch: 23, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.152590274810791
Epoch: 24, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 602550
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.381943941116333
Epoch: 1, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.808 Vali Acc: 0.122 Test Loss: 1.808 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 2.33192777633667
Epoch: 2, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.750 Vali Acc: 0.250 Test Loss: 1.750 Test Acc: 0.250
Validation loss decreased (-0.122204 --> -0.249982).  Saving model ...
Epoch: 3 cost time: 1.772902250289917
Epoch: 3, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.636 Vali Acc: 0.383 Test Loss: 1.636 Test Acc: 0.383
Validation loss decreased (-0.249982 --> -0.383317).  Saving model ...
Epoch: 4 cost time: 1.7592546939849854
Epoch: 4, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.498 Vali Acc: 0.517 Test Loss: 1.498 Test Acc: 0.517
Validation loss decreased (-0.383317 --> -0.516652).  Saving model ...
Epoch: 5 cost time: 2.3373072147369385
Epoch: 5, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.240 Vali Acc: 0.628 Test Loss: 1.240 Test Acc: 0.628
Validation loss decreased (-0.516652 --> -0.627765).  Saving model ...
Epoch: 6 cost time: 2.087620258331299
Epoch: 6, Steps: 12 | Train Loss: 1.217 Vali Loss: 0.997 Vali Acc: 0.711 Test Loss: 0.997 Test Acc: 0.711
Validation loss decreased (-0.627765 --> -0.711101).  Saving model ...
Epoch: 7 cost time: 1.8954613208770752
Epoch: 7, Steps: 12 | Train Loss: 0.940 Vali Loss: 0.800 Vali Acc: 0.744 Test Loss: 0.800 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 2.1477227210998535
Epoch: 8, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
Validation loss decreased (-0.744436 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 3.077812433242798
Epoch: 9, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2591633796691895
Epoch: 10, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.518 Vali Acc: 0.811 Test Loss: 0.518 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 2.0860722064971924
Epoch: 11, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.473 Vali Acc: 0.811 Test Loss: 0.473 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 2.26645565032959
Epoch: 12, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.414 Vali Acc: 0.844 Test Loss: 0.414 Test Acc: 0.844
Validation loss decreased (-0.811106 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 3.077406167984009
Epoch: 13, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.379 Vali Acc: 0.828 Test Loss: 0.379 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2178025245666504
Epoch: 14, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.349 Vali Acc: 0.844 Test Loss: 0.349 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 2.262315273284912
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.334 Vali Acc: 0.856 Test Loss: 0.334 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.8367998600006104
Epoch: 16, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4392647743225098
Epoch: 17, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 2.0306291580200195
Epoch: 18, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0759055614471436
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.154280424118042
Epoch: 20, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.043564558029175
Epoch: 21, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6796841621398926
Epoch: 22, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.126317262649536
Epoch: 23, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9179167747497559
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3697590827941895
Epoch: 25, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6471595764160156
Epoch: 26, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4007277488708496
Epoch: 27, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 370550
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.062609910964966
Epoch: 1, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.744 Vali Acc: 0.222 Test Loss: 1.744 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 2.5366477966308594
Epoch: 2, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.693 Vali Acc: 0.211 Test Loss: 1.693 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.264775514602661
Epoch: 3, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.556 Vali Acc: 0.439 Test Loss: 1.556 Test Acc: 0.439
Validation loss decreased (-0.222205 --> -0.438873).  Saving model ...
Epoch: 4 cost time: 2.633023262023926
Epoch: 4, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.385 Vali Acc: 0.628 Test Loss: 1.385 Test Acc: 0.628
Validation loss decreased (-0.438873 --> -0.627764).  Saving model ...
Epoch: 5 cost time: 2.4059090614318848
Epoch: 5, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.162 Vali Acc: 0.667 Test Loss: 1.162 Test Acc: 0.667
Validation loss decreased (-0.627764 --> -0.666655).  Saving model ...
Epoch: 6 cost time: 2.233062505722046
Epoch: 6, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.952 Vali Acc: 0.678 Test Loss: 0.952 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677768).  Saving model ...
Epoch: 7 cost time: 2.3342409133911133
Epoch: 7, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.764 Vali Acc: 0.750 Test Loss: 0.764 Test Acc: 0.750
Validation loss decreased (-0.677768 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.9700498580932617
Epoch: 8, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.653 Vali Acc: 0.722 Test Loss: 0.653 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5743372440338135
Epoch: 9, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.578 Vali Acc: 0.778 Test Loss: 0.578 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 2.41638445854187
Epoch: 10, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.500 Vali Acc: 0.739 Test Loss: 0.500 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5497665405273438
Epoch: 11, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.444 Vali Acc: 0.817 Test Loss: 0.444 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 2.196657657623291
Epoch: 12, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.413 Vali Acc: 0.828 Test Loss: 0.413 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 2.1874046325683594
Epoch: 13, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.164685010910034
Epoch: 14, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 2.0315346717834473
Epoch: 15, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.350 Vali Acc: 0.828 Test Loss: 0.350 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 1.99906587600708
Epoch: 16, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 1.6636221408843994
Epoch: 17, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 2.010882616043091
Epoch: 18, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.11415958404541
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 2.281503677368164
Epoch: 20, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2429921627044678
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3510382175445557
Epoch: 22, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9882762432098389
Epoch: 23, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9756536483764648
Epoch: 24, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.5148141384124756
Epoch: 25, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.3025619983673096
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1974756717681885
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.412578821182251
Epoch: 28, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.452 Vali Acc: 0.828 Test Loss: 0.452 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3631582260131836
Epoch: 29, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 30 cost time: 1.6720709800720215
Epoch: 30, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 31 cost time: 2.6080310344696045
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.369 Vali Acc: 0.833 Test Loss: 0.369 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.583732843399048
Epoch: 32, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 33 cost time: 1.8272151947021484
Epoch: 33, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9713196754455566
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8666110038757324
Epoch: 35, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.2430145740509033
Epoch: 36, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.041719675064087
Epoch: 37, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.34035587310791
Epoch: 38, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.1705660820007324
Epoch: 39, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.9331305027008057
Epoch: 40, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.383007287979126
Epoch: 41, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.2551541328430176
Epoch: 42, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 370230
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.295357704162598
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.774 Vali Acc: 0.278 Test Loss: 1.774 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 1.8699228763580322
Epoch: 2, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.710 Vali Acc: 0.350 Test Loss: 1.710 Test Acc: 0.350
Validation loss decreased (-0.277760 --> -0.349983).  Saving model ...
Epoch: 3 cost time: 2.2344858646392822
Epoch: 3, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.583 Vali Acc: 0.561 Test Loss: 1.583 Test Acc: 0.561
Validation loss decreased (-0.349983 --> -0.561095).  Saving model ...
Epoch: 4 cost time: 2.0036134719848633
Epoch: 4, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.426 Vali Acc: 0.617 Test Loss: 1.426 Test Acc: 0.617
Validation loss decreased (-0.561095 --> -0.616652).  Saving model ...
Epoch: 5 cost time: 2.024959087371826
Epoch: 5, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.234 Vali Acc: 0.672 Test Loss: 1.234 Test Acc: 0.672
Validation loss decreased (-0.616652 --> -0.672210).  Saving model ...
Epoch: 6 cost time: 2.076706647872925
Epoch: 6, Steps: 12 | Train Loss: 1.196 Vali Loss: 0.998 Vali Acc: 0.667 Test Loss: 0.998 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.08689284324646
Epoch: 7, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
Validation loss decreased (-0.672210 --> -0.727770).  Saving model ...
Epoch: 8 cost time: 1.731703758239746
Epoch: 8, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.657 Vali Acc: 0.767 Test Loss: 0.657 Test Acc: 0.767
Validation loss decreased (-0.727770 --> -0.766660).  Saving model ...
Epoch: 9 cost time: 1.7021479606628418
Epoch: 9, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.567 Vali Acc: 0.778 Test Loss: 0.567 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 1.9437692165374756
Epoch: 10, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.482 Vali Acc: 0.817 Test Loss: 0.482 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 2.0602047443389893
Epoch: 11, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.441 Vali Acc: 0.811 Test Loss: 0.441 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9394781589508057
Epoch: 12, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.406 Vali Acc: 0.817 Test Loss: 0.406 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 2.1563291549682617
Epoch: 13, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.381 Vali Acc: 0.828 Test Loss: 0.381 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 2.353044033050537
Epoch: 14, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.367 Vali Acc: 0.828 Test Loss: 0.367 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.7674789428710938
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 2.1479485034942627
Epoch: 16, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 2.4421865940093994
Epoch: 17, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.358 Vali Acc: 0.828 Test Loss: 0.358 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.737022638320923
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 19 cost time: 2.2220280170440674
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9883546829223633
Epoch: 20, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.310 Vali Acc: 0.867 Test Loss: 0.310 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 21 cost time: 2.222090244293213
Epoch: 21, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.972062349319458
Epoch: 22, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9932234287261963
Epoch: 23, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.112293243408203
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.031136989593506
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9734067916870117
Epoch: 26, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.194765090942383
Epoch: 27, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5318715572357178
Epoch: 28, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.435 Vali Acc: 0.828 Test Loss: 0.435 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0395991802215576
Epoch: 29, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.412 Vali Acc: 0.844 Test Loss: 0.412 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7826778888702393
Epoch: 30, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 369910
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.267327070236206
Epoch: 1, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.784 Vali Acc: 0.150 Test Loss: 1.784 Test Acc: 0.150
Validation loss decreased (inf --> -0.149982).  Saving model ...
Epoch: 2 cost time: 2.7163100242614746
Epoch: 2, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.720 Vali Acc: 0.394 Test Loss: 1.720 Test Acc: 0.394
Validation loss decreased (-0.149982 --> -0.394427).  Saving model ...
Epoch: 3 cost time: 2.646817445755005
Epoch: 3, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.620 Vali Acc: 0.467 Test Loss: 1.620 Test Acc: 0.467
Validation loss decreased (-0.394427 --> -0.466650).  Saving model ...
Epoch: 4 cost time: 2.443622350692749
Epoch: 4, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.463 Vali Acc: 0.511 Test Loss: 1.463 Test Acc: 0.511
Validation loss decreased (-0.466650 --> -0.511096).  Saving model ...
Epoch: 5 cost time: 2.310776948928833
Epoch: 5, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.191 Vali Acc: 0.644 Test Loss: 1.191 Test Acc: 0.644
Validation loss decreased (-0.511096 --> -0.644433).  Saving model ...
Epoch: 6 cost time: 2.124387502670288
Epoch: 6, Steps: 12 | Train Loss: 1.109 Vali Loss: 0.952 Vali Acc: 0.689 Test Loss: 0.952 Test Acc: 0.689
Validation loss decreased (-0.644433 --> -0.688879).  Saving model ...
Epoch: 7 cost time: 2.599482297897339
Epoch: 7, Steps: 12 | Train Loss: 0.863 Vali Loss: 0.776 Vali Acc: 0.711 Test Loss: 0.776 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711103).  Saving model ...
Epoch: 8 cost time: 2.457923650741577
Epoch: 8, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.679 Vali Acc: 0.733 Test Loss: 0.679 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 2.9248790740966797
Epoch: 9, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.604 Vali Acc: 0.750 Test Loss: 0.604 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 2.8878633975982666
Epoch: 10, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 2.2802224159240723
Epoch: 11, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.467 Vali Acc: 0.794 Test Loss: 0.467 Test Acc: 0.794
Validation loss decreased (-0.761106 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 2.332702159881592
Epoch: 12, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.426 Vali Acc: 0.822 Test Loss: 0.426 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 2.0430378913879395
Epoch: 13, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.406 Vali Acc: 0.822 Test Loss: 0.406 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 2.4694550037384033
Epoch: 14, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.381 Vali Acc: 0.828 Test Loss: 0.381 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 2.7312772274017334
Epoch: 15, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.368 Vali Acc: 0.833 Test Loss: 0.368 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 16 cost time: 2.7235493659973145
Epoch: 16, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 17 cost time: 2.2277045249938965
Epoch: 17, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7853808403015137
Epoch: 18, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5647335052490234
Epoch: 19, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8979341983795166
Epoch: 20, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6960561275482178
Epoch: 21, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 22 cost time: 2.663968563079834
Epoch: 22, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.535886526107788
Epoch: 23, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1949260234832764
Epoch: 24, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 25 cost time: 2.4428279399871826
Epoch: 25, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.275655508041382
Epoch: 26, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.131368398666382
Epoch: 27, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.219616651535034
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.314 Vali Acc: 0.828 Test Loss: 0.314 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0050718784332275
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.2466933727264404
Epoch: 30, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.415 Vali Acc: 0.833 Test Loss: 0.415 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.942415475845337
Epoch: 31, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.376 Vali Acc: 0.856 Test Loss: 0.376 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.345592975616455
Epoch: 32, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.1145617961883545
Epoch: 33, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.378 Vali Acc: 0.833 Test Loss: 0.378 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.8769571781158447
Epoch: 34, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 369590
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.537455797195435
Epoch: 1, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.764 Vali Acc: 0.228 Test Loss: 1.764 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 2.189687967300415
Epoch: 2, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.702 Vali Acc: 0.306 Test Loss: 1.702 Test Acc: 0.306
Validation loss decreased (-0.227760 --> -0.305539).  Saving model ...
Epoch: 3 cost time: 2.034762144088745
Epoch: 3, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.575 Vali Acc: 0.522 Test Loss: 1.575 Test Acc: 0.522
Validation loss decreased (-0.305539 --> -0.522206).  Saving model ...
Epoch: 4 cost time: 2.261935234069824
Epoch: 4, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.432 Vali Acc: 0.661 Test Loss: 1.432 Test Acc: 0.661
Validation loss decreased (-0.522206 --> -0.661097).  Saving model ...
Epoch: 5 cost time: 1.6858928203582764
Epoch: 5, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.235 Vali Acc: 0.600 Test Loss: 1.235 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.974557876586914
Epoch: 6, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.018 Vali Acc: 0.694 Test Loss: 1.018 Test Acc: 0.694
Validation loss decreased (-0.661097 --> -0.694434).  Saving model ...
Epoch: 7 cost time: 1.6495301723480225
Epoch: 7, Steps: 12 | Train Loss: 0.941 Vali Loss: 0.849 Vali Acc: 0.678 Test Loss: 0.849 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8887686729431152
Epoch: 8, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.729 Vali Acc: 0.722 Test Loss: 0.729 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722215).  Saving model ...
Epoch: 9 cost time: 2.3335649967193604
Epoch: 9, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.642 Vali Acc: 0.739 Test Loss: 0.642 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738882).  Saving model ...
Epoch: 10 cost time: 1.8329062461853027
Epoch: 10, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 1.7594728469848633
Epoch: 11, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.529 Vali Acc: 0.761 Test Loss: 0.529 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 12 cost time: 1.7856225967407227
Epoch: 12, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.469 Vali Acc: 0.789 Test Loss: 0.469 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 13 cost time: 2.05031418800354
Epoch: 13, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.442 Vali Acc: 0.794 Test Loss: 0.442 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 14 cost time: 2.0989041328430176
Epoch: 14, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.415 Vali Acc: 0.817 Test Loss: 0.415 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.9983456134796143
Epoch: 15, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.410 Vali Acc: 0.828 Test Loss: 0.410 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 1.8702518939971924
Epoch: 16, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.377 Vali Acc: 0.828 Test Loss: 0.377 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 2.313612461090088
Epoch: 17, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8479509353637695
Epoch: 18, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 1.9452095031738281
Epoch: 19, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.336 Vali Acc: 0.828 Test Loss: 0.336 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 1.9870209693908691
Epoch: 20, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 1.6496727466583252
Epoch: 21, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2424933910369873
Epoch: 22, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.313 Vali Acc: 0.828 Test Loss: 0.313 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5755140781402588
Epoch: 23, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.345 Vali Acc: 0.844 Test Loss: 0.345 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1053881645202637
Epoch: 24, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.316 Vali Acc: 0.833 Test Loss: 0.316 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1503021717071533
Epoch: 25, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.319 Vali Acc: 0.856 Test Loss: 0.319 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 1.721817970275879
Epoch: 26, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 27 cost time: 2.068962335586548
Epoch: 27, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9301881790161133
Epoch: 28, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 29 cost time: 1.6451332569122314
Epoch: 29, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9623143672943115
Epoch: 30, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8708844184875488
Epoch: 31, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.143825054168701
Epoch: 32, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8441462516784668
Epoch: 33, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.076427936553955
Epoch: 34, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.352 Vali Acc: 0.828 Test Loss: 0.352 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.9896214008331299
Epoch: 35, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.2120327949523926
Epoch: 36, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.107645034790039
Epoch: 37, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.5223422050476074
Epoch: 38, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 254070
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.449919939041138
Epoch: 1, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.743 Vali Acc: 0.294 Test Loss: 1.743 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 2.1545536518096924
Epoch: 2, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.682 Vali Acc: 0.222 Test Loss: 1.682 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7901387214660645
Epoch: 3, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.556 Vali Acc: 0.567 Test Loss: 1.556 Test Acc: 0.567
Validation loss decreased (-0.294427 --> -0.566651).  Saving model ...
Epoch: 4 cost time: 2.0048301219940186
Epoch: 4, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.409 Vali Acc: 0.572 Test Loss: 1.409 Test Acc: 0.572
Validation loss decreased (-0.566651 --> -0.572208).  Saving model ...
Epoch: 5 cost time: 2.7111735343933105
Epoch: 5, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.232 Vali Acc: 0.639 Test Loss: 1.232 Test Acc: 0.639
Validation loss decreased (-0.572208 --> -0.638877).  Saving model ...
Epoch: 6 cost time: 2.1072144508361816
Epoch: 6, Steps: 12 | Train Loss: 1.178 Vali Loss: 0.996 Vali Acc: 0.694 Test Loss: 0.996 Test Acc: 0.694
Validation loss decreased (-0.638877 --> -0.694434).  Saving model ...
Epoch: 7 cost time: 2.225464344024658
Epoch: 7, Steps: 12 | Train Loss: 0.937 Vali Loss: 0.800 Vali Acc: 0.772 Test Loss: 0.800 Test Acc: 0.772
Validation loss decreased (-0.694434 --> -0.772214).  Saving model ...
Epoch: 8 cost time: 2.3140857219696045
Epoch: 8, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.666 Vali Acc: 0.794 Test Loss: 0.666 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 1.8806307315826416
Epoch: 9, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.580 Vali Acc: 0.772 Test Loss: 0.580 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1992690563201904
Epoch: 10, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.510 Vali Acc: 0.800 Test Loss: 0.510 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 2.340820074081421
Epoch: 11, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.466 Vali Acc: 0.794 Test Loss: 0.466 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8895063400268555
Epoch: 12, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.432 Vali Acc: 0.789 Test Loss: 0.432 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5476126670837402
Epoch: 13, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.404 Vali Acc: 0.806 Test Loss: 0.404 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805552).  Saving model ...
Epoch: 14 cost time: 1.8115575313568115
Epoch: 14, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 2.070892333984375
Epoch: 15, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 16 cost time: 1.9369206428527832
Epoch: 16, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.102684259414673
Epoch: 17, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.347 Vali Acc: 0.822 Test Loss: 0.347 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 18 cost time: 2.0552260875701904
Epoch: 18, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 1.8889014720916748
Epoch: 19, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 1.770848274230957
Epoch: 20, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2475168704986572
Epoch: 21, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.331 Vali Acc: 0.867 Test Loss: 0.331 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 22 cost time: 1.9239614009857178
Epoch: 22, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 23 cost time: 1.7118825912475586
Epoch: 23, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.330 Vali Acc: 0.856 Test Loss: 0.330 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9681119918823242
Epoch: 24, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0171523094177246
Epoch: 25, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.278780698776245
Epoch: 26, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8056628704071045
Epoch: 27, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.333 Vali Acc: 0.856 Test Loss: 0.333 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.331702470779419
Epoch: 28, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9873464107513428
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.324 Vali Acc: 0.844 Test Loss: 0.324 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.522693395614624
Epoch: 30, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.1132161617279053
Epoch: 31, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.006669044494629
Epoch: 32, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 253750
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8732292652130127
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.747 Vali Acc: 0.211 Test Loss: 1.747 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.9069690704345703
Epoch: 2, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.643 Vali Acc: 0.333 Test Loss: 1.643 Test Acc: 0.333
Validation loss decreased (-0.211094 --> -0.333317).  Saving model ...
Epoch: 3 cost time: 2.1637508869171143
Epoch: 3, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.516 Vali Acc: 0.539 Test Loss: 1.516 Test Acc: 0.539
Validation loss decreased (-0.333317 --> -0.538874).  Saving model ...
Epoch: 4 cost time: 1.9971716403961182
Epoch: 4, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.317 Vali Acc: 0.622 Test Loss: 1.317 Test Acc: 0.622
Validation loss decreased (-0.538874 --> -0.622209).  Saving model ...
Epoch: 5 cost time: 2.390707015991211
Epoch: 5, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.117 Vali Acc: 0.678 Test Loss: 1.117 Test Acc: 0.678
Validation loss decreased (-0.622209 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 1.9799995422363281
Epoch: 6, Steps: 12 | Train Loss: 1.072 Vali Loss: 0.927 Vali Acc: 0.689 Test Loss: 0.927 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 2.0643794536590576
Epoch: 7, Steps: 12 | Train Loss: 0.887 Vali Loss: 0.775 Vali Acc: 0.706 Test Loss: 0.775 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 2.7653324604034424
Epoch: 8, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.680 Vali Acc: 0.728 Test Loss: 0.680 Test Acc: 0.728
Validation loss decreased (-0.705548 --> -0.727771).  Saving model ...
Epoch: 9 cost time: 2.441572427749634
Epoch: 9, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.727771 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 1.950279951095581
Epoch: 10, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
Validation loss decreased (-0.783328 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 2.0958011150360107
Epoch: 11, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.464 Vali Acc: 0.811 Test Loss: 0.464 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0642406940460205
Epoch: 12, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.443 Vali Acc: 0.822 Test Loss: 0.443 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7566823959350586
Epoch: 13, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.413 Vali Acc: 0.844 Test Loss: 0.413 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 2.001220703125
Epoch: 14, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.386 Vali Acc: 0.856 Test Loss: 0.386 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 2.0719473361968994
Epoch: 15, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.373 Vali Acc: 0.844 Test Loss: 0.373 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1354713439941406
Epoch: 16, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.349 Vali Acc: 0.844 Test Loss: 0.349 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.107828378677368
Epoch: 17, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.034485101699829
Epoch: 18, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.356 Vali Acc: 0.844 Test Loss: 0.356 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8370060920715332
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 1.9758679866790771
Epoch: 20, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.357 Vali Acc: 0.856 Test Loss: 0.357 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2124898433685303
Epoch: 21, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 22 cost time: 2.22064208984375
Epoch: 22, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.911146640777588
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 2.0627641677856445
Epoch: 24, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 25 cost time: 1.802910566329956
Epoch: 25, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 1.9575855731964111
Epoch: 26, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.213982343673706
Epoch: 27, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2911109924316406
Epoch: 28, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 29 cost time: 2.3040590286254883
Epoch: 29, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.324871063232422
Epoch: 30, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1401946544647217
Epoch: 31, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.328 Vali Acc: 0.878 Test Loss: 0.328 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 32 cost time: 1.9684793949127197
Epoch: 32, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.318 Vali Acc: 0.833 Test Loss: 0.318 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.4791266918182373
Epoch: 33, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.4918651580810547
Epoch: 34, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.2109882831573486
Epoch: 35, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.333 Vali Acc: 0.833 Test Loss: 0.333 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.432865858078003
Epoch: 36, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9445257186889648
Epoch: 37, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.219015121459961
Epoch: 38, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.8990428447723389
Epoch: 39, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.447 Vali Acc: 0.817 Test Loss: 0.447 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.3179335594177246
Epoch: 40, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.0330612659454346
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.302 Vali Acc: 0.883 Test Loss: 0.302 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 42 cost time: 1.8628838062286377
Epoch: 42, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.8285930156707764
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.936880111694336
Epoch: 44, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.647404432296753
Epoch: 45, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.348 Vali Acc: 0.856 Test Loss: 0.348 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.059915542602539
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.2994678020477295
Epoch: 47, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.173356533050537
Epoch: 48, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.9579360485076904
Epoch: 49, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.898543357849121
Epoch: 50, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.975231647491455
Epoch: 51, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 253430
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.7007153034210205
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.798 Vali Acc: 0.161 Test Loss: 1.798 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 2.246000289916992
Epoch: 2, Steps: 12 | Train Loss: 1.805 Vali Loss: 1.745 Vali Acc: 0.206 Test Loss: 1.745 Test Acc: 0.206
Validation loss decreased (-0.161093 --> -0.205538).  Saving model ...
Epoch: 3 cost time: 1.9356327056884766
Epoch: 3, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.669 Vali Acc: 0.439 Test Loss: 1.669 Test Acc: 0.439
Validation loss decreased (-0.205538 --> -0.438872).  Saving model ...
Epoch: 4 cost time: 2.03299617767334
Epoch: 4, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.558 Vali Acc: 0.478 Test Loss: 1.558 Test Acc: 0.478
Validation loss decreased (-0.438872 --> -0.477762).  Saving model ...
Epoch: 5 cost time: 1.7949769496917725
Epoch: 5, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.378 Vali Acc: 0.578 Test Loss: 1.378 Test Acc: 0.578
Validation loss decreased (-0.477762 --> -0.577764).  Saving model ...
Epoch: 6 cost time: 1.5502209663391113
Epoch: 6, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.170 Vali Acc: 0.633 Test Loss: 1.170 Test Acc: 0.633
Validation loss decreased (-0.577764 --> -0.633322).  Saving model ...
Epoch: 7 cost time: 1.7898800373077393
Epoch: 7, Steps: 12 | Train Loss: 1.074 Vali Loss: 0.938 Vali Acc: 0.644 Test Loss: 0.938 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644435).  Saving model ...
Epoch: 8 cost time: 2.43038010597229
Epoch: 8, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.763 Vali Acc: 0.744 Test Loss: 0.763 Test Acc: 0.744
Validation loss decreased (-0.644435 --> -0.744437).  Saving model ...
Epoch: 9 cost time: 1.6952238082885742
Epoch: 9, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.645 Vali Acc: 0.728 Test Loss: 0.645 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1823949813842773
Epoch: 10, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.561 Vali Acc: 0.794 Test Loss: 0.561 Test Acc: 0.794
Validation loss decreased (-0.744437 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 1.8112223148345947
Epoch: 11, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.504 Vali Acc: 0.811 Test Loss: 0.504 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 1.661170482635498
Epoch: 12, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.467 Vali Acc: 0.778 Test Loss: 0.467 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8116250038146973
Epoch: 13, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.416 Vali Acc: 0.794 Test Loss: 0.416 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9911439418792725
Epoch: 14, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.00386381149292
Epoch: 15, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
Validation loss decreased (-0.811106 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 3.0467777252197266
Epoch: 16, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.953655481338501
Epoch: 17, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.317 Vali Acc: 0.883 Test Loss: 0.317 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 2.0591583251953125
Epoch: 18, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 2.2832605838775635
Epoch: 19, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5802905559539795
Epoch: 20, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.863133430480957
Epoch: 21, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9750759601593018
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.630523920059204
Epoch: 23, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.319 Vali Acc: 0.856 Test Loss: 0.319 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0356640815734863
Epoch: 24, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.3477230072021484
Epoch: 25, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.098073959350586
Epoch: 26, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.926124095916748
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.355 Vali Acc: 0.867 Test Loss: 0.355 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.500910758972168
Epoch: 28, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.335 Vali Acc: 0.856 Test Loss: 0.335 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 253110
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.659992933273315
Epoch: 1, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.780 Vali Acc: 0.172 Test Loss: 1.780 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 2.4861600399017334
Epoch: 2, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.725 Vali Acc: 0.372 Test Loss: 1.725 Test Acc: 0.372
Validation loss decreased (-0.172204 --> -0.372205).  Saving model ...
Epoch: 3 cost time: 2.487793445587158
Epoch: 3, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.618 Vali Acc: 0.383 Test Loss: 1.618 Test Acc: 0.383
Validation loss decreased (-0.372205 --> -0.383317).  Saving model ...
Epoch: 4 cost time: 1.8881752490997314
Epoch: 4, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.482 Vali Acc: 0.578 Test Loss: 1.482 Test Acc: 0.578
Validation loss decreased (-0.383317 --> -0.577763).  Saving model ...
Epoch: 5 cost time: 2.2156927585601807
Epoch: 5, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.297 Vali Acc: 0.639 Test Loss: 1.297 Test Acc: 0.639
Validation loss decreased (-0.577763 --> -0.638876).  Saving model ...
Epoch: 6 cost time: 1.9052212238311768
Epoch: 6, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.118 Vali Acc: 0.656 Test Loss: 1.118 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 7 cost time: 1.9967598915100098
Epoch: 7, Steps: 12 | Train Loss: 1.013 Vali Loss: 0.902 Vali Acc: 0.744 Test Loss: 0.902 Test Acc: 0.744
Validation loss decreased (-0.655544 --> -0.744435).  Saving model ...
Epoch: 8 cost time: 2.257096767425537
Epoch: 8, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.768 Vali Acc: 0.678 Test Loss: 0.768 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.721257209777832
Epoch: 9, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 1.8451318740844727
Epoch: 10, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.594 Vali Acc: 0.772 Test Loss: 0.594 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772216).  Saving model ...
Epoch: 11 cost time: 1.9839978218078613
Epoch: 11, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.555 Vali Acc: 0.750 Test Loss: 0.555 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.82763671875
Epoch: 12, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.513 Vali Acc: 0.800 Test Loss: 0.513 Test Acc: 0.800
Validation loss decreased (-0.772216 --> -0.799995).  Saving model ...
Epoch: 13 cost time: 1.9816529750823975
Epoch: 13, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.474 Vali Acc: 0.806 Test Loss: 0.474 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 14 cost time: 2.0144147872924805
Epoch: 14, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.440 Vali Acc: 0.828 Test Loss: 0.440 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827773).  Saving model ...
Epoch: 15 cost time: 2.0208277702331543
Epoch: 15, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 2.117802619934082
Epoch: 16, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.395754814147949
Epoch: 17, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.429 Vali Acc: 0.800 Test Loss: 0.429 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.41137433052063
Epoch: 18, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.414 Vali Acc: 0.800 Test Loss: 0.414 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.099421501159668
Epoch: 19, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.397 Vali Acc: 0.839 Test Loss: 0.397 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 2.1850616931915283
Epoch: 20, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.355 Vali Acc: 0.856 Test Loss: 0.355 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 2.972363233566284
Epoch: 21, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8130500316619873
Epoch: 22, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.895596981048584
Epoch: 23, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.356 Vali Acc: 0.856 Test Loss: 0.356 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.878117561340332
Epoch: 24, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0975043773651123
Epoch: 25, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.401 Vali Acc: 0.839 Test Loss: 0.401 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.02384352684021
Epoch: 26, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8136274814605713
Epoch: 27, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.369 Vali Acc: 0.839 Test Loss: 0.369 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1305370330810547
Epoch: 28, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.345 Vali Acc: 0.856 Test Loss: 0.345 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 29 cost time: 1.6410505771636963
Epoch: 29, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.355 Vali Acc: 0.856 Test Loss: 0.355 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.731987476348877
Epoch: 30, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.354 Vali Acc: 0.856 Test Loss: 0.354 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1493217945098877
Epoch: 31, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0108704566955566
Epoch: 32, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.414 Vali Acc: 0.856 Test Loss: 0.414 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8430020809173584
Epoch: 33, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.399 Vali Acc: 0.800 Test Loss: 0.399 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.347735643386841
Epoch: 34, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8083205223083496
Epoch: 35, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.9660663604736328
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.373 Vali Acc: 0.844 Test Loss: 0.373 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.0602667331695557
Epoch: 37, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866662).  Saving model ...
Epoch: 38 cost time: 1.9835472106933594
Epoch: 38, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9205870628356934
Epoch: 39, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0630149841308594
Epoch: 40, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.9723448753356934
Epoch: 41, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.378 Vali Acc: 0.856 Test Loss: 0.378 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.010173797607422
Epoch: 42, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.401 Vali Acc: 0.844 Test Loss: 0.401 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.1326634883880615
Epoch: 43, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.587456464767456
Epoch: 44, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.457 Vali Acc: 0.861 Test Loss: 0.457 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.659212589263916
Epoch: 45, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.459 Vali Acc: 0.811 Test Loss: 0.459 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.750535011291504
Epoch: 46, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 47 cost time: 2.2408623695373535
Epoch: 47, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.379 Vali Acc: 0.878 Test Loss: 0.379 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877774).  Saving model ...
Epoch: 48 cost time: 2.471703290939331
Epoch: 48, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.2005703449249268
Epoch: 49, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.679534435272217
Epoch: 50, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.406 Vali Acc: 0.839 Test Loss: 0.406 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.844561815261841
Epoch: 51, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.411 Vali Acc: 0.883 Test Loss: 0.411 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 52 cost time: 2.5366244316101074
Epoch: 52, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.430 Vali Acc: 0.878 Test Loss: 0.430 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.3450400829315186
Epoch: 53, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.3301448822021484
Epoch: 54, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.414 Vali Acc: 0.872 Test Loss: 0.414 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.174415349960327
Epoch: 55, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.403 Vali Acc: 0.861 Test Loss: 0.403 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.8510949611663818
Epoch: 56, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.433 Vali Acc: 0.872 Test Loss: 0.433 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.6298093795776367
Epoch: 57, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 2.2535908222198486
Epoch: 58, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.436 Vali Acc: 0.867 Test Loss: 0.436 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.1433701515197754
Epoch: 59, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 2.055192232131958
Epoch: 60, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.404 Vali Acc: 0.878 Test Loss: 0.404 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.8969049453735352
Epoch: 61, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 195830
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.496147155761719
Epoch: 1, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.834 Vali Acc: 0.100 Test Loss: 1.834 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 1.8558435440063477
Epoch: 2, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.767 Vali Acc: 0.178 Test Loss: 1.767 Test Acc: 0.178
Validation loss decreased (-0.099982 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 1.7707264423370361
Epoch: 3, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.660 Vali Acc: 0.372 Test Loss: 1.660 Test Acc: 0.372
Validation loss decreased (-0.177760 --> -0.372206).  Saving model ...
Epoch: 4 cost time: 2.1574325561523438
Epoch: 4, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.551 Vali Acc: 0.456 Test Loss: 1.551 Test Acc: 0.456
Validation loss decreased (-0.372206 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 1.8696198463439941
Epoch: 5, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.402 Vali Acc: 0.539 Test Loss: 1.402 Test Acc: 0.539
Validation loss decreased (-0.455540 --> -0.538875).  Saving model ...
Epoch: 6 cost time: 1.7457432746887207
Epoch: 6, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.210 Vali Acc: 0.617 Test Loss: 1.210 Test Acc: 0.617
Validation loss decreased (-0.538875 --> -0.616655).  Saving model ...
Epoch: 7 cost time: 2.1699275970458984
Epoch: 7, Steps: 12 | Train Loss: 1.117 Vali Loss: 0.986 Vali Acc: 0.722 Test Loss: 0.986 Test Acc: 0.722
Validation loss decreased (-0.616655 --> -0.722212).  Saving model ...
Epoch: 8 cost time: 2.984863519668579
Epoch: 8, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.834 Vali Acc: 0.706 Test Loss: 0.834 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.020106792449951
Epoch: 9, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.704 Vali Acc: 0.733 Test Loss: 0.704 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733326).  Saving model ...
Epoch: 10 cost time: 1.7625946998596191
Epoch: 10, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.628 Vali Acc: 0.767 Test Loss: 0.628 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766660).  Saving model ...
Epoch: 11 cost time: 1.8732259273529053
Epoch: 11, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.563 Vali Acc: 0.750 Test Loss: 0.563 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0528857707977295
Epoch: 12, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.513 Vali Acc: 0.767 Test Loss: 0.513 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766662).  Saving model ...
Epoch: 13 cost time: 1.8277003765106201
Epoch: 13, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.472 Vali Acc: 0.811 Test Loss: 0.472 Test Acc: 0.811
Validation loss decreased (-0.766662 --> -0.811106).  Saving model ...
Epoch: 14 cost time: 2.428833246231079
Epoch: 14, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.443 Vali Acc: 0.811 Test Loss: 0.443 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 2.1089234352111816
Epoch: 15, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.412 Vali Acc: 0.839 Test Loss: 0.412 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 2.1359713077545166
Epoch: 16, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 2.4768788814544678
Epoch: 17, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 2.1729800701141357
Epoch: 18, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3460865020751953
Epoch: 19, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7617661952972412
Epoch: 20, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3860628604888916
Epoch: 21, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.523221015930176
Epoch: 22, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 2.106563091278076
Epoch: 23, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1387531757354736
Epoch: 24, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.49674916267395
Epoch: 25, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1997854709625244
Epoch: 26, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.4324653148651123
Epoch: 27, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 1.9040534496307373
Epoch: 28, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7576324939727783
Epoch: 29, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.344 Vali Acc: 0.850 Test Loss: 0.344 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3461906909942627
Epoch: 30, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8878452777862549
Epoch: 31, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.855452299118042
Epoch: 32, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 33 cost time: 2.2191147804260254
Epoch: 33, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.3601479530334473
Epoch: 34, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 35 cost time: 1.7990117073059082
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 36 cost time: 2.071107864379883
Epoch: 36, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.3493621349334717
Epoch: 37, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.563460111618042
Epoch: 38, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.7492823600769043
Epoch: 39, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.1995620727539062
Epoch: 40, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.175999164581299
Epoch: 41, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.068228006362915
Epoch: 42, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.341 Vali Acc: 0.856 Test Loss: 0.341 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.333475112915039
Epoch: 43, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.319 Vali Acc: 0.878 Test Loss: 0.319 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.9179716110229492
Epoch: 44, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.365 Vali Acc: 0.856 Test Loss: 0.365 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.1309754848480225
Epoch: 45, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 195510
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.58237886428833
Epoch: 1, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.840 Vali Acc: 0.072 Test Loss: 1.840 Test Acc: 0.072
Validation loss decreased (inf --> -0.072204).  Saving model ...
Epoch: 2 cost time: 2.4205963611602783
Epoch: 2, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.763 Vali Acc: 0.161 Test Loss: 1.763 Test Acc: 0.161
Validation loss decreased (-0.072204 --> -0.161093).  Saving model ...
Epoch: 3 cost time: 2.123073101043701
Epoch: 3, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.636 Vali Acc: 0.411 Test Loss: 1.636 Test Acc: 0.411
Validation loss decreased (-0.161093 --> -0.411095).  Saving model ...
Epoch: 4 cost time: 1.975301742553711
Epoch: 4, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.496 Vali Acc: 0.539 Test Loss: 1.496 Test Acc: 0.539
Validation loss decreased (-0.411095 --> -0.538874).  Saving model ...
Epoch: 5 cost time: 1.600743293762207
Epoch: 5, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.324 Vali Acc: 0.578 Test Loss: 1.324 Test Acc: 0.578
Validation loss decreased (-0.538874 --> -0.577765).  Saving model ...
Epoch: 6 cost time: 1.8575351238250732
Epoch: 6, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.123 Vali Acc: 0.667 Test Loss: 1.123 Test Acc: 0.667
Validation loss decreased (-0.577765 --> -0.666655).  Saving model ...
Epoch: 7 cost time: 1.9670910835266113
Epoch: 7, Steps: 12 | Train Loss: 1.092 Vali Loss: 0.958 Vali Acc: 0.667 Test Loss: 0.958 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 2.344146966934204
Epoch: 8, Steps: 12 | Train Loss: 0.888 Vali Loss: 0.808 Vali Acc: 0.728 Test Loss: 0.808 Test Acc: 0.728
Validation loss decreased (-0.666657 --> -0.727770).  Saving model ...
Epoch: 9 cost time: 1.7896947860717773
Epoch: 9, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.684 Vali Acc: 0.756 Test Loss: 0.684 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 1.818061351776123
Epoch: 10, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.598 Vali Acc: 0.772 Test Loss: 0.598 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772216).  Saving model ...
Epoch: 11 cost time: 1.6333847045898438
Epoch: 11, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.539 Vali Acc: 0.772 Test Loss: 0.539 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772217).  Saving model ...
Epoch: 12 cost time: 1.9098620414733887
Epoch: 12, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.500 Vali Acc: 0.822 Test Loss: 0.500 Test Acc: 0.822
Validation loss decreased (-0.772217 --> -0.822217).  Saving model ...
Epoch: 13 cost time: 1.8939743041992188
Epoch: 13, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.480 Vali Acc: 0.800 Test Loss: 0.480 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0084118843078613
Epoch: 14, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844440).  Saving model ...
Epoch: 15 cost time: 1.9424011707305908
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.416 Vali Acc: 0.872 Test Loss: 0.416 Test Acc: 0.872
Validation loss decreased (-0.844440 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 1.8372375965118408
Epoch: 16, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.377 Vali Acc: 0.856 Test Loss: 0.377 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.074831247329712
Epoch: 17, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.397 Vali Acc: 0.839 Test Loss: 0.397 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6800494194030762
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8251886367797852
Epoch: 19, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.379 Vali Acc: 0.872 Test Loss: 0.379 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 20 cost time: 1.6517775058746338
Epoch: 20, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3768107891082764
Epoch: 21, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.319 Vali Acc: 0.878 Test Loss: 0.319 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 2.047717809677124
Epoch: 22, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 2.2087106704711914
Epoch: 23, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.355 Vali Acc: 0.861 Test Loss: 0.355 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1201934814453125
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.302 Vali Acc: 0.883 Test Loss: 0.302 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.110023021697998
Epoch: 25, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.9417572021484375
Epoch: 26, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.354806661605835
Epoch: 27, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9895470142364502
Epoch: 28, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2191977500915527
Epoch: 29, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.4134793281555176
Epoch: 30, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7874932289123535
Epoch: 31, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.2600483894348145
Epoch: 32, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.251312255859375
Epoch: 33, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.854660987854004
Epoch: 34, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.2061188220977783
Epoch: 35, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.330 Vali Acc: 0.894 Test Loss: 0.330 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 195190
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8949520587921143
Epoch: 1, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.728 Vali Acc: 0.267 Test Loss: 1.728 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 2.452894926071167
Epoch: 2, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.664 Vali Acc: 0.272 Test Loss: 1.664 Test Acc: 0.272
Validation loss decreased (-0.266649 --> -0.272206).  Saving model ...
Epoch: 3 cost time: 2.6262543201446533
Epoch: 3, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.561 Vali Acc: 0.461 Test Loss: 1.561 Test Acc: 0.461
Validation loss decreased (-0.272206 --> -0.461096).  Saving model ...
Epoch: 4 cost time: 2.3361799716949463
Epoch: 4, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.444 Vali Acc: 0.594 Test Loss: 1.444 Test Acc: 0.594
Validation loss decreased (-0.461096 --> -0.594430).  Saving model ...
Epoch: 5 cost time: 1.833404779434204
Epoch: 5, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.305 Vali Acc: 0.600 Test Loss: 1.305 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 2.3343706130981445
Epoch: 6, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.119 Vali Acc: 0.706 Test Loss: 1.119 Test Acc: 0.706
Validation loss decreased (-0.599987 --> -0.705544).  Saving model ...
Epoch: 7 cost time: 1.862076997756958
Epoch: 7, Steps: 12 | Train Loss: 1.114 Vali Loss: 0.947 Vali Acc: 0.689 Test Loss: 0.947 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.091686487197876
Epoch: 8, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.805 Vali Acc: 0.728 Test Loss: 0.805 Test Acc: 0.728
Validation loss decreased (-0.705544 --> -0.727770).  Saving model ...
Epoch: 9 cost time: 2.1376399993896484
Epoch: 9, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.702 Vali Acc: 0.711 Test Loss: 0.702 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8896915912628174
Epoch: 10, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.623 Vali Acc: 0.728 Test Loss: 0.623 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727772).  Saving model ...
Epoch: 11 cost time: 1.5125863552093506
Epoch: 11, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.560 Vali Acc: 0.778 Test Loss: 0.560 Test Acc: 0.778
Validation loss decreased (-0.727772 --> -0.777772).  Saving model ...
Epoch: 12 cost time: 1.820117473602295
Epoch: 12, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 13 cost time: 1.5581002235412598
Epoch: 13, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822217).  Saving model ...
Epoch: 14 cost time: 1.8360605239868164
Epoch: 14, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.441 Vali Acc: 0.806 Test Loss: 0.441 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9316096305847168
Epoch: 15, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.400 Vali Acc: 0.839 Test Loss: 0.400 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 1.8982913494110107
Epoch: 16, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.418 Vali Acc: 0.817 Test Loss: 0.418 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0062544345855713
Epoch: 17, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 2.0285232067108154
Epoch: 18, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.421 Vali Acc: 0.839 Test Loss: 0.421 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.954411506652832
Epoch: 19, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 2.281014919281006
Epoch: 20, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877774).  Saving model ...
Epoch: 21 cost time: 2.0722126960754395
Epoch: 21, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.327 Vali Acc: 0.878 Test Loss: 0.327 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 1.8851430416107178
Epoch: 22, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 2.137079954147339
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0095763206481934
Epoch: 24, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 25 cost time: 1.995255470275879
Epoch: 25, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9865632057189941
Epoch: 26, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3599371910095215
Epoch: 27, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2067010402679443
Epoch: 28, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.989253520965576
Epoch: 29, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.113992214202881
Epoch: 30, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.4397451877593994
Epoch: 31, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.306945323944092
Epoch: 32, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.6449689865112305
Epoch: 33, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.1586339473724365
Epoch: 34, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 194870
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.640715599060059
Epoch: 1, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.533 Vali Acc: 0.367 Test Loss: 1.533 Test Acc: 0.367
Validation loss decreased (inf --> -0.366651).  Saving model ...
Epoch: 2 cost time: 2.4294514656066895
Epoch: 2, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.133 Vali Acc: 0.511 Test Loss: 1.133 Test Acc: 0.511
Validation loss decreased (-0.366651 --> -0.511100).  Saving model ...
Epoch: 3 cost time: 2.5436229705810547
Epoch: 3, Steps: 12 | Train Loss: 0.866 Vali Loss: 0.702 Vali Acc: 0.683 Test Loss: 0.702 Test Acc: 0.683
Validation loss decreased (-0.511100 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 2.5494534969329834
Epoch: 4, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.519 Vali Acc: 0.744 Test Loss: 0.519 Test Acc: 0.744
Validation loss decreased (-0.683326 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 2.6568806171417236
Epoch: 5, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.520 Vali Acc: 0.761 Test Loss: 0.520 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 2.5453412532806396
Epoch: 6, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.776 Vali Acc: 0.761 Test Loss: 0.776 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2550060749053955
Epoch: 7, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.728 Vali Acc: 0.789 Test Loss: 0.728 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788882).  Saving model ...
Epoch: 8 cost time: 2.4436392784118652
Epoch: 8, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788883).  Saving model ...
Epoch: 9 cost time: 2.243506908416748
Epoch: 9, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.372 Vali Acc: 0.839 Test Loss: 0.372 Test Acc: 0.839
Validation loss decreased (-0.788883 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 2.0101165771484375
Epoch: 10, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.472 Vali Acc: 0.839 Test Loss: 0.472 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1553657054901123
Epoch: 11, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.501 Vali Acc: 0.839 Test Loss: 0.501 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.12835431098938
Epoch: 12, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 2.125816583633423
Epoch: 13, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.963 Vali Acc: 0.800 Test Loss: 0.963 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7665328979492188
Epoch: 14, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3881468772888184
Epoch: 15, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855551).  Saving model ...
Epoch: 16 cost time: 2.2104361057281494
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.051149368286133
Epoch: 17, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.948 Vali Acc: 0.817 Test Loss: 0.948 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7324790954589844
Epoch: 18, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.718 Vali Acc: 0.817 Test Loss: 0.718 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3044185638427734
Epoch: 19, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.765 Vali Acc: 0.844 Test Loss: 0.765 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6201114654541016
Epoch: 20, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.281501054763794
Epoch: 21, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
Validation loss decreased (-0.855551 --> -0.883328).  Saving model ...
Epoch: 22 cost time: 1.651545763015747
Epoch: 22, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8091740608215332
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1567811965942383
Epoch: 24, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6199216842651367
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8496241569519043
Epoch: 26, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.843 Vali Acc: 0.856 Test Loss: 0.843 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7275841236114502
Epoch: 27, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.673 Vali Acc: 0.839 Test Loss: 0.673 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.3791537284851074
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.796 Vali Acc: 0.850 Test Loss: 0.796 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.8352293968200684
Epoch: 29, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.928295373916626
Epoch: 30, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.795 Vali Acc: 0.861 Test Loss: 0.795 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.29292893409729
Epoch: 31, Steps: 12 | Train Loss: 0.205 Vali Loss: 1.319 Vali Acc: 0.828 Test Loss: 1.319 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 8068906
model size : 35.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.657783269882202
Epoch: 1, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.387 Vali Acc: 0.550 Test Loss: 1.387 Test Acc: 0.550
Validation loss decreased (inf --> -0.549986).  Saving model ...
Epoch: 2 cost time: 2.3987579345703125
Epoch: 2, Steps: 12 | Train Loss: 1.175 Vali Loss: 0.997 Vali Acc: 0.650 Test Loss: 0.997 Test Acc: 0.650
Validation loss decreased (-0.549986 --> -0.649990).  Saving model ...
Epoch: 3 cost time: 2.1687839031219482
Epoch: 3, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.907 Vali Acc: 0.694 Test Loss: 0.907 Test Acc: 0.694
Validation loss decreased (-0.649990 --> -0.694435).  Saving model ...
Epoch: 4 cost time: 2.058800458908081
Epoch: 4, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.686 Vali Acc: 0.756 Test Loss: 0.686 Test Acc: 0.756
Validation loss decreased (-0.694435 --> -0.755549).  Saving model ...
Epoch: 5 cost time: 2.3429911136627197
Epoch: 5, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.849 Vali Acc: 0.739 Test Loss: 0.849 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.224865198135376
Epoch: 6, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.497 Vali Acc: 0.772 Test Loss: 0.497 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 2.34877872467041
Epoch: 7, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.421 Vali Acc: 0.811 Test Loss: 0.421 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 2.5139951705932617
Epoch: 8, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.516 Vali Acc: 0.794 Test Loss: 0.516 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2720415592193604
Epoch: 9, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.48952317237854
Epoch: 10, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.792 Vali Acc: 0.811 Test Loss: 0.792 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.225461006164551
Epoch: 11, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.796 Vali Acc: 0.828 Test Loss: 0.796 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827770).  Saving model ...
Epoch: 12 cost time: 2.4126498699188232
Epoch: 12, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827772).  Saving model ...
Epoch: 13 cost time: 2.3981223106384277
Epoch: 13, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
Validation loss decreased (-0.827772 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 2.4615471363067627
Epoch: 14, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.387 Vali Acc: 0.878 Test Loss: 0.387 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 2.2049171924591064
Epoch: 15, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1297929286956787
Epoch: 16, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1420061588287354
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.745 Vali Acc: 0.806 Test Loss: 0.745 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.758781909942627
Epoch: 18, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.510 Vali Acc: 0.878 Test Loss: 0.510 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.026625871658325
Epoch: 19, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.671 Vali Acc: 0.822 Test Loss: 0.671 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.184725284576416
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.752 Vali Acc: 0.833 Test Loss: 0.752 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.050774335861206
Epoch: 21, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.992 Vali Acc: 0.806 Test Loss: 0.992 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0470664501190186
Epoch: 22, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.097130537033081
Epoch: 23, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1663691997528076
Epoch: 24, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 8066858
model size : 35.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5169901847839355
Epoch: 1, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.657 Vali Acc: 0.406 Test Loss: 1.657 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 2.065392255783081
Epoch: 2, Steps: 12 | Train Loss: 1.222 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
Validation loss decreased (-0.405539 --> -0.749992).  Saving model ...
Epoch: 3 cost time: 1.9292490482330322
Epoch: 3, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.573 Vali Acc: 0.744 Test Loss: 0.573 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.141958475112915
Epoch: 4, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.665 Vali Acc: 0.728 Test Loss: 0.665 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8463330268859863
Epoch: 5, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.769 Vali Acc: 0.728 Test Loss: 0.769 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2342357635498047
Epoch: 6, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.448 Vali Acc: 0.806 Test Loss: 0.448 Test Acc: 0.806
Validation loss decreased (-0.749992 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 2.1586368083953857
Epoch: 7, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 2.209144353866577
Epoch: 8, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.8097529411315918
Epoch: 9, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.371 Vali Acc: 0.856 Test Loss: 0.371 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 2.1273324489593506
Epoch: 10, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3731329441070557
Epoch: 11, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.855552 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 2.0751118659973145
Epoch: 12, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.280435800552368
Epoch: 13, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.366818904876709
Epoch: 14, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0945353507995605
Epoch: 15, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0842103958129883
Epoch: 16, Steps: 12 | Train Loss: 0.264 Vali Loss: 1.046 Vali Acc: 0.806 Test Loss: 1.046 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.880185842514038
Epoch: 17, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.083024024963379
Epoch: 18, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.713 Vali Acc: 0.856 Test Loss: 0.713 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9533259868621826
Epoch: 19, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7116336822509766
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5897841453552246
Epoch: 21, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 8064810
model size : 35.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.395769357681274
Epoch: 1, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.566 Vali Acc: 0.211 Test Loss: 1.566 Test Acc: 0.211
Validation loss decreased (inf --> -0.211095).  Saving model ...
Epoch: 2 cost time: 2.4034764766693115
Epoch: 2, Steps: 12 | Train Loss: 1.256 Vali Loss: 0.988 Vali Acc: 0.578 Test Loss: 0.988 Test Acc: 0.578
Validation loss decreased (-0.211095 --> -0.577768).  Saving model ...
Epoch: 3 cost time: 2.0216333866119385
Epoch: 3, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
Validation loss decreased (-0.577768 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 2.131744146347046
Epoch: 4, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.994 Vali Acc: 0.678 Test Loss: 0.994 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1285817623138428
Epoch: 5, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.729 Vali Acc: 0.706 Test Loss: 0.729 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9642326831817627
Epoch: 6, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
Validation loss decreased (-0.716660 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 2.0724525451660156
Epoch: 7, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.736 Vali Acc: 0.800 Test Loss: 0.736 Test Acc: 0.800
Validation loss decreased (-0.761105 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 1.800462245941162
Epoch: 8, Steps: 12 | Train Loss: 0.569 Vali Loss: 1.021 Vali Acc: 0.800 Test Loss: 1.021 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.283437967300415
Epoch: 9, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.513 Vali Acc: 0.811 Test Loss: 0.513 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811106).  Saving model ...
Epoch: 10 cost time: 2.3584747314453125
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.639 Vali Acc: 0.811 Test Loss: 0.639 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.278660774230957
Epoch: 11, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.811106 --> -0.844439).  Saving model ...
Epoch: 12 cost time: 1.6451950073242188
Epoch: 12, Steps: 12 | Train Loss: 0.289 Vali Loss: 1.022 Vali Acc: 0.772 Test Loss: 1.022 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1345973014831543
Epoch: 13, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.921 Vali Acc: 0.811 Test Loss: 0.921 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0190112590789795
Epoch: 14, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.468 Vali Acc: 0.839 Test Loss: 0.468 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8085660934448242
Epoch: 15, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
Validation loss decreased (-0.844439 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.655139446258545
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.436 Vali Acc: 0.856 Test Loss: 0.436 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9291059970855713
Epoch: 17, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.436 Vali Acc: 0.867 Test Loss: 0.436 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.019437074661255
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8068277835845947
Epoch: 19, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.418 Vali Acc: 0.856 Test Loss: 0.418 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8145828247070312
Epoch: 20, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.37161922454834
Epoch: 21, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5248162746429443
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.126 Vali Acc: 0.800 Test Loss: 1.126 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.1178395748138428
Epoch: 23, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.680 Vali Acc: 0.844 Test Loss: 0.680 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9112145900726318
Epoch: 24, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.975 Vali Acc: 0.794 Test Loss: 0.975 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.3717403411865234
Epoch: 25, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.847 Vali Acc: 0.800 Test Loss: 0.847 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 8062762
model size : 35.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.750889778137207
Epoch: 1, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.493 Vali Acc: 0.356 Test Loss: 1.493 Test Acc: 0.356
Validation loss decreased (inf --> -0.355541).  Saving model ...
Epoch: 2 cost time: 2.2839531898498535
Epoch: 2, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.041 Vali Acc: 0.611 Test Loss: 1.041 Test Acc: 0.611
Validation loss decreased (-0.355541 --> -0.611101).  Saving model ...
Epoch: 3 cost time: 1.898728609085083
Epoch: 3, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.714 Vali Acc: 0.722 Test Loss: 0.714 Test Acc: 0.722
Validation loss decreased (-0.611101 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 2.372028350830078
Epoch: 4, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 1.9578454494476318
Epoch: 5, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.804 Vali Acc: 0.728 Test Loss: 0.804 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727770).  Saving model ...
Epoch: 6 cost time: 1.9818081855773926
Epoch: 6, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.727770 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 2.256218194961548
Epoch: 7, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.583 Vali Acc: 0.794 Test Loss: 0.583 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794439).  Saving model ...
Epoch: 8 cost time: 1.7895500659942627
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.963 Vali Acc: 0.739 Test Loss: 0.963 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3493473529815674
Epoch: 9, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.893 Vali Acc: 0.806 Test Loss: 0.893 Test Acc: 0.806
Validation loss decreased (-0.794439 --> -0.805547).  Saving model ...
Epoch: 10 cost time: 1.6709434986114502
Epoch: 10, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.622 Vali Acc: 0.806 Test Loss: 0.622 Test Acc: 0.806
Validation loss decreased (-0.805547 --> -0.805549).  Saving model ...
Epoch: 11 cost time: 1.996603012084961
Epoch: 11, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.805549 --> -0.844439).  Saving model ...
Epoch: 12 cost time: 2.398348331451416
Epoch: 12, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.419 Vali Acc: 0.867 Test Loss: 0.419 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866662).  Saving model ...
Epoch: 13 cost time: 1.9626574516296387
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.429910659790039
Epoch: 14, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.174522638320923
Epoch: 15, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0432958602905273
Epoch: 16, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4294755458831787
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.583 Vali Acc: 0.839 Test Loss: 0.583 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.497044324874878
Epoch: 18, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3812081813812256
Epoch: 19, Steps: 12 | Train Loss: 0.453 Vali Loss: 1.154 Vali Acc: 0.800 Test Loss: 1.154 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.4356770515441895
Epoch: 20, Steps: 12 | Train Loss: 0.511 Vali Loss: 1.048 Vali Acc: 0.794 Test Loss: 1.048 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4933743476867676
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.768 Vali Acc: 0.822 Test Loss: 0.768 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.384401559829712
Epoch: 22, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.691 Vali Acc: 0.833 Test Loss: 0.691 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 6755626
model size : 30.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.328226089477539
Epoch: 1, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.453 Vali Acc: 0.411 Test Loss: 1.453 Test Acc: 0.411
Validation loss decreased (inf --> -0.411097).  Saving model ...
Epoch: 2 cost time: 2.3917572498321533
Epoch: 2, Steps: 12 | Train Loss: 1.268 Vali Loss: 0.940 Vali Acc: 0.633 Test Loss: 0.940 Test Acc: 0.633
Validation loss decreased (-0.411097 --> -0.633324).  Saving model ...
Epoch: 3 cost time: 2.5449790954589844
Epoch: 3, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.854 Vali Acc: 0.661 Test Loss: 0.854 Test Acc: 0.661
Validation loss decreased (-0.633324 --> -0.661103).  Saving model ...
Epoch: 4 cost time: 1.8584046363830566
Epoch: 4, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
Validation loss decreased (-0.661103 --> -0.722217).  Saving model ...
Epoch: 5 cost time: 1.3544063568115234
Epoch: 5, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.722217 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.8240842819213867
Epoch: 6, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.782 Vali Acc: 0.694 Test Loss: 0.782 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8960464000701904
Epoch: 7, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.439 Vali Acc: 0.811 Test Loss: 0.439 Test Acc: 0.811
Validation loss decreased (-0.749994 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 2.3761377334594727
Epoch: 8, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.561065435409546
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.367 Vali Acc: 0.861 Test Loss: 0.367 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861107).  Saving model ...
Epoch: 10 cost time: 1.7050116062164307
Epoch: 10, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.503 Vali Acc: 0.828 Test Loss: 0.503 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9539198875427246
Epoch: 11, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3752501010894775
Epoch: 12, Steps: 12 | Train Loss: 0.277 Vali Loss: 1.100 Vali Acc: 0.800 Test Loss: 1.100 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.746957778930664
Epoch: 13, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.811 Vali Acc: 0.839 Test Loss: 0.811 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.404777765274048
Epoch: 14, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.35918927192688
Epoch: 15, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.834 Vali Acc: 0.839 Test Loss: 0.834 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.119354724884033
Epoch: 16, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.693 Vali Acc: 0.844 Test Loss: 0.693 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3675644397735596
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2964863777160645
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 1.052 Vali Acc: 0.833 Test Loss: 1.052 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0016074180603027
Epoch: 19, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 6753578
model size : 30.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.82340145111084
Epoch: 1, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.425 Vali Acc: 0.583 Test Loss: 1.425 Test Acc: 0.583
Validation loss decreased (inf --> -0.583319).  Saving model ...
Epoch: 2 cost time: 1.654353141784668
Epoch: 2, Steps: 12 | Train Loss: 1.159 Vali Loss: 0.942 Vali Acc: 0.633 Test Loss: 0.942 Test Acc: 0.633
Validation loss decreased (-0.583319 --> -0.633324).  Saving model ...
Epoch: 3 cost time: 1.6408236026763916
Epoch: 3, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.796 Vali Acc: 0.617 Test Loss: 0.796 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.677802324295044
Epoch: 4, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.613 Vali Acc: 0.739 Test Loss: 0.613 Test Acc: 0.739
Validation loss decreased (-0.633324 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 1.6770868301391602
Epoch: 5, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.828 Vali Acc: 0.744 Test Loss: 0.828 Test Acc: 0.744
Validation loss decreased (-0.738883 --> -0.744436).  Saving model ...
Epoch: 6 cost time: 1.766399621963501
Epoch: 6, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.559 Vali Acc: 0.806 Test Loss: 0.559 Test Acc: 0.806
Validation loss decreased (-0.744436 --> -0.805550).  Saving model ...
Epoch: 7 cost time: 1.8624584674835205
Epoch: 7, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0719716548919678
Epoch: 8, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
Validation loss decreased (-0.805550 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 1.7728002071380615
Epoch: 9, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5158398151397705
Epoch: 10, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.067 Vali Acc: 0.789 Test Loss: 1.067 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.262065887451172
Epoch: 11, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.345667839050293
Epoch: 12, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.731 Vali Acc: 0.817 Test Loss: 0.731 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2919726371765137
Epoch: 13, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1648454666137695
Epoch: 14, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6392040252685547
Epoch: 15, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.177910566329956
Epoch: 16, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855550).  Saving model ...
Epoch: 17 cost time: 2.139721632003784
Epoch: 17, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.284677505493164
Epoch: 18, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
Validation loss decreased (-0.855550 --> -0.877773).  Saving model ...
Epoch: 19 cost time: 2.173978328704834
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0371904373168945
Epoch: 20, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.849 Vali Acc: 0.822 Test Loss: 0.849 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1372129917144775
Epoch: 21, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.310 Vali Acc: 0.806 Test Loss: 1.310 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.095188617706299
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.802 Vali Acc: 0.844 Test Loss: 0.802 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9651737213134766
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.247 Vali Acc: 0.839 Test Loss: 1.247 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9724805355072021
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.960 Vali Acc: 0.850 Test Loss: 0.960 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0122313499450684
Epoch: 25, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.626448392868042
Epoch: 26, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.992 Vali Acc: 0.783 Test Loss: 0.992 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.6556591987609863
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.226 Vali Acc: 0.767 Test Loss: 1.226 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8769123554229736
Epoch: 28, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.935 Vali Acc: 0.833 Test Loss: 0.935 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 6751530
model size : 30.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.289947509765625
Epoch: 1, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.450 Vali Acc: 0.472 Test Loss: 1.450 Test Acc: 0.472
Validation loss decreased (inf --> -0.472208).  Saving model ...
Epoch: 2 cost time: 2.1661128997802734
Epoch: 2, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.122 Vali Acc: 0.628 Test Loss: 1.122 Test Acc: 0.628
Validation loss decreased (-0.472208 --> -0.627767).  Saving model ...
Epoch: 3 cost time: 2.038452625274658
Epoch: 3, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.654 Vali Acc: 0.711 Test Loss: 0.654 Test Acc: 0.711
Validation loss decreased (-0.627767 --> -0.711105).  Saving model ...
Epoch: 4 cost time: 2.0941569805145264
Epoch: 4, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.974 Vali Acc: 0.650 Test Loss: 0.974 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3495032787323
Epoch: 5, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.584 Vali Acc: 0.761 Test Loss: 0.584 Test Acc: 0.761
Validation loss decreased (-0.711105 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 2.2262656688690186
Epoch: 6, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.597 Vali Acc: 0.756 Test Loss: 0.597 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3686110973358154
Epoch: 7, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.415 Vali Acc: 0.817 Test Loss: 0.415 Test Acc: 0.817
Validation loss decreased (-0.761105 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 2.3207077980041504
Epoch: 8, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.599 Vali Acc: 0.778 Test Loss: 0.599 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.223282814025879
Epoch: 9, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.676 Vali Acc: 0.778 Test Loss: 0.676 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2852423191070557
Epoch: 10, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.910 Vali Acc: 0.783 Test Loss: 0.910 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0573692321777344
Epoch: 11, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.781 Vali Acc: 0.794 Test Loss: 0.781 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9788904190063477
Epoch: 12, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.850 Vali Acc: 0.783 Test Loss: 0.850 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4713222980499268
Epoch: 13, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.663 Vali Acc: 0.817 Test Loss: 0.663 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2619211673736572
Epoch: 14, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.801 Vali Acc: 0.811 Test Loss: 0.801 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3539958000183105
Epoch: 15, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 2.032927989959717
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8354406356811523
Epoch: 17, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.630 Vali Acc: 0.817 Test Loss: 0.630 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.012902021408081
Epoch: 18, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861106).  Saving model ...
Epoch: 19 cost time: 1.6698706150054932
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.686 Vali Acc: 0.839 Test Loss: 0.686 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.532578468322754
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 21 cost time: 1.4688467979431152
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.441530466079712
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.649 Vali Acc: 0.839 Test Loss: 0.649 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7314393520355225
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.743 Vali Acc: 0.844 Test Loss: 0.743 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7787446975708008
Epoch: 24, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.708 Vali Acc: 0.828 Test Loss: 0.708 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.95815110206604
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.155052900314331
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.040 Vali Acc: 0.822 Test Loss: 1.040 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.1561696529388428
Epoch: 27, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.798 Vali Acc: 0.850 Test Loss: 0.798 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.091538429260254
Epoch: 28, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.728 Vali Acc: 0.856 Test Loss: 0.728 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.5690150260925293
Epoch: 29, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.266810417175293
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.696 Vali Acc: 0.833 Test Loss: 0.696 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 6749482
model size : 30.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.248350143432617
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.548 Vali Acc: 0.417 Test Loss: 1.548 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 2.0099756717681885
Epoch: 2, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.059 Vali Acc: 0.661 Test Loss: 1.059 Test Acc: 0.661
Validation loss decreased (-0.416651 --> -0.661101).  Saving model ...
Epoch: 3 cost time: 2.511329412460327
Epoch: 3, Steps: 12 | Train Loss: 0.826 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
Validation loss decreased (-0.661101 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 2.402435541152954
Epoch: 4, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.741 Vali Acc: 0.744 Test Loss: 0.741 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 2.038544178009033
Epoch: 5, Steps: 12 | Train Loss: 0.779 Vali Loss: 1.431 Vali Acc: 0.722 Test Loss: 1.431 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.252346992492676
Epoch: 6, Steps: 12 | Train Loss: 0.886 Vali Loss: 0.487 Vali Acc: 0.772 Test Loss: 0.487 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 2.2514736652374268
Epoch: 7, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
Validation loss decreased (-0.772217 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.5320746898651123
Epoch: 8, Steps: 12 | Train Loss: 0.313 Vali Loss: 1.025 Vali Acc: 0.783 Test Loss: 1.025 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.36323881149292
Epoch: 9, Steps: 12 | Train Loss: 0.857 Vali Loss: 0.518 Vali Acc: 0.806 Test Loss: 0.518 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.75909423828125
Epoch: 10, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 2.3837082386016846
Epoch: 11, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.822 Vali Acc: 0.789 Test Loss: 0.822 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5559566020965576
Epoch: 12, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.402 Vali Acc: 0.867 Test Loss: 0.402 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 2.5024170875549316
Epoch: 13, Steps: 12 | Train Loss: 0.369 Vali Loss: 1.029 Vali Acc: 0.783 Test Loss: 1.029 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3905389308929443
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.188589334487915
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.950 Vali Acc: 0.783 Test Loss: 0.950 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.468250036239624
Epoch: 16, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.574 Vali Acc: 0.839 Test Loss: 0.574 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.333278179168701
Epoch: 17, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.451 Vali Acc: 0.872 Test Loss: 0.451 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872218).  Saving model ...
Epoch: 18 cost time: 2.153669595718384
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4301159381866455
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.376 Vali Acc: 0.839 Test Loss: 0.376 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7415969371795654
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3506622314453125
Epoch: 21, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.898 Vali Acc: 0.833 Test Loss: 0.898 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2464535236358643
Epoch: 22, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.852 Vali Acc: 0.817 Test Loss: 0.852 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5484979152679443
Epoch: 23, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.889 Vali Acc: 0.833 Test Loss: 0.889 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.593071937561035
Epoch: 24, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.900 Vali Acc: 0.850 Test Loss: 0.900 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.579676389694214
Epoch: 25, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.652 Vali Acc: 0.867 Test Loss: 0.652 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5682730674743652
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2817482948303223
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 6098986
model size : 28.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.264952898025513
Epoch: 1, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.527 Vali Acc: 0.289 Test Loss: 1.527 Test Acc: 0.289
Validation loss decreased (inf --> -0.288874).  Saving model ...
Epoch: 2 cost time: 2.192133903503418
Epoch: 2, Steps: 12 | Train Loss: 1.207 Vali Loss: 0.910 Vali Acc: 0.667 Test Loss: 0.910 Test Acc: 0.667
Validation loss decreased (-0.288874 --> -0.666658).  Saving model ...
Epoch: 3 cost time: 2.255197525024414
Epoch: 3, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.804 Vali Acc: 0.639 Test Loss: 0.804 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.258121967315674
Epoch: 4, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.800 Vali Acc: 0.711 Test Loss: 0.800 Test Acc: 0.711
Validation loss decreased (-0.666658 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 2.6307647228240967
Epoch: 5, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.445 Vali Acc: 0.789 Test Loss: 0.445 Test Acc: 0.789
Validation loss decreased (-0.711103 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 2.4947030544281006
Epoch: 6, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.575 Vali Acc: 0.756 Test Loss: 0.575 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6416077613830566
Epoch: 7, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.374 Vali Acc: 0.817 Test Loss: 0.374 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 2.405728816986084
Epoch: 8, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2580606937408447
Epoch: 9, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.359 Vali Acc: 0.833 Test Loss: 0.359 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.2690796852111816
Epoch: 10, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.379178762435913
Epoch: 11, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.358 Vali Acc: 0.867 Test Loss: 0.358 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 2.5552358627319336
Epoch: 12, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3255279064178467
Epoch: 13, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.603912353515625
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5080580711364746
Epoch: 15, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3777568340301514
Epoch: 16, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.608527660369873
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7761340141296387
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3903894424438477
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.414 Vali Acc: 0.878 Test Loss: 0.414 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 2.155775308609009
Epoch: 20, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.439954996109009
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.117 Vali Acc: 0.828 Test Loss: 1.117 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.527434825897217
Epoch: 22, Steps: 12 | Train Loss: 0.252 Vali Loss: 1.152 Vali Acc: 0.833 Test Loss: 1.152 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.124725341796875
Epoch: 23, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.440666913986206
Epoch: 24, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.834 Vali Acc: 0.844 Test Loss: 0.834 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.361466646194458
Epoch: 25, Steps: 12 | Train Loss: 0.236 Vali Loss: 1.109 Vali Acc: 0.856 Test Loss: 1.109 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.637756586074829
Epoch: 26, Steps: 12 | Train Loss: 0.421 Vali Loss: 1.085 Vali Acc: 0.833 Test Loss: 1.085 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.592512369155884
Epoch: 27, Steps: 12 | Train Loss: 0.470 Vali Loss: 1.035 Vali Acc: 0.822 Test Loss: 1.035 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.4546544551849365
Epoch: 28, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.233 Vali Acc: 0.828 Test Loss: 1.233 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.603039026260376
Epoch: 29, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.840 Vali Acc: 0.839 Test Loss: 0.840 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 6096938
model size : 28.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.133336782455444
Epoch: 1, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.549 Vali Acc: 0.439 Test Loss: 1.549 Test Acc: 0.439
Validation loss decreased (inf --> -0.438873).  Saving model ...
Epoch: 2 cost time: 2.1638519763946533
Epoch: 2, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.055 Vali Acc: 0.606 Test Loss: 1.055 Test Acc: 0.606
Validation loss decreased (-0.438873 --> -0.605545).  Saving model ...
Epoch: 3 cost time: 2.081383466720581
Epoch: 3, Steps: 12 | Train Loss: 0.850 Vali Loss: 0.661 Vali Acc: 0.700 Test Loss: 0.661 Test Acc: 0.700
Validation loss decreased (-0.605545 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 2.331066846847534
Epoch: 4, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (-0.699993 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 1.8057670593261719
Epoch: 5, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.755 Vali Acc: 0.750 Test Loss: 0.755 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 1.7174530029296875
Epoch: 6, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.048 Vali Acc: 0.667 Test Loss: 1.048 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4881260395050049
Epoch: 7, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.412 Vali Acc: 0.783 Test Loss: 0.412 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 1.752011775970459
Epoch: 8, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
Validation loss decreased (-0.783329 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.6892566680908203
Epoch: 9, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.475 Vali Acc: 0.828 Test Loss: 0.475 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.172332525253296
Epoch: 10, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.589 Vali Acc: 0.817 Test Loss: 0.589 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.14054274559021
Epoch: 11, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.416 Vali Acc: 0.833 Test Loss: 0.416 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.357619047164917
Epoch: 12, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.407 Vali Acc: 0.856 Test Loss: 0.407 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 1.8826074600219727
Epoch: 13, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.418 Vali Acc: 0.839 Test Loss: 0.418 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.539371967315674
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.641 Vali Acc: 0.778 Test Loss: 0.641 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8460288047790527
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.369 Vali Acc: 0.872 Test Loss: 0.369 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 2.973675012588501
Epoch: 16, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.414 Vali Acc: 0.883 Test Loss: 0.414 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883329).  Saving model ...
Epoch: 17 cost time: 1.872274398803711
Epoch: 17, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.517 Vali Acc: 0.839 Test Loss: 0.517 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8212146759033203
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6407902240753174
Epoch: 19, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.647 Vali Acc: 0.828 Test Loss: 0.647 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5735726356506348
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6919019222259521
Epoch: 21, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.258 Vali Acc: 0.822 Test Loss: 1.258 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6119894981384277
Epoch: 22, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.768 Vali Acc: 0.839 Test Loss: 0.768 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4224193096160889
Epoch: 23, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6116878986358643
Epoch: 24, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.735 Vali Acc: 0.839 Test Loss: 0.735 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5520355701446533
Epoch: 25, Steps: 12 | Train Loss: 0.215 Vali Loss: 1.232 Vali Acc: 0.772 Test Loss: 1.232 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5542964935302734
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.702 Vali Acc: 0.844 Test Loss: 0.702 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 6094890
model size : 28.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.080275058746338
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.543 Vali Acc: 0.467 Test Loss: 1.543 Test Acc: 0.467
Validation loss decreased (inf --> -0.466651).  Saving model ...
Epoch: 2 cost time: 1.6118175983428955
Epoch: 2, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.111 Vali Acc: 0.656 Test Loss: 1.111 Test Acc: 0.656
Validation loss decreased (-0.466651 --> -0.655544).  Saving model ...
Epoch: 3 cost time: 1.8378124237060547
Epoch: 3, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.696 Vali Acc: 0.650 Test Loss: 0.696 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7549734115600586
Epoch: 4, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.516 Vali Acc: 0.778 Test Loss: 0.516 Test Acc: 0.778
Validation loss decreased (-0.655544 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 1.8042142391204834
Epoch: 5, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.457 Vali Acc: 0.767 Test Loss: 0.457 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7198867797851562
Epoch: 6, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.401 Vali Acc: 0.794 Test Loss: 0.401 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.333986759185791
Epoch: 7, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.720390796661377
Epoch: 8, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.735 Vali Acc: 0.756 Test Loss: 0.735 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4943671226501465
Epoch: 9, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.851 Vali Acc: 0.789 Test Loss: 0.851 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4326012134552002
Epoch: 10, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
Validation loss decreased (-0.816663 --> -0.899997).  Saving model ...
Epoch: 11 cost time: 1.5130627155303955
Epoch: 11, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.333 Vali Acc: 0.872 Test Loss: 0.333 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.955596685409546
Epoch: 12, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6243267059326172
Epoch: 13, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.395 Vali Acc: 0.872 Test Loss: 0.395 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7783231735229492
Epoch: 14, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.007985830307007
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.981 Vali Acc: 0.811 Test Loss: 0.981 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1140007972717285
Epoch: 16, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.468 Vali Acc: 0.867 Test Loss: 0.468 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2263967990875244
Epoch: 17, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.665 Vali Acc: 0.811 Test Loss: 0.665 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3770530223846436
Epoch: 18, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.383781909942627
Epoch: 19, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.659 Vali Acc: 0.839 Test Loss: 0.659 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2168540954589844
Epoch: 20, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.600 Vali Acc: 0.861 Test Loss: 0.600 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 6092842
model size : 28.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.173727750778198
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.575 Vali Acc: 0.356 Test Loss: 1.575 Test Acc: 0.356
Validation loss decreased (inf --> -0.355540).  Saving model ...
Epoch: 2 cost time: 1.8957760334014893
Epoch: 2, Steps: 12 | Train Loss: 1.344 Vali Loss: 1.128 Vali Acc: 0.556 Test Loss: 1.128 Test Acc: 0.556
Validation loss decreased (-0.355540 --> -0.555544).  Saving model ...
Epoch: 3 cost time: 1.6744678020477295
Epoch: 3, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.996 Vali Acc: 0.628 Test Loss: 0.996 Test Acc: 0.628
Validation loss decreased (-0.555544 --> -0.627768).  Saving model ...
Epoch: 4 cost time: 1.6167876720428467
Epoch: 4, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.686 Vali Acc: 0.728 Test Loss: 0.686 Test Acc: 0.728
Validation loss decreased (-0.627768 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 2.0735998153686523
Epoch: 5, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.647 Vali Acc: 0.706 Test Loss: 0.647 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6268393993377686
Epoch: 6, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.609 Vali Acc: 0.794 Test Loss: 0.609 Test Acc: 0.794
Validation loss decreased (-0.727771 --> -0.794438).  Saving model ...
Epoch: 7 cost time: 1.6705496311187744
Epoch: 7, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.400 Vali Acc: 0.817 Test Loss: 0.400 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.9278123378753662
Epoch: 8, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.998833179473877
Epoch: 9, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.578 Vali Acc: 0.800 Test Loss: 0.578 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9085538387298584
Epoch: 10, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.359 Vali Acc: 0.872 Test Loss: 0.359 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 2.130159378051758
Epoch: 11, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.389 Vali Acc: 0.878 Test Loss: 0.389 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 1.6525168418884277
Epoch: 12, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.744 Vali Acc: 0.806 Test Loss: 0.744 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9575185775756836
Epoch: 13, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.063992738723755
Epoch: 14, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.869173288345337
Epoch: 15, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8967442512512207
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6196048259735107
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.568 Vali Acc: 0.867 Test Loss: 0.568 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.131359100341797
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.345 Vali Acc: 0.894 Test Loss: 0.345 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 1.9801640510559082
Epoch: 19, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.774 Vali Acc: 0.850 Test Loss: 0.774 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1054248809814453
Epoch: 20, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.369 Vali Acc: 0.894 Test Loss: 0.369 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.792102575302124
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.687 Vali Acc: 0.867 Test Loss: 0.687 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3257057666778564
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.942394495010376
Epoch: 23, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.681 Vali Acc: 0.861 Test Loss: 0.681 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1780788898468018
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.655 Vali Acc: 0.861 Test Loss: 0.655 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.256538152694702
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.511 Vali Acc: 0.883 Test Loss: 0.511 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7575371265411377
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.895108699798584
Epoch: 27, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.616 Vali Acc: 0.878 Test Loss: 0.616 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7546334266662598
Epoch: 28, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 5770666
model size : 27.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.947590351104736
Epoch: 1, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.616 Vali Acc: 0.528 Test Loss: 1.616 Test Acc: 0.528
Validation loss decreased (inf --> -0.527762).  Saving model ...
Epoch: 2 cost time: 2.0992953777313232
Epoch: 2, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.132 Vali Acc: 0.667 Test Loss: 1.132 Test Acc: 0.667
Validation loss decreased (-0.527762 --> -0.666655).  Saving model ...
Epoch: 3 cost time: 2.096101999282837
Epoch: 3, Steps: 12 | Train Loss: 0.999 Vali Loss: 0.718 Vali Acc: 0.706 Test Loss: 0.718 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705548).  Saving model ...
Epoch: 4 cost time: 2.0321574211120605
Epoch: 4, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.533 Vali Acc: 0.750 Test Loss: 0.533 Test Acc: 0.750
Validation loss decreased (-0.705548 --> -0.749995).  Saving model ...
Epoch: 5 cost time: 2.0201821327209473
Epoch: 5, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.604 Vali Acc: 0.756 Test Loss: 0.604 Test Acc: 0.756
Validation loss decreased (-0.749995 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 2.022726535797119
Epoch: 6, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788883).  Saving model ...
Epoch: 7 cost time: 2.016193389892578
Epoch: 7, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 1.8171231746673584
Epoch: 8, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.080 Vali Acc: 0.767 Test Loss: 1.080 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9620964527130127
Epoch: 9, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.646 Vali Acc: 0.800 Test Loss: 0.646 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 2.0141210556030273
Epoch: 10, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.508 Vali Acc: 0.817 Test Loss: 0.508 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 1.8238584995269775
Epoch: 11, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 1.7591114044189453
Epoch: 12, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.822217 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 1.978058099746704
Epoch: 13, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.335 Vali Acc: 0.872 Test Loss: 0.335 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.8463523387908936
Epoch: 14, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.393 Vali Acc: 0.867 Test Loss: 0.393 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7645213603973389
Epoch: 15, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8501026630401611
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.417 Vali Acc: 0.872 Test Loss: 0.417 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.656752347946167
Epoch: 17, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.395 Vali Acc: 0.861 Test Loss: 0.395 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6168622970581055
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.677 Vali Acc: 0.839 Test Loss: 0.677 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6529297828674316
Epoch: 19, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.797 Vali Acc: 0.822 Test Loss: 0.797 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7874059677124023
Epoch: 20, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.698 Vali Acc: 0.856 Test Loss: 0.698 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8979475498199463
Epoch: 21, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.458 Vali Acc: 0.861 Test Loss: 0.458 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.801095724105835
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6065073013305664
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.848 Vali Acc: 0.861 Test Loss: 0.848 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 5768618
model size : 27.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.502397775650024
Epoch: 1, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.452 Vali Acc: 0.472 Test Loss: 1.452 Test Acc: 0.472
Validation loss decreased (inf --> -0.472208).  Saving model ...
Epoch: 2 cost time: 1.8819506168365479
Epoch: 2, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.012 Vali Acc: 0.583 Test Loss: 1.012 Test Acc: 0.583
Validation loss decreased (-0.472208 --> -0.583323).  Saving model ...
Epoch: 3 cost time: 2.2778990268707275
Epoch: 3, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.131 Vali Acc: 0.628 Test Loss: 1.131 Test Acc: 0.628
Validation loss decreased (-0.583323 --> -0.627766).  Saving model ...
Epoch: 4 cost time: 1.7851448059082031
Epoch: 4, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.712 Vali Acc: 0.711 Test Loss: 0.712 Test Acc: 0.711
Validation loss decreased (-0.627766 --> -0.711104).  Saving model ...
Epoch: 5 cost time: 2.004422903060913
Epoch: 5, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.597 Vali Acc: 0.728 Test Loss: 0.597 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727772).  Saving model ...
Epoch: 6 cost time: 2.257305383682251
Epoch: 6, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.771 Vali Acc: 0.700 Test Loss: 0.771 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.132628917694092
Epoch: 7, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.517 Vali Acc: 0.761 Test Loss: 0.517 Test Acc: 0.761
Validation loss decreased (-0.727772 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 2.497795343399048
Epoch: 8, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.588 Vali Acc: 0.778 Test Loss: 0.588 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 2.2698781490325928
Epoch: 9, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.561 Vali Acc: 0.794 Test Loss: 0.561 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794439).  Saving model ...
Epoch: 10 cost time: 2.274789571762085
Epoch: 10, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.419 Vali Acc: 0.856 Test Loss: 0.419 Test Acc: 0.856
Validation loss decreased (-0.794439 --> -0.855551).  Saving model ...
Epoch: 11 cost time: 2.003817319869995
Epoch: 11, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.8557333946228027
Epoch: 12, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.422 Vali Acc: 0.861 Test Loss: 0.422 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9316275119781494
Epoch: 13, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6023573875427246
Epoch: 14, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.454049587249756
Epoch: 15, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.353 Vali Acc: 0.872 Test Loss: 0.353 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5050973892211914
Epoch: 16, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.272901773452759
Epoch: 17, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.770 Vali Acc: 0.856 Test Loss: 0.770 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2132480144500732
Epoch: 18, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.491650342941284
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5577478408813477
Epoch: 20, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.050 Vali Acc: 0.817 Test Loss: 1.050 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.7834131717681885
Epoch: 21, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.831 Vali Acc: 0.828 Test Loss: 0.831 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 5766570
model size : 26.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.713540077209473
Epoch: 1, Steps: 12 | Train Loss: 1.976 Vali Loss: 1.620 Vali Acc: 0.489 Test Loss: 1.620 Test Acc: 0.489
Validation loss decreased (inf --> -0.488873).  Saving model ...
Epoch: 2 cost time: 1.679853916168213
Epoch: 2, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.127 Vali Acc: 0.472 Test Loss: 1.127 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8707609176635742
Epoch: 3, Steps: 12 | Train Loss: 0.901 Vali Loss: 0.708 Vali Acc: 0.639 Test Loss: 0.708 Test Acc: 0.639
Validation loss decreased (-0.488873 --> -0.638882).  Saving model ...
Epoch: 4 cost time: 1.4651174545288086
Epoch: 4, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.530 Vali Acc: 0.750 Test Loss: 0.530 Test Acc: 0.750
Validation loss decreased (-0.638882 --> -0.749995).  Saving model ...
Epoch: 5 cost time: 1.5761809349060059
Epoch: 5, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.567 Vali Acc: 0.739 Test Loss: 0.567 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7726848125457764
Epoch: 6, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.399 Vali Acc: 0.794 Test Loss: 0.399 Test Acc: 0.794
Validation loss decreased (-0.749995 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.8164153099060059
Epoch: 7, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.358 Vali Acc: 0.811 Test Loss: 0.358 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811108).  Saving model ...
Epoch: 8 cost time: 1.5052714347839355
Epoch: 8, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
Validation loss decreased (-0.811108 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.8077707290649414
Epoch: 9, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.745 Vali Acc: 0.767 Test Loss: 0.745 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6250050067901611
Epoch: 10, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.3541014194488525
Epoch: 11, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.818998098373413
Epoch: 12, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 1.7474024295806885
Epoch: 13, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.855551 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.9105710983276367
Epoch: 14, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.659 Vali Acc: 0.817 Test Loss: 0.659 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6896603107452393
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7265920639038086
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7677803039550781
Epoch: 17, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.803290843963623
Epoch: 18, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.432 Vali Acc: 0.878 Test Loss: 0.432 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9001295566558838
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.386 Vali Acc: 0.878 Test Loss: 0.386 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.021749258041382
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9165124893188477
Epoch: 21, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.936513900756836
Epoch: 22, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.885 Vali Acc: 0.833 Test Loss: 0.885 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3562517166137695
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 5764522
model size : 26.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.537257671356201
Epoch: 1, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.740 Vali Acc: 0.167 Test Loss: 1.740 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 2.299002170562744
Epoch: 2, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.425 Vali Acc: 0.583 Test Loss: 1.425 Test Acc: 0.583
Validation loss decreased (-0.166649 --> -0.583319).  Saving model ...
Epoch: 3 cost time: 1.9799864292144775
Epoch: 3, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.039 Vali Acc: 0.539 Test Loss: 1.039 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3893535137176514
Epoch: 4, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.812 Vali Acc: 0.628 Test Loss: 0.812 Test Acc: 0.628
Validation loss decreased (-0.583319 --> -0.627770).  Saving model ...
Epoch: 5 cost time: 2.548459768295288
Epoch: 5, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.570 Vali Acc: 0.728 Test Loss: 0.570 Test Acc: 0.728
Validation loss decreased (-0.627770 --> -0.727772).  Saving model ...
Epoch: 6 cost time: 1.82011079788208
Epoch: 6, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.587 Vali Acc: 0.739 Test Loss: 0.587 Test Acc: 0.739
Validation loss decreased (-0.727772 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.9306292533874512
Epoch: 7, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.456 Vali Acc: 0.800 Test Loss: 0.456 Test Acc: 0.800
Validation loss decreased (-0.738883 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 2.4287798404693604
Epoch: 8, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.430 Vali Acc: 0.811 Test Loss: 0.430 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 1.741272211074829
Epoch: 9, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.490 Vali Acc: 0.772 Test Loss: 0.490 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7782022953033447
Epoch: 10, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.388 Vali Acc: 0.828 Test Loss: 0.388 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 2.004838228225708
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.386 Vali Acc: 0.839 Test Loss: 0.386 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 2.2162022590637207
Epoch: 12, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.513 Vali Acc: 0.794 Test Loss: 0.513 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.02871036529541
Epoch: 13, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.9490890502929688
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.430 Vali Acc: 0.828 Test Loss: 0.430 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.237748384475708
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.359 Vali Acc: 0.856 Test Loss: 0.359 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 2.0300633907318115
Epoch: 16, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5512099266052246
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.447 Vali Acc: 0.861 Test Loss: 0.447 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 1.8259363174438477
Epoch: 18, Steps: 12 | Train Loss: 0.275 Vali Loss: 1.106 Vali Acc: 0.783 Test Loss: 1.106 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9696195125579834
Epoch: 19, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.394 Vali Acc: 0.844 Test Loss: 0.394 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0142624378204346
Epoch: 20, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.429 Vali Acc: 0.867 Test Loss: 0.429 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 2.0376267433166504
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0679731369018555
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.429 Vali Acc: 0.872 Test Loss: 0.429 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 23 cost time: 2.0862913131713867
Epoch: 23, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.383 Vali Acc: 0.878 Test Loss: 0.383 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 24 cost time: 2.3123855590820312
Epoch: 24, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6021325588226318
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5854997634887695
Epoch: 26, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7619764804840088
Epoch: 27, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.425 Vali Acc: 0.856 Test Loss: 0.425 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8983826637268066
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.578 Vali Acc: 0.839 Test Loss: 0.578 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6663079261779785
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.14864444732666
Epoch: 30, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.104856491088867
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7926054000854492
Epoch: 32, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.957017421722412
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.698 Vali Acc: 0.872 Test Loss: 0.698 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2726314
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.0887980461120605
Epoch: 1, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.673 Vali Acc: 0.350 Test Loss: 1.673 Test Acc: 0.350
Validation loss decreased (inf --> -0.349983).  Saving model ...
Epoch: 2 cost time: 2.4602999687194824
Epoch: 2, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
Validation loss decreased (-0.349983 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 2.2038745880126953
Epoch: 3, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.033 Vali Acc: 0.572 Test Loss: 1.033 Test Acc: 0.572
Validation loss decreased (-0.549988 --> -0.572212).  Saving model ...
Epoch: 4 cost time: 2.2608697414398193
Epoch: 4, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.698 Vali Acc: 0.661 Test Loss: 0.698 Test Acc: 0.661
Validation loss decreased (-0.572212 --> -0.661104).  Saving model ...
Epoch: 5 cost time: 2.3492331504821777
Epoch: 5, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.602 Vali Acc: 0.711 Test Loss: 0.602 Test Acc: 0.711
Validation loss decreased (-0.661104 --> -0.711105).  Saving model ...
Epoch: 6 cost time: 2.2961156368255615
Epoch: 6, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.507 Vali Acc: 0.744 Test Loss: 0.507 Test Acc: 0.744
Validation loss decreased (-0.711105 --> -0.744439).  Saving model ...
Epoch: 7 cost time: 2.3104026317596436
Epoch: 7, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.580 Vali Acc: 0.739 Test Loss: 0.580 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3533074855804443
Epoch: 8, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.586 Vali Acc: 0.733 Test Loss: 0.586 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3224000930786133
Epoch: 9, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.487 Vali Acc: 0.778 Test Loss: 0.487 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 10 cost time: 2.396291494369507
Epoch: 10, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.378 Vali Acc: 0.822 Test Loss: 0.378 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 2.1594691276550293
Epoch: 11, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.405 Vali Acc: 0.822 Test Loss: 0.405 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.296091318130493
Epoch: 12, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0045416355133057
Epoch: 13, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.397 Vali Acc: 0.828 Test Loss: 0.397 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.8184452056884766
Epoch: 14, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2862346172332764
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 2.5181870460510254
Epoch: 16, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.474747657775879
Epoch: 17, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.409 Vali Acc: 0.844 Test Loss: 0.409 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.226292371749878
Epoch: 18, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.399 Vali Acc: 0.856 Test Loss: 0.399 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 2.3043715953826904
Epoch: 19, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.569 Vali Acc: 0.817 Test Loss: 0.569 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9913263320922852
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4327704906463623
Epoch: 21, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2352333068847656
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.437 Vali Acc: 0.844 Test Loss: 0.437 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6003828048706055
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.226560592651367
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.397 Vali Acc: 0.872 Test Loss: 0.397 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872218).  Saving model ...
Epoch: 25 cost time: 2.376910448074341
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.849 Vali Acc: 0.817 Test Loss: 0.849 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2506675720214844
Epoch: 26, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.406 Vali Acc: 0.872 Test Loss: 0.406 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.5929529666900635
Epoch: 27, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.395 Vali Acc: 0.894 Test Loss: 0.395 Test Acc: 0.894
Validation loss decreased (-0.872218 --> -0.894440).  Saving model ...
Epoch: 28 cost time: 2.0611965656280518
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.460 Vali Acc: 0.867 Test Loss: 0.460 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1654717922210693
Epoch: 29, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.406 Vali Acc: 0.867 Test Loss: 0.406 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3104188442230225
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.371323823928833
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.696516513824463
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.407 Vali Acc: 0.867 Test Loss: 0.407 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.215986728668213
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.615471601486206
Epoch: 34, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.410 Vali Acc: 0.878 Test Loss: 0.410 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.231316566467285
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.011796712875366
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.1564114093780518
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2725290
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.68564248085022
Epoch: 1, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.736 Vali Acc: 0.172 Test Loss: 1.736 Test Acc: 0.172
Validation loss decreased (inf --> -0.172205).  Saving model ...
Epoch: 2 cost time: 1.9242238998413086
Epoch: 2, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.305 Vali Acc: 0.467 Test Loss: 1.305 Test Acc: 0.467
Validation loss decreased (-0.172205 --> -0.466654).  Saving model ...
Epoch: 3 cost time: 2.0924792289733887
Epoch: 3, Steps: 12 | Train Loss: 1.055 Vali Loss: 0.843 Vali Acc: 0.733 Test Loss: 0.843 Test Acc: 0.733
Validation loss decreased (-0.466654 --> -0.733325).  Saving model ...
Epoch: 4 cost time: 2.0648698806762695
Epoch: 4, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.815 Vali Acc: 0.628 Test Loss: 0.815 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9478440284729004
Epoch: 5, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.564 Vali Acc: 0.772 Test Loss: 0.564 Test Acc: 0.772
Validation loss decreased (-0.733325 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 2.6229214668273926
Epoch: 6, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.752 Vali Acc: 0.689 Test Loss: 0.752 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4033565521240234
Epoch: 7, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.470 Vali Acc: 0.800 Test Loss: 0.470 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 2.394667387008667
Epoch: 8, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.235950469970703
Epoch: 9, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.493 Vali Acc: 0.778 Test Loss: 0.493 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9270081520080566
Epoch: 10, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.421 Vali Acc: 0.817 Test Loss: 0.421 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 2.002180576324463
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.346 Vali Acc: 0.833 Test Loss: 0.346 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.7042417526245117
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 2.236304998397827
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8969841003417969
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.331 Vali Acc: 0.872 Test Loss: 0.331 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 1.839613676071167
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.459632396697998
Epoch: 16, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2029988765716553
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0215766429901123
Epoch: 18, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.3022358417510986
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6662847995758057
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3664770126342773
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 2.0509660243988037
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2888171672821045
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.397 Vali Acc: 0.872 Test Loss: 0.397 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.19085431098938
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 1.8899188041687012
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9243297576904297
Epoch: 26, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1808242797851562
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.456 Vali Acc: 0.867 Test Loss: 0.456 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0926713943481445
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.443 Vali Acc: 0.872 Test Loss: 0.443 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.195845365524292
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.348 Vali Acc: 0.883 Test Loss: 0.348 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.227234363555908
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9724597930908203
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8021855354309082
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.429638147354126
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.209000587463379
Epoch: 34, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2724266
model size : 12.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.346644401550293
Epoch: 1, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.690 Vali Acc: 0.344 Test Loss: 1.690 Test Acc: 0.344
Validation loss decreased (inf --> -0.344428).  Saving model ...
Epoch: 2 cost time: 1.7527053356170654
Epoch: 2, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.227 Vali Acc: 0.628 Test Loss: 1.227 Test Acc: 0.628
Validation loss decreased (-0.344428 --> -0.627766).  Saving model ...
Epoch: 3 cost time: 1.809072732925415
Epoch: 3, Steps: 12 | Train Loss: 1.075 Vali Loss: 0.931 Vali Acc: 0.594 Test Loss: 0.931 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1624624729156494
Epoch: 4, Steps: 12 | Train Loss: 0.881 Vali Loss: 0.878 Vali Acc: 0.694 Test Loss: 0.878 Test Acc: 0.694
Validation loss decreased (-0.627766 --> -0.694436).  Saving model ...
Epoch: 5 cost time: 1.6288623809814453
Epoch: 5, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.564 Vali Acc: 0.728 Test Loss: 0.564 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727772).  Saving model ...
Epoch: 6 cost time: 1.776677131652832
Epoch: 6, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.517 Vali Acc: 0.767 Test Loss: 0.517 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 2.0984811782836914
Epoch: 7, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.646 Vali Acc: 0.733 Test Loss: 0.646 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8464410305023193
Epoch: 8, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.389 Vali Acc: 0.833 Test Loss: 0.389 Test Acc: 0.833
Validation loss decreased (-0.766661 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 1.2690083980560303
Epoch: 9, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.432 Vali Acc: 0.789 Test Loss: 0.432 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6963510513305664
Epoch: 10, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.628 Vali Acc: 0.767 Test Loss: 0.628 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.660963535308838
Epoch: 11, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3127660751342773
Epoch: 12, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 2.3031954765319824
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 1.6161553859710693
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 2.0954670906066895
Epoch: 15, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9058794975280762
Epoch: 16, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 1.8235142230987549
Epoch: 17, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.401 Vali Acc: 0.844 Test Loss: 0.401 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0978925228118896
Epoch: 18, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6330983638763428
Epoch: 19, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.446 Vali Acc: 0.861 Test Loss: 0.446 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.794600248336792
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.398 Vali Acc: 0.867 Test Loss: 0.398 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 21 cost time: 2.1573731899261475
Epoch: 21, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.396 Vali Acc: 0.867 Test Loss: 0.396 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 22 cost time: 2.207448720932007
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.378 Vali Acc: 0.867 Test Loss: 0.378 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 23 cost time: 2.347468137741089
Epoch: 23, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5708510875701904
Epoch: 24, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1175930500030518
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.435 Vali Acc: 0.856 Test Loss: 0.435 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2516942024230957
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.486516237258911
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3645212650299072
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.513 Vali Acc: 0.878 Test Loss: 0.513 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 2.4729673862457275
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.670 Vali Acc: 0.828 Test Loss: 0.670 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0806994438171387
Epoch: 30, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.449 Vali Acc: 0.878 Test Loss: 0.449 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 2.014373540878296
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.721 Vali Acc: 0.839 Test Loss: 0.721 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8167223930358887
Epoch: 32, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6883933544158936
Epoch: 33, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.707 Vali Acc: 0.861 Test Loss: 0.707 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.813232421875
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.763 Vali Acc: 0.806 Test Loss: 0.763 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.009891986846924
Epoch: 35, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.64601469039917
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.710 Vali Acc: 0.844 Test Loss: 0.710 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7055892944335938
Epoch: 37, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.060532331466675
Epoch: 38, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.146279811859131
Epoch: 39, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4770185947418213
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2723242
model size : 12.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.532243013381958
Epoch: 1, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.650 Vali Acc: 0.333 Test Loss: 1.650 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 1.9542300701141357
Epoch: 2, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.356 Vali Acc: 0.433 Test Loss: 1.356 Test Acc: 0.433
Validation loss decreased (-0.333317 --> -0.433320).  Saving model ...
Epoch: 3 cost time: 1.3795299530029297
Epoch: 3, Steps: 12 | Train Loss: 1.230 Vali Loss: 0.959 Vali Acc: 0.606 Test Loss: 0.959 Test Acc: 0.606
Validation loss decreased (-0.433320 --> -0.605546).  Saving model ...
Epoch: 4 cost time: 1.667867660522461
Epoch: 4, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
Validation loss decreased (-0.605546 --> -0.722216).  Saving model ...
Epoch: 5 cost time: 1.9933013916015625
Epoch: 5, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.762 Vali Acc: 0.639 Test Loss: 0.762 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8668720722198486
Epoch: 6, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.558 Vali Acc: 0.728 Test Loss: 0.558 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727772).  Saving model ...
Epoch: 7 cost time: 1.847043752670288
Epoch: 7, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.456 Vali Acc: 0.778 Test Loss: 0.456 Test Acc: 0.778
Validation loss decreased (-0.727772 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 2.149797201156616
Epoch: 8, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.441 Vali Acc: 0.811 Test Loss: 0.441 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 2.0789337158203125
Epoch: 9, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.507 Vali Acc: 0.756 Test Loss: 0.507 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5434691905975342
Epoch: 10, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.478 Vali Acc: 0.806 Test Loss: 0.478 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6440763473510742
Epoch: 11, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 1.560842752456665
Epoch: 12, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1694271564483643
Epoch: 13, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.681715965270996
Epoch: 14, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 1.746436357498169
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.282 Vali Acc: 0.856 Test Loss: 0.282 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 16 cost time: 1.8166282176971436
Epoch: 16, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.646393060684204
Epoch: 17, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 1.5131237506866455
Epoch: 18, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.358 Vali Acc: 0.878 Test Loss: 0.358 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877774).  Saving model ...
Epoch: 19 cost time: 1.704404592514038
Epoch: 19, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.361 Vali Acc: 0.856 Test Loss: 0.361 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3594248294830322
Epoch: 20, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.862466812133789
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.375 Vali Acc: 0.872 Test Loss: 0.375 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9676258563995361
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.329 Vali Acc: 0.883 Test Loss: 0.329 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.011763572692871
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0202949047088623
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.466 Vali Acc: 0.839 Test Loss: 0.466 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.384789228439331
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.746 Vali Acc: 0.833 Test Loss: 0.746 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.21710467338562
Epoch: 26, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.456434726715088
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 28 cost time: 2.239762783050537
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2286994457244873
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.441 Vali Acc: 0.867 Test Loss: 0.441 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.0505213737487793
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.500 Vali Acc: 0.867 Test Loss: 0.500 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.0070464611053467
Epoch: 31, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.902320384979248
Epoch: 32, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.18401837348938
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.500 Vali Acc: 0.894 Test Loss: 0.500 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894439).  Saving model ...
Epoch: 34 cost time: 2.4327855110168457
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.412 Vali Acc: 0.883 Test Loss: 0.412 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1083872318267822
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.807445764541626
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.521 Vali Acc: 0.878 Test Loss: 0.521 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.0572988986968994
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.8805124759674072
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.894 Test Loss: 0.556 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.5736603736877441
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.5434858798980713
Epoch: 40, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.458 Vali Acc: 0.883 Test Loss: 0.458 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.0040690898895264
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.026858329772949
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.411 Vali Acc: 0.878 Test Loss: 0.411 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.6826694011688232
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.683 Vali Acc: 0.844 Test Loss: 0.683 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2068394
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5120530128479
Epoch: 1, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.750 Vali Acc: 0.328 Test Loss: 1.750 Test Acc: 0.328
Validation loss decreased (inf --> -0.327760).  Saving model ...
Epoch: 2 cost time: 1.956742525100708
Epoch: 2, Steps: 12 | Train Loss: 1.537 Vali Loss: 1.303 Vali Acc: 0.550 Test Loss: 1.303 Test Acc: 0.550
Validation loss decreased (-0.327760 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 1.8475019931793213
Epoch: 3, Steps: 12 | Train Loss: 1.152 Vali Loss: 0.934 Vali Acc: 0.617 Test Loss: 0.934 Test Acc: 0.617
Validation loss decreased (-0.549987 --> -0.616657).  Saving model ...
Epoch: 4 cost time: 1.7804608345031738
Epoch: 4, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.847 Vali Acc: 0.628 Test Loss: 0.847 Test Acc: 0.628
Validation loss decreased (-0.616657 --> -0.627769).  Saving model ...
Epoch: 5 cost time: 2.5707926750183105
Epoch: 5, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.644 Vali Acc: 0.739 Test Loss: 0.644 Test Acc: 0.739
Validation loss decreased (-0.627769 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 2.0336925983428955
Epoch: 6, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.538 Vali Acc: 0.739 Test Loss: 0.538 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738884).  Saving model ...
Epoch: 7 cost time: 2.231311798095703
Epoch: 7, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.738884 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 2.343900680541992
Epoch: 8, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.440 Vali Acc: 0.833 Test Loss: 0.440 Test Acc: 0.833
Validation loss decreased (-0.749992 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 1.8876214027404785
Epoch: 9, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.421 Vali Acc: 0.839 Test Loss: 0.421 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 1.8721258640289307
Epoch: 10, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.425 Vali Acc: 0.817 Test Loss: 0.425 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8648574352264404
Epoch: 11, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.349 Vali Acc: 0.839 Test Loss: 0.349 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 1.9069559574127197
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.509 Vali Acc: 0.794 Test Loss: 0.509 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.920191764831543
Epoch: 13, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.483 Vali Acc: 0.806 Test Loss: 0.483 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0520482063293457
Epoch: 14, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 1.9714794158935547
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.345 Vali Acc: 0.844 Test Loss: 0.345 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2400639057159424
Epoch: 16, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.430 Vali Acc: 0.839 Test Loss: 0.430 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9215219020843506
Epoch: 17, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.411388635635376
Epoch: 18, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 19 cost time: 2.2281715869903564
Epoch: 19, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8334918022155762
Epoch: 20, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9358017444610596
Epoch: 21, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.363 Vali Acc: 0.867 Test Loss: 0.363 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9929678440093994
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.374 Vali Acc: 0.861 Test Loss: 0.374 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9186747074127197
Epoch: 23, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7724823951721191
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0055928230285645
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.363 Vali Acc: 0.867 Test Loss: 0.363 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.393221855163574
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.132460832595825
Epoch: 27, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3901069164276123
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.369 Vali Acc: 0.878 Test Loss: 0.369 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 29 cost time: 2.4474620819091797
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8414595127105713
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.390 Vali Acc: 0.856 Test Loss: 0.390 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.0927093029022217
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.385 Vali Acc: 0.872 Test Loss: 0.385 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8899989128112793
Epoch: 32, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.470 Vali Acc: 0.889 Test Loss: 0.470 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888884).  Saving model ...
Epoch: 33 cost time: 2.128718137741089
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.668513536453247
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.416 Vali Acc: 0.883 Test Loss: 0.416 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.492173433303833
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.1238274574279785
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.374 Vali Acc: 0.878 Test Loss: 0.374 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7698349952697754
Epoch: 37, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5718097686767578
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.507 Vali Acc: 0.867 Test Loss: 0.507 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.134758472442627
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7321128845214844
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6522915363311768
Epoch: 41, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.259692907333374
Epoch: 42, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2067370
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.517738342285156
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.686 Vali Acc: 0.333 Test Loss: 1.686 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 2.321014165878296
Epoch: 2, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.304 Vali Acc: 0.550 Test Loss: 1.304 Test Acc: 0.550
Validation loss decreased (-0.333316 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 2.07243013381958
Epoch: 3, Steps: 12 | Train Loss: 1.128 Vali Loss: 0.938 Vali Acc: 0.600 Test Loss: 0.938 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 1.981799602508545
Epoch: 4, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.687 Vali Acc: 0.717 Test Loss: 0.687 Test Acc: 0.717
Validation loss decreased (-0.599991 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 2.4501328468322754
Epoch: 5, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.619 Vali Acc: 0.728 Test Loss: 0.619 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727772).  Saving model ...
Epoch: 6 cost time: 2.077712297439575
Epoch: 6, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1666407585144043
Epoch: 7, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.505 Vali Acc: 0.756 Test Loss: 0.505 Test Acc: 0.756
Validation loss decreased (-0.727772 --> -0.755551).  Saving model ...
Epoch: 8 cost time: 2.6239593029022217
Epoch: 8, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.414 Vali Acc: 0.806 Test Loss: 0.414 Test Acc: 0.806
Validation loss decreased (-0.755551 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 2.1263833045959473
Epoch: 9, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 1.4659900665283203
Epoch: 10, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.466 Vali Acc: 0.789 Test Loss: 0.466 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9102497100830078
Epoch: 11, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 12 cost time: 2.007761001586914
Epoch: 12, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 2.0866987705230713
Epoch: 13, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 1.8343541622161865
Epoch: 14, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1054153442382812
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.7015798091888428
Epoch: 16, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6828184127807617
Epoch: 17, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7939338684082031
Epoch: 18, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.279897689819336
Epoch: 19, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.368 Vali Acc: 0.883 Test Loss: 0.368 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9258360862731934
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.412 Vali Acc: 0.878 Test Loss: 0.412 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8927149772644043
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.418 Vali Acc: 0.856 Test Loss: 0.418 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3913912773132324
Epoch: 22, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.505 Vali Acc: 0.861 Test Loss: 0.505 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.03275203704834
Epoch: 23, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.201542377471924
Epoch: 24, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9954545497894287
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2066346
model size : 10.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.143473863601685
Epoch: 1, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.661 Vali Acc: 0.350 Test Loss: 1.661 Test Acc: 0.350
Validation loss decreased (inf --> -0.349983).  Saving model ...
Epoch: 2 cost time: 2.036651849746704
Epoch: 2, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.368 Vali Acc: 0.556 Test Loss: 1.368 Test Acc: 0.556
Validation loss decreased (-0.349983 --> -0.555542).  Saving model ...
Epoch: 3 cost time: 2.082559585571289
Epoch: 3, Steps: 12 | Train Loss: 1.208 Vali Loss: 0.955 Vali Acc: 0.606 Test Loss: 0.955 Test Acc: 0.606
Validation loss decreased (-0.555542 --> -0.605546).  Saving model ...
Epoch: 4 cost time: 2.177297353744507
Epoch: 4, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.714 Vali Acc: 0.644 Test Loss: 0.714 Test Acc: 0.644
Validation loss decreased (-0.605546 --> -0.644437).  Saving model ...
Epoch: 5 cost time: 2.4373812675476074
Epoch: 5, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (-0.644437 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 1.9985299110412598
Epoch: 6, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.705 Vali Acc: 0.711 Test Loss: 0.705 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.799262523651123
Epoch: 7, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.437 Vali Acc: 0.794 Test Loss: 0.437 Test Acc: 0.794
Validation loss decreased (-0.722216 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.249619245529175
Epoch: 8, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.424 Vali Acc: 0.800 Test Loss: 0.424 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 1.988480806350708
Epoch: 9, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.455 Vali Acc: 0.783 Test Loss: 0.455 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2079732418060303
Epoch: 10, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0824530124664307
Epoch: 11, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.960038423538208
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.438 Vali Acc: 0.828 Test Loss: 0.438 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.346859931945801
Epoch: 13, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.386 Vali Acc: 0.839 Test Loss: 0.386 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 1.9863834381103516
Epoch: 14, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.430 Vali Acc: 0.828 Test Loss: 0.430 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.293853521347046
Epoch: 15, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.477 Vali Acc: 0.839 Test Loss: 0.477 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.119107484817505
Epoch: 16, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.8546712398529053
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.370 Vali Acc: 0.839 Test Loss: 0.370 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5105042457580566
Epoch: 18, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.577 Vali Acc: 0.811 Test Loss: 0.577 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1340105533599854
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 20 cost time: 2.0645017623901367
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872217).  Saving model ...
Epoch: 21 cost time: 1.7051587104797363
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3156380653381348
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1405787467956543
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
Validation loss decreased (-0.872217 --> -0.894441).  Saving model ...
Epoch: 24 cost time: 1.5095908641815186
Epoch: 24, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0529158115386963
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.515 Vali Acc: 0.883 Test Loss: 0.515 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.889714241027832
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.515 Vali Acc: 0.872 Test Loss: 0.515 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.187150001525879
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.325256586074829
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0788300037384033
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.684 Vali Acc: 0.844 Test Loss: 0.684 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.077932596206665
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.0005154609680176
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.408651351928711
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.3323516845703125
Epoch: 33, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2065322
model size : 10.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.00969123840332
Epoch: 1, Steps: 12 | Train Loss: 1.938 Vali Loss: 1.770 Vali Acc: 0.261 Test Loss: 1.770 Test Acc: 0.261
Validation loss decreased (inf --> -0.261093).  Saving model ...
Epoch: 2 cost time: 1.9002504348754883
Epoch: 2, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.348 Vali Acc: 0.461 Test Loss: 1.348 Test Acc: 0.461
Validation loss decreased (-0.261093 --> -0.461098).  Saving model ...
Epoch: 3 cost time: 1.948899507522583
Epoch: 3, Steps: 12 | Train Loss: 1.177 Vali Loss: 0.985 Vali Acc: 0.572 Test Loss: 0.985 Test Acc: 0.572
Validation loss decreased (-0.461098 --> -0.572212).  Saving model ...
Epoch: 4 cost time: 1.9874866008758545
Epoch: 4, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.826 Vali Acc: 0.661 Test Loss: 0.826 Test Acc: 0.661
Validation loss decreased (-0.572212 --> -0.661103).  Saving model ...
Epoch: 5 cost time: 1.900635004043579
Epoch: 5, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.647 Vali Acc: 0.744 Test Loss: 0.647 Test Acc: 0.744
Validation loss decreased (-0.661103 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 1.5900897979736328
Epoch: 6, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.730 Vali Acc: 0.672 Test Loss: 0.730 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.548415422439575
Epoch: 7, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.554 Vali Acc: 0.744 Test Loss: 0.554 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 2.041895627975464
Epoch: 8, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 1.9261670112609863
Epoch: 9, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.425 Vali Acc: 0.811 Test Loss: 0.425 Test Acc: 0.811
Validation loss decreased (-0.761106 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 2.361243963241577
Epoch: 10, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8232533931732178
Epoch: 11, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.512 Vali Acc: 0.839 Test Loss: 0.512 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838884).  Saving model ...
Epoch: 12 cost time: 1.689206838607788
Epoch: 12, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.418 Vali Acc: 0.811 Test Loss: 0.418 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1628453731536865
Epoch: 13, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0273847579956055
Epoch: 14, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 2.1583690643310547
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.150308847427368
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.35430908203125
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0091896057128906
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.8985559940338135
Epoch: 19, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.378 Vali Acc: 0.856 Test Loss: 0.378 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2189226150512695
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.374 Vali Acc: 0.867 Test Loss: 0.374 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2845029830932617
Epoch: 21, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9409406185150146
Epoch: 22, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.407 Vali Acc: 0.872 Test Loss: 0.407 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9408776760101318
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1714117527008057
Epoch: 24, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.347 Vali Acc: 0.872 Test Loss: 0.347 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.379676342010498
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.093 Vali Acc: 0.817 Test Loss: 1.093 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0294950008392334
Epoch: 26, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1372456550598145
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.410 Vali Acc: 0.883 Test Loss: 0.410 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3719639778137207
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.394 Vali Acc: 0.872 Test Loss: 0.394 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1739434
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.203388929367065
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.659 Vali Acc: 0.233 Test Loss: 1.659 Test Acc: 0.233
Validation loss decreased (inf --> -0.233317).  Saving model ...
Epoch: 2 cost time: 1.9317512512207031
Epoch: 2, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.273 Vali Acc: 0.633 Test Loss: 1.273 Test Acc: 0.633
Validation loss decreased (-0.233317 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 2.2855782508850098
Epoch: 3, Steps: 12 | Train Loss: 1.127 Vali Loss: 0.988 Vali Acc: 0.589 Test Loss: 0.988 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8525722026824951
Epoch: 4, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.633321 --> -0.716659).  Saving model ...
Epoch: 5 cost time: 2.2017645835876465
Epoch: 5, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.582 Vali Acc: 0.756 Test Loss: 0.582 Test Acc: 0.756
Validation loss decreased (-0.716659 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 1.8176798820495605
Epoch: 6, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.798 Vali Acc: 0.728 Test Loss: 0.798 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9346089363098145
Epoch: 7, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.451 Vali Acc: 0.800 Test Loss: 0.451 Test Acc: 0.800
Validation loss decreased (-0.755550 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 2.3506453037261963
Epoch: 8, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.409 Vali Acc: 0.789 Test Loss: 0.409 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.126857042312622
Epoch: 9, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.444 Vali Acc: 0.811 Test Loss: 0.444 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 1.507897138595581
Epoch: 10, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9661016464233398
Epoch: 11, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.451 Vali Acc: 0.811 Test Loss: 0.451 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0767765045166016
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 1.6777729988098145
Epoch: 13, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 1.7676820755004883
Epoch: 14, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.350 Vali Acc: 0.867 Test Loss: 0.350 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 1.8407018184661865
Epoch: 15, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0260045528411865
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.611858606338501
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8180413246154785
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.417 Vali Acc: 0.856 Test Loss: 0.417 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7495818138122559
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6341500282287598
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.478 Vali Acc: 0.828 Test Loss: 0.478 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.80712890625
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9570021629333496
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5817415714263916
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 1.7245585918426514
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.911529302597046
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.8492553234100342
Epoch: 26, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2073278427124023
Epoch: 27, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.408 Vali Acc: 0.872 Test Loss: 0.408 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.070761203765869
Epoch: 28, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8452064990997314
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.358 Vali Acc: 0.894 Test Loss: 0.358 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 30 cost time: 1.9508707523345947
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6737003326416016
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.450 Vali Acc: 0.883 Test Loss: 0.450 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4058291912078857
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.2136871814727783
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.744964599609375
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.440 Vali Acc: 0.856 Test Loss: 0.440 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.9596409797668457
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7606253623962402
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6173381805419922
Epoch: 37, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.684 Vali Acc: 0.861 Test Loss: 0.684 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.714672565460205
Epoch: 38, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.60562801361084
Epoch: 39, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1738410
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.037042140960693
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.678 Vali Acc: 0.361 Test Loss: 1.678 Test Acc: 0.361
Validation loss decreased (inf --> -0.361094).  Saving model ...
Epoch: 2 cost time: 1.6334409713745117
Epoch: 2, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.394 Vali Acc: 0.489 Test Loss: 1.394 Test Acc: 0.489
Validation loss decreased (-0.361094 --> -0.488875).  Saving model ...
Epoch: 3 cost time: 1.8238465785980225
Epoch: 3, Steps: 12 | Train Loss: 1.260 Vali Loss: 0.984 Vali Acc: 0.667 Test Loss: 0.984 Test Acc: 0.667
Validation loss decreased (-0.488875 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 1.6589128971099854
Epoch: 4, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.794 Vali Acc: 0.622 Test Loss: 0.794 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3556559085845947
Epoch: 5, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.647 Vali Acc: 0.706 Test Loss: 0.647 Test Acc: 0.706
Validation loss decreased (-0.666657 --> -0.705549).  Saving model ...
Epoch: 6 cost time: 1.4056754112243652
Epoch: 6, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (-0.705549 --> -0.722217).  Saving model ...
Epoch: 7 cost time: 1.4135332107543945
Epoch: 7, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.491 Vali Acc: 0.767 Test Loss: 0.491 Test Acc: 0.767
Validation loss decreased (-0.722217 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 1.3741304874420166
Epoch: 8, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.455 Vali Acc: 0.789 Test Loss: 0.455 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.6490199565887451
Epoch: 9, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.633 Vali Acc: 0.756 Test Loss: 0.633 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7347502708435059
Epoch: 10, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 1.459939956665039
Epoch: 11, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.519 Vali Acc: 0.794 Test Loss: 0.519 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.903550624847412
Epoch: 12, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.796 Vali Acc: 0.756 Test Loss: 0.796 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.755277395248413
Epoch: 13, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.659 Vali Acc: 0.767 Test Loss: 0.659 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6380066871643066
Epoch: 14, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.439 Vali Acc: 0.817 Test Loss: 0.439 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 15 cost time: 1.4142632484436035
Epoch: 15, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.505 Vali Acc: 0.794 Test Loss: 0.505 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.439333200454712
Epoch: 16, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827772).  Saving model ...
Epoch: 17 cost time: 1.5414962768554688
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 2.352400779724121
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8360111713409424
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.449 Vali Acc: 0.867 Test Loss: 0.449 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866662).  Saving model ...
Epoch: 20 cost time: 1.961136817932129
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.569 Vali Acc: 0.817 Test Loss: 0.569 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.093200206756592
Epoch: 21, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9330670833587646
Epoch: 22, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.770 Vali Acc: 0.828 Test Loss: 0.770 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9534173011779785
Epoch: 23, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9490957260131836
Epoch: 24, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.426 Vali Acc: 0.872 Test Loss: 0.426 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 25 cost time: 2.139009475708008
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.978358268737793
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1829159259796143
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.074 Vali Acc: 0.817 Test Loss: 1.074 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.278042793273926
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.534 Vali Acc: 0.839 Test Loss: 0.534 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2934961318969727
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1515345573425293
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.1699752807617188
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.474 Vali Acc: 0.883 Test Loss: 0.474 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 2.1566336154937744
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.053990602493286
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8928496837615967
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.459 Vali Acc: 0.861 Test Loss: 0.459 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.079296588897705
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7219970226287842
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.484 Vali Acc: 0.883 Test Loss: 0.484 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5977685451507568
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7527930736541748
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.447 Vali Acc: 0.867 Test Loss: 0.447 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4435780048370361
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 40 cost time: 1.68965744972229
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2943782806396484
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.876 Vali Acc: 0.833 Test Loss: 0.876 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.0237202644348145
Epoch: 42, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.8854403495788574
Epoch: 43, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8081040382385254
Epoch: 44, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.071302652359009
Epoch: 45, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.0384695529937744
Epoch: 46, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.823 Vali Acc: 0.828 Test Loss: 0.823 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.9634058475494385
Epoch: 47, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.0832433700561523
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.536 Vali Acc: 0.878 Test Loss: 0.536 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.112072467803955
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1737386
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.199980735778809
Epoch: 1, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.790 Vali Acc: 0.300 Test Loss: 1.790 Test Acc: 0.300
Validation loss decreased (inf --> -0.299982).  Saving model ...
Epoch: 2 cost time: 1.979346752166748
Epoch: 2, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.357 Vali Acc: 0.444 Test Loss: 1.357 Test Acc: 0.444
Validation loss decreased (-0.299982 --> -0.444431).  Saving model ...
Epoch: 3 cost time: 1.84450364112854
Epoch: 3, Steps: 12 | Train Loss: 1.175 Vali Loss: 0.958 Vali Acc: 0.650 Test Loss: 0.958 Test Acc: 0.650
Validation loss decreased (-0.444431 --> -0.649990).  Saving model ...
Epoch: 4 cost time: 1.859449863433838
Epoch: 4, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.718 Vali Acc: 0.728 Test Loss: 0.718 Test Acc: 0.728
Validation loss decreased (-0.649990 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 1.5764260292053223
Epoch: 5, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.713 Vali Acc: 0.644 Test Loss: 0.713 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6031663417816162
Epoch: 6, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.542 Vali Acc: 0.739 Test Loss: 0.542 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.5363640785217285
Epoch: 7, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
Validation loss decreased (-0.738883 --> -0.783328).  Saving model ...
Epoch: 8 cost time: 1.7174296379089355
Epoch: 8, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.436 Vali Acc: 0.778 Test Loss: 0.436 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8573715686798096
Epoch: 9, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
Validation loss decreased (-0.783328 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 1.7888896465301514
Epoch: 10, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.448 Vali Acc: 0.772 Test Loss: 0.448 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.117098808288574
Epoch: 11, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5293457508087158
Epoch: 12, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0647265911102295
Epoch: 13, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 1.9018421173095703
Epoch: 14, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.507 Vali Acc: 0.800 Test Loss: 0.507 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.533510208129883
Epoch: 15, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.751 Vali Acc: 0.811 Test Loss: 0.751 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0918991565704346
Epoch: 16, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.593 Vali Acc: 0.817 Test Loss: 0.593 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9545085430145264
Epoch: 17, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 18 cost time: 1.6753675937652588
Epoch: 18, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8108954429626465
Epoch: 19, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7310237884521484
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.623 Vali Acc: 0.839 Test Loss: 0.623 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.495137929916382
Epoch: 21, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.3737189769744873
Epoch: 22, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.475 Vali Acc: 0.828 Test Loss: 0.475 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.369119644165039
Epoch: 23, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1236143112182617
Epoch: 24, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7636065483093262
Epoch: 25, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.340 Vali Acc: 0.856 Test Loss: 0.340 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1589221954345703
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.393 Vali Acc: 0.878 Test Loss: 0.393 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877774).  Saving model ...
Epoch: 27 cost time: 1.5370776653289795
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.795447587966919
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.874828815460205
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5992381572723389
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.460 Vali Acc: 0.867 Test Loss: 0.460 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.0457260608673096
Epoch: 31, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.564 Vali Acc: 0.839 Test Loss: 0.564 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6327612400054932
Epoch: 32, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.626 Vali Acc: 0.839 Test Loss: 0.626 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.092703104019165
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 34 cost time: 1.8194506168365479
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0269219875335693
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.449 Vali Acc: 0.867 Test Loss: 0.449 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.5567145347595215
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.8109452724456787
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.9134621620178223
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.460 Vali Acc: 0.867 Test Loss: 0.460 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.9393210411071777
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.636 Vali Acc: 0.878 Test Loss: 0.636 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.4484634399414062
Epoch: 40, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.5198323726654053
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.859 Vali Acc: 0.839 Test Loss: 0.859 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.0961475372314453
Epoch: 42, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.669 Vali Acc: 0.861 Test Loss: 0.669 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.8576505184173584
Epoch: 43, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.456 Vali Acc: 0.867 Test Loss: 0.456 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1736362
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6392574310302734
Epoch: 1, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.697 Vali Acc: 0.339 Test Loss: 1.697 Test Acc: 0.339
Validation loss decreased (inf --> -0.338872).  Saving model ...
Epoch: 2 cost time: 1.6738488674163818
Epoch: 2, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.320 Vali Acc: 0.494 Test Loss: 1.320 Test Acc: 0.494
Validation loss decreased (-0.338872 --> -0.494431).  Saving model ...
Epoch: 3 cost time: 1.5650897026062012
Epoch: 3, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.206 Vali Acc: 0.589 Test Loss: 1.206 Test Acc: 0.589
Validation loss decreased (-0.494431 --> -0.588877).  Saving model ...
Epoch: 4 cost time: 1.6363937854766846
Epoch: 4, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.980 Vali Acc: 0.667 Test Loss: 0.980 Test Acc: 0.667
Validation loss decreased (-0.588877 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 2.083650827407837
Epoch: 5, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
Validation loss decreased (-0.666657 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 1.8994038105010986
Epoch: 6, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.556 Vali Acc: 0.717 Test Loss: 0.556 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6405153274536133
Epoch: 7, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.456 Vali Acc: 0.778 Test Loss: 0.456 Test Acc: 0.778
Validation loss decreased (-0.722216 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 1.7168471813201904
Epoch: 8, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.614 Vali Acc: 0.728 Test Loss: 0.614 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7667796611785889
Epoch: 9, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.483 Vali Acc: 0.783 Test Loss: 0.483 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 2.345560073852539
Epoch: 10, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 2.3185999393463135
Epoch: 11, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.494 Vali Acc: 0.767 Test Loss: 0.494 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8598709106445312
Epoch: 12, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.383 Vali Acc: 0.833 Test Loss: 0.383 Test Acc: 0.833
Validation loss decreased (-0.783329 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 1.7565484046936035
Epoch: 13, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1124303340911865
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 2.484422445297241
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.383 Vali Acc: 0.828 Test Loss: 0.383 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.853729009628296
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.874809980392456
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.357 Vali Acc: 0.856 Test Loss: 0.357 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2320048809051514
Epoch: 18, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.401 Vali Acc: 0.856 Test Loss: 0.401 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0382375717163086
Epoch: 19, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 20 cost time: 2.1994245052337646
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8499128818511963
Epoch: 21, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.374 Vali Acc: 0.878 Test Loss: 0.374 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 22 cost time: 2.226500988006592
Epoch: 22, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8291001319885254
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.435 Vali Acc: 0.894 Test Loss: 0.435 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894440).  Saving model ...
Epoch: 24 cost time: 2.1295266151428223
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.605787992477417
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.838348627090454
Epoch: 26, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.361 Vali Acc: 0.878 Test Loss: 0.361 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.921219825744629
Epoch: 27, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7302985191345215
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0901033878326416
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.455 Vali Acc: 0.883 Test Loss: 0.455 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8151538372039795
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.453 Vali Acc: 0.883 Test Loss: 0.453 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.009319305419922
Epoch: 31, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.414 Vali Acc: 0.872 Test Loss: 0.414 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6505703926086426
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.913879156112671
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1574954
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.17945671081543
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.657 Vali Acc: 0.356 Test Loss: 1.657 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 1.837146282196045
Epoch: 2, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.257 Vali Acc: 0.622 Test Loss: 1.257 Test Acc: 0.622
Validation loss decreased (-0.355539 --> -0.622210).  Saving model ...
Epoch: 3 cost time: 1.9034984111785889
Epoch: 3, Steps: 12 | Train Loss: 1.112 Vali Loss: 0.939 Vali Acc: 0.600 Test Loss: 0.939 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.844470500946045
Epoch: 4, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.732 Vali Acc: 0.678 Test Loss: 0.732 Test Acc: 0.678
Validation loss decreased (-0.622210 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 1.620621919631958
Epoch: 5, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.659 Vali Acc: 0.711 Test Loss: 0.659 Test Acc: 0.711
Validation loss decreased (-0.677770 --> -0.711105).  Saving model ...
Epoch: 6 cost time: 1.7208876609802246
Epoch: 6, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.626 Vali Acc: 0.772 Test Loss: 0.626 Test Acc: 0.772
Validation loss decreased (-0.711105 --> -0.772216).  Saving model ...
Epoch: 7 cost time: 2.022228479385376
Epoch: 7, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.604 Vali Acc: 0.744 Test Loss: 0.604 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1631240844726562
Epoch: 8, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.432 Vali Acc: 0.789 Test Loss: 0.432 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788885).  Saving model ...
Epoch: 9 cost time: 2.059122323989868
Epoch: 9, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.512 Vali Acc: 0.761 Test Loss: 0.512 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2682008743286133
Epoch: 10, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.707 Vali Acc: 0.778 Test Loss: 0.707 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7506167888641357
Epoch: 11, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.419 Vali Acc: 0.822 Test Loss: 0.419 Test Acc: 0.822
Validation loss decreased (-0.788885 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 1.6775212287902832
Epoch: 12, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.606 Vali Acc: 0.772 Test Loss: 0.606 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6062495708465576
Epoch: 13, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.456 Vali Acc: 0.822 Test Loss: 0.456 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7290568351745605
Epoch: 14, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.382 Vali Acc: 0.833 Test Loss: 0.382 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 1.4434974193572998
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.562631607055664
Epoch: 16, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
Validation loss decreased (-0.833330 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 1.7200541496276855
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.7585923671722412
Epoch: 18, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.416 Vali Acc: 0.867 Test Loss: 0.416 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6503996849060059
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.8750994205474854
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8877530097961426
Epoch: 21, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.394 Vali Acc: 0.878 Test Loss: 0.394 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5907151699066162
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.45084547996521
Epoch: 23, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.451 Vali Acc: 0.867 Test Loss: 0.451 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9858589172363281
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.332 Vali Acc: 0.872 Test Loss: 0.332 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9758989810943604
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.427 Vali Acc: 0.872 Test Loss: 0.427 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6899938583374023
Epoch: 26, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.462 Vali Acc: 0.872 Test Loss: 0.462 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0143883228302
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.687 Vali Acc: 0.817 Test Loss: 0.687 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.021221399307251
Epoch: 28, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.482 Vali Acc: 0.861 Test Loss: 0.482 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.806748628616333
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.409 Vali Acc: 0.883 Test Loss: 0.409 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1573930
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9803237915039062
Epoch: 1, Steps: 12 | Train Loss: 1.985 Vali Loss: 1.716 Vali Acc: 0.278 Test Loss: 1.716 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 2.4358229637145996
Epoch: 2, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.413 Vali Acc: 0.300 Test Loss: 1.413 Test Acc: 0.300
Validation loss decreased (-0.277761 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 2.2671236991882324
Epoch: 3, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.029 Vali Acc: 0.656 Test Loss: 1.029 Test Acc: 0.656
Validation loss decreased (-0.299986 --> -0.655545).  Saving model ...
Epoch: 4 cost time: 1.6459088325500488
Epoch: 4, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.781 Vali Acc: 0.678 Test Loss: 0.781 Test Acc: 0.678
Validation loss decreased (-0.655545 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 1.6823534965515137
Epoch: 5, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.796 Vali Acc: 0.706 Test Loss: 0.796 Test Acc: 0.706
Validation loss decreased (-0.677770 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 1.7005202770233154
Epoch: 6, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716661).  Saving model ...
Epoch: 7 cost time: 2.010267496109009
Epoch: 7, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.455 Vali Acc: 0.794 Test Loss: 0.455 Test Acc: 0.794
Validation loss decreased (-0.716661 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.074784278869629
Epoch: 8, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.436 Vali Acc: 0.800 Test Loss: 0.436 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 1.969527006149292
Epoch: 9, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.405 Vali Acc: 0.789 Test Loss: 0.405 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.945774793624878
Epoch: 10, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.468 Vali Acc: 0.794 Test Loss: 0.468 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3668344020843506
Epoch: 11, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.301 Vali Acc: 0.833 Test Loss: 0.301 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 2.0947461128234863
Epoch: 12, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.406 Vali Acc: 0.822 Test Loss: 0.406 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.162358522415161
Epoch: 13, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 2.440861940383911
Epoch: 14, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7811863422393799
Epoch: 15, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 2.0647695064544678
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.331 Vali Acc: 0.878 Test Loss: 0.331 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.155693769454956
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3554306030273438
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 2.023613214492798
Epoch: 19, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.398 Vali Acc: 0.872 Test Loss: 0.398 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1948442459106445
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 2.3883016109466553
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 2.3357160091400146
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.427 Vali Acc: 0.872 Test Loss: 0.427 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.632324457168579
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.225879669189453
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1222870349884033
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.496 Vali Acc: 0.894 Test Loss: 0.496 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.460932970046997
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9833898544311523
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2842013835906982
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.429 Vali Acc: 0.861 Test Loss: 0.429 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.2615108489990234
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.405 Vali Acc: 0.872 Test Loss: 0.405 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7191901206970215
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.38974666595459
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1572906
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9465723037719727
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.743 Vali Acc: 0.189 Test Loss: 1.743 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 1.5847554206848145
Epoch: 2, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.336 Vali Acc: 0.506 Test Loss: 1.336 Test Acc: 0.506
Validation loss decreased (-0.188871 --> -0.505542).  Saving model ...
Epoch: 3 cost time: 1.8457772731781006
Epoch: 3, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
Validation loss decreased (-0.505542 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 1.6497280597686768
Epoch: 4, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.746 Vali Acc: 0.661 Test Loss: 0.746 Test Acc: 0.661
Validation loss decreased (-0.599990 --> -0.661104).  Saving model ...
Epoch: 5 cost time: 1.751537561416626
Epoch: 5, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.647 Vali Acc: 0.700 Test Loss: 0.647 Test Acc: 0.700
Validation loss decreased (-0.661104 --> -0.699994).  Saving model ...
Epoch: 6 cost time: 1.979201078414917
Epoch: 6, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.641 Vali Acc: 0.761 Test Loss: 0.641 Test Acc: 0.761
Validation loss decreased (-0.699994 --> -0.761105).  Saving model ...
Epoch: 7 cost time: 1.6426212787628174
Epoch: 7, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.539 Vali Acc: 0.772 Test Loss: 0.539 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 1.945744514465332
Epoch: 8, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.493 Vali Acc: 0.744 Test Loss: 0.493 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8224194049835205
Epoch: 9, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.817 Vali Acc: 0.761 Test Loss: 0.817 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5455033779144287
Epoch: 10, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.409 Vali Acc: 0.828 Test Loss: 0.409 Test Acc: 0.828
Validation loss decreased (-0.772217 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.668605089187622
Epoch: 11, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.589 Vali Acc: 0.767 Test Loss: 0.589 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9292919635772705
Epoch: 12, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.435 Vali Acc: 0.789 Test Loss: 0.435 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5225718021392822
Epoch: 13, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 1.646848440170288
Epoch: 14, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.329 Vali Acc: 0.861 Test Loss: 0.329 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.9257471561431885
Epoch: 15, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7015604972839355
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7672719955444336
Epoch: 17, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4712321758270264
Epoch: 18, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 1.5750279426574707
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.719357967376709
Epoch: 20, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.360 Vali Acc: 0.883 Test Loss: 0.360 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.8556101322174072
Epoch: 21, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.398 Vali Acc: 0.872 Test Loss: 0.398 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1548850536346436
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.388 Vali Acc: 0.856 Test Loss: 0.388 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9502723217010498
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8165888786315918
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.421 Vali Acc: 0.839 Test Loss: 0.421 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.033170461654663
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.80357027053833
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.450 Vali Acc: 0.867 Test Loss: 0.450 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8275120258331299
Epoch: 27, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.453 Vali Acc: 0.867 Test Loss: 0.453 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1460886001586914
Epoch: 28, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7483422756195068
Epoch: 29, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.416 Vali Acc: 0.878 Test Loss: 0.416 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.0195658206939697
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.929 Vali Acc: 0.828 Test Loss: 0.929 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1571882
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.162679433822632
Epoch: 1, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.701 Vali Acc: 0.278 Test Loss: 1.701 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 1.8219428062438965
Epoch: 2, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.480 Vali Acc: 0.517 Test Loss: 1.480 Test Acc: 0.517
Validation loss decreased (-0.277761 --> -0.516652).  Saving model ...
Epoch: 3 cost time: 1.954470157623291
Epoch: 3, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.155 Vali Acc: 0.650 Test Loss: 1.155 Test Acc: 0.650
Validation loss decreased (-0.516652 --> -0.649988).  Saving model ...
Epoch: 4 cost time: 1.6708450317382812
Epoch: 4, Steps: 12 | Train Loss: 1.030 Vali Loss: 0.903 Vali Acc: 0.661 Test Loss: 0.903 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661102).  Saving model ...
Epoch: 5 cost time: 1.3008031845092773
Epoch: 5, Steps: 12 | Train Loss: 0.854 Vali Loss: 0.739 Vali Acc: 0.689 Test Loss: 0.739 Test Acc: 0.689
Validation loss decreased (-0.661102 --> -0.688882).  Saving model ...
Epoch: 6 cost time: 1.7797462940216064
Epoch: 6, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
Validation loss decreased (-0.688882 --> -0.716660).  Saving model ...
Epoch: 7 cost time: 1.8180160522460938
Epoch: 7, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.554 Vali Acc: 0.767 Test Loss: 0.554 Test Acc: 0.767
Validation loss decreased (-0.716660 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.528991937637329
Epoch: 8, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.493 Vali Acc: 0.778 Test Loss: 0.493 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.6670701503753662
Epoch: 9, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.478 Vali Acc: 0.778 Test Loss: 0.478 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 10 cost time: 1.5656466484069824
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.433 Vali Acc: 0.811 Test Loss: 0.433 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 1.7521166801452637
Epoch: 11, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.431 Vali Acc: 0.794 Test Loss: 0.431 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7855255603790283
Epoch: 12, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 2.1251511573791504
Epoch: 13, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.439 Vali Acc: 0.806 Test Loss: 0.439 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5305848121643066
Epoch: 14, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.477 Vali Acc: 0.806 Test Loss: 0.477 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8694493770599365
Epoch: 15, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.426 Vali Acc: 0.822 Test Loss: 0.426 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 1.8201191425323486
Epoch: 16, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 2.0560009479522705
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.425 Vali Acc: 0.800 Test Loss: 0.425 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5258965492248535
Epoch: 18, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.444 Vali Acc: 0.817 Test Loss: 0.444 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5631322860717773
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.425 Vali Acc: 0.828 Test Loss: 0.425 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 1.9614112377166748
Epoch: 20, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.443 Vali Acc: 0.822 Test Loss: 0.443 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4872987270355225
Epoch: 21, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 1.797499418258667
Epoch: 22, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.375 Vali Acc: 0.839 Test Loss: 0.375 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 1.5674073696136475
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6326544284820557
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.491 Vali Acc: 0.811 Test Loss: 0.491 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.960106611251831
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.397 Vali Acc: 0.828 Test Loss: 0.397 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6221733093261719
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 27 cost time: 1.5328619480133057
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.416 Vali Acc: 0.856 Test Loss: 0.416 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.589841365814209
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.391218900680542
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0908055305480957
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.414 Vali Acc: 0.856 Test Loss: 0.414 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6871745586395264
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 32 cost time: 1.6545586585998535
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.451 Vali Acc: 0.839 Test Loss: 0.451 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.678490161895752
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.469 Vali Acc: 0.839 Test Loss: 0.469 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8800592422485352
Epoch: 34, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5190377235412598
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.434 Vali Acc: 0.872 Test Loss: 0.434 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 36 cost time: 1.4339826107025146
Epoch: 36, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.583 Vali Acc: 0.839 Test Loss: 0.583 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7355694770812988
Epoch: 37, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7290558815002441
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.515380859375
Epoch: 39, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.400270700454712
Epoch: 40, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.5167980194091797
Epoch: 41, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.562 Vali Acc: 0.817 Test Loss: 0.562 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.5257830619812012
Epoch: 42, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.7382314205169678
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.4849674701690674
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.8613827228546143
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1038058
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.124133586883545
Epoch: 1, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.709 Vali Acc: 0.267 Test Loss: 1.709 Test Acc: 0.267
Validation loss decreased (inf --> -0.266650).  Saving model ...
Epoch: 2 cost time: 1.3924689292907715
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.486 Vali Acc: 0.517 Test Loss: 1.486 Test Acc: 0.517
Validation loss decreased (-0.266650 --> -0.516652).  Saving model ...
Epoch: 3 cost time: 1.4669196605682373
Epoch: 3, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.159 Vali Acc: 0.644 Test Loss: 1.159 Test Acc: 0.644
Validation loss decreased (-0.516652 --> -0.644433).  Saving model ...
Epoch: 4 cost time: 1.327026605606079
Epoch: 4, Steps: 12 | Train Loss: 0.990 Vali Loss: 0.863 Vali Acc: 0.628 Test Loss: 0.863 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4365835189819336
Epoch: 5, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.658 Vali Acc: 0.706 Test Loss: 0.658 Test Acc: 0.706
Validation loss decreased (-0.644433 --> -0.705549).  Saving model ...
Epoch: 6 cost time: 1.3287353515625
Epoch: 6, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (-0.705549 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.31797194480896
Epoch: 7, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.565 Vali Acc: 0.750 Test Loss: 0.565 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.2462432384490967
Epoch: 8, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.589 Vali Acc: 0.744 Test Loss: 0.589 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4334352016448975
Epoch: 9, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.481 Vali Acc: 0.756 Test Loss: 0.481 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755551).  Saving model ...
Epoch: 10 cost time: 1.333397626876831
Epoch: 10, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
Validation loss decreased (-0.755551 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 1.3387393951416016
Epoch: 11, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.599 Vali Acc: 0.767 Test Loss: 0.599 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 1.4633476734161377
Epoch: 12, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.470 Vali Acc: 0.806 Test Loss: 0.470 Test Acc: 0.806
Validation loss decreased (-0.766661 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 1.7549207210540771
Epoch: 13, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.437 Vali Acc: 0.806 Test Loss: 0.437 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805551).  Saving model ...
Epoch: 14 cost time: 1.3816747665405273
Epoch: 14, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.519 Vali Acc: 0.761 Test Loss: 0.519 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7413513660430908
Epoch: 15, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.400 Vali Acc: 0.800 Test Loss: 0.400 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5597813129425049
Epoch: 16, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.452 Vali Acc: 0.800 Test Loss: 0.452 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3233668804168701
Epoch: 17, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 18 cost time: 1.2461228370666504
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.495 Vali Acc: 0.817 Test Loss: 0.495 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2871994972229004
Epoch: 19, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.579 Vali Acc: 0.811 Test Loss: 0.579 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2906312942504883
Epoch: 20, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 21 cost time: 1.411729335784912
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 1.3500745296478271
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.419 Vali Acc: 0.822 Test Loss: 0.419 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4806897640228271
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.434 Vali Acc: 0.833 Test Loss: 0.434 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 1.316610336303711
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.501 Vali Acc: 0.839 Test Loss: 0.501 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838884).  Saving model ...
Epoch: 25 cost time: 1.440791368484497
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.401 Vali Acc: 0.817 Test Loss: 0.401 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2822229862213135
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.433 Vali Acc: 0.844 Test Loss: 0.433 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 27 cost time: 1.2191925048828125
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.393 Vali Acc: 0.817 Test Loss: 0.393 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2154150009155273
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 29 cost time: 1.4130902290344238
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.391442060470581
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.344 Vali Acc: 0.867 Test Loss: 0.344 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 31 cost time: 1.5311365127563477
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.399 Vali Acc: 0.856 Test Loss: 0.399 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1378114223480225
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.423 Vali Acc: 0.867 Test Loss: 0.423 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5482869148254395
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5462408065795898
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6631786823272705
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5774896144866943
Epoch: 36, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.455 Vali Acc: 0.856 Test Loss: 0.455 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7248454093933105
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.413 Vali Acc: 0.844 Test Loss: 0.413 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7780382633209229
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5445332527160645
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3436686992645264
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1037546
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4609293937683105
Epoch: 1, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.699 Vali Acc: 0.222 Test Loss: 1.699 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 1.418717622756958
Epoch: 2, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.444 Vali Acc: 0.572 Test Loss: 1.444 Test Acc: 0.572
Validation loss decreased (-0.222205 --> -0.572208).  Saving model ...
Epoch: 3 cost time: 1.46598219871521
Epoch: 3, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.136 Vali Acc: 0.683 Test Loss: 1.136 Test Acc: 0.683
Validation loss decreased (-0.572208 --> -0.683322).  Saving model ...
Epoch: 4 cost time: 1.5528678894042969
Epoch: 4, Steps: 12 | Train Loss: 0.999 Vali Loss: 0.862 Vali Acc: 0.650 Test Loss: 0.862 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4081358909606934
Epoch: 5, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.748 Vali Acc: 0.706 Test Loss: 0.748 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 1.3667943477630615
Epoch: 6, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.705548 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.5771913528442383
Epoch: 7, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.560 Vali Acc: 0.739 Test Loss: 0.560 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3963406085968018
Epoch: 8, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.5139245986938477
Epoch: 9, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.466 Vali Acc: 0.778 Test Loss: 0.466 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.529745101928711
Epoch: 10, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.496 Vali Acc: 0.772 Test Loss: 0.496 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.794370412826538
Epoch: 11, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.461 Vali Acc: 0.789 Test Loss: 0.461 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 1.716738224029541
Epoch: 12, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.396 Vali Acc: 0.828 Test Loss: 0.396 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 1.7653207778930664
Epoch: 13, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.473 Vali Acc: 0.800 Test Loss: 0.473 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.852940559387207
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.399 Vali Acc: 0.822 Test Loss: 0.399 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.53312087059021
Epoch: 15, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.452 Vali Acc: 0.817 Test Loss: 0.452 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5249865055084229
Epoch: 16, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.359297513961792
Epoch: 17, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.398 Vali Acc: 0.828 Test Loss: 0.398 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6454379558563232
Epoch: 18, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.435 Vali Acc: 0.817 Test Loss: 0.435 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6899232864379883
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.66269850730896
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.434 Vali Acc: 0.828 Test Loss: 0.434 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.773519515991211
Epoch: 21, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4998619556427002
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.423 Vali Acc: 0.839 Test Loss: 0.423 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 1.417677879333496
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.404 Vali Acc: 0.817 Test Loss: 0.404 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6754913330078125
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3882181644439697
Epoch: 25, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.848271131515503
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.428 Vali Acc: 0.828 Test Loss: 0.428 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6253888607025146
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5077788829803467
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 29 cost time: 1.5150682926177979
Epoch: 29, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4973139762878418
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 31 cost time: 1.5427484512329102
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.627134084701538
Epoch: 32, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.439 Vali Acc: 0.861 Test Loss: 0.439 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5880122184753418
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.366 Vali Acc: 0.878 Test Loss: 0.366 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877774).  Saving model ...
Epoch: 34 cost time: 1.4445099830627441
Epoch: 34, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6346077919006348
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.377 Vali Acc: 0.861 Test Loss: 0.377 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3336677551269531
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.412 Vali Acc: 0.844 Test Loss: 0.412 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5629515647888184
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2250161170959473
Epoch: 38, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4495127201080322
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4873435497283936
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.406 Vali Acc: 0.844 Test Loss: 0.406 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.4552721977233887
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2260687351226807
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3855977058410645
Epoch: 43, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1037034
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.039914608001709
Epoch: 1, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.668 Vali Acc: 0.272 Test Loss: 1.668 Test Acc: 0.272
Validation loss decreased (inf --> -0.272206).  Saving model ...
Epoch: 2 cost time: 1.2179975509643555
Epoch: 2, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.445 Vali Acc: 0.506 Test Loss: 1.445 Test Acc: 0.506
Validation loss decreased (-0.272206 --> -0.505541).  Saving model ...
Epoch: 3 cost time: 1.4119091033935547
Epoch: 3, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
Validation loss decreased (-0.505541 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 1.3465478420257568
Epoch: 4, Steps: 12 | Train Loss: 1.051 Vali Loss: 0.870 Vali Acc: 0.733 Test Loss: 0.870 Test Acc: 0.733
Validation loss decreased (-0.549989 --> -0.733325).  Saving model ...
Epoch: 5 cost time: 1.227135181427002
Epoch: 5, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.773 Vali Acc: 0.694 Test Loss: 0.773 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3025124073028564
Epoch: 6, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.674 Vali Acc: 0.661 Test Loss: 0.674 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3033061027526855
Epoch: 7, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.588 Vali Acc: 0.728 Test Loss: 0.588 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.367699146270752
Epoch: 8, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.480 Vali Acc: 0.767 Test Loss: 0.480 Test Acc: 0.767
Validation loss decreased (-0.733325 --> -0.766662).  Saving model ...
Epoch: 9 cost time: 1.5301899909973145
Epoch: 9, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.446 Vali Acc: 0.789 Test Loss: 0.446 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.8163912296295166
Epoch: 10, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.418 Vali Acc: 0.806 Test Loss: 0.418 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.4069828987121582
Epoch: 11, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.425 Vali Acc: 0.828 Test Loss: 0.425 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.5573599338531494
Epoch: 12, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 1.7393500804901123
Epoch: 13, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.433 Vali Acc: 0.778 Test Loss: 0.433 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7743682861328125
Epoch: 14, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.418 Vali Acc: 0.828 Test Loss: 0.418 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.68123459815979
Epoch: 15, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.473 Vali Acc: 0.800 Test Loss: 0.473 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4733588695526123
Epoch: 16, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.462 Vali Acc: 0.811 Test Loss: 0.462 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5677993297576904
Epoch: 17, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.419 Vali Acc: 0.839 Test Loss: 0.419 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6167547702789307
Epoch: 18, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.456 Vali Acc: 0.817 Test Loss: 0.456 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.825948715209961
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.451 Vali Acc: 0.828 Test Loss: 0.451 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5699753761291504
Epoch: 20, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.426 Vali Acc: 0.822 Test Loss: 0.426 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.423302412033081
Epoch: 21, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.462 Vali Acc: 0.794 Test Loss: 0.462 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8530850410461426
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.453 Vali Acc: 0.794 Test Loss: 0.453 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 1036522
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.744452238082886
Epoch: 1, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.728 Vali Acc: 0.311 Test Loss: 1.728 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 1.93992018699646
Epoch: 2, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.492 Vali Acc: 0.489 Test Loss: 1.492 Test Acc: 0.489
Validation loss decreased (-0.311094 --> -0.488874).  Saving model ...
Epoch: 3 cost time: 1.5117101669311523
Epoch: 3, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.195 Vali Acc: 0.650 Test Loss: 1.195 Test Acc: 0.650
Validation loss decreased (-0.488874 --> -0.649988).  Saving model ...
Epoch: 4 cost time: 1.6433765888214111
Epoch: 4, Steps: 12 | Train Loss: 1.110 Vali Loss: 0.928 Vali Acc: 0.656 Test Loss: 0.928 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655546).  Saving model ...
Epoch: 5 cost time: 1.7300283908843994
Epoch: 5, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.714 Vali Acc: 0.739 Test Loss: 0.714 Test Acc: 0.739
Validation loss decreased (-0.655546 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 1.5998296737670898
Epoch: 6, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.618 Vali Acc: 0.756 Test Loss: 0.618 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 7 cost time: 1.6809139251708984
Epoch: 7, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.561 Vali Acc: 0.767 Test Loss: 0.561 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.8673505783081055
Epoch: 8, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.501 Vali Acc: 0.761 Test Loss: 0.501 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7924487590789795
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.502 Vali Acc: 0.756 Test Loss: 0.502 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5295836925506592
Epoch: 10, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.451 Vali Acc: 0.794 Test Loss: 0.451 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.5122911930084229
Epoch: 11, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.447 Vali Acc: 0.767 Test Loss: 0.447 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4457435607910156
Epoch: 12, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.435 Vali Acc: 0.817 Test Loss: 0.435 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 1.5520498752593994
Epoch: 13, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.411 Vali Acc: 0.817 Test Loss: 0.411 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 14 cost time: 1.377079963684082
Epoch: 14, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 1.7703475952148438
Epoch: 15, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 1.5770478248596191
Epoch: 16, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5679214000701904
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 1.5742499828338623
Epoch: 18, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.463 Vali Acc: 0.839 Test Loss: 0.463 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8487462997436523
Epoch: 19, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4927301406860352
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.363 Vali Acc: 0.856 Test Loss: 0.363 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8337392807006836
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6329443454742432
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.433 Vali Acc: 0.867 Test Loss: 0.433 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 23 cost time: 1.4005074501037598
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5539743900299072
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.394 Vali Acc: 0.872 Test Loss: 0.394 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 25 cost time: 1.8475983142852783
Epoch: 25, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6324362754821777
Epoch: 26, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6841423511505127
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.418 Vali Acc: 0.878 Test Loss: 0.418 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 28 cost time: 1.3299651145935059
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.445 Vali Acc: 0.878 Test Loss: 0.445 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5357377529144287
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.421 Vali Acc: 0.872 Test Loss: 0.421 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5071165561676025
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6347606182098389
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.452 Vali Acc: 0.883 Test Loss: 0.452 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 1.5228776931762695
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.577725887298584
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.375 Vali Acc: 0.883 Test Loss: 0.375 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883330).  Saving model ...
Epoch: 34 cost time: 1.5562891960144043
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3177073001861572
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.420 Vali Acc: 0.883 Test Loss: 0.420 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.555044174194336
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.481 Vali Acc: 0.883 Test Loss: 0.481 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.701796531677246
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5519671440124512
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.5067360401153564
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.449 Vali Acc: 0.878 Test Loss: 0.449 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.5467376708984375
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6582863330841064
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894439).  Saving model ...
Epoch: 42 cost time: 1.7386596202850342
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.571 Vali Acc: 0.883 Test Loss: 0.571 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.469057321548462
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.558647871017456
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4325711727142334
Epoch: 45, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.4278206825256348
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.5592870712280273
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.567 Vali Acc: 0.872 Test Loss: 0.567 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3859436511993408
Epoch: 48, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.602 Vali Acc: 0.883 Test Loss: 0.602 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3803627490997314
Epoch: 49, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.666 Vali Acc: 0.844 Test Loss: 0.666 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.3186585903167725
Epoch: 50, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.537 Vali Acc: 0.883 Test Loss: 0.537 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.422351360321045
Epoch: 51, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.710 Vali Acc: 0.861 Test Loss: 0.710 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 707818
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.116870641708374
Epoch: 1, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.727 Vali Acc: 0.261 Test Loss: 1.727 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 1.894864559173584
Epoch: 2, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.491 Vali Acc: 0.467 Test Loss: 1.491 Test Acc: 0.467
Validation loss decreased (-0.261094 --> -0.466652).  Saving model ...
Epoch: 3 cost time: 1.8005671501159668
Epoch: 3, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.180 Vali Acc: 0.633 Test Loss: 1.180 Test Acc: 0.633
Validation loss decreased (-0.466652 --> -0.633322).  Saving model ...
Epoch: 4 cost time: 1.864762306213379
Epoch: 4, Steps: 12 | Train Loss: 1.111 Vali Loss: 0.919 Vali Acc: 0.661 Test Loss: 0.919 Test Acc: 0.661
Validation loss decreased (-0.633322 --> -0.661102).  Saving model ...
Epoch: 5 cost time: 1.5562939643859863
Epoch: 5, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.739 Vali Acc: 0.700 Test Loss: 0.739 Test Acc: 0.700
Validation loss decreased (-0.661102 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 1.7172589302062988
Epoch: 6, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
Validation loss decreased (-0.699993 --> -0.716661).  Saving model ...
Epoch: 7 cost time: 1.436861276626587
Epoch: 7, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.551 Vali Acc: 0.772 Test Loss: 0.551 Test Acc: 0.772
Validation loss decreased (-0.716661 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 1.6650636196136475
Epoch: 8, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.493 Vali Acc: 0.767 Test Loss: 0.493 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7151386737823486
Epoch: 9, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.457 Vali Acc: 0.789 Test Loss: 0.457 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.5840704441070557
Epoch: 10, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.387 Vali Acc: 0.828 Test Loss: 0.387 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.714536190032959
Epoch: 11, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.424 Vali Acc: 0.789 Test Loss: 0.424 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6310155391693115
Epoch: 12, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.401 Vali Acc: 0.794 Test Loss: 0.401 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6212410926818848
Epoch: 13, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.401 Vali Acc: 0.817 Test Loss: 0.401 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2996101379394531
Epoch: 14, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5378503799438477
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.474 Vali Acc: 0.817 Test Loss: 0.474 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7926349639892578
Epoch: 16, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6852061748504639
Epoch: 17, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9457063674926758
Epoch: 18, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.451 Vali Acc: 0.817 Test Loss: 0.451 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8278827667236328
Epoch: 19, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.430 Vali Acc: 0.817 Test Loss: 0.430 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6374986171722412
Epoch: 20, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.459 Vali Acc: 0.828 Test Loss: 0.459 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 707306
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.671599864959717
Epoch: 1, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.710 Vali Acc: 0.339 Test Loss: 1.710 Test Acc: 0.339
Validation loss decreased (inf --> -0.338872).  Saving model ...
Epoch: 2 cost time: 1.7052714824676514
Epoch: 2, Steps: 12 | Train Loss: 1.603 Vali Loss: 1.475 Vali Acc: 0.528 Test Loss: 1.475 Test Acc: 0.528
Validation loss decreased (-0.338872 --> -0.527763).  Saving model ...
Epoch: 3 cost time: 1.4892306327819824
Epoch: 3, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.185 Vali Acc: 0.617 Test Loss: 1.185 Test Acc: 0.617
Validation loss decreased (-0.527763 --> -0.616655).  Saving model ...
Epoch: 4 cost time: 1.4371111392974854
Epoch: 4, Steps: 12 | Train Loss: 1.062 Vali Loss: 0.919 Vali Acc: 0.683 Test Loss: 0.919 Test Acc: 0.683
Validation loss decreased (-0.616655 --> -0.683324).  Saving model ...
Epoch: 5 cost time: 1.4702270030975342
Epoch: 5, Steps: 12 | Train Loss: 0.778 Vali Loss: 0.714 Vali Acc: 0.711 Test Loss: 0.714 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711104).  Saving model ...
Epoch: 6 cost time: 1.528548002243042
Epoch: 6, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.679 Vali Acc: 0.706 Test Loss: 0.679 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.694122552871704
Epoch: 7, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.603 Vali Acc: 0.711 Test Loss: 0.603 Test Acc: 0.711
Validation loss decreased (-0.711104 --> -0.711105).  Saving model ...
Epoch: 8 cost time: 2.0658516883850098
Epoch: 8, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.498 Vali Acc: 0.778 Test Loss: 0.498 Test Acc: 0.778
Validation loss decreased (-0.711105 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.817892074584961
Epoch: 9, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 1.9979307651519775
Epoch: 10, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.446 Vali Acc: 0.767 Test Loss: 0.446 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7380995750427246
Epoch: 11, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.443 Vali Acc: 0.783 Test Loss: 0.443 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 12 cost time: 1.5231640338897705
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.390 Vali Acc: 0.806 Test Loss: 0.390 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805552).  Saving model ...
Epoch: 13 cost time: 1.333221673965454
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.406 Vali Acc: 0.822 Test Loss: 0.406 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 1.9595110416412354
Epoch: 14, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.456 Vali Acc: 0.806 Test Loss: 0.456 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8237636089324951
Epoch: 15, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.414 Vali Acc: 0.811 Test Loss: 0.414 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7958838939666748
Epoch: 16, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.407 Vali Acc: 0.822 Test Loss: 0.407 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8269400596618652
Epoch: 17, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.412 Vali Acc: 0.817 Test Loss: 0.412 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8109095096588135
Epoch: 18, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.517 Vali Acc: 0.806 Test Loss: 0.517 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8721959590911865
Epoch: 19, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6084136962890625
Epoch: 20, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.431 Vali Acc: 0.839 Test Loss: 0.431 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 21 cost time: 1.7415845394134521
Epoch: 21, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.458 Vali Acc: 0.822 Test Loss: 0.458 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.682706356048584
Epoch: 22, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.050557851791382
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844440).  Saving model ...
Epoch: 24 cost time: 1.669039011001587
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7556777000427246
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.483 Vali Acc: 0.828 Test Loss: 0.483 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.569920539855957
Epoch: 26, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855551).  Saving model ...
Epoch: 27 cost time: 1.7409303188323975
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.067817211151123
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 29 cost time: 2.251629114151001
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 30 cost time: 2.0661532878875732
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5968127250671387
Epoch: 31, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.435 Vali Acc: 0.839 Test Loss: 0.435 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8045790195465088
Epoch: 32, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.444 Vali Acc: 0.844 Test Loss: 0.444 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.0441927909851074
Epoch: 33, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.530 Vali Acc: 0.811 Test Loss: 0.530 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5540838241577148
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5933265686035156
Epoch: 35, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.299107313156128
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8875136375427246
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.7471067905426025
Epoch: 38, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.449 Vali Acc: 0.861 Test Loss: 0.449 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 39 cost time: 1.4828011989593506
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.508589267730713
Epoch: 40, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.467961311340332
Epoch: 41, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872217).  Saving model ...
Epoch: 42 cost time: 1.318636178970337
Epoch: 42, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5300700664520264
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 44 cost time: 1.7591907978057861
Epoch: 44, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.103949546813965
Epoch: 45, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.614771842956543
Epoch: 46, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.1016340255737305
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6509416103363037
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.0127646923065186
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.5515034198760986
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.7418427467346191
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.603 Vali Acc: 0.872 Test Loss: 0.603 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.9275102615356445
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.5446105003356934
Epoch: 53, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 706794
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7481489181518555
Epoch: 1, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.681 Vali Acc: 0.317 Test Loss: 1.681 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 1.748352289199829
Epoch: 2, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.447 Vali Acc: 0.494 Test Loss: 1.447 Test Acc: 0.494
Validation loss decreased (-0.316650 --> -0.494430).  Saving model ...
Epoch: 3 cost time: 1.8780872821807861
Epoch: 3, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.195 Vali Acc: 0.578 Test Loss: 1.195 Test Acc: 0.578
Validation loss decreased (-0.494430 --> -0.577766).  Saving model ...
Epoch: 4 cost time: 1.7931151390075684
Epoch: 4, Steps: 12 | Train Loss: 1.083 Vali Loss: 0.947 Vali Acc: 0.600 Test Loss: 0.947 Test Acc: 0.600
Validation loss decreased (-0.577766 --> -0.599991).  Saving model ...
Epoch: 5 cost time: 1.7909119129180908
Epoch: 5, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.742 Vali Acc: 0.694 Test Loss: 0.742 Test Acc: 0.694
Validation loss decreased (-0.599991 --> -0.694437).  Saving model ...
Epoch: 6 cost time: 1.6577401161193848
Epoch: 6, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.689 Vali Acc: 0.683 Test Loss: 0.689 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.089231014251709
Epoch: 7, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.646 Vali Acc: 0.700 Test Loss: 0.646 Test Acc: 0.700
Validation loss decreased (-0.694437 --> -0.699994).  Saving model ...
Epoch: 8 cost time: 1.4699664115905762
Epoch: 8, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.578 Vali Acc: 0.744 Test Loss: 0.578 Test Acc: 0.744
Validation loss decreased (-0.699994 --> -0.744439).  Saving model ...
Epoch: 9 cost time: 1.8254778385162354
Epoch: 9, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.552 Vali Acc: 0.739 Test Loss: 0.552 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9289679527282715
Epoch: 10, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.441 Vali Acc: 0.761 Test Loss: 0.441 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761107).  Saving model ...
Epoch: 11 cost time: 1.5161046981811523
Epoch: 11, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.455 Vali Acc: 0.800 Test Loss: 0.455 Test Acc: 0.800
Validation loss decreased (-0.761107 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 1.6032862663269043
Epoch: 12, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.423 Vali Acc: 0.806 Test Loss: 0.423 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 1.4055893421173096
Epoch: 13, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.467 Vali Acc: 0.800 Test Loss: 0.467 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.485168218612671
Epoch: 14, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.425 Vali Acc: 0.783 Test Loss: 0.425 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5395104885101318
Epoch: 15, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.362 Vali Acc: 0.844 Test Loss: 0.362 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 1.6342787742614746
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3448450565338135
Epoch: 17, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.405 Vali Acc: 0.833 Test Loss: 0.405 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6048915386199951
Epoch: 18, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.353 Vali Acc: 0.861 Test Loss: 0.353 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 1.4285252094268799
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.415 Vali Acc: 0.839 Test Loss: 0.415 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6178057193756104
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.398 Vali Acc: 0.856 Test Loss: 0.398 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5565690994262695
Epoch: 21, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6616029739379883
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.400 Vali Acc: 0.844 Test Loss: 0.400 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.645207405090332
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.469 Vali Acc: 0.828 Test Loss: 0.469 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5992786884307861
Epoch: 24, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.418 Vali Acc: 0.856 Test Loss: 0.418 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7995810508728027
Epoch: 25, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.392 Vali Acc: 0.839 Test Loss: 0.392 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7093045711517334
Epoch: 26, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.425 Vali Acc: 0.817 Test Loss: 0.425 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8363680839538574
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.409 Vali Acc: 0.867 Test Loss: 0.409 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 28 cost time: 1.5559968948364258
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.374 Vali Acc: 0.867 Test Loss: 0.374 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 29 cost time: 1.8546855449676514
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5898253917694092
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7506024837493896
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.394 Vali Acc: 0.867 Test Loss: 0.394 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4498720169067383
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.443 Vali Acc: 0.839 Test Loss: 0.443 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6612884998321533
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.461 Vali Acc: 0.833 Test Loss: 0.461 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7792322635650635
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.1180808544158936
Epoch: 35, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.7426981925964355
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.417 Vali Acc: 0.839 Test Loss: 0.417 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.1199791431427
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.1599082946777344
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 706282
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5234320163726807
Epoch: 1, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.721 Vali Acc: 0.283 Test Loss: 1.721 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 1.2881951332092285
Epoch: 2, Steps: 12 | Train Loss: 1.641 Vali Loss: 1.502 Vali Acc: 0.372 Test Loss: 1.502 Test Acc: 0.372
Validation loss decreased (-0.283316 --> -0.372207).  Saving model ...
Epoch: 3 cost time: 1.4451336860656738
Epoch: 3, Steps: 12 | Train Loss: 1.407 Vali Loss: 1.218 Vali Acc: 0.639 Test Loss: 1.218 Test Acc: 0.639
Validation loss decreased (-0.372207 --> -0.638877).  Saving model ...
Epoch: 4 cost time: 1.546048641204834
Epoch: 4, Steps: 12 | Train Loss: 1.097 Vali Loss: 0.911 Vali Acc: 0.722 Test Loss: 0.911 Test Acc: 0.722
Validation loss decreased (-0.638877 --> -0.722213).  Saving model ...
Epoch: 5 cost time: 1.401592493057251
Epoch: 5, Steps: 12 | Train Loss: 0.854 Vali Loss: 0.740 Vali Acc: 0.728 Test Loss: 0.740 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727770).  Saving model ...
Epoch: 6 cost time: 1.5544841289520264
Epoch: 6, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
Validation loss decreased (-0.727770 --> -0.783327).  Saving model ...
Epoch: 7 cost time: 1.7577860355377197
Epoch: 7, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.567 Vali Acc: 0.739 Test Loss: 0.567 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4752779006958008
Epoch: 8, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.495 Vali Acc: 0.767 Test Loss: 0.495 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.556098222732544
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.518 Vali Acc: 0.772 Test Loss: 0.518 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.591695785522461
Epoch: 10, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.558 Vali Acc: 0.767 Test Loss: 0.558 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.668107032775879
Epoch: 11, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.436 Vali Acc: 0.794 Test Loss: 0.436 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 1.6333105564117432
Epoch: 12, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.409 Vali Acc: 0.817 Test Loss: 0.409 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 1.3142695426940918
Epoch: 13, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.414 Vali Acc: 0.828 Test Loss: 0.414 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.3870933055877686
Epoch: 14, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.404 Vali Acc: 0.817 Test Loss: 0.404 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3822219371795654
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.517 Vali Acc: 0.794 Test Loss: 0.517 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4640898704528809
Epoch: 16, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 1.4748311042785645
Epoch: 17, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 1.3441109657287598
Epoch: 18, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.466 Vali Acc: 0.806 Test Loss: 0.466 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.373534917831421
Epoch: 19, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.432 Vali Acc: 0.839 Test Loss: 0.432 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5763568878173828
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.397 Vali Acc: 0.839 Test Loss: 0.397 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0109810829162598
Epoch: 21, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.356 Vali Acc: 0.844 Test Loss: 0.356 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 1.479600429534912
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 1.3359105587005615
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.493 Vali Acc: 0.839 Test Loss: 0.493 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8416645526885986
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.411576271057129
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.405 Vali Acc: 0.844 Test Loss: 0.405 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7460391521453857
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4626317024230957
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6016466617584229
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.578042984008789
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4923770427703857
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.461 Vali Acc: 0.839 Test Loss: 0.461 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7376737594604492
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.522 Vali Acc: 0.839 Test Loss: 0.522 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8739807605743408
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 542698
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9835503101348877
Epoch: 1, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.803 Vali Acc: 0.233 Test Loss: 1.803 Test Acc: 0.233
Validation loss decreased (inf --> -0.233315).  Saving model ...
Epoch: 2 cost time: 1.4577155113220215
Epoch: 2, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.594 Vali Acc: 0.444 Test Loss: 1.594 Test Acc: 0.444
Validation loss decreased (-0.233315 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 1.4470338821411133
Epoch: 3, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.336 Vali Acc: 0.617 Test Loss: 1.336 Test Acc: 0.617
Validation loss decreased (-0.444429 --> -0.616653).  Saving model ...
Epoch: 4 cost time: 1.5441820621490479
Epoch: 4, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
Validation loss decreased (-0.616653 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 2.016496181488037
Epoch: 5, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.815 Vali Acc: 0.689 Test Loss: 0.815 Test Acc: 0.689
Validation loss decreased (-0.649989 --> -0.688881).  Saving model ...
Epoch: 6 cost time: 1.353745460510254
Epoch: 6, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.678 Vali Acc: 0.711 Test Loss: 0.678 Test Acc: 0.711
Validation loss decreased (-0.688881 --> -0.711104).  Saving model ...
Epoch: 7 cost time: 1.4434447288513184
Epoch: 7, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.631 Vali Acc: 0.744 Test Loss: 0.631 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 1.6769027709960938
Epoch: 8, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.537 Vali Acc: 0.700 Test Loss: 0.537 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4380462169647217
Epoch: 9, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.500 Vali Acc: 0.767 Test Loss: 0.500 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766662).  Saving model ...
Epoch: 10 cost time: 1.6993863582611084
Epoch: 10, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.457 Vali Acc: 0.761 Test Loss: 0.457 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.796464204788208
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.425 Vali Acc: 0.794 Test Loss: 0.425 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 12 cost time: 1.358177900314331
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.395 Vali Acc: 0.789 Test Loss: 0.395 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5699975490570068
Epoch: 13, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.408 Vali Acc: 0.806 Test Loss: 0.408 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 14 cost time: 1.6945579051971436
Epoch: 14, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.382 Vali Acc: 0.817 Test Loss: 0.382 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.5813829898834229
Epoch: 15, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 1.564697265625
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.466 Vali Acc: 0.806 Test Loss: 0.466 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3963451385498047
Epoch: 17, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.376 Vali Acc: 0.839 Test Loss: 0.376 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5303912162780762
Epoch: 18, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.447 Vali Acc: 0.828 Test Loss: 0.447 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4834721088409424
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.426 Vali Acc: 0.811 Test Loss: 0.426 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3066000938415527
Epoch: 20, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.423 Vali Acc: 0.856 Test Loss: 0.423 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 21 cost time: 1.7443716526031494
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.744086503982544
Epoch: 22, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.456 Vali Acc: 0.839 Test Loss: 0.456 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2349557876586914
Epoch: 23, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.382 Vali Acc: 0.856 Test Loss: 0.382 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 1.672212839126587
Epoch: 24, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.407 Vali Acc: 0.856 Test Loss: 0.407 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4043443202972412
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5474154949188232
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861106).  Saving model ...
Epoch: 27 cost time: 1.3661856651306152
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8503313064575195
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7504870891571045
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.577183485031128
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 31 cost time: 1.8211588859558105
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6583819389343262
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7214863300323486
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 34 cost time: 1.575601577758789
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.438 Vali Acc: 0.856 Test Loss: 0.438 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.887223243713379
Epoch: 35, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.439 Vali Acc: 0.872 Test Loss: 0.439 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 36 cost time: 1.634110689163208
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.489 Vali Acc: 0.883 Test Loss: 0.489 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883328).  Saving model ...
Epoch: 37 cost time: 2.0797343254089355
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.450 Vali Acc: 0.878 Test Loss: 0.450 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7805323600769043
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.690 Vali Acc: 0.817 Test Loss: 0.690 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7663764953613281
Epoch: 39, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.455 Vali Acc: 0.878 Test Loss: 0.455 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8980326652526855
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.715 Vali Acc: 0.839 Test Loss: 0.715 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6018414497375488
Epoch: 41, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.0506367683410645
Epoch: 42, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.6057407855987549
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4490344524383545
Epoch: 44, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.4916210174560547
Epoch: 45, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.8866782188415527
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 542186
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.488049030303955
Epoch: 1, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.722 Vali Acc: 0.267 Test Loss: 1.722 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 1.5824100971221924
Epoch: 2, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.486 Vali Acc: 0.556 Test Loss: 1.486 Test Acc: 0.556
Validation loss decreased (-0.266649 --> -0.555541).  Saving model ...
Epoch: 3 cost time: 1.7576463222503662
Epoch: 3, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.222 Vali Acc: 0.589 Test Loss: 1.222 Test Acc: 0.589
Validation loss decreased (-0.555541 --> -0.588877).  Saving model ...
Epoch: 4 cost time: 1.9466216564178467
Epoch: 4, Steps: 12 | Train Loss: 1.137 Vali Loss: 0.975 Vali Acc: 0.633 Test Loss: 0.975 Test Acc: 0.633
Validation loss decreased (-0.588877 --> -0.633324).  Saving model ...
Epoch: 5 cost time: 1.3822658061981201
Epoch: 5, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.866 Vali Acc: 0.667 Test Loss: 0.866 Test Acc: 0.667
Validation loss decreased (-0.633324 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.6365206241607666
Epoch: 6, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.693 Vali Acc: 0.672 Test Loss: 0.693 Test Acc: 0.672
Validation loss decreased (-0.666658 --> -0.672215).  Saving model ...
Epoch: 7 cost time: 1.5852737426757812
Epoch: 7, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.623 Vali Acc: 0.744 Test Loss: 0.623 Test Acc: 0.744
Validation loss decreased (-0.672215 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 1.555070400238037
Epoch: 8, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.568 Vali Acc: 0.772 Test Loss: 0.568 Test Acc: 0.772
Validation loss decreased (-0.744438 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 1.7499134540557861
Epoch: 9, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.466 Vali Acc: 0.750 Test Loss: 0.466 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.500864028930664
Epoch: 10, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 1.698566198348999
Epoch: 11, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.420 Vali Acc: 0.778 Test Loss: 0.420 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5496795177459717
Epoch: 12, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.404 Vali Acc: 0.811 Test Loss: 0.404 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 1.6737749576568604
Epoch: 13, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.180001735687256
Epoch: 14, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.734 Vali Acc: 0.778 Test Loss: 0.734 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6463816165924072
Epoch: 15, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.432 Vali Acc: 0.811 Test Loss: 0.432 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8423290252685547
Epoch: 16, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.387 Vali Acc: 0.817 Test Loss: 0.387 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 17 cost time: 1.928063154220581
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 1.8316478729248047
Epoch: 18, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7523672580718994
Epoch: 19, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.380110502243042
Epoch: 20, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 21 cost time: 1.6058154106140137
Epoch: 21, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.387 Vali Acc: 0.844 Test Loss: 0.387 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.609928846359253
Epoch: 22, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872218).  Saving model ...
Epoch: 23 cost time: 1.8084337711334229
Epoch: 23, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8430964946746826
Epoch: 24, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.433 Vali Acc: 0.844 Test Loss: 0.433 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.011014461517334
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.436 Vali Acc: 0.844 Test Loss: 0.436 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4267950057983398
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.392 Vali Acc: 0.839 Test Loss: 0.392 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.819573163986206
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5636274814605713
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7328760623931885
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.870915174484253
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.098236560821533
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3659906387329102
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 541674
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6615002155303955
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.698 Vali Acc: 0.311 Test Loss: 1.698 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 1.4783778190612793
Epoch: 2, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.475 Vali Acc: 0.644 Test Loss: 1.475 Test Acc: 0.644
Validation loss decreased (-0.311094 --> -0.644430).  Saving model ...
Epoch: 3 cost time: 1.261110544204712
Epoch: 3, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.230 Vali Acc: 0.661 Test Loss: 1.230 Test Acc: 0.661
Validation loss decreased (-0.644430 --> -0.661099).  Saving model ...
Epoch: 4 cost time: 1.4269955158233643
Epoch: 4, Steps: 12 | Train Loss: 1.148 Vali Loss: 0.971 Vali Acc: 0.678 Test Loss: 0.971 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677768).  Saving model ...
Epoch: 5 cost time: 1.523024320602417
Epoch: 5, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.798 Vali Acc: 0.694 Test Loss: 0.798 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694436).  Saving model ...
Epoch: 6 cost time: 1.5380456447601318
Epoch: 6, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.663 Vali Acc: 0.728 Test Loss: 0.663 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.6705141067504883
Epoch: 7, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3366286754608154
Epoch: 8, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.727771 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 1.1628317832946777
Epoch: 9, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.487 Vali Acc: 0.756 Test Loss: 0.487 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.136547327041626
Epoch: 10, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 1.3893110752105713
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 1.570890188217163
Epoch: 12, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.516 Vali Acc: 0.772 Test Loss: 0.516 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3597619533538818
Epoch: 13, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.385 Vali Acc: 0.811 Test Loss: 0.385 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5231478214263916
Epoch: 14, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 1.4305174350738525
Epoch: 15, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.510 Vali Acc: 0.800 Test Loss: 0.510 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4085133075714111
Epoch: 16, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.417 Vali Acc: 0.833 Test Loss: 0.417 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3140554428100586
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 18 cost time: 1.3007078170776367
Epoch: 18, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.405 Vali Acc: 0.806 Test Loss: 0.405 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5896306037902832
Epoch: 19, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.389 Vali Acc: 0.850 Test Loss: 0.389 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849996).  Saving model ...
Epoch: 20 cost time: 1.614814043045044
Epoch: 20, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.338 Vali Acc: 0.856 Test Loss: 0.338 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 1.7687065601348877
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4757866859436035
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 23 cost time: 1.6746437549591064
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5449488162994385
Epoch: 24, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.424 Vali Acc: 0.872 Test Loss: 0.424 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.333184003829956
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.364 Vali Acc: 0.856 Test Loss: 0.364 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3708791732788086
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.364 Vali Acc: 0.856 Test Loss: 0.364 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4389657974243164
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.454 Vali Acc: 0.856 Test Loss: 0.454 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.333538293838501
Epoch: 28, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6206645965576172
Epoch: 29, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.405 Vali Acc: 0.867 Test Loss: 0.405 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3788506984710693
Epoch: 30, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.542 Vali Acc: 0.839 Test Loss: 0.542 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.257084608078003
Epoch: 31, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.478 Vali Acc: 0.878 Test Loss: 0.478 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2449791431427002
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.439 Vali Acc: 0.839 Test Loss: 0.439 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 541162
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9905872344970703
Epoch: 1, Steps: 12 | Train Loss: 1.923 Vali Loss: 1.757 Vali Acc: 0.278 Test Loss: 1.757 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 1.4424405097961426
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.518 Vali Acc: 0.567 Test Loss: 1.518 Test Acc: 0.567
Validation loss decreased (-0.277760 --> -0.566651).  Saving model ...
Epoch: 3 cost time: 1.8658943176269531
Epoch: 3, Steps: 12 | Train Loss: 1.423 Vali Loss: 1.260 Vali Acc: 0.556 Test Loss: 1.260 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9398584365844727
Epoch: 4, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.009 Vali Acc: 0.706 Test Loss: 1.009 Test Acc: 0.706
Validation loss decreased (-0.566651 --> -0.705545).  Saving model ...
Epoch: 5 cost time: 1.553196668624878
Epoch: 5, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.788 Vali Acc: 0.756 Test Loss: 0.788 Test Acc: 0.756
Validation loss decreased (-0.705545 --> -0.755548).  Saving model ...
Epoch: 6 cost time: 1.4808876514434814
Epoch: 6, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.664 Vali Acc: 0.733 Test Loss: 0.664 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.888303279876709
Epoch: 7, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.587 Vali Acc: 0.778 Test Loss: 0.587 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777772).  Saving model ...
Epoch: 8 cost time: 1.8153553009033203
Epoch: 8, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.573 Vali Acc: 0.761 Test Loss: 0.573 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9784929752349854
Epoch: 9, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.532 Vali Acc: 0.767 Test Loss: 0.532 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.593231439590454
Epoch: 10, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.459 Vali Acc: 0.806 Test Loss: 0.459 Test Acc: 0.806
Validation loss decreased (-0.777772 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 1.5674779415130615
Epoch: 11, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.448 Vali Acc: 0.789 Test Loss: 0.448 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.348876953125
Epoch: 12, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.431 Vali Acc: 0.811 Test Loss: 0.431 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 1.5049831867218018
Epoch: 13, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.420 Vali Acc: 0.811 Test Loss: 0.420 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 1.3819315433502197
Epoch: 14, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 1.3482458591461182
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.387 Vali Acc: 0.817 Test Loss: 0.387 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6969239711761475
Epoch: 16, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.560 Vali Acc: 0.772 Test Loss: 0.560 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4584341049194336
Epoch: 17, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.336 Vali Acc: 0.817 Test Loss: 0.336 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.380028486251831
Epoch: 18, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 19 cost time: 1.8728864192962646
Epoch: 19, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 1.468724012374878
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.402514934539795
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.333 Vali Acc: 0.872 Test Loss: 0.333 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 2.2655434608459473
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8575403690338135
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3581273555755615
Epoch: 24, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6410009860992432
Epoch: 25, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.390 Vali Acc: 0.856 Test Loss: 0.390 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.374526023864746
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.024731159210205
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.343 Vali Acc: 0.861 Test Loss: 0.343 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8185977935791016
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.448 Vali Acc: 0.872 Test Loss: 0.448 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.726454257965088
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.343 Vali Acc: 0.872 Test Loss: 0.343 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.225043296813965
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.368 Vali Acc: 0.867 Test Loss: 0.368 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9441661834716797
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 460138
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.112631320953369
Epoch: 1, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.760 Vali Acc: 0.222 Test Loss: 1.760 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 1.7344436645507812
Epoch: 2, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.547 Vali Acc: 0.544 Test Loss: 1.547 Test Acc: 0.544
Validation loss decreased (-0.222205 --> -0.544429).  Saving model ...
Epoch: 3 cost time: 1.5378804206848145
Epoch: 3, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.298 Vali Acc: 0.589 Test Loss: 1.298 Test Acc: 0.589
Validation loss decreased (-0.544429 --> -0.588876).  Saving model ...
Epoch: 4 cost time: 1.6265461444854736
Epoch: 4, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.097 Vali Acc: 0.622 Test Loss: 1.097 Test Acc: 0.622
Validation loss decreased (-0.588876 --> -0.622211).  Saving model ...
Epoch: 5 cost time: 1.302560567855835
Epoch: 5, Steps: 12 | Train Loss: 0.999 Vali Loss: 0.859 Vali Acc: 0.667 Test Loss: 0.859 Test Acc: 0.667
Validation loss decreased (-0.622211 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.434586763381958
Epoch: 6, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.739 Vali Acc: 0.628 Test Loss: 0.739 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6834003925323486
Epoch: 7, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.656 Vali Acc: 0.744 Test Loss: 0.656 Test Acc: 0.744
Validation loss decreased (-0.666658 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 1.7898430824279785
Epoch: 8, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.561 Vali Acc: 0.756 Test Loss: 0.561 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 1.6806697845458984
Epoch: 9, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.512 Vali Acc: 0.794 Test Loss: 0.512 Test Acc: 0.794
Validation loss decreased (-0.755550 --> -0.794439).  Saving model ...
Epoch: 10 cost time: 1.672924518585205
Epoch: 10, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.496 Vali Acc: 0.750 Test Loss: 0.496 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4184725284576416
Epoch: 11, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.427 Vali Acc: 0.756 Test Loss: 0.427 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5422513484954834
Epoch: 12, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.441 Vali Acc: 0.783 Test Loss: 0.441 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5508029460906982
Epoch: 13, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
Validation loss decreased (-0.794439 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.5006096363067627
Epoch: 14, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.351 Vali Acc: 0.822 Test Loss: 0.351 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5350513458251953
Epoch: 15, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 1.963724136352539
Epoch: 16, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.533722162246704
Epoch: 17, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6731841564178467
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4339663982391357
Epoch: 19, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8647291660308838
Epoch: 20, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.333 Vali Acc: 0.856 Test Loss: 0.333 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 1.3816251754760742
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8775782585144043
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 23 cost time: 1.440230369567871
Epoch: 23, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 1.4286072254180908
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5317356586456299
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.393 Vali Acc: 0.878 Test Loss: 0.393 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 26 cost time: 1.3627815246582031
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 27 cost time: 1.447171688079834
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.406 Vali Acc: 0.872 Test Loss: 0.406 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6390190124511719
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6427974700927734
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.066516399383545
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.355 Vali Acc: 0.872 Test Loss: 0.355 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7604506015777588
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.379 Vali Acc: 0.878 Test Loss: 0.379 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5163805484771729
Epoch: 32, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.442 Vali Acc: 0.883 Test Loss: 0.442 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883329).  Saving model ...
Epoch: 33 cost time: 1.447113037109375
Epoch: 33, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3108389377593994
Epoch: 34, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.430 Vali Acc: 0.878 Test Loss: 0.430 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4589927196502686
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.441 Vali Acc: 0.844 Test Loss: 0.441 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4857196807861328
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.400 Vali Acc: 0.878 Test Loss: 0.400 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7479209899902344
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.432 Vali Acc: 0.883 Test Loss: 0.432 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 38 cost time: 1.6663596630096436
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.452 Vali Acc: 0.867 Test Loss: 0.452 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4540865421295166
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.437 Vali Acc: 0.883 Test Loss: 0.437 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6950929164886475
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.411 Vali Acc: 0.861 Test Loss: 0.411 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5006380081176758
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.442 Vali Acc: 0.867 Test Loss: 0.442 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9333958625793457
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.486 Vali Acc: 0.878 Test Loss: 0.486 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.5755679607391357
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.391 Vali Acc: 0.872 Test Loss: 0.391 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.585921049118042
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.883 Test Loss: 0.363 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883330).  Saving model ...
Epoch: 45 cost time: 1.5995490550994873
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.387 Vali Acc: 0.878 Test Loss: 0.387 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3645551204681396
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.422 Vali Acc: 0.878 Test Loss: 0.422 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.593634843826294
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.423 Vali Acc: 0.872 Test Loss: 0.423 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.4692184925079346
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.496727705001831
Epoch: 49, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.424 Vali Acc: 0.883 Test Loss: 0.424 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.7708806991577148
Epoch: 50, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.4627323150634766
Epoch: 51, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.5186057090759277
Epoch: 52, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.6179697513580322
Epoch: 53, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.4446675777435303
Epoch: 54, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 459626
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.75667405128479
Epoch: 1, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.742 Vali Acc: 0.267 Test Loss: 1.742 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 1.2448883056640625
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.507 Vali Acc: 0.594 Test Loss: 1.507 Test Acc: 0.594
Validation loss decreased (-0.266649 --> -0.594429).  Saving model ...
Epoch: 3 cost time: 1.154160737991333
Epoch: 3, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.243 Vali Acc: 0.644 Test Loss: 1.243 Test Acc: 0.644
Validation loss decreased (-0.594429 --> -0.644432).  Saving model ...
Epoch: 4 cost time: 1.3112726211547852
Epoch: 4, Steps: 12 | Train Loss: 1.177 Vali Loss: 0.987 Vali Acc: 0.667 Test Loss: 0.987 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 1.3172640800476074
Epoch: 5, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.780 Vali Acc: 0.717 Test Loss: 0.780 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.716659).  Saving model ...
Epoch: 6 cost time: 1.233428716659546
Epoch: 6, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722215).  Saving model ...
Epoch: 7 cost time: 1.8256111145019531
Epoch: 7, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.627 Vali Acc: 0.706 Test Loss: 0.627 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4859845638275146
Epoch: 8, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.559 Vali Acc: 0.756 Test Loss: 0.559 Test Acc: 0.756
Validation loss decreased (-0.722215 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 1.4298889636993408
Epoch: 9, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.509 Vali Acc: 0.761 Test Loss: 0.509 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 10 cost time: 1.490724802017212
Epoch: 10, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.461 Vali Acc: 0.761 Test Loss: 0.461 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 1.3064055442810059
Epoch: 11, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.480 Vali Acc: 0.750 Test Loss: 0.480 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4523653984069824
Epoch: 12, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.496 Vali Acc: 0.750 Test Loss: 0.496 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.521432876586914
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.441 Vali Acc: 0.811 Test Loss: 0.441 Test Acc: 0.811
Validation loss decreased (-0.761106 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 1.3899047374725342
Epoch: 14, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.415 Vali Acc: 0.794 Test Loss: 0.415 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.438241720199585
Epoch: 15, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.380 Vali Acc: 0.856 Test Loss: 0.380 Test Acc: 0.856
Validation loss decreased (-0.811107 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.3563780784606934
Epoch: 16, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.392 Vali Acc: 0.817 Test Loss: 0.392 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3599400520324707
Epoch: 17, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.391 Vali Acc: 0.811 Test Loss: 0.391 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.443352460861206
Epoch: 18, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3797037601470947
Epoch: 19, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4715397357940674
Epoch: 20, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6966969966888428
Epoch: 21, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7738430500030518
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.488776445388794
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.311223030090332
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.420 Vali Acc: 0.856 Test Loss: 0.420 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3367698192596436
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 459114
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.394266366958618
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.727 Vali Acc: 0.217 Test Loss: 1.727 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 1.6222789287567139
Epoch: 2, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.508 Vali Acc: 0.544 Test Loss: 1.508 Test Acc: 0.544
Validation loss decreased (-0.216649 --> -0.544429).  Saving model ...
Epoch: 3 cost time: 1.8847334384918213
Epoch: 3, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.257 Vali Acc: 0.611 Test Loss: 1.257 Test Acc: 0.611
Validation loss decreased (-0.544429 --> -0.611099).  Saving model ...
Epoch: 4 cost time: 1.822092056274414
Epoch: 4, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.008 Vali Acc: 0.650 Test Loss: 1.008 Test Acc: 0.650
Validation loss decreased (-0.611099 --> -0.649990).  Saving model ...
Epoch: 5 cost time: 1.6457998752593994
Epoch: 5, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.834 Vali Acc: 0.633 Test Loss: 0.834 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9526212215423584
Epoch: 6, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.716 Vali Acc: 0.694 Test Loss: 0.716 Test Acc: 0.694
Validation loss decreased (-0.649990 --> -0.694437).  Saving model ...
Epoch: 7 cost time: 1.571509838104248
Epoch: 7, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
Validation loss decreased (-0.694437 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 1.452432632446289
Epoch: 8, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.8115029335021973
Epoch: 9, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.491 Vali Acc: 0.767 Test Loss: 0.491 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766662).  Saving model ...
Epoch: 10 cost time: 1.8132989406585693
Epoch: 10, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.487 Vali Acc: 0.750 Test Loss: 0.487 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8289427757263184
Epoch: 11, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.537 Vali Acc: 0.794 Test Loss: 0.537 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794439).  Saving model ...
Epoch: 12 cost time: 1.6246371269226074
Epoch: 12, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.455 Vali Acc: 0.817 Test Loss: 0.455 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 1.4742519855499268
Epoch: 13, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.411 Vali Acc: 0.783 Test Loss: 0.411 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6953213214874268
Epoch: 14, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.442814826965332
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.857511281967163
Epoch: 16, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822217).  Saving model ...
Epoch: 17 cost time: 1.4912607669830322
Epoch: 17, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4245610237121582
Epoch: 18, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827773).  Saving model ...
Epoch: 19 cost time: 1.3815672397613525
Epoch: 19, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844441).  Saving model ...
Epoch: 20 cost time: 2.0279548168182373
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.458 Vali Acc: 0.828 Test Loss: 0.458 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.267416000366211
Epoch: 21, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 1.4869863986968994
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.388 Vali Acc: 0.856 Test Loss: 0.388 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.751826524734497
Epoch: 23, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7885901927947998
Epoch: 24, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.631366491317749
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.411 Vali Acc: 0.867 Test Loss: 0.411 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 26 cost time: 1.8085463047027588
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9290564060211182
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.436 Vali Acc: 0.867 Test Loss: 0.436 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7128300666809082
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.428 Vali Acc: 0.844 Test Loss: 0.428 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6132900714874268
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.437 Vali Acc: 0.867 Test Loss: 0.437 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8926589488983154
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.426 Vali Acc: 0.856 Test Loss: 0.426 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.946488857269287
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872218).  Saving model ...
Epoch: 32 cost time: 1.5727741718292236
Epoch: 32, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.422 Vali Acc: 0.856 Test Loss: 0.422 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9135034084320068
Epoch: 33, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6867191791534424
Epoch: 34, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.461 Vali Acc: 0.839 Test Loss: 0.461 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6734404563903809
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6394908428192139
Epoch: 36, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.494 Vali Acc: 0.872 Test Loss: 0.494 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7352626323699951
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.426 Vali Acc: 0.856 Test Loss: 0.426 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5336744785308838
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.446 Vali Acc: 0.861 Test Loss: 0.446 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.8934907913208008
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 40 cost time: 1.830590009689331
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.2565689086914062
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.438 Vali Acc: 0.872 Test Loss: 0.438 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7496588230133057
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.820894718170166
Epoch: 43, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.0737056732177734
Epoch: 44, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.421 Vali Acc: 0.867 Test Loss: 0.421 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6110548973083496
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.473 Vali Acc: 0.861 Test Loss: 0.473 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.7246978282928467
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.6243247985839844
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.431 Vali Acc: 0.878 Test Loss: 0.431 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 48 cost time: 1.9617493152618408
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.494896411895752
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.613213062286377
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.4959750175476074
Epoch: 51, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.522 Vali Acc: 0.872 Test Loss: 0.522 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.6408183574676514
Epoch: 52, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.72806715965271
Epoch: 53, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.70920991897583
Epoch: 54, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.9353976249694824
Epoch: 55, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.7851252555847168
Epoch: 56, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.9781825542449951
Epoch: 57, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.720 Vali Acc: 0.861 Test Loss: 0.720 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 458602
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.221956729888916
Epoch: 1, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.778 Vali Acc: 0.189 Test Loss: 1.778 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 1.669447660446167
Epoch: 2, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.621 Vali Acc: 0.422 Test Loss: 1.621 Test Acc: 0.422
Validation loss decreased (-0.188871 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 1.3062005043029785
Epoch: 3, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.418 Vali Acc: 0.572 Test Loss: 1.418 Test Acc: 0.572
Validation loss decreased (-0.422206 --> -0.572208).  Saving model ...
Epoch: 4 cost time: 1.4910979270935059
Epoch: 4, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.167 Vali Acc: 0.644 Test Loss: 1.167 Test Acc: 0.644
Validation loss decreased (-0.572208 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 1.5683681964874268
Epoch: 5, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.912 Vali Acc: 0.711 Test Loss: 0.912 Test Acc: 0.711
Validation loss decreased (-0.644433 --> -0.711102).  Saving model ...
Epoch: 6 cost time: 1.4128117561340332
Epoch: 6, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.768 Vali Acc: 0.767 Test Loss: 0.768 Test Acc: 0.767
Validation loss decreased (-0.711102 --> -0.766659).  Saving model ...
Epoch: 7 cost time: 1.7653965950012207
Epoch: 7, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.669 Vali Acc: 0.739 Test Loss: 0.669 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9368293285369873
Epoch: 8, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.598 Vali Acc: 0.778 Test Loss: 0.598 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 1.528508186340332
Epoch: 9, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.538 Vali Acc: 0.761 Test Loss: 0.538 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5218985080718994
Epoch: 10, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.487 Vali Acc: 0.789 Test Loss: 0.487 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 1.5622076988220215
Epoch: 11, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.447 Vali Acc: 0.817 Test Loss: 0.447 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 1.294623851776123
Epoch: 12, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.429 Vali Acc: 0.811 Test Loss: 0.429 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7883188724517822
Epoch: 13, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.408 Vali Acc: 0.800 Test Loss: 0.408 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.757190227508545
Epoch: 14, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.433 Vali Acc: 0.806 Test Loss: 0.433 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.691589593887329
Epoch: 15, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.384 Vali Acc: 0.833 Test Loss: 0.384 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 1.6745951175689697
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.385 Vali Acc: 0.794 Test Loss: 0.385 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6760118007659912
Epoch: 17, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.415 Vali Acc: 0.806 Test Loss: 0.415 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4169902801513672
Epoch: 18, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.391 Vali Acc: 0.800 Test Loss: 0.391 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7001373767852783
Epoch: 19, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.443 Vali Acc: 0.794 Test Loss: 0.443 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6278996467590332
Epoch: 20, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.382 Vali Acc: 0.789 Test Loss: 0.382 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5001723766326904
Epoch: 21, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9389045238494873
Epoch: 22, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.380 Vali Acc: 0.844 Test Loss: 0.380 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 1.7767999172210693
Epoch: 23, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.57839035987854
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.372 Vali Acc: 0.817 Test Loss: 0.372 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5023062229156494
Epoch: 25, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5108487606048584
Epoch: 26, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.332 Vali Acc: 0.844 Test Loss: 0.332 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 1.2703895568847656
Epoch: 27, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 28 cost time: 1.3351898193359375
Epoch: 28, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.399 Vali Acc: 0.806 Test Loss: 0.399 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.409353256225586
Epoch: 29, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4618990421295166
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.381 Vali Acc: 0.828 Test Loss: 0.381 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6262214183807373
Epoch: 31, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 32 cost time: 1.275132656097412
Epoch: 32, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.416 Vali Acc: 0.839 Test Loss: 0.416 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4544780254364014
Epoch: 33, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.451 Vali Acc: 0.839 Test Loss: 0.451 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5606119632720947
Epoch: 34, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.414 Vali Acc: 0.828 Test Loss: 0.414 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2720880508422852
Epoch: 35, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4863955974578857
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 37 cost time: 1.6758520603179932
Epoch: 37, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.557183027267456
Epoch: 38, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.427 Vali Acc: 0.822 Test Loss: 0.427 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6234490871429443
Epoch: 39, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8343501091003418
Epoch: 40, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.426 Vali Acc: 0.828 Test Loss: 0.426 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.733276128768921
Epoch: 41, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.429 Vali Acc: 0.839 Test Loss: 0.429 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.9022307395935059
Epoch: 42, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.772984504699707
Epoch: 43, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.424 Vali Acc: 0.828 Test Loss: 0.424 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.6261827945709229
Epoch: 44, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.626028299331665
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.460 Vali Acc: 0.817 Test Loss: 0.460 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4359104633331299
Epoch: 46, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.457 Vali Acc: 0.861 Test Loss: 0.457 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 439690
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.678504705429077
Epoch: 1, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.785 Vali Acc: 0.183 Test Loss: 1.785 Test Acc: 0.183
Validation loss decreased (inf --> -0.183315).  Saving model ...
Epoch: 2 cost time: 1.6457366943359375
Epoch: 2, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.657 Vali Acc: 0.306 Test Loss: 1.657 Test Acc: 0.306
Validation loss decreased (-0.183315 --> -0.305539).  Saving model ...
Epoch: 3 cost time: 1.4688167572021484
Epoch: 3, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.448 Vali Acc: 0.606 Test Loss: 1.448 Test Acc: 0.606
Validation loss decreased (-0.305539 --> -0.605541).  Saving model ...
Epoch: 4 cost time: 1.7851848602294922
Epoch: 4, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.208 Vali Acc: 0.728 Test Loss: 1.208 Test Acc: 0.728
Validation loss decreased (-0.605541 --> -0.727766).  Saving model ...
Epoch: 5 cost time: 1.9787843227386475
Epoch: 5, Steps: 12 | Train Loss: 1.036 Vali Loss: 0.928 Vali Acc: 0.750 Test Loss: 0.928 Test Acc: 0.750
Validation loss decreased (-0.727766 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.8263275623321533
Epoch: 6, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.753 Vali Acc: 0.739 Test Loss: 0.753 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0672664642333984
Epoch: 7, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.663 Vali Acc: 0.739 Test Loss: 0.663 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6395635604858398
Epoch: 8, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.601 Vali Acc: 0.744 Test Loss: 0.601 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6102499961853027
Epoch: 9, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761106).  Saving model ...
Epoch: 10 cost time: 1.6421830654144287
Epoch: 10, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.462 Vali Acc: 0.811 Test Loss: 0.462 Test Acc: 0.811
Validation loss decreased (-0.761106 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 1.7039659023284912
Epoch: 11, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.463 Vali Acc: 0.789 Test Loss: 0.463 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8526933193206787
Epoch: 12, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.425 Vali Acc: 0.789 Test Loss: 0.425 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.905365228652954
Epoch: 13, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.426 Vali Acc: 0.828 Test Loss: 0.426 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.828418254852295
Epoch: 14, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5416953563690186
Epoch: 15, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 1.4384849071502686
Epoch: 16, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 1.7540287971496582
Epoch: 17, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.422 Vali Acc: 0.828 Test Loss: 0.422 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.599604606628418
Epoch: 18, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.377 Vali Acc: 0.789 Test Loss: 0.377 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9540023803710938
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 20 cost time: 1.712845802307129
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.387 Vali Acc: 0.794 Test Loss: 0.387 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6535279750823975
Epoch: 21, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.424 Vali Acc: 0.806 Test Loss: 0.424 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2912516593933105
Epoch: 22, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.351 Vali Acc: 0.844 Test Loss: 0.351 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.020864725112915
Epoch: 23, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.360 Vali Acc: 0.867 Test Loss: 0.360 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 24 cost time: 1.9701642990112305
Epoch: 24, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9919099807739258
Epoch: 25, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.435 Vali Acc: 0.794 Test Loss: 0.435 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7711255550384521
Epoch: 26, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.453 Vali Acc: 0.817 Test Loss: 0.453 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.595750093460083
Epoch: 27, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.369 Vali Acc: 0.806 Test Loss: 0.369 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.877927541732788
Epoch: 28, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9222421646118164
Epoch: 29, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.451 Vali Acc: 0.828 Test Loss: 0.451 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9082129001617432
Epoch: 30, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.392 Vali Acc: 0.794 Test Loss: 0.392 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9425721168518066
Epoch: 31, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.450 Vali Acc: 0.794 Test Loss: 0.450 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5269901752471924
Epoch: 32, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6495022773742676
Epoch: 33, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.437 Vali Acc: 0.817 Test Loss: 0.437 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 439434
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6874632835388184
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.746 Vali Acc: 0.272 Test Loss: 1.746 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 1.9285335540771484
Epoch: 2, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.611 Vali Acc: 0.428 Test Loss: 1.611 Test Acc: 0.428
Validation loss decreased (-0.272205 --> -0.427762).  Saving model ...
Epoch: 3 cost time: 1.6080594062805176
Epoch: 3, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.413 Vali Acc: 0.639 Test Loss: 1.413 Test Acc: 0.639
Validation loss decreased (-0.427762 --> -0.638875).  Saving model ...
Epoch: 4 cost time: 1.46730375289917
Epoch: 4, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.179 Vali Acc: 0.661 Test Loss: 1.179 Test Acc: 0.661
Validation loss decreased (-0.638875 --> -0.661099).  Saving model ...
Epoch: 5 cost time: 1.293607234954834
Epoch: 5, Steps: 12 | Train Loss: 1.088 Vali Loss: 0.932 Vali Acc: 0.689 Test Loss: 0.932 Test Acc: 0.689
Validation loss decreased (-0.661099 --> -0.688880).  Saving model ...
Epoch: 6 cost time: 1.8232176303863525
Epoch: 6, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.757 Vali Acc: 0.678 Test Loss: 0.757 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5011022090911865
Epoch: 7, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.626 Vali Acc: 0.739 Test Loss: 0.626 Test Acc: 0.739
Validation loss decreased (-0.688880 --> -0.738883).  Saving model ...
Epoch: 8 cost time: 1.5028131008148193
Epoch: 8, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.569 Vali Acc: 0.744 Test Loss: 0.569 Test Acc: 0.744
Validation loss decreased (-0.738883 --> -0.744439).  Saving model ...
Epoch: 9 cost time: 1.741400957107544
Epoch: 9, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.535 Vali Acc: 0.767 Test Loss: 0.535 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 1.4515721797943115
Epoch: 10, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.485 Vali Acc: 0.767 Test Loss: 0.485 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766662).  Saving model ...
Epoch: 11 cost time: 1.2828314304351807
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.450 Vali Acc: 0.772 Test Loss: 0.450 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 12 cost time: 1.3230221271514893
Epoch: 12, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.428 Vali Acc: 0.811 Test Loss: 0.428 Test Acc: 0.811
Validation loss decreased (-0.772218 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 1.639571189880371
Epoch: 13, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.427 Vali Acc: 0.806 Test Loss: 0.427 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5459215641021729
Epoch: 14, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.444 Vali Acc: 0.778 Test Loss: 0.444 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4232463836669922
Epoch: 15, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.616673231124878
Epoch: 16, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.470 Vali Acc: 0.783 Test Loss: 0.470 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5728363990783691
Epoch: 17, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.483 Vali Acc: 0.778 Test Loss: 0.483 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2521488666534424
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.462 Vali Acc: 0.789 Test Loss: 0.462 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.273514986038208
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.400 Vali Acc: 0.817 Test Loss: 0.400 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 20 cost time: 1.3495924472808838
Epoch: 20, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.443 Vali Acc: 0.783 Test Loss: 0.443 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4940910339355469
Epoch: 21, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.424 Vali Acc: 0.822 Test Loss: 0.424 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 1.6083204746246338
Epoch: 22, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6221649646759033
Epoch: 23, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.420 Vali Acc: 0.778 Test Loss: 0.420 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3827769756317139
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.418 Vali Acc: 0.828 Test Loss: 0.418 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 1.54841947555542
Epoch: 25, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 26 cost time: 1.389617681503296
Epoch: 26, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.460 Vali Acc: 0.789 Test Loss: 0.460 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8910846710205078
Epoch: 27, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.490 Vali Acc: 0.817 Test Loss: 0.490 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5482115745544434
Epoch: 28, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.439 Vali Acc: 0.806 Test Loss: 0.439 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8489775657653809
Epoch: 29, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.480 Vali Acc: 0.789 Test Loss: 0.480 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3514103889465332
Epoch: 30, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.411 Vali Acc: 0.856 Test Loss: 0.411 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 31 cost time: 1.4516801834106445
Epoch: 31, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.457 Vali Acc: 0.794 Test Loss: 0.457 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.492582082748413
Epoch: 32, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.418 Vali Acc: 0.806 Test Loss: 0.418 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7059102058410645
Epoch: 33, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.459 Vali Acc: 0.800 Test Loss: 0.459 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5212724208831787
Epoch: 34, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4216580390930176
Epoch: 35, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6674132347106934
Epoch: 36, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.557 Vali Acc: 0.778 Test Loss: 0.557 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4683008193969727
Epoch: 37, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7170815467834473
Epoch: 38, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.523 Vali Acc: 0.839 Test Loss: 0.523 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.450897216796875
Epoch: 39, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.423222541809082
Epoch: 40, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 439178
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.110273361206055
Epoch: 1, Steps: 12 | Train Loss: 1.911 Vali Loss: 1.778 Vali Acc: 0.261 Test Loss: 1.778 Test Acc: 0.261
Validation loss decreased (inf --> -0.261093).  Saving model ...
Epoch: 2 cost time: 1.5728051662445068
Epoch: 2, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.647 Vali Acc: 0.294 Test Loss: 1.647 Test Acc: 0.294
Validation loss decreased (-0.261093 --> -0.294428).  Saving model ...
Epoch: 3 cost time: 1.8077170848846436
Epoch: 3, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.462 Vali Acc: 0.611 Test Loss: 1.462 Test Acc: 0.611
Validation loss decreased (-0.294428 --> -0.611096).  Saving model ...
Epoch: 4 cost time: 1.9338996410369873
Epoch: 4, Steps: 12 | Train Loss: 1.373 Vali Loss: 1.203 Vali Acc: 0.656 Test Loss: 1.203 Test Acc: 0.656
Validation loss decreased (-0.611096 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 1.824512004852295
Epoch: 5, Steps: 12 | Train Loss: 1.117 Vali Loss: 0.949 Vali Acc: 0.700 Test Loss: 0.949 Test Acc: 0.700
Validation loss decreased (-0.655544 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 1.617201328277588
Epoch: 6, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.780 Vali Acc: 0.678 Test Loss: 0.780 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6436946392059326
Epoch: 7, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.654 Vali Acc: 0.750 Test Loss: 0.654 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.836111068725586
Epoch: 8, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.380800724029541
Epoch: 9, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 1.5048511028289795
Epoch: 10, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 1.7747135162353516
Epoch: 11, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.472 Vali Acc: 0.761 Test Loss: 0.472 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.364262342453003
Epoch: 12, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.470 Vali Acc: 0.794 Test Loss: 0.470 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 1.5497231483459473
Epoch: 13, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.473 Vali Acc: 0.772 Test Loss: 0.473 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5412437915802002
Epoch: 14, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.418 Vali Acc: 0.783 Test Loss: 0.418 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5927400588989258
Epoch: 15, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 1.449173927307129
Epoch: 16, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 1.6777851581573486
Epoch: 17, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.348 Vali Acc: 0.811 Test Loss: 0.348 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5871047973632812
Epoch: 18, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.444 Vali Acc: 0.794 Test Loss: 0.444 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8471894264221191
Epoch: 19, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.379 Vali Acc: 0.794 Test Loss: 0.379 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6312363147735596
Epoch: 20, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.345 Vali Acc: 0.844 Test Loss: 0.345 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 21 cost time: 2.0360424518585205
Epoch: 21, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0895941257476807
Epoch: 22, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.202143430709839
Epoch: 23, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.375 Vali Acc: 0.789 Test Loss: 0.375 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0459389686584473
Epoch: 24, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.347 Vali Acc: 0.811 Test Loss: 0.347 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1005749702453613
Epoch: 25, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.346 Vali Acc: 0.822 Test Loss: 0.346 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6481821537017822
Epoch: 26, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5736286640167236
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.379 Vali Acc: 0.828 Test Loss: 0.379 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9209797382354736
Epoch: 28, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9880027770996094
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.406 Vali Acc: 0.794 Test Loss: 0.406 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.114960193634033
Epoch: 30, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.427 Vali Acc: 0.817 Test Loss: 0.427 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 438922
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1473472118377686
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.761 Vali Acc: 0.272 Test Loss: 1.761 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 2.40181827545166
Epoch: 2, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.667 Vali Acc: 0.411 Test Loss: 1.667 Test Acc: 0.411
Validation loss decreased (-0.272205 --> -0.411094).  Saving model ...
Epoch: 3 cost time: 1.4293599128723145
Epoch: 3, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.503 Vali Acc: 0.594 Test Loss: 1.503 Test Acc: 0.594
Validation loss decreased (-0.411094 --> -0.594429).  Saving model ...
Epoch: 4 cost time: 1.8545215129852295
Epoch: 4, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.315 Vali Acc: 0.644 Test Loss: 1.315 Test Acc: 0.644
Validation loss decreased (-0.594429 --> -0.644431).  Saving model ...
Epoch: 5 cost time: 2.0927069187164307
Epoch: 5, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.068 Vali Acc: 0.661 Test Loss: 1.068 Test Acc: 0.661
Validation loss decreased (-0.644431 --> -0.661100).  Saving model ...
Epoch: 6 cost time: 1.742912769317627
Epoch: 6, Steps: 12 | Train Loss: 0.965 Vali Loss: 0.850 Vali Acc: 0.700 Test Loss: 0.850 Test Acc: 0.700
Validation loss decreased (-0.661100 --> -0.699991).  Saving model ...
Epoch: 7 cost time: 1.8196725845336914
Epoch: 7, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.721 Vali Acc: 0.711 Test Loss: 0.721 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711104).  Saving model ...
Epoch: 8 cost time: 1.8060979843139648
Epoch: 8, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.630 Vali Acc: 0.733 Test Loss: 0.630 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 1.8519513607025146
Epoch: 9, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.563 Vali Acc: 0.756 Test Loss: 0.563 Test Acc: 0.756
Validation loss decreased (-0.733327 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 1.8718335628509521
Epoch: 10, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.511 Vali Acc: 0.794 Test Loss: 0.511 Test Acc: 0.794
Validation loss decreased (-0.755550 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 1.6548941135406494
Epoch: 11, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.472 Vali Acc: 0.811 Test Loss: 0.472 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 1.5990099906921387
Epoch: 12, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.449 Vali Acc: 0.800 Test Loss: 0.449 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7399115562438965
Epoch: 13, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.424 Vali Acc: 0.806 Test Loss: 0.424 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.645129680633545
Epoch: 14, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.399 Vali Acc: 0.817 Test Loss: 0.399 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.7102234363555908
Epoch: 15, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 1.5726442337036133
Epoch: 16, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6483087539672852
Epoch: 17, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 18 cost time: 1.7074306011199951
Epoch: 18, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.387 Vali Acc: 0.817 Test Loss: 0.387 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5221376419067383
Epoch: 19, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.370 Vali Acc: 0.811 Test Loss: 0.370 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5572848320007324
Epoch: 20, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 21 cost time: 2.194437026977539
Epoch: 21, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.472 Vali Acc: 0.806 Test Loss: 0.472 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4072728157043457
Epoch: 22, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8408231735229492
Epoch: 23, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 1.713151216506958
Epoch: 24, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.362 Vali Acc: 0.844 Test Loss: 0.362 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.9663949012756348
Epoch: 25, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.396 Vali Acc: 0.800 Test Loss: 0.396 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2235889434814453
Epoch: 26, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.349 Vali Acc: 0.839 Test Loss: 0.349 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7812979221343994
Epoch: 27, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.363 Vali Acc: 0.844 Test Loss: 0.363 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.679750680923462
Epoch: 28, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 29 cost time: 1.9650661945343018
Epoch: 29, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.467 Vali Acc: 0.822 Test Loss: 0.467 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1250383853912354
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.422 Vali Acc: 0.806 Test Loss: 0.422 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.2947793006896973
Epoch: 31, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.396 Vali Acc: 0.856 Test Loss: 0.396 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 32 cost time: 1.8742995262145996
Epoch: 32, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.412 Vali Acc: 0.844 Test Loss: 0.412 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5083065032958984
Epoch: 33, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.367 Vali Acc: 0.839 Test Loss: 0.367 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.601045846939087
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7432551383972168
Epoch: 35, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.805239200592041
Epoch: 36, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.357 Vali Acc: 0.856 Test Loss: 0.357 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 37 cost time: 1.6062793731689453
Epoch: 37, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.794905424118042
Epoch: 38, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3511159420013428
Epoch: 39, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.402 Vali Acc: 0.844 Test Loss: 0.402 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7047150135040283
Epoch: 40, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.810767412185669
Epoch: 41, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.7497127056121826
Epoch: 42, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.457 Vali Acc: 0.844 Test Loss: 0.457 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7620055675506592
Epoch: 43, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.424 Vali Acc: 0.856 Test Loss: 0.424 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.524322509765625
Epoch: 44, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.441 Vali Acc: 0.844 Test Loss: 0.441 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.6786317825317383
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7369532585144043
Epoch: 46, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.437 Vali Acc: 0.817 Test Loss: 0.437 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 273290
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.224043846130371
Epoch: 1, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.714 Vali Acc: 0.344 Test Loss: 1.714 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 1.781810998916626
Epoch: 2, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.596 Vali Acc: 0.417 Test Loss: 1.596 Test Acc: 0.417
Validation loss decreased (-0.344427 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 1.474843978881836
Epoch: 3, Steps: 12 | Train Loss: 1.574 Vali Loss: 1.436 Vali Acc: 0.594 Test Loss: 1.436 Test Acc: 0.594
Validation loss decreased (-0.416651 --> -0.594430).  Saving model ...
Epoch: 4 cost time: 1.3315329551696777
Epoch: 4, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.256 Vali Acc: 0.672 Test Loss: 1.256 Test Acc: 0.672
Validation loss decreased (-0.594430 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.7239789962768555
Epoch: 5, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.045 Vali Acc: 0.656 Test Loss: 1.045 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.738783597946167
Epoch: 6, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
Validation loss decreased (-0.672210 --> -0.705547).  Saving model ...
Epoch: 7 cost time: 1.6017732620239258
Epoch: 7, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.744 Vali Acc: 0.706 Test Loss: 0.744 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 1.6994740962982178
Epoch: 8, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 2.090787172317505
Epoch: 9, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.591 Vali Acc: 0.728 Test Loss: 0.591 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5493760108947754
Epoch: 10, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.544 Vali Acc: 0.756 Test Loss: 0.544 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 1.5984082221984863
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.486 Vali Acc: 0.783 Test Loss: 0.486 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783328).  Saving model ...
Epoch: 12 cost time: 1.419605016708374
Epoch: 12, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.452 Vali Acc: 0.794 Test Loss: 0.452 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 1.5477964878082275
Epoch: 13, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.433 Vali Acc: 0.789 Test Loss: 0.433 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.640608549118042
Epoch: 14, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.399 Vali Acc: 0.822 Test Loss: 0.399 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 1.6816911697387695
Epoch: 15, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.396 Vali Acc: 0.828 Test Loss: 0.396 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 1.725440502166748
Epoch: 16, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.385 Vali Acc: 0.817 Test Loss: 0.385 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3512682914733887
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.467 Vali Acc: 0.800 Test Loss: 0.467 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.019437789916992
Epoch: 18, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.390 Vali Acc: 0.789 Test Loss: 0.390 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.976656436920166
Epoch: 19, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.361 Vali Acc: 0.817 Test Loss: 0.361 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7493538856506348
Epoch: 20, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 21 cost time: 1.6185128688812256
Epoch: 21, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.389 Vali Acc: 0.794 Test Loss: 0.389 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.002241611480713
Epoch: 22, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.395 Vali Acc: 0.833 Test Loss: 0.395 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2185072898864746
Epoch: 23, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9503517150878906
Epoch: 24, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.373 Vali Acc: 0.806 Test Loss: 0.373 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.042361259460449
Epoch: 25, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.372 Vali Acc: 0.839 Test Loss: 0.372 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7544035911560059
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.373 Vali Acc: 0.806 Test Loss: 0.373 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6690168380737305
Epoch: 27, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8567798137664795
Epoch: 28, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.717925786972046
Epoch: 29, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.418 Vali Acc: 0.839 Test Loss: 0.418 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5731029510498047
Epoch: 30, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.441 Vali Acc: 0.828 Test Loss: 0.441 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 273034
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.115771532058716
Epoch: 1, Steps: 12 | Train Loss: 1.874 Vali Loss: 1.748 Vali Acc: 0.211 Test Loss: 1.748 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.5817782878875732
Epoch: 2, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.687 Vali Acc: 0.278 Test Loss: 1.687 Test Acc: 0.278
Validation loss decreased (-0.211094 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 1.4761760234832764
Epoch: 3, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.520 Vali Acc: 0.444 Test Loss: 1.520 Test Acc: 0.444
Validation loss decreased (-0.277761 --> -0.444429).  Saving model ...
Epoch: 4 cost time: 1.4951860904693604
Epoch: 4, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.324 Vali Acc: 0.656 Test Loss: 1.324 Test Acc: 0.656
Validation loss decreased (-0.444429 --> -0.655542).  Saving model ...
Epoch: 5 cost time: 1.6468493938446045
Epoch: 5, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.098 Vali Acc: 0.728 Test Loss: 1.098 Test Acc: 0.728
Validation loss decreased (-0.655542 --> -0.727767).  Saving model ...
Epoch: 6 cost time: 1.6666700839996338
Epoch: 6, Steps: 12 | Train Loss: 0.982 Vali Loss: 0.900 Vali Acc: 0.678 Test Loss: 0.900 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6333363056182861
Epoch: 7, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.779 Vali Acc: 0.717 Test Loss: 0.779 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6126997470855713
Epoch: 8, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.683 Vali Acc: 0.744 Test Loss: 0.683 Test Acc: 0.744
Validation loss decreased (-0.727767 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 1.5763914585113525
Epoch: 9, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.613 Vali Acc: 0.756 Test Loss: 0.613 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 1.3938755989074707
Epoch: 10, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.568 Vali Acc: 0.772 Test Loss: 0.568 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 1.7579970359802246
Epoch: 11, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.512 Vali Acc: 0.778 Test Loss: 0.512 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 12 cost time: 1.8472669124603271
Epoch: 12, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.486 Vali Acc: 0.783 Test Loss: 0.486 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783328).  Saving model ...
Epoch: 13 cost time: 1.6569128036499023
Epoch: 13, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.472 Vali Acc: 0.789 Test Loss: 0.472 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 14 cost time: 1.5065879821777344
Epoch: 14, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.462 Vali Acc: 0.778 Test Loss: 0.462 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7300870418548584
Epoch: 15, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.418 Vali Acc: 0.806 Test Loss: 0.418 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 16 cost time: 1.685476303100586
Epoch: 16, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.454 Vali Acc: 0.794 Test Loss: 0.454 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.561373233795166
Epoch: 17, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.413 Vali Acc: 0.806 Test Loss: 0.413 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805551).  Saving model ...
Epoch: 18 cost time: 1.3483655452728271
Epoch: 18, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.423 Vali Acc: 0.811 Test Loss: 0.423 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 1.5923519134521484
Epoch: 19, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.419 Vali Acc: 0.817 Test Loss: 0.419 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 20 cost time: 1.508105993270874
Epoch: 20, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.404 Vali Acc: 0.822 Test Loss: 0.404 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 21 cost time: 2.1270697116851807
Epoch: 21, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.408 Vali Acc: 0.806 Test Loss: 0.408 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7496984004974365
Epoch: 22, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.431 Vali Acc: 0.811 Test Loss: 0.431 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5775909423828125
Epoch: 23, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.417 Vali Acc: 0.828 Test Loss: 0.417 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 1.530329704284668
Epoch: 24, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.437 Vali Acc: 0.817 Test Loss: 0.437 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0364348888397217
Epoch: 25, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.464 Vali Acc: 0.806 Test Loss: 0.464 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7239270210266113
Epoch: 26, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6091647148132324
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9666101932525635
Epoch: 28, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.546 Vali Acc: 0.794 Test Loss: 0.546 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4964015483856201
Epoch: 29, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5996479988098145
Epoch: 30, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833328).  Saving model ...
Epoch: 31 cost time: 1.6401255130767822
Epoch: 31, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5903377532958984
Epoch: 32, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.809946060180664
Epoch: 33, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6156084537506104
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.552 Vali Acc: 0.817 Test Loss: 0.552 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6432623863220215
Epoch: 35, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.508 Vali Acc: 0.817 Test Loss: 0.508 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7238600254058838
Epoch: 36, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5057158470153809
Epoch: 37, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.565 Vali Acc: 0.811 Test Loss: 0.565 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.0710983276367188
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.801243543624878
Epoch: 39, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.549 Vali Acc: 0.811 Test Loss: 0.549 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6368694305419922
Epoch: 40, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 272778
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4332592487335205
Epoch: 1, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.779 Vali Acc: 0.211 Test Loss: 1.779 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.3440062999725342
Epoch: 2, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.684 Vali Acc: 0.344 Test Loss: 1.684 Test Acc: 0.344
Validation loss decreased (-0.211093 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 1.5012621879577637
Epoch: 3, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.547 Vali Acc: 0.550 Test Loss: 1.547 Test Acc: 0.550
Validation loss decreased (-0.344428 --> -0.549985).  Saving model ...
Epoch: 4 cost time: 1.4420921802520752
Epoch: 4, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.366 Vali Acc: 0.578 Test Loss: 1.366 Test Acc: 0.578
Validation loss decreased (-0.549985 --> -0.577764).  Saving model ...
Epoch: 5 cost time: 1.4069292545318604
Epoch: 5, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.157 Vali Acc: 0.656 Test Loss: 1.157 Test Acc: 0.656
Validation loss decreased (-0.577764 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 1.143784523010254
Epoch: 6, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.898 Vali Acc: 0.706 Test Loss: 0.898 Test Acc: 0.706
Validation loss decreased (-0.655544 --> -0.705547).  Saving model ...
Epoch: 7 cost time: 1.155261754989624
Epoch: 7, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.744 Vali Acc: 0.728 Test Loss: 0.744 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 8 cost time: 1.4015161991119385
Epoch: 8, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.630 Vali Acc: 0.756 Test Loss: 0.630 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.3963637351989746
Epoch: 9, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.553 Vali Acc: 0.767 Test Loss: 0.553 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 1.3908047676086426
Epoch: 10, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.520 Vali Acc: 0.767 Test Loss: 0.520 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 1.2906994819641113
Epoch: 11, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783328).  Saving model ...
Epoch: 12 cost time: 1.1646907329559326
Epoch: 12, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.438 Vali Acc: 0.794 Test Loss: 0.438 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 1.2574293613433838
Epoch: 13, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.415 Vali Acc: 0.783 Test Loss: 0.415 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.325502872467041
Epoch: 14, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.417 Vali Acc: 0.806 Test Loss: 0.417 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 15 cost time: 1.2741248607635498
Epoch: 15, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.441 Vali Acc: 0.794 Test Loss: 0.441 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5132031440734863
Epoch: 16, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 1.3655941486358643
Epoch: 17, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.400 Vali Acc: 0.828 Test Loss: 0.400 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 18 cost time: 1.610551357269287
Epoch: 18, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2942516803741455
Epoch: 19, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.408 Vali Acc: 0.806 Test Loss: 0.408 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0812163352966309
Epoch: 20, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.388 Vali Acc: 0.817 Test Loss: 0.388 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2529797554016113
Epoch: 21, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.383 Vali Acc: 0.833 Test Loss: 0.383 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 1.2190217971801758
Epoch: 22, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5856800079345703
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.382897138595581
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.421 Vali Acc: 0.811 Test Loss: 0.421 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4945549964904785
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.413 Vali Acc: 0.806 Test Loss: 0.413 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1859941482543945
Epoch: 26, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.468 Vali Acc: 0.789 Test Loss: 0.468 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2146224975585938
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.421 Vali Acc: 0.817 Test Loss: 0.421 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6378662586212158
Epoch: 28, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.430 Vali Acc: 0.828 Test Loss: 0.430 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6040866374969482
Epoch: 29, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.436 Vali Acc: 0.828 Test Loss: 0.436 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4940695762634277
Epoch: 30, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.481 Vali Acc: 0.800 Test Loss: 0.481 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.80283522605896
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.440 Vali Acc: 0.822 Test Loss: 0.440 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 272522
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9975638389587402
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.771 Vali Acc: 0.311 Test Loss: 1.771 Test Acc: 0.311
Validation loss decreased (inf --> -0.311093).  Saving model ...
Epoch: 2 cost time: 1.3556616306304932
Epoch: 2, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.687 Vali Acc: 0.328 Test Loss: 1.687 Test Acc: 0.328
Validation loss decreased (-0.311093 --> -0.327761).  Saving model ...
Epoch: 3 cost time: 1.4137241840362549
Epoch: 3, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.540 Vali Acc: 0.511 Test Loss: 1.540 Test Acc: 0.511
Validation loss decreased (-0.327761 --> -0.511096).  Saving model ...
Epoch: 4 cost time: 1.2752206325531006
Epoch: 4, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.377 Vali Acc: 0.678 Test Loss: 1.377 Test Acc: 0.678
Validation loss decreased (-0.511096 --> -0.677764).  Saving model ...
Epoch: 5 cost time: 1.6481940746307373
Epoch: 5, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.146 Vali Acc: 0.694 Test Loss: 1.146 Test Acc: 0.694
Validation loss decreased (-0.677764 --> -0.694433).  Saving model ...
Epoch: 6 cost time: 1.6478161811828613
Epoch: 6, Steps: 12 | Train Loss: 1.058 Vali Loss: 0.950 Vali Acc: 0.694 Test Loss: 0.950 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694435).  Saving model ...
Epoch: 7 cost time: 1.548553228378296
Epoch: 7, Steps: 12 | Train Loss: 0.888 Vali Loss: 0.791 Vali Acc: 0.683 Test Loss: 0.791 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.503298044204712
Epoch: 8, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.707 Vali Acc: 0.711 Test Loss: 0.707 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711104).  Saving model ...
Epoch: 9 cost time: 1.2956516742706299
Epoch: 9, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.644 Vali Acc: 0.700 Test Loss: 0.644 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.451824426651001
Epoch: 10, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.584 Vali Acc: 0.772 Test Loss: 0.584 Test Acc: 0.772
Validation loss decreased (-0.711104 --> -0.772216).  Saving model ...
Epoch: 11 cost time: 1.3402931690216064
Epoch: 11, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.547 Vali Acc: 0.761 Test Loss: 0.547 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1950583457946777
Epoch: 12, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.553 Vali Acc: 0.767 Test Loss: 0.553 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4717817306518555
Epoch: 13, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.487 Vali Acc: 0.767 Test Loss: 0.487 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4384493827819824
Epoch: 14, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.443 Vali Acc: 0.817 Test Loss: 0.443 Test Acc: 0.817
Validation loss decreased (-0.772216 --> -0.816662).  Saving model ...
Epoch: 15 cost time: 1.362304449081421
Epoch: 15, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.427 Vali Acc: 0.778 Test Loss: 0.427 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3155550956726074
Epoch: 16, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 1.514033555984497
Epoch: 17, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.383 Vali Acc: 0.828 Test Loss: 0.383 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.586759328842163
Epoch: 18, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3886668682098389
Epoch: 19, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3665423393249512
Epoch: 20, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 21 cost time: 1.3218002319335938
Epoch: 21, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 1.3660449981689453
Epoch: 22, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2349185943603516
Epoch: 23, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3713936805725098
Epoch: 24, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.335 Vali Acc: 0.872 Test Loss: 0.335 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 25 cost time: 1.5140669345855713
Epoch: 25, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4655053615570068
Epoch: 26, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3879876136779785
Epoch: 27, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3343944549560547
Epoch: 28, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.407118320465088
Epoch: 29, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4009277820587158
Epoch: 30, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3840806484222412
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.393 Vali Acc: 0.839 Test Loss: 0.393 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.583904504776001
Epoch: 32, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.378 Vali Acc: 0.867 Test Loss: 0.378 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.492145299911499
Epoch: 33, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.360 Vali Acc: 0.844 Test Loss: 0.360 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2718191146850586
Epoch: 34, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 190090
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.205437421798706
Epoch: 1, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.758 Vali Acc: 0.239 Test Loss: 1.758 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 1.7615578174591064
Epoch: 2, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.667 Vali Acc: 0.417 Test Loss: 1.667 Test Acc: 0.417
Validation loss decreased (-0.238871 --> -0.416650).  Saving model ...
Epoch: 3 cost time: 1.5937166213989258
Epoch: 3, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.525 Vali Acc: 0.544 Test Loss: 1.525 Test Acc: 0.544
Validation loss decreased (-0.416650 --> -0.544429).  Saving model ...
Epoch: 4 cost time: 1.3921325206756592
Epoch: 4, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.343 Vali Acc: 0.617 Test Loss: 1.343 Test Acc: 0.617
Validation loss decreased (-0.544429 --> -0.616653).  Saving model ...
Epoch: 5 cost time: 1.8623812198638916
Epoch: 5, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.142 Vali Acc: 0.706 Test Loss: 1.142 Test Acc: 0.706
Validation loss decreased (-0.616653 --> -0.705544).  Saving model ...
Epoch: 6 cost time: 1.5632143020629883
Epoch: 6, Steps: 12 | Train Loss: 1.092 Vali Loss: 0.958 Vali Acc: 0.694 Test Loss: 0.958 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4620347023010254
Epoch: 7, Steps: 12 | Train Loss: 0.874 Vali Loss: 0.778 Vali Acc: 0.706 Test Loss: 0.778 Test Acc: 0.706
Validation loss decreased (-0.705544 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 1.3280794620513916
Epoch: 8, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.681 Vali Acc: 0.711 Test Loss: 0.681 Test Acc: 0.711
Validation loss decreased (-0.705548 --> -0.711104).  Saving model ...
Epoch: 9 cost time: 1.5658209323883057
Epoch: 9, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.619 Vali Acc: 0.728 Test Loss: 0.619 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727772).  Saving model ...
Epoch: 10 cost time: 1.4323573112487793
Epoch: 10, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.570 Vali Acc: 0.733 Test Loss: 0.570 Test Acc: 0.733
Validation loss decreased (-0.727772 --> -0.733328).  Saving model ...
Epoch: 11 cost time: 1.2803280353546143
Epoch: 11, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.520 Vali Acc: 0.761 Test Loss: 0.520 Test Acc: 0.761
Validation loss decreased (-0.733328 --> -0.761106).  Saving model ...
Epoch: 12 cost time: 1.5922126770019531
Epoch: 12, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.469 Vali Acc: 0.778 Test Loss: 0.469 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 13 cost time: 1.3147892951965332
Epoch: 13, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.450 Vali Acc: 0.800 Test Loss: 0.450 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799995).  Saving model ...
Epoch: 14 cost time: 1.193498134613037
Epoch: 14, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.409 Vali Acc: 0.794 Test Loss: 0.409 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3564770221710205
Epoch: 15, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.383 Vali Acc: 0.822 Test Loss: 0.383 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 1.3953120708465576
Epoch: 16, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.376 Vali Acc: 0.822 Test Loss: 0.376 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 1.7563390731811523
Epoch: 17, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2687714099884033
Epoch: 18, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.360 Vali Acc: 0.806 Test Loss: 0.360 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5601365566253662
Epoch: 19, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.350 Vali Acc: 0.822 Test Loss: 0.350 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 20 cost time: 1.3608777523040771
Epoch: 20, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 21 cost time: 1.3628482818603516
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.331 Vali Acc: 0.817 Test Loss: 0.331 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2035932540893555
Epoch: 22, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4669010639190674
Epoch: 23, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7362134456634521
Epoch: 24, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.37369966506958
Epoch: 25, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 1.629702091217041
Epoch: 26, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.371 Vali Acc: 0.856 Test Loss: 0.371 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 27 cost time: 1.4630889892578125
Epoch: 27, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.352 Vali Acc: 0.806 Test Loss: 0.352 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6590027809143066
Epoch: 28, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6847355365753174
Epoch: 29, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.428246021270752
Epoch: 30, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2183594703674316
Epoch: 31, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.377 Vali Acc: 0.844 Test Loss: 0.377 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.692582607269287
Epoch: 32, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4852957725524902
Epoch: 33, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.295032262802124
Epoch: 34, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.372 Vali Acc: 0.856 Test Loss: 0.372 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6240406036376953
Epoch: 35, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3854327201843262
Epoch: 36, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 189834
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.254086256027222
Epoch: 1, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.714 Vali Acc: 0.311 Test Loss: 1.714 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 1.6155695915222168
Epoch: 2, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.610 Vali Acc: 0.428 Test Loss: 1.610 Test Acc: 0.428
Validation loss decreased (-0.311094 --> -0.427762).  Saving model ...
Epoch: 3 cost time: 1.2043201923370361
Epoch: 3, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.432 Vali Acc: 0.572 Test Loss: 1.432 Test Acc: 0.572
Validation loss decreased (-0.427762 --> -0.572208).  Saving model ...
Epoch: 4 cost time: 1.3395941257476807
Epoch: 4, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.231 Vali Acc: 0.672 Test Loss: 1.231 Test Acc: 0.672
Validation loss decreased (-0.572208 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 1.4277243614196777
Epoch: 5, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.018 Vali Acc: 0.689 Test Loss: 1.018 Test Acc: 0.689
Validation loss decreased (-0.672210 --> -0.688879).  Saving model ...
Epoch: 6 cost time: 1.4198932647705078
Epoch: 6, Steps: 12 | Train Loss: 0.922 Vali Loss: 0.857 Vali Acc: 0.667 Test Loss: 0.857 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.984050989151001
Epoch: 7, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.740 Vali Acc: 0.722 Test Loss: 0.740 Test Acc: 0.722
Validation loss decreased (-0.688879 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 1.7002723217010498
Epoch: 8, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.663 Vali Acc: 0.711 Test Loss: 0.663 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1455137729644775
Epoch: 9, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.632 Vali Acc: 0.750 Test Loss: 0.632 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.4308497905731201
Epoch: 10, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.566 Vali Acc: 0.744 Test Loss: 0.566 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.064639091491699
Epoch: 11, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.538 Vali Acc: 0.767 Test Loss: 0.538 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 2.168487787246704
Epoch: 12, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.498 Vali Acc: 0.761 Test Loss: 0.498 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7308764457702637
Epoch: 13, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.477 Vali Acc: 0.800 Test Loss: 0.477 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799995).  Saving model ...
Epoch: 14 cost time: 1.7751860618591309
Epoch: 14, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.447 Vali Acc: 0.800 Test Loss: 0.447 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 15 cost time: 1.3823256492614746
Epoch: 15, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.426 Vali Acc: 0.800 Test Loss: 0.426 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 16 cost time: 1.5331363677978516
Epoch: 16, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.422 Vali Acc: 0.800 Test Loss: 0.422 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 17 cost time: 1.3826193809509277
Epoch: 17, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.420 Vali Acc: 0.822 Test Loss: 0.420 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 18 cost time: 1.740309476852417
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.419 Vali Acc: 0.800 Test Loss: 0.419 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6957924365997314
Epoch: 19, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.429 Vali Acc: 0.800 Test Loss: 0.429 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.219900131225586
Epoch: 20, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.398 Vali Acc: 0.778 Test Loss: 0.398 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9483954906463623
Epoch: 21, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 1.401935338973999
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.387 Vali Acc: 0.844 Test Loss: 0.387 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 23 cost time: 1.3277668952941895
Epoch: 23, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.547071933746338
Epoch: 24, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.206796407699585
Epoch: 25, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.376 Vali Acc: 0.833 Test Loss: 0.376 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6519224643707275
Epoch: 26, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.523115873336792
Epoch: 27, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7035701274871826
Epoch: 28, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4990568161010742
Epoch: 29, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.438 Vali Acc: 0.794 Test Loss: 0.438 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4173364639282227
Epoch: 30, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 31 cost time: 1.597773790359497
Epoch: 31, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.376 Vali Acc: 0.856 Test Loss: 0.376 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 32 cost time: 1.4139759540557861
Epoch: 32, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6293365955352783
Epoch: 33, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.382 Vali Acc: 0.839 Test Loss: 0.382 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7834131717681885
Epoch: 34, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5256171226501465
Epoch: 35, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.379 Vali Acc: 0.839 Test Loss: 0.379 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4818973541259766
Epoch: 36, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5818309783935547
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4073898792266846
Epoch: 38, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.402 Vali Acc: 0.844 Test Loss: 0.402 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.5446295738220215
Epoch: 39, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.534564733505249
Epoch: 40, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4504790306091309
Epoch: 41, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 189578
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.280017614364624
Epoch: 1, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.708 Vali Acc: 0.383 Test Loss: 1.708 Test Acc: 0.383
Validation loss decreased (inf --> -0.383316).  Saving model ...
Epoch: 2 cost time: 1.3586881160736084
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.596 Vali Acc: 0.406 Test Loss: 1.596 Test Acc: 0.406
Validation loss decreased (-0.383316 --> -0.405540).  Saving model ...
Epoch: 3 cost time: 1.3673739433288574
Epoch: 3, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.436 Vali Acc: 0.611 Test Loss: 1.436 Test Acc: 0.611
Validation loss decreased (-0.405540 --> -0.611097).  Saving model ...
Epoch: 4 cost time: 1.179375171661377
Epoch: 4, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.226 Vali Acc: 0.706 Test Loss: 1.226 Test Acc: 0.706
Validation loss decreased (-0.611097 --> -0.705543).  Saving model ...
Epoch: 5 cost time: 1.5258634090423584
Epoch: 5, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.026 Vali Acc: 0.661 Test Loss: 1.026 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6863667964935303
Epoch: 6, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.833 Vali Acc: 0.694 Test Loss: 0.833 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5370769500732422
Epoch: 7, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.705 Vali Acc: 0.733 Test Loss: 0.705 Test Acc: 0.733
Validation loss decreased (-0.705543 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 1.5474121570587158
Epoch: 8, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.357572317123413
Epoch: 9, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.589 Vali Acc: 0.744 Test Loss: 0.589 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744439).  Saving model ...
Epoch: 10 cost time: 1.2205796241760254
Epoch: 10, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.493 Vali Acc: 0.783 Test Loss: 0.493 Test Acc: 0.783
Validation loss decreased (-0.744439 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 1.2118744850158691
Epoch: 11, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.460 Vali Acc: 0.789 Test Loss: 0.460 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 1.2839438915252686
Epoch: 12, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.432 Vali Acc: 0.794 Test Loss: 0.432 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 1.4887866973876953
Epoch: 13, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.416 Vali Acc: 0.811 Test Loss: 0.416 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 2.065356969833374
Epoch: 14, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 1.5756185054779053
Epoch: 15, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4284675121307373
Epoch: 16, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.381 Vali Acc: 0.789 Test Loss: 0.381 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4947583675384521
Epoch: 17, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.371 Vali Acc: 0.806 Test Loss: 0.371 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.757779836654663
Epoch: 18, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 19 cost time: 1.3781499862670898
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 1.3575267791748047
Epoch: 20, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2232167720794678
Epoch: 21, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.356 Vali Acc: 0.833 Test Loss: 0.356 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.53611159324646
Epoch: 22, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 23 cost time: 1.5384008884429932
Epoch: 23, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.388397455215454
Epoch: 24, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4887745380401611
Epoch: 25, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4352738857269287
Epoch: 26, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5851850509643555
Epoch: 27, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.341 Vali Acc: 0.839 Test Loss: 0.341 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.638279676437378
Epoch: 28, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6244468688964844
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 30 cost time: 1.5820503234863281
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7225677967071533
Epoch: 31, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4006166458129883
Epoch: 32, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 33 cost time: 1.6328012943267822
Epoch: 33, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.390 Vali Acc: 0.828 Test Loss: 0.390 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3651676177978516
Epoch: 34, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.360 Vali Acc: 0.844 Test Loss: 0.360 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4196128845214844
Epoch: 35, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 36 cost time: 1.3375053405761719
Epoch: 36, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8814926147460938
Epoch: 37, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.376 Vali Acc: 0.856 Test Loss: 0.376 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.668346881866455
Epoch: 38, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.372 Vali Acc: 0.833 Test Loss: 0.372 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4779589176177979
Epoch: 39, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.359 Vali Acc: 0.856 Test Loss: 0.359 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.4902667999267578
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.56791090965271
Epoch: 41, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.410 Vali Acc: 0.822 Test Loss: 0.410 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6112456321716309
Epoch: 42, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.415 Vali Acc: 0.861 Test Loss: 0.415 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.6249299049377441
Epoch: 43, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.399 Vali Acc: 0.822 Test Loss: 0.399 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.511420488357544
Epoch: 44, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3587291240692139
Epoch: 45, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.440 Vali Acc: 0.833 Test Loss: 0.440 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 189322
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.475766181945801
Epoch: 1, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.790 Vali Acc: 0.167 Test Loss: 1.790 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.480743408203125
Epoch: 2, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.689 Vali Acc: 0.283 Test Loss: 1.689 Test Acc: 0.283
Validation loss decreased (-0.166649 --> -0.283316).  Saving model ...
Epoch: 3 cost time: 1.5971097946166992
Epoch: 3, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.526 Vali Acc: 0.528 Test Loss: 1.526 Test Acc: 0.528
Validation loss decreased (-0.283316 --> -0.527763).  Saving model ...
Epoch: 4 cost time: 1.6188750267028809
Epoch: 4, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.365 Vali Acc: 0.617 Test Loss: 1.365 Test Acc: 0.617
Validation loss decreased (-0.527763 --> -0.616653).  Saving model ...
Epoch: 5 cost time: 1.7741248607635498
Epoch: 5, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.160 Vali Acc: 0.633 Test Loss: 1.160 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633322).  Saving model ...
Epoch: 6 cost time: 1.6732816696166992
Epoch: 6, Steps: 12 | Train Loss: 1.034 Vali Loss: 0.979 Vali Acc: 0.672 Test Loss: 0.979 Test Acc: 0.672
Validation loss decreased (-0.633322 --> -0.672212).  Saving model ...
Epoch: 7 cost time: 1.8549065589904785
Epoch: 7, Steps: 12 | Train Loss: 0.886 Vali Loss: 0.820 Vali Acc: 0.667 Test Loss: 0.820 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8447036743164062
Epoch: 8, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.717 Vali Acc: 0.683 Test Loss: 0.717 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683326).  Saving model ...
Epoch: 9 cost time: 1.7098610401153564
Epoch: 9, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.662 Vali Acc: 0.728 Test Loss: 0.662 Test Acc: 0.728
Validation loss decreased (-0.683326 --> -0.727771).  Saving model ...
Epoch: 10 cost time: 1.7013049125671387
Epoch: 10, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.584 Vali Acc: 0.739 Test Loss: 0.584 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 11 cost time: 1.461679458618164
Epoch: 11, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.542 Vali Acc: 0.767 Test Loss: 0.542 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 1.7789883613586426
Epoch: 12, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.516 Vali Acc: 0.761 Test Loss: 0.516 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5500304698944092
Epoch: 13, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.475 Vali Acc: 0.783 Test Loss: 0.475 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783329).  Saving model ...
Epoch: 14 cost time: 1.4225845336914062
Epoch: 14, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.463 Vali Acc: 0.778 Test Loss: 0.463 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4343876838684082
Epoch: 15, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.421 Vali Acc: 0.811 Test Loss: 0.421 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 1.5432994365692139
Epoch: 16, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.408 Vali Acc: 0.822 Test Loss: 0.408 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 1.6233394145965576
Epoch: 17, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.402 Vali Acc: 0.806 Test Loss: 0.402 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.352299451828003
Epoch: 18, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.445 Vali Acc: 0.783 Test Loss: 0.445 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8008091449737549
Epoch: 19, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.937807321548462
Epoch: 20, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.361 Vali Acc: 0.839 Test Loss: 0.361 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 21 cost time: 1.5763475894927979
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9978840351104736
Epoch: 22, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.384 Vali Acc: 0.828 Test Loss: 0.384 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7998647689819336
Epoch: 23, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.414 Vali Acc: 0.811 Test Loss: 0.414 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5588011741638184
Epoch: 24, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.372 Vali Acc: 0.844 Test Loss: 0.372 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.9455690383911133
Epoch: 25, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.372 Vali Acc: 0.839 Test Loss: 0.372 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8062715530395508
Epoch: 26, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 27 cost time: 1.6701326370239258
Epoch: 27, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 28 cost time: 1.5001757144927979
Epoch: 28, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.708472728729248
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8225386142730713
Epoch: 30, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.385 Vali Acc: 0.839 Test Loss: 0.385 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4844844341278076
Epoch: 31, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.396 Vali Acc: 0.839 Test Loss: 0.396 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7025775909423828
Epoch: 32, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5185294151306152
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.393 Vali Acc: 0.856 Test Loss: 0.393 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 34 cost time: 1.46759033203125
Epoch: 34, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3959660530090332
Epoch: 35, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4551656246185303
Epoch: 36, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5174837112426758
Epoch: 37, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5988597869873047
Epoch: 38, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.619816780090332
Epoch: 39, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.376988172531128
Epoch: 40, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 41 cost time: 1.7126941680908203
Epoch: 41, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.369 Vali Acc: 0.856 Test Loss: 0.369 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0937774181365967
Epoch: 42, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.416 Vali Acc: 0.839 Test Loss: 0.416 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6817817687988281
Epoch: 43, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.0187478065490723
Epoch: 44, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4588868618011475
Epoch: 45, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.380 Vali Acc: 0.867 Test Loss: 0.380 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 46 cost time: 1.4165098667144775
Epoch: 46, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.410 Vali Acc: 0.856 Test Loss: 0.410 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4885625839233398
Epoch: 47, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.466545820236206
Epoch: 48, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.7426509857177734
Epoch: 49, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.389 Vali Acc: 0.856 Test Loss: 0.389 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.4702258110046387
Epoch: 50, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.437 Vali Acc: 0.856 Test Loss: 0.437 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.4568276405334473
Epoch: 51, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.4114203453063965
Epoch: 52, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.5328459739685059
Epoch: 53, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.6332166194915771
Epoch: 54, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.465 Vali Acc: 0.817 Test Loss: 0.465 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.9922926425933838
Epoch: 55, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 148490
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.570106267929077
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.770 Vali Acc: 0.167 Test Loss: 1.770 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.2969846725463867
Epoch: 2, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.679 Vali Acc: 0.272 Test Loss: 1.679 Test Acc: 0.272
Validation loss decreased (-0.166649 --> -0.272205).  Saving model ...
Epoch: 3 cost time: 1.3468544483184814
Epoch: 3, Steps: 12 | Train Loss: 1.629 Vali Loss: 1.543 Vali Acc: 0.572 Test Loss: 1.543 Test Acc: 0.572
Validation loss decreased (-0.272205 --> -0.572207).  Saving model ...
Epoch: 4 cost time: 1.2441868782043457
Epoch: 4, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.374 Vali Acc: 0.633 Test Loss: 1.374 Test Acc: 0.633
Validation loss decreased (-0.572207 --> -0.633320).  Saving model ...
Epoch: 5 cost time: 1.3725194931030273
Epoch: 5, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.190 Vali Acc: 0.678 Test Loss: 1.190 Test Acc: 0.678
Validation loss decreased (-0.633320 --> -0.677766).  Saving model ...
Epoch: 6 cost time: 1.5928936004638672
Epoch: 6, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.003 Vali Acc: 0.683 Test Loss: 1.003 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683323).  Saving model ...
Epoch: 7 cost time: 1.4216384887695312
Epoch: 7, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.824 Vali Acc: 0.733 Test Loss: 0.824 Test Acc: 0.733
Validation loss decreased (-0.683323 --> -0.733325).  Saving model ...
Epoch: 8 cost time: 1.3417327404022217
Epoch: 8, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.700 Vali Acc: 0.728 Test Loss: 0.700 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3604533672332764
Epoch: 9, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.613 Vali Acc: 0.756 Test Loss: 0.613 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 1.3013341426849365
Epoch: 10, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.559 Vali Acc: 0.761 Test Loss: 0.559 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 1.3434808254241943
Epoch: 11, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.521 Vali Acc: 0.778 Test Loss: 0.521 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 12 cost time: 1.3170218467712402
Epoch: 12, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.475 Vali Acc: 0.806 Test Loss: 0.475 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 1.8627033233642578
Epoch: 13, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.449 Vali Acc: 0.822 Test Loss: 0.449 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 1.4365499019622803
Epoch: 14, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.446 Vali Acc: 0.789 Test Loss: 0.446 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4336934089660645
Epoch: 15, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.452 Vali Acc: 0.794 Test Loss: 0.452 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.274033784866333
Epoch: 16, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.447 Vali Acc: 0.778 Test Loss: 0.447 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.466672658920288
Epoch: 17, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.422 Vali Acc: 0.789 Test Loss: 0.422 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4382109642028809
Epoch: 18, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.400 Vali Acc: 0.844 Test Loss: 0.400 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844440).  Saving model ...
Epoch: 19 cost time: 1.3731815814971924
Epoch: 19, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.398 Vali Acc: 0.806 Test Loss: 0.398 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5208215713500977
Epoch: 20, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.384 Vali Acc: 0.844 Test Loss: 0.384 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844441).  Saving model ...
Epoch: 21 cost time: 1.4934568405151367
Epoch: 21, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5471410751342773
Epoch: 22, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.397 Vali Acc: 0.794 Test Loss: 0.397 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1908032894134521
Epoch: 23, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2774159908294678
Epoch: 24, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.394 Vali Acc: 0.811 Test Loss: 0.394 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3062593936920166
Epoch: 25, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2214949131011963
Epoch: 26, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.430 Vali Acc: 0.800 Test Loss: 0.430 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.304560899734497
Epoch: 27, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.552807092666626
Epoch: 28, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.504 Vali Acc: 0.806 Test Loss: 0.504 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6433186531066895
Epoch: 29, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.408 Vali Acc: 0.811 Test Loss: 0.408 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3338813781738281
Epoch: 30, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.393 Vali Acc: 0.839 Test Loss: 0.393 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 148234
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.471055030822754
Epoch: 1, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.725 Vali Acc: 0.344 Test Loss: 1.725 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 1.598994493484497
Epoch: 2, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.631 Vali Acc: 0.356 Test Loss: 1.631 Test Acc: 0.356
Validation loss decreased (-0.344427 --> -0.355539).  Saving model ...
Epoch: 3 cost time: 1.4733340740203857
Epoch: 3, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.470 Vali Acc: 0.578 Test Loss: 1.470 Test Acc: 0.578
Validation loss decreased (-0.355539 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 1.2747032642364502
Epoch: 4, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.284 Vali Acc: 0.661 Test Loss: 1.284 Test Acc: 0.661
Validation loss decreased (-0.577763 --> -0.661098).  Saving model ...
Epoch: 5 cost time: 1.3084723949432373
Epoch: 5, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.088 Vali Acc: 0.678 Test Loss: 1.088 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 1.444713830947876
Epoch: 6, Steps: 12 | Train Loss: 1.006 Vali Loss: 0.913 Vali Acc: 0.689 Test Loss: 0.913 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 1.4510090351104736
Epoch: 7, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.774 Vali Acc: 0.678 Test Loss: 0.774 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4544036388397217
Epoch: 8, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.667 Vali Acc: 0.756 Test Loss: 0.667 Test Acc: 0.756
Validation loss decreased (-0.688880 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.5920970439910889
Epoch: 9, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.604 Vali Acc: 0.739 Test Loss: 0.604 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2422707080841064
Epoch: 10, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.553 Vali Acc: 0.767 Test Loss: 0.553 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 1.2793591022491455
Epoch: 11, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.507 Vali Acc: 0.756 Test Loss: 0.507 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.261497974395752
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.478 Vali Acc: 0.794 Test Loss: 0.478 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 1.1904244422912598
Epoch: 13, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.461 Vali Acc: 0.794 Test Loss: 0.461 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 14 cost time: 1.3208448886871338
Epoch: 14, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.444 Vali Acc: 0.783 Test Loss: 0.444 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1828761100769043
Epoch: 15, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.423 Vali Acc: 0.789 Test Loss: 0.423 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.879826307296753
Epoch: 16, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.405 Vali Acc: 0.811 Test Loss: 0.405 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 17 cost time: 1.4663145542144775
Epoch: 17, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.397 Vali Acc: 0.806 Test Loss: 0.397 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.646801471710205
Epoch: 18, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.388 Vali Acc: 0.806 Test Loss: 0.388 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5105528831481934
Epoch: 19, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.398 Vali Acc: 0.828 Test Loss: 0.398 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 1.3448607921600342
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 21 cost time: 1.4125182628631592
Epoch: 21, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.407 Vali Acc: 0.789 Test Loss: 0.407 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7117180824279785
Epoch: 22, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.394 Vali Acc: 0.839 Test Loss: 0.394 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.492203950881958
Epoch: 23, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5577328205108643
Epoch: 24, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.436 Vali Acc: 0.822 Test Loss: 0.436 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.46950364112854
Epoch: 25, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6396973133087158
Epoch: 26, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4146528244018555
Epoch: 27, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.437 Vali Acc: 0.839 Test Loss: 0.437 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.48722243309021
Epoch: 28, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.408 Vali Acc: 0.817 Test Loss: 0.408 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3213999271392822
Epoch: 29, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.414 Vali Acc: 0.828 Test Loss: 0.414 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5824029445648193
Epoch: 30, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 31 cost time: 1.3079147338867188
Epoch: 31, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 32 cost time: 1.42679762840271
Epoch: 32, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.409 Vali Acc: 0.856 Test Loss: 0.409 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 33 cost time: 1.5223042964935303
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.452 Vali Acc: 0.828 Test Loss: 0.452 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.501246452331543
Epoch: 34, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4489493370056152
Epoch: 35, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6370248794555664
Epoch: 36, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.409 Vali Acc: 0.828 Test Loss: 0.409 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6121935844421387
Epoch: 37, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.435 Vali Acc: 0.861 Test Loss: 0.435 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 38 cost time: 1.3043239116668701
Epoch: 38, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3199303150177002
Epoch: 39, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 40 cost time: 1.2712225914001465
Epoch: 40, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.396 Vali Acc: 0.867 Test Loss: 0.396 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 41 cost time: 1.2098729610443115
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2046682834625244
Epoch: 42, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2753326892852783
Epoch: 43, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.416 Vali Acc: 0.839 Test Loss: 0.416 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4726102352142334
Epoch: 44, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.412 Vali Acc: 0.844 Test Loss: 0.412 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4992616176605225
Epoch: 45, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.436 Vali Acc: 0.844 Test Loss: 0.436 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.6221823692321777
Epoch: 46, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.268451452255249
Epoch: 47, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3303909301757812
Epoch: 48, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.6485850811004639
Epoch: 49, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.438 Vali Acc: 0.867 Test Loss: 0.438 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.449084997177124
Epoch: 50, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 147978
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7342944145202637
Epoch: 1, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.701 Vali Acc: 0.267 Test Loss: 1.701 Test Acc: 0.267
Validation loss decreased (inf --> -0.266650).  Saving model ...
Epoch: 2 cost time: 1.735994815826416
Epoch: 2, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.611 Vali Acc: 0.422 Test Loss: 1.611 Test Acc: 0.422
Validation loss decreased (-0.266650 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 1.9586787223815918
Epoch: 3, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.491 Vali Acc: 0.533 Test Loss: 1.491 Test Acc: 0.533
Validation loss decreased (-0.422206 --> -0.533318).  Saving model ...
Epoch: 4 cost time: 1.6298811435699463
Epoch: 4, Steps: 12 | Train Loss: 1.459 Vali Loss: 1.309 Vali Acc: 0.600 Test Loss: 1.309 Test Acc: 0.600
Validation loss decreased (-0.533318 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 1.5052762031555176
Epoch: 5, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.130 Vali Acc: 0.656 Test Loss: 1.130 Test Acc: 0.656
Validation loss decreased (-0.599987 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 1.2180285453796387
Epoch: 6, Steps: 12 | Train Loss: 1.010 Vali Loss: 0.932 Vali Acc: 0.706 Test Loss: 0.932 Test Acc: 0.706
Validation loss decreased (-0.655544 --> -0.705546).  Saving model ...
Epoch: 7 cost time: 1.5175933837890625
Epoch: 7, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.773 Vali Acc: 0.739 Test Loss: 0.773 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738881).  Saving model ...
Epoch: 8 cost time: 1.6007530689239502
Epoch: 8, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.664 Vali Acc: 0.761 Test Loss: 0.664 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761104).  Saving model ...
Epoch: 9 cost time: 1.6907074451446533
Epoch: 9, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788883).  Saving model ...
Epoch: 10 cost time: 1.1341512203216553
Epoch: 10, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.551 Vali Acc: 0.767 Test Loss: 0.551 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4240477085113525
Epoch: 11, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.509 Vali Acc: 0.811 Test Loss: 0.509 Test Acc: 0.811
Validation loss decreased (-0.788883 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 1.4933993816375732
Epoch: 12, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.475 Vali Acc: 0.806 Test Loss: 0.475 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4582147598266602
Epoch: 13, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.435 Vali Acc: 0.806 Test Loss: 0.435 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5742435455322266
Epoch: 14, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.416 Vali Acc: 0.811 Test Loss: 0.416 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 1.6500341892242432
Epoch: 15, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.403 Vali Acc: 0.822 Test Loss: 0.403 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 1.6678478717803955
Epoch: 16, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 2.05993914604187
Epoch: 17, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 18 cost time: 1.7287554740905762
Epoch: 18, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 2.0022096633911133
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.612783670425415
Epoch: 20, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.358 Vali Acc: 0.822 Test Loss: 0.358 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5949225425720215
Epoch: 21, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 22 cost time: 1.4041540622711182
Epoch: 22, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3262207508087158
Epoch: 23, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5346226692199707
Epoch: 24, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4349615573883057
Epoch: 25, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4740872383117676
Epoch: 26, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5040152072906494
Epoch: 27, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.356 Vali Acc: 0.844 Test Loss: 0.356 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4137706756591797
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.408 Vali Acc: 0.828 Test Loss: 0.408 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.273486852645874
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 30 cost time: 1.50238037109375
Epoch: 30, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.311708927154541
Epoch: 31, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.445 Vali Acc: 0.839 Test Loss: 0.445 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3566927909851074
Epoch: 32, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5194242000579834
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.433 Vali Acc: 0.839 Test Loss: 0.433 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3483054637908936
Epoch: 34, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.410 Vali Acc: 0.839 Test Loss: 0.410 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.472238302230835
Epoch: 35, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2994532585144043
Epoch: 36, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.5112502574920654
Epoch: 37, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.417 Vali Acc: 0.839 Test Loss: 0.417 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6179051399230957
Epoch: 38, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.412 Vali Acc: 0.839 Test Loss: 0.412 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.638007640838623
Epoch: 39, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.440 Vali Acc: 0.839 Test Loss: 0.440 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 147722
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.976267099380493
Epoch: 1, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.369 Vali Acc: 0.356 Test Loss: 1.369 Test Acc: 0.356
Validation loss decreased (inf --> -0.355542).  Saving model ...
Epoch: 2 cost time: 1.505526065826416
Epoch: 2, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.258 Vali Acc: 0.461 Test Loss: 1.258 Test Acc: 0.461
Validation loss decreased (-0.355542 --> -0.461099).  Saving model ...
Epoch: 3 cost time: 1.3235774040222168
Epoch: 3, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.762 Vali Acc: 0.639 Test Loss: 0.762 Test Acc: 0.639
Validation loss decreased (-0.461099 --> -0.638881).  Saving model ...
Epoch: 4 cost time: 1.155630111694336
Epoch: 4, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.547 Vali Acc: 0.750 Test Loss: 0.547 Test Acc: 0.750
Validation loss decreased (-0.638881 --> -0.749995).  Saving model ...
Epoch: 5 cost time: 1.4233248233795166
Epoch: 5, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.580 Vali Acc: 0.728 Test Loss: 0.580 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3667936325073242
Epoch: 6, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.871 Vali Acc: 0.761 Test Loss: 0.871 Test Acc: 0.761
Validation loss decreased (-0.749995 --> -0.761102).  Saving model ...
Epoch: 7 cost time: 1.4817454814910889
Epoch: 7, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.660 Vali Acc: 0.806 Test Loss: 0.660 Test Acc: 0.806
Validation loss decreased (-0.761102 --> -0.805549).  Saving model ...
Epoch: 8 cost time: 1.3951539993286133
Epoch: 8, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.711 Vali Acc: 0.778 Test Loss: 0.711 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4965012073516846
Epoch: 9, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 1.6858606338500977
Epoch: 10, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.400 Vali Acc: 0.856 Test Loss: 0.400 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.3127107620239258
Epoch: 11, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.763 Vali Acc: 0.822 Test Loss: 0.763 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3615992069244385
Epoch: 12, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.774 Vali Acc: 0.828 Test Loss: 0.774 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.407773733139038
Epoch: 13, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.753 Vali Acc: 0.844 Test Loss: 0.753 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4923765659332275
Epoch: 14, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2718851566314697
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 1.6336798667907715
Epoch: 16, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.042 Vali Acc: 0.828 Test Loss: 1.042 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4747645854949951
Epoch: 17, Steps: 12 | Train Loss: 0.361 Vali Loss: 1.230 Vali Acc: 0.839 Test Loss: 1.230 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5029857158660889
Epoch: 18, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.955 Vali Acc: 0.833 Test Loss: 0.955 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.403106927871704
Epoch: 19, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2105684280395508
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.911 Vali Acc: 0.839 Test Loss: 0.911 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4158549308776855
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.897 Vali Acc: 0.839 Test Loss: 0.897 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3300647735595703
Epoch: 22, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.005 Vali Acc: 0.817 Test Loss: 1.005 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3664054870605469
Epoch: 23, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 1.7485454082489014
Epoch: 24, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.741 Vali Acc: 0.833 Test Loss: 0.741 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4036786556243896
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.779 Vali Acc: 0.856 Test Loss: 0.779 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4371263980865479
Epoch: 26, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.751 Vali Acc: 0.872 Test Loss: 0.751 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1898815631866455
Epoch: 27, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.768 Vali Acc: 0.839 Test Loss: 0.768 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.248723030090332
Epoch: 28, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.923 Vali Acc: 0.850 Test Loss: 0.923 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3687751293182373
Epoch: 29, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.879 Vali Acc: 0.867 Test Loss: 0.879 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4653704166412354
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.923 Vali Acc: 0.828 Test Loss: 0.923 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3855915069580078
Epoch: 31, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.306 Vali Acc: 0.844 Test Loss: 1.306 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.609870433807373
Epoch: 32, Steps: 12 | Train Loss: 0.226 Vali Loss: 1.339 Vali Acc: 0.794 Test Loss: 1.339 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.331939458847046
Epoch: 33, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.156 Vali Acc: 0.828 Test Loss: 1.156 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 4973598
model size : 23.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4015212059020996
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.400 Vali Acc: 0.400 Test Loss: 1.400 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.287257432937622
Epoch: 2, Steps: 12 | Train Loss: 1.157 Vali Loss: 0.852 Vali Acc: 0.650 Test Loss: 0.852 Test Acc: 0.650
Validation loss decreased (-0.399986 --> -0.649991).  Saving model ...
Epoch: 3 cost time: 1.1232085227966309
Epoch: 3, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.681 Vali Acc: 0.689 Test Loss: 0.681 Test Acc: 0.689
Validation loss decreased (-0.649991 --> -0.688882).  Saving model ...
Epoch: 4 cost time: 1.3064382076263428
Epoch: 4, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.555 Vali Acc: 0.756 Test Loss: 0.555 Test Acc: 0.756
Validation loss decreased (-0.688882 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 1.3509185314178467
Epoch: 5, Steps: 12 | Train Loss: 0.467 Vali Loss: 1.060 Vali Acc: 0.733 Test Loss: 1.060 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0875742435455322
Epoch: 6, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.618 Vali Acc: 0.767 Test Loss: 0.618 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766660).  Saving model ...
Epoch: 7 cost time: 1.2789793014526367
Epoch: 7, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.723 Vali Acc: 0.728 Test Loss: 0.723 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2581639289855957
Epoch: 8, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.591 Vali Acc: 0.794 Test Loss: 0.591 Test Acc: 0.794
Validation loss decreased (-0.766660 --> -0.794439).  Saving model ...
Epoch: 9 cost time: 1.1365525722503662
Epoch: 9, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.328 Vali Acc: 0.844 Test Loss: 0.328 Test Acc: 0.844
Validation loss decreased (-0.794439 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 1.3403215408325195
Epoch: 10, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3994739055633545
Epoch: 11, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 1.4134876728057861
Epoch: 12, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
Validation loss decreased (-0.849996 --> -0.899997).  Saving model ...
Epoch: 13 cost time: 1.4152989387512207
Epoch: 13, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.389 Vali Acc: 0.878 Test Loss: 0.389 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5719325542449951
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.441 Vali Acc: 0.894 Test Loss: 0.441 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3761177062988281
Epoch: 15, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.780 Vali Acc: 0.817 Test Loss: 0.780 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.313878059387207
Epoch: 16, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.726 Vali Acc: 0.856 Test Loss: 0.726 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3919570446014404
Epoch: 17, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.802 Vali Acc: 0.856 Test Loss: 0.802 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.359356164932251
Epoch: 18, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.433 Vali Acc: 0.872 Test Loss: 0.433 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3496687412261963
Epoch: 19, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.950 Vali Acc: 0.817 Test Loss: 0.950 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.405959129333496
Epoch: 20, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3422303199768066
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6810460090637207
Epoch: 22, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 4972318
model size : 23.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.475013256072998
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.459 Vali Acc: 0.533 Test Loss: 1.459 Test Acc: 0.533
Validation loss decreased (inf --> -0.533319).  Saving model ...
Epoch: 2 cost time: 1.1119258403778076
Epoch: 2, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.253 Vali Acc: 0.556 Test Loss: 1.253 Test Acc: 0.556
Validation loss decreased (-0.533319 --> -0.555543).  Saving model ...
Epoch: 3 cost time: 1.3645367622375488
Epoch: 3, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.778 Vali Acc: 0.633 Test Loss: 0.778 Test Acc: 0.633
Validation loss decreased (-0.555543 --> -0.633326).  Saving model ...
Epoch: 4 cost time: 1.3015177249908447
Epoch: 4, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.726 Vali Acc: 0.667 Test Loss: 0.726 Test Acc: 0.667
Validation loss decreased (-0.633326 --> -0.666659).  Saving model ...
Epoch: 5 cost time: 1.2650065422058105
Epoch: 5, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.680 Vali Acc: 0.728 Test Loss: 0.680 Test Acc: 0.728
Validation loss decreased (-0.666659 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.2948715686798096
Epoch: 6, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.633 Vali Acc: 0.739 Test Loss: 0.633 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.2494375705718994
Epoch: 7, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.587 Vali Acc: 0.794 Test Loss: 0.587 Test Acc: 0.794
Validation loss decreased (-0.738883 --> -0.794439).  Saving model ...
Epoch: 8 cost time: 1.1822760105133057
Epoch: 8, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.794439 --> -0.822217).  Saving model ...
Epoch: 9 cost time: 1.3431551456451416
Epoch: 9, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.975 Vali Acc: 0.778 Test Loss: 1.975 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.352149486541748
Epoch: 10, Steps: 12 | Train Loss: 1.032 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844439).  Saving model ...
Epoch: 11 cost time: 1.2432811260223389
Epoch: 11, Steps: 12 | Train Loss: 0.440 Vali Loss: 1.384 Vali Acc: 0.794 Test Loss: 1.384 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6117312908172607
Epoch: 12, Steps: 12 | Train Loss: 0.606 Vali Loss: 1.190 Vali Acc: 0.778 Test Loss: 1.190 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2876524925231934
Epoch: 13, Steps: 12 | Train Loss: 0.556 Vali Loss: 1.456 Vali Acc: 0.744 Test Loss: 1.456 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3450672626495361
Epoch: 14, Steps: 12 | Train Loss: 0.413 Vali Loss: 1.026 Vali Acc: 0.778 Test Loss: 1.026 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3335886001586914
Epoch: 15, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.648 Vali Acc: 0.872 Test Loss: 0.648 Test Acc: 0.872
Validation loss decreased (-0.844439 --> -0.872216).  Saving model ...
Epoch: 16 cost time: 1.2735860347747803
Epoch: 16, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.221242904663086
Epoch: 17, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 18 cost time: 1.3830156326293945
Epoch: 18, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.477 Vali Acc: 0.878 Test Loss: 0.477 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 19 cost time: 1.6980955600738525
Epoch: 19, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4061994552612305
Epoch: 20, Steps: 12 | Train Loss: 0.277 Vali Loss: 1.181 Vali Acc: 0.800 Test Loss: 1.181 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.429391860961914
Epoch: 21, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.852 Vali Acc: 0.850 Test Loss: 0.852 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.508812665939331
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.515 Vali Acc: 0.794 Test Loss: 1.515 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2819573879241943
Epoch: 23, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.897 Vali Acc: 0.844 Test Loss: 0.897 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5568180084228516
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.867 Vali Acc: 0.850 Test Loss: 0.867 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4519801139831543
Epoch: 25, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.304 Vali Acc: 0.822 Test Loss: 1.304 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4580881595611572
Epoch: 26, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.927 Vali Acc: 0.844 Test Loss: 0.927 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6146788597106934
Epoch: 27, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.756 Vali Acc: 0.872 Test Loss: 0.756 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.485671043395996
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.277 Vali Acc: 0.850 Test Loss: 1.277 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 4971038
model size : 23.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5963292121887207
Epoch: 1, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.388 Vali Acc: 0.461 Test Loss: 1.388 Test Acc: 0.461
Validation loss decreased (inf --> -0.461097).  Saving model ...
Epoch: 2 cost time: 1.3893437385559082
Epoch: 2, Steps: 12 | Train Loss: 1.087 Vali Loss: 0.912 Vali Acc: 0.628 Test Loss: 0.912 Test Acc: 0.628
Validation loss decreased (-0.461097 --> -0.627769).  Saving model ...
Epoch: 3 cost time: 1.2977232933044434
Epoch: 3, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.772 Vali Acc: 0.683 Test Loss: 0.772 Test Acc: 0.683
Validation loss decreased (-0.627769 --> -0.683326).  Saving model ...
Epoch: 4 cost time: 1.384861946105957
Epoch: 4, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.950 Vali Acc: 0.733 Test Loss: 0.950 Test Acc: 0.733
Validation loss decreased (-0.683326 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 1.2965738773345947
Epoch: 5, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.749 Vali Acc: 0.750 Test Loss: 0.749 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.1484284400939941
Epoch: 6, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.562 Vali Acc: 0.800 Test Loss: 0.562 Test Acc: 0.800
Validation loss decreased (-0.749993 --> -0.799994).  Saving model ...
Epoch: 7 cost time: 1.2106080055236816
Epoch: 7, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.691 Vali Acc: 0.761 Test Loss: 0.691 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3317844867706299
Epoch: 8, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.528 Vali Acc: 0.756 Test Loss: 0.528 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3778588771820068
Epoch: 9, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.534 Vali Acc: 0.794 Test Loss: 0.534 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0322165489196777
Epoch: 10, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
Validation loss decreased (-0.799994 --> -0.905552).  Saving model ...
Epoch: 11 cost time: 1.266646146774292
Epoch: 11, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.554 Vali Acc: 0.817 Test Loss: 0.554 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4472107887268066
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4654154777526855
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2059729099273682
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0491728782653809
Epoch: 15, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2998807430267334
Epoch: 16, Steps: 12 | Train Loss: 0.373 Vali Loss: 1.735 Vali Acc: 0.817 Test Loss: 1.735 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.29569673538208
Epoch: 17, Steps: 12 | Train Loss: 1.296 Vali Loss: 0.705 Vali Acc: 0.867 Test Loss: 0.705 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3964829444885254
Epoch: 18, Steps: 12 | Train Loss: 0.548 Vali Loss: 1.498 Vali Acc: 0.833 Test Loss: 1.498 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4456729888916016
Epoch: 19, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.801 Vali Acc: 0.861 Test Loss: 0.801 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.52242112159729
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 1.244 Vali Acc: 0.822 Test Loss: 1.244 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 4969758
model size : 23.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3557310104370117
Epoch: 1, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.541 Vali Acc: 0.306 Test Loss: 1.541 Test Acc: 0.306
Validation loss decreased (inf --> -0.305540).  Saving model ...
Epoch: 2 cost time: 1.5012624263763428
Epoch: 2, Steps: 12 | Train Loss: 1.365 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
Validation loss decreased (-0.305540 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 1.4519665241241455
Epoch: 3, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.085 Vali Acc: 0.594 Test Loss: 1.085 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3418405055999756
Epoch: 4, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.666 Vali Acc: 0.717 Test Loss: 0.666 Test Acc: 0.717
Validation loss decreased (-0.599990 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 1.2838160991668701
Epoch: 5, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.671 Vali Acc: 0.706 Test Loss: 0.671 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3756649494171143
Epoch: 6, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.513 Vali Acc: 0.806 Test Loss: 0.513 Test Acc: 0.806
Validation loss decreased (-0.716660 --> -0.805550).  Saving model ...
Epoch: 7 cost time: 1.2021210193634033
Epoch: 7, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.640 Vali Acc: 0.767 Test Loss: 0.640 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6407930850982666
Epoch: 8, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.588 Vali Acc: 0.806 Test Loss: 0.588 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3950493335723877
Epoch: 9, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.556 Vali Acc: 0.794 Test Loss: 0.556 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1266303062438965
Epoch: 10, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.490 Vali Acc: 0.817 Test Loss: 0.490 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 1.364551305770874
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.460 Vali Acc: 0.806 Test Loss: 0.460 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0317449569702148
Epoch: 12, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
Validation loss decreased (-0.816662 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.1980667114257812
Epoch: 13, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1404569149017334
Epoch: 14, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.856 Vali Acc: 0.811 Test Loss: 0.856 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1607143878936768
Epoch: 15, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.706 Vali Acc: 0.828 Test Loss: 0.706 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1371428966522217
Epoch: 16, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.693 Vali Acc: 0.839 Test Loss: 0.693 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.321288824081421
Epoch: 17, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.450 Vali Acc: 0.883 Test Loss: 0.450 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3989157676696777
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.579 Vali Acc: 0.894 Test Loss: 0.579 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894439).  Saving model ...
Epoch: 19 cost time: 1.1637506484985352
Epoch: 19, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.055 Vali Acc: 0.828 Test Loss: 1.055 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5612504482269287
Epoch: 20, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3658578395843506
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.514 Vali Acc: 0.894 Test Loss: 0.514 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 22 cost time: 1.341900110244751
Epoch: 22, Steps: 12 | Train Loss: 0.337 Vali Loss: 1.052 Vali Acc: 0.822 Test Loss: 1.052 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.485689401626587
Epoch: 23, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.631 Vali Acc: 0.872 Test Loss: 0.631 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3959786891937256
Epoch: 24, Steps: 12 | Train Loss: 0.239 Vali Loss: 1.036 Vali Acc: 0.856 Test Loss: 1.036 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1867010593414307
Epoch: 25, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.896 Vali Acc: 0.828 Test Loss: 0.896 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.544142723083496
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.777 Vali Acc: 0.839 Test Loss: 0.777 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3265159130096436
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.858 Vali Acc: 0.856 Test Loss: 0.858 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4763481616973877
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.769 Vali Acc: 0.867 Test Loss: 0.769 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5740077495574951
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.704 Vali Acc: 0.872 Test Loss: 0.704 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4115376472473145
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.950 Vali Acc: 0.861 Test Loss: 0.950 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2129454612731934
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.923 Vali Acc: 0.861 Test Loss: 0.923 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 4185630
model size : 20.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1503095626831055
Epoch: 1, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.346 Vali Acc: 0.550 Test Loss: 1.346 Test Acc: 0.550
Validation loss decreased (inf --> -0.549987).  Saving model ...
Epoch: 2 cost time: 1.4351425170898438
Epoch: 2, Steps: 12 | Train Loss: 1.142 Vali Loss: 0.875 Vali Acc: 0.633 Test Loss: 0.875 Test Acc: 0.633
Validation loss decreased (-0.549987 --> -0.633325).  Saving model ...
Epoch: 3 cost time: 1.1923797130584717
Epoch: 3, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.856 Vali Acc: 0.667 Test Loss: 0.856 Test Acc: 0.667
Validation loss decreased (-0.633325 --> -0.666658).  Saving model ...
Epoch: 4 cost time: 1.544018268585205
Epoch: 4, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.684 Vali Acc: 0.650 Test Loss: 0.684 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4047787189483643
Epoch: 5, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.719 Vali Acc: 0.733 Test Loss: 0.719 Test Acc: 0.733
Validation loss decreased (-0.666658 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 1.4438295364379883
Epoch: 6, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.860 Vali Acc: 0.794 Test Loss: 0.860 Test Acc: 0.794
Validation loss decreased (-0.733326 --> -0.794436).  Saving model ...
Epoch: 7 cost time: 1.3513977527618408
Epoch: 7, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.486 Vali Acc: 0.761 Test Loss: 0.486 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4099512100219727
Epoch: 8, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
Validation loss decreased (-0.794436 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 1.4151062965393066
Epoch: 9, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.677 Vali Acc: 0.789 Test Loss: 0.677 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.311657190322876
Epoch: 10, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.476 Vali Acc: 0.806 Test Loss: 0.476 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4415578842163086
Epoch: 11, Steps: 12 | Train Loss: 0.733 Vali Loss: 2.243 Vali Acc: 0.767 Test Loss: 2.243 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2587158679962158
Epoch: 12, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.604 Vali Acc: 0.772 Test Loss: 1.604 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.457350730895996
Epoch: 13, Steps: 12 | Train Loss: 1.289 Vali Loss: 0.829 Vali Acc: 0.822 Test Loss: 0.829 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2632732391357422
Epoch: 14, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.663 Vali Acc: 0.828 Test Loss: 0.663 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3726472854614258
Epoch: 15, Steps: 12 | Train Loss: 0.386 Vali Loss: 1.018 Vali Acc: 0.839 Test Loss: 1.018 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838879).  Saving model ...
Epoch: 16 cost time: 1.3772549629211426
Epoch: 16, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.838879 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.440373182296753
Epoch: 17, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.963 Vali Acc: 0.828 Test Loss: 0.963 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.272498607635498
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2099835872650146
Epoch: 19, Steps: 12 | Train Loss: 0.724 Vali Loss: 1.341 Vali Acc: 0.844 Test Loss: 1.341 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4567439556121826
Epoch: 20, Steps: 12 | Train Loss: 0.423 Vali Loss: 1.409 Vali Acc: 0.811 Test Loss: 1.409 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.39975905418396
Epoch: 21, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.707 Vali Acc: 0.856 Test Loss: 0.707 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855548).  Saving model ...
Epoch: 22 cost time: 1.368086814880371
Epoch: 22, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.673 Vali Acc: 0.878 Test Loss: 0.673 Test Acc: 0.878
Validation loss decreased (-0.855548 --> -0.877771).  Saving model ...
Epoch: 23 cost time: 1.5523395538330078
Epoch: 23, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3363165855407715
Epoch: 24, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.754 Vali Acc: 0.894 Test Loss: 0.754 Test Acc: 0.894
Validation loss decreased (-0.877771 --> -0.894437).  Saving model ...
Epoch: 25 cost time: 1.254880666732788
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5113353729248047
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.702 Vali Acc: 0.867 Test Loss: 0.702 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.489173412322998
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.917 Vali Acc: 0.856 Test Loss: 0.917 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4593310356140137
Epoch: 28, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.466 Vali Acc: 0.883 Test Loss: 0.466 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4936845302581787
Epoch: 29, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.943 Vali Acc: 0.833 Test Loss: 0.943 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3414053916931152
Epoch: 30, Steps: 12 | Train Loss: 0.306 Vali Loss: 1.131 Vali Acc: 0.844 Test Loss: 1.131 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4146475791931152
Epoch: 31, Steps: 12 | Train Loss: 0.261 Vali Loss: 1.386 Vali Acc: 0.817 Test Loss: 1.386 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5936694145202637
Epoch: 32, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.861 Vali Acc: 0.872 Test Loss: 0.861 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4517877101898193
Epoch: 33, Steps: 12 | Train Loss: 0.411 Vali Loss: 1.682 Vali Acc: 0.822 Test Loss: 1.682 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4222235679626465
Epoch: 34, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.809 Vali Acc: 0.861 Test Loss: 0.809 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 4184350
model size : 20.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.295231342315674
Epoch: 1, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.385 Vali Acc: 0.378 Test Loss: 1.385 Test Acc: 0.378
Validation loss decreased (inf --> -0.377764).  Saving model ...
Epoch: 2 cost time: 1.1999547481536865
Epoch: 2, Steps: 12 | Train Loss: 1.071 Vali Loss: 0.820 Vali Acc: 0.628 Test Loss: 0.820 Test Acc: 0.628
Validation loss decreased (-0.377764 --> -0.627770).  Saving model ...
Epoch: 3 cost time: 1.303642749786377
Epoch: 3, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.604 Vali Acc: 0.711 Test Loss: 0.604 Test Acc: 0.711
Validation loss decreased (-0.627770 --> -0.711105).  Saving model ...
Epoch: 4 cost time: 1.592149257659912
Epoch: 4, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
Validation loss decreased (-0.711105 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 1.4194724559783936
Epoch: 5, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.608 Vali Acc: 0.756 Test Loss: 0.608 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2532739639282227
Epoch: 6, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.564 Vali Acc: 0.739 Test Loss: 0.564 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.879075527191162
Epoch: 7, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.670 Vali Acc: 0.711 Test Loss: 0.670 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.549501657485962
Epoch: 8, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.603 Vali Acc: 0.761 Test Loss: 0.603 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 1.1938724517822266
Epoch: 9, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.814 Vali Acc: 0.772 Test Loss: 0.814 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772214).  Saving model ...
Epoch: 10 cost time: 1.165867567062378
Epoch: 10, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.493 Vali Acc: 0.811 Test Loss: 0.493 Test Acc: 0.811
Validation loss decreased (-0.772214 --> -0.811106).  Saving model ...
Epoch: 11 cost time: 1.4275240898132324
Epoch: 11, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.830 Vali Acc: 0.783 Test Loss: 0.830 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.217923641204834
Epoch: 12, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
Validation loss decreased (-0.811106 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 1.4603312015533447
Epoch: 13, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.427109718322754
Epoch: 14, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.913 Vali Acc: 0.806 Test Loss: 0.913 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.655503511428833
Epoch: 15, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.741 Vali Acc: 0.789 Test Loss: 0.741 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.206937313079834
Epoch: 16, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.768 Vali Acc: 0.844 Test Loss: 0.768 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2813448905944824
Epoch: 17, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.857 Vali Acc: 0.817 Test Loss: 0.857 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5224692821502686
Epoch: 18, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.762 Vali Acc: 0.833 Test Loss: 0.762 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.121711015701294
Epoch: 19, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.950 Vali Acc: 0.822 Test Loss: 0.950 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.146313190460205
Epoch: 20, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1154980659484863
Epoch: 21, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.409 Vali Acc: 0.872 Test Loss: 0.409 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 22 cost time: 1.0742239952087402
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3232758045196533
Epoch: 23, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4435334205627441
Epoch: 24, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.985 Vali Acc: 0.839 Test Loss: 0.985 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4406280517578125
Epoch: 25, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.799 Vali Acc: 0.856 Test Loss: 0.799 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.162431240081787
Epoch: 26, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.872 Vali Acc: 0.833 Test Loss: 0.872 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2375962734222412
Epoch: 27, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.728 Vali Acc: 0.872 Test Loss: 0.728 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2614085674285889
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.156 Vali Acc: 0.844 Test Loss: 1.156 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5431876182556152
Epoch: 29, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.977 Vali Acc: 0.833 Test Loss: 0.977 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4135591983795166
Epoch: 30, Steps: 12 | Train Loss: 0.581 Vali Loss: 1.023 Vali Acc: 0.878 Test Loss: 1.023 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877768).  Saving model ...
Epoch: 31 cost time: 1.554250717163086
Epoch: 31, Steps: 12 | Train Loss: 0.607 Vali Loss: 1.223 Vali Acc: 0.817 Test Loss: 1.223 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3423147201538086
Epoch: 32, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.968 Vali Acc: 0.861 Test Loss: 0.968 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.557643175125122
Epoch: 33, Steps: 12 | Train Loss: 0.247 Vali Loss: 1.036 Vali Acc: 0.850 Test Loss: 1.036 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2314672470092773
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.742 Vali Acc: 0.878 Test Loss: 0.742 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877770).  Saving model ...
Epoch: 35 cost time: 1.5436546802520752
Epoch: 35, Steps: 12 | Train Loss: 0.194 Vali Loss: 1.300 Vali Acc: 0.833 Test Loss: 1.300 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7816016674041748
Epoch: 36, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.263 Vali Acc: 0.872 Test Loss: 1.263 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8609979152679443
Epoch: 37, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.852 Vali Acc: 0.878 Test Loss: 0.852 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4129655361175537
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.729 Vali Acc: 0.894 Test Loss: 0.729 Test Acc: 0.894
Validation loss decreased (-0.877770 --> -0.894437).  Saving model ...
Epoch: 39 cost time: 1.393425703048706
Epoch: 39, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.385 Vali Acc: 0.867 Test Loss: 1.385 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4782218933105469
Epoch: 40, Steps: 12 | Train Loss: 0.099 Vali Loss: 2.043 Vali Acc: 0.822 Test Loss: 2.043 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3816959857940674
Epoch: 41, Steps: 12 | Train Loss: 0.268 Vali Loss: 1.058 Vali Acc: 0.856 Test Loss: 1.058 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2769098281860352
Epoch: 42, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.991 Vali Acc: 0.878 Test Loss: 0.991 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.823857307434082
Epoch: 43, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.228 Vali Acc: 0.867 Test Loss: 1.228 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6303868293762207
Epoch: 44, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.300 Vali Acc: 0.867 Test Loss: 1.300 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5320055484771729
Epoch: 45, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.242 Vali Acc: 0.883 Test Loss: 1.242 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.2164647579193115
Epoch: 46, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.323 Vali Acc: 0.839 Test Loss: 1.323 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.4082551002502441
Epoch: 47, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.436 Vali Acc: 0.850 Test Loss: 1.436 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.2880821228027344
Epoch: 48, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.639 Vali Acc: 0.844 Test Loss: 1.639 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 4183070
model size : 20.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3286044597625732
Epoch: 1, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.489 Vali Acc: 0.417 Test Loss: 1.489 Test Acc: 0.417
Validation loss decreased (inf --> -0.416652).  Saving model ...
Epoch: 2 cost time: 1.3173143863677979
Epoch: 2, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.426 Vali Acc: 0.561 Test Loss: 1.426 Test Acc: 0.561
Validation loss decreased (-0.416652 --> -0.561097).  Saving model ...
Epoch: 3 cost time: 1.1856873035430908
Epoch: 3, Steps: 12 | Train Loss: 1.050 Vali Loss: 0.910 Vali Acc: 0.650 Test Loss: 0.910 Test Acc: 0.650
Validation loss decreased (-0.561097 --> -0.649991).  Saving model ...
Epoch: 4 cost time: 1.4892587661743164
Epoch: 4, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.929 Vali Acc: 0.744 Test Loss: 0.929 Test Acc: 0.744
Validation loss decreased (-0.649991 --> -0.744435).  Saving model ...
Epoch: 5 cost time: 1.0760281085968018
Epoch: 5, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.782 Vali Acc: 0.700 Test Loss: 0.782 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2508420944213867
Epoch: 6, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.974 Vali Acc: 0.794 Test Loss: 0.974 Test Acc: 0.794
Validation loss decreased (-0.744435 --> -0.794435).  Saving model ...
Epoch: 7 cost time: 1.1026852130889893
Epoch: 7, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.970 Vali Acc: 0.672 Test Loss: 0.970 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4747326374053955
Epoch: 8, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.643 Vali Acc: 0.772 Test Loss: 0.643 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2306184768676758
Epoch: 9, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.424 Vali Acc: 0.839 Test Loss: 0.424 Test Acc: 0.839
Validation loss decreased (-0.794435 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 1.1683828830718994
Epoch: 10, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.808 Vali Acc: 0.778 Test Loss: 0.808 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1648366451263428
Epoch: 11, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.346 Vali Acc: 0.872 Test Loss: 0.346 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.2505857944488525
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.558 Vali Acc: 0.839 Test Loss: 0.558 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.327101230621338
Epoch: 13, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2588934898376465
Epoch: 14, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 1.064279317855835
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.433 Vali Acc: 0.867 Test Loss: 0.433 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1702799797058105
Epoch: 16, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.625 Vali Acc: 0.867 Test Loss: 0.625 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2179341316223145
Epoch: 17, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1424620151519775
Epoch: 18, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.895 Vali Acc: 0.856 Test Loss: 0.895 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1427772045135498
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 1.4714062213897705
Epoch: 20, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.703 Vali Acc: 0.878 Test Loss: 0.703 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.582324743270874
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.547264814376831
Epoch: 22, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4514048099517822
Epoch: 23, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.704 Vali Acc: 0.856 Test Loss: 0.704 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.511453628540039
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.887 Vali Acc: 0.850 Test Loss: 0.887 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3745191097259521
Epoch: 25, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.588 Vali Acc: 0.883 Test Loss: 0.588 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.476444959640503
Epoch: 26, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.806 Vali Acc: 0.850 Test Loss: 0.806 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6414108276367188
Epoch: 27, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.433 Vali Acc: 0.828 Test Loss: 1.433 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5041687488555908
Epoch: 28, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.794 Vali Acc: 0.861 Test Loss: 0.794 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4605128765106201
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.839 Vali Acc: 0.883 Test Loss: 0.839 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 4181790
model size : 20.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.51507306098938
Epoch: 1, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.369 Vali Acc: 0.522 Test Loss: 1.369 Test Acc: 0.522
Validation loss decreased (inf --> -0.522209).  Saving model ...
Epoch: 2 cost time: 1.0818581581115723
Epoch: 2, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.010 Vali Acc: 0.572 Test Loss: 1.010 Test Acc: 0.572
Validation loss decreased (-0.522209 --> -0.572212).  Saving model ...
Epoch: 3 cost time: 1.1595969200134277
Epoch: 3, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.741 Vali Acc: 0.678 Test Loss: 0.741 Test Acc: 0.678
Validation loss decreased (-0.572212 --> -0.677770).  Saving model ...
Epoch: 4 cost time: 1.186706781387329
Epoch: 4, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.564 Vali Acc: 0.728 Test Loss: 0.564 Test Acc: 0.728
Validation loss decreased (-0.677770 --> -0.727772).  Saving model ...
Epoch: 5 cost time: 1.1377341747283936
Epoch: 5, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.930 Vali Acc: 0.756 Test Loss: 0.930 Test Acc: 0.756
Validation loss decreased (-0.727772 --> -0.755546).  Saving model ...
Epoch: 6 cost time: 1.1508572101593018
Epoch: 6, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.486 Vali Acc: 0.806 Test Loss: 0.486 Test Acc: 0.806
Validation loss decreased (-0.755546 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 0.9995272159576416
Epoch: 7, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.428 Vali Acc: 0.822 Test Loss: 0.428 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.1260004043579102
Epoch: 8, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.457 Vali Acc: 0.811 Test Loss: 0.457 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.347999095916748
Epoch: 9, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.906 Vali Acc: 0.783 Test Loss: 0.906 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2074947357177734
Epoch: 10, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844440).  Saving model ...
Epoch: 11 cost time: 1.1466197967529297
Epoch: 11, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.739 Vali Acc: 0.833 Test Loss: 0.739 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2705607414245605
Epoch: 12, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1080560684204102
Epoch: 13, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.446 Vali Acc: 0.844 Test Loss: 0.446 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 1.1927857398986816
Epoch: 14, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.1310875415802002
Epoch: 15, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.765 Vali Acc: 0.811 Test Loss: 0.765 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1820917129516602
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.356 Vali Acc: 0.867 Test Loss: 0.356 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866663).  Saving model ...
Epoch: 17 cost time: 1.2500627040863037
Epoch: 17, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0865321159362793
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.774 Vali Acc: 0.822 Test Loss: 0.774 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.164531946182251
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.2252342700958252
Epoch: 20, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.393 Vali Acc: 0.894 Test Loss: 0.393 Test Acc: 0.894
Validation loss decreased (-0.872216 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 1.0972614288330078
Epoch: 21, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.736 Vali Acc: 0.833 Test Loss: 0.736 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4549567699432373
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.889 Vali Acc: 0.839 Test Loss: 0.889 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4054005146026611
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.919 Vali Acc: 0.872 Test Loss: 0.919 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2258350849151611
Epoch: 24, Steps: 12 | Train Loss: 0.262 Vali Loss: 1.242 Vali Acc: 0.828 Test Loss: 1.242 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1419463157653809
Epoch: 25, Steps: 12 | Train Loss: 0.305 Vali Loss: 1.204 Vali Acc: 0.811 Test Loss: 1.204 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2609584331512451
Epoch: 26, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.785 Vali Acc: 0.861 Test Loss: 0.785 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1275947093963623
Epoch: 27, Steps: 12 | Train Loss: 0.232 Vali Loss: 1.092 Vali Acc: 0.811 Test Loss: 1.092 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.111581802368164
Epoch: 28, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.970 Vali Acc: 0.839 Test Loss: 0.970 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1372263431549072
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.688 Vali Acc: 0.883 Test Loss: 0.688 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1423258781433105
Epoch: 30, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.236 Vali Acc: 0.844 Test Loss: 1.236 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 3791646
model size : 19.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5151021480560303
Epoch: 1, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.491 Vali Acc: 0.306 Test Loss: 1.491 Test Acc: 0.306
Validation loss decreased (inf --> -0.305541).  Saving model ...
Epoch: 2 cost time: 1.7955877780914307
Epoch: 2, Steps: 12 | Train Loss: 1.201 Vali Loss: 0.949 Vali Acc: 0.594 Test Loss: 0.949 Test Acc: 0.594
Validation loss decreased (-0.305541 --> -0.594435).  Saving model ...
Epoch: 3 cost time: 1.5469014644622803
Epoch: 3, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.811 Vali Acc: 0.728 Test Loss: 0.811 Test Acc: 0.728
Validation loss decreased (-0.594435 --> -0.727770).  Saving model ...
Epoch: 4 cost time: 1.3862338066101074
Epoch: 4, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.986 Vali Acc: 0.728 Test Loss: 0.986 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1207194328308105
Epoch: 5, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
Validation loss decreased (-0.727770 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 1.6317672729492188
Epoch: 6, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.671 Vali Acc: 0.750 Test Loss: 0.671 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4062228202819824
Epoch: 7, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.498 Vali Acc: 0.767 Test Loss: 0.498 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.311460256576538
Epoch: 8, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.422 Vali Acc: 0.811 Test Loss: 0.422 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 1.1619513034820557
Epoch: 9, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
Validation loss decreased (-0.811107 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.0672752857208252
Epoch: 10, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.439 Vali Acc: 0.844 Test Loss: 0.439 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2636420726776123
Epoch: 11, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.420 Vali Acc: 0.839 Test Loss: 0.420 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1553170680999756
Epoch: 12, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.475 Vali Acc: 0.800 Test Loss: 0.475 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2805683612823486
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 1.4271602630615234
Epoch: 14, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3656420707702637
Epoch: 15, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
Validation loss decreased (-0.855552 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 1.5559217929840088
Epoch: 16, Steps: 12 | Train Loss: 0.250 Vali Loss: 1.516 Vali Acc: 0.794 Test Loss: 1.516 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2218828201293945
Epoch: 17, Steps: 12 | Train Loss: 0.361 Vali Loss: 1.174 Vali Acc: 0.783 Test Loss: 1.174 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2621824741363525
Epoch: 18, Steps: 12 | Train Loss: 0.532 Vali Loss: 1.204 Vali Acc: 0.806 Test Loss: 1.204 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3943228721618652
Epoch: 19, Steps: 12 | Train Loss: 0.504 Vali Loss: 1.149 Vali Acc: 0.856 Test Loss: 1.149 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4458179473876953
Epoch: 20, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.983 Vali Acc: 0.828 Test Loss: 0.983 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5245280265808105
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.008 Vali Acc: 0.839 Test Loss: 1.008 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4226949214935303
Epoch: 22, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.908 Vali Acc: 0.844 Test Loss: 0.908 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4295134544372559
Epoch: 23, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.623 Vali Acc: 0.883 Test Loss: 0.623 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5319347381591797
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.719 Vali Acc: 0.856 Test Loss: 0.719 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.314256191253662
Epoch: 25, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.917 Vali Acc: 0.817 Test Loss: 0.917 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 3790366
model size : 19.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2664074897766113
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.536 Vali Acc: 0.378 Test Loss: 1.536 Test Acc: 0.378
Validation loss decreased (inf --> -0.377762).  Saving model ...
Epoch: 2 cost time: 1.4666943550109863
Epoch: 2, Steps: 12 | Train Loss: 1.216 Vali Loss: 0.888 Vali Acc: 0.622 Test Loss: 0.888 Test Acc: 0.622
Validation loss decreased (-0.377762 --> -0.622213).  Saving model ...
Epoch: 3 cost time: 1.4631845951080322
Epoch: 3, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.986 Vali Acc: 0.633 Test Loss: 0.986 Test Acc: 0.633
Validation loss decreased (-0.622213 --> -0.633323).  Saving model ...
Epoch: 4 cost time: 1.5267634391784668
Epoch: 4, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.747 Vali Acc: 0.722 Test Loss: 0.747 Test Acc: 0.722
Validation loss decreased (-0.633323 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 1.2744410037994385
Epoch: 5, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.481 Vali Acc: 0.789 Test Loss: 0.481 Test Acc: 0.789
Validation loss decreased (-0.722215 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 1.4143710136413574
Epoch: 6, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.451 Vali Acc: 0.794 Test Loss: 0.451 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.3332576751708984
Epoch: 7, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.358 Vali Acc: 0.844 Test Loss: 0.358 Test Acc: 0.844
Validation loss decreased (-0.794440 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.405029535293579
Epoch: 8, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.2672784328460693
Epoch: 9, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.435 Vali Acc: 0.817 Test Loss: 0.435 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4704930782318115
Epoch: 10, Steps: 12 | Train Loss: 0.296 Vali Loss: 1.317 Vali Acc: 0.700 Test Loss: 1.317 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2647819519042969
Epoch: 11, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.215 Vali Acc: 0.744 Test Loss: 1.215 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3889868259429932
Epoch: 12, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.959 Vali Acc: 0.783 Test Loss: 0.959 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4317517280578613
Epoch: 13, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861106).  Saving model ...
Epoch: 14 cost time: 1.2590315341949463
Epoch: 14, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4137823581695557
Epoch: 15, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5677900314331055
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 17 cost time: 1.5406103134155273
Epoch: 17, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.166078805923462
Epoch: 18, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.710 Vali Acc: 0.844 Test Loss: 0.710 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3957624435424805
Epoch: 19, Steps: 12 | Train Loss: 0.427 Vali Loss: 1.458 Vali Acc: 0.811 Test Loss: 1.458 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1855640411376953
Epoch: 20, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.875 Vali Acc: 0.867 Test Loss: 0.875 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2140462398529053
Epoch: 21, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.722 Vali Acc: 0.861 Test Loss: 0.722 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.51247239112854
Epoch: 22, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.661 Vali Acc: 0.889 Test Loss: 0.661 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888882).  Saving model ...
Epoch: 23 cost time: 1.5792336463928223
Epoch: 23, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6597926616668701
Epoch: 24, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.770 Vali Acc: 0.822 Test Loss: 1.770 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5528960227966309
Epoch: 25, Steps: 12 | Train Loss: 0.327 Vali Loss: 1.004 Vali Acc: 0.828 Test Loss: 1.004 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3746707439422607
Epoch: 26, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.780 Vali Acc: 0.844 Test Loss: 0.780 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3453736305236816
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.734 Vali Acc: 0.872 Test Loss: 0.734 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2370781898498535
Epoch: 28, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.335 Vali Acc: 0.833 Test Loss: 1.335 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4862821102142334
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.677 Vali Acc: 0.867 Test Loss: 0.677 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4030835628509521
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.866 Vali Acc: 0.883 Test Loss: 0.866 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2118639945983887
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.729 Vali Acc: 0.889 Test Loss: 0.729 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.705791711807251
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.792 Vali Acc: 0.894 Test Loss: 0.792 Test Acc: 0.894
Validation loss decreased (-0.888882 --> -0.894437).  Saving model ...
Epoch: 33 cost time: 1.2792723178863525
Epoch: 33, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.262 Vali Acc: 0.828 Test Loss: 1.262 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3201770782470703
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.702 Vali Acc: 0.883 Test Loss: 0.702 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.233311653137207
Epoch: 35, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.991 Vali Acc: 0.894 Test Loss: 0.991 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3105189800262451
Epoch: 36, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.750 Vali Acc: 0.828 Test Loss: 1.750 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3044164180755615
Epoch: 37, Steps: 12 | Train Loss: 0.436 Vali Loss: 1.834 Vali Acc: 0.833 Test Loss: 1.834 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4023385047912598
Epoch: 38, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.045 Vali Acc: 0.839 Test Loss: 1.045 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.377476453781128
Epoch: 39, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.596 Vali Acc: 0.822 Test Loss: 1.596 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6010632514953613
Epoch: 40, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.012 Vali Acc: 0.872 Test Loss: 1.012 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1905460357666016
Epoch: 41, Steps: 12 | Train Loss: 0.161 Vali Loss: 2.352 Vali Acc: 0.794 Test Loss: 2.352 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.5001826286315918
Epoch: 42, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.350 Vali Acc: 0.867 Test Loss: 1.350 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 3789086
model size : 19.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.346306562423706
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.517 Vali Acc: 0.350 Test Loss: 1.517 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 1.4114913940429688
Epoch: 2, Steps: 12 | Train Loss: 1.173 Vali Loss: 0.943 Vali Acc: 0.617 Test Loss: 0.943 Test Acc: 0.617
Validation loss decreased (-0.349985 --> -0.616657).  Saving model ...
Epoch: 3 cost time: 1.3463709354400635
Epoch: 3, Steps: 12 | Train Loss: 0.913 Vali Loss: 0.699 Vali Acc: 0.689 Test Loss: 0.699 Test Acc: 0.689
Validation loss decreased (-0.616657 --> -0.688882).  Saving model ...
Epoch: 4 cost time: 1.489398717880249
Epoch: 4, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.613 Vali Acc: 0.700 Test Loss: 0.613 Test Acc: 0.700
Validation loss decreased (-0.688882 --> -0.699994).  Saving model ...
Epoch: 5 cost time: 1.4432260990142822
Epoch: 5, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.980 Vali Acc: 0.700 Test Loss: 0.980 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.392235279083252
Epoch: 6, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.800 Vali Acc: 0.706 Test Loss: 0.800 Test Acc: 0.706
Validation loss decreased (-0.699994 --> -0.705548).  Saving model ...
Epoch: 7 cost time: 1.541818618774414
Epoch: 7, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.445 Vali Acc: 0.783 Test Loss: 0.445 Test Acc: 0.783
Validation loss decreased (-0.705548 --> -0.783329).  Saving model ...
Epoch: 8 cost time: 1.4560675621032715
Epoch: 8, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.672 Vali Acc: 0.794 Test Loss: 0.672 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794438).  Saving model ...
Epoch: 9 cost time: 1.5695583820343018
Epoch: 9, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.752 Vali Acc: 0.783 Test Loss: 0.752 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2752289772033691
Epoch: 10, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 1.4741909503936768
Epoch: 11, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.675 Vali Acc: 0.778 Test Loss: 0.675 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.312720775604248
Epoch: 12, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6558191776275635
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.262 Vali Acc: 0.867 Test Loss: 0.262 Test Acc: 0.867
Validation loss decreased (-0.799996 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 1.432542324066162
Epoch: 14, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.680 Vali Acc: 0.828 Test Loss: 0.680 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2248940467834473
Epoch: 15, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.4347116947174072
Epoch: 16, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1101164817810059
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 1.2058441638946533
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2069196701049805
Epoch: 19, Steps: 12 | Train Loss: 0.479 Vali Loss: 1.575 Vali Acc: 0.806 Test Loss: 1.575 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4723515510559082
Epoch: 20, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.721 Vali Acc: 0.861 Test Loss: 0.721 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4596431255340576
Epoch: 21, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3514800071716309
Epoch: 22, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 1.3566539287567139
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.856 Vali Acc: 0.861 Test Loss: 0.856 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3234622478485107
Epoch: 24, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.746 Vali Acc: 0.861 Test Loss: 0.746 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3683338165283203
Epoch: 25, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.952 Vali Acc: 0.844 Test Loss: 0.952 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.587113618850708
Epoch: 26, Steps: 12 | Train Loss: 0.234 Vali Loss: 1.440 Vali Acc: 0.817 Test Loss: 1.440 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.324181318283081
Epoch: 27, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.966 Vali Acc: 0.844 Test Loss: 0.966 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.317988395690918
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.164 Vali Acc: 0.839 Test Loss: 1.164 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.415923833847046
Epoch: 29, Steps: 12 | Train Loss: 0.196 Vali Loss: 1.205 Vali Acc: 0.844 Test Loss: 1.205 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3371047973632812
Epoch: 30, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.762 Vali Acc: 0.883 Test Loss: 0.762 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2086472511291504
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.715 Vali Acc: 0.872 Test Loss: 0.715 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.290860891342163
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.670 Vali Acc: 0.883 Test Loss: 0.670 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3787806
model size : 19.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.36320161819458
Epoch: 1, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.416 Vali Acc: 0.483 Test Loss: 1.416 Test Acc: 0.483
Validation loss decreased (inf --> -0.483319).  Saving model ...
Epoch: 2 cost time: 1.272705316543579
Epoch: 2, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.024 Vali Acc: 0.633 Test Loss: 1.024 Test Acc: 0.633
Validation loss decreased (-0.483319 --> -0.633323).  Saving model ...
Epoch: 3 cost time: 1.0469694137573242
Epoch: 3, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.804 Vali Acc: 0.661 Test Loss: 0.804 Test Acc: 0.661
Validation loss decreased (-0.633323 --> -0.661103).  Saving model ...
Epoch: 4 cost time: 1.2531421184539795
Epoch: 4, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.514 Vali Acc: 0.756 Test Loss: 0.514 Test Acc: 0.756
Validation loss decreased (-0.661103 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 1.238921880722046
Epoch: 5, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.927 Vali Acc: 0.650 Test Loss: 0.927 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4570531845092773
Epoch: 6, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.490 Vali Acc: 0.772 Test Loss: 0.490 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 1.3542757034301758
Epoch: 7, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.443 Vali Acc: 0.767 Test Loss: 0.443 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.375528335571289
Epoch: 8, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.555 Vali Acc: 0.806 Test Loss: 0.555 Test Acc: 0.806
Validation loss decreased (-0.772217 --> -0.805550).  Saving model ...
Epoch: 9 cost time: 1.2890725135803223
Epoch: 9, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.737 Vali Acc: 0.817 Test Loss: 0.737 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 1.3004591464996338
Epoch: 10, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.716 Vali Acc: 0.817 Test Loss: 0.716 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 1.373856782913208
Epoch: 11, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.810 Vali Acc: 0.778 Test Loss: 0.810 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.428647756576538
Epoch: 12, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
Validation loss decreased (-0.816660 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 1.6003515720367432
Epoch: 13, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.487159013748169
Epoch: 14, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.409 Vali Acc: 0.861 Test Loss: 0.409 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 1.4696118831634521
Epoch: 15, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.238797664642334
Epoch: 16, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.786 Vali Acc: 0.828 Test Loss: 0.786 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1242790222167969
Epoch: 17, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.414 Vali Acc: 0.872 Test Loss: 0.414 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 18 cost time: 1.1968579292297363
Epoch: 18, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.732 Vali Acc: 0.833 Test Loss: 0.732 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1737713813781738
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.533 Vali Acc: 0.872 Test Loss: 0.533 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.240872859954834
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883328).  Saving model ...
Epoch: 21 cost time: 1.1453211307525635
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2220189571380615
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.637 Vali Acc: 0.872 Test Loss: 0.637 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2732300758361816
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.794 Vali Acc: 0.833 Test Loss: 0.794 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1261248588562012
Epoch: 24, Steps: 12 | Train Loss: 0.237 Vali Loss: 1.597 Vali Acc: 0.844 Test Loss: 1.597 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2620391845703125
Epoch: 25, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.776 Vali Acc: 0.867 Test Loss: 0.776 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.386786937713623
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.172 Vali Acc: 0.850 Test Loss: 1.172 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5054855346679688
Epoch: 27, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.441 Vali Acc: 0.828 Test Loss: 1.441 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6177794933319092
Epoch: 28, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.828 Vali Acc: 0.878 Test Loss: 0.828 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4779527187347412
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.386 Vali Acc: 0.839 Test Loss: 1.386 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4777328968048096
Epoch: 30, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.569 Vali Acc: 0.839 Test Loss: 1.569 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 3594654
model size : 18.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3041586875915527
Epoch: 1, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.542 Vali Acc: 0.350 Test Loss: 1.542 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 1.3108985424041748
Epoch: 2, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.038 Vali Acc: 0.578 Test Loss: 1.038 Test Acc: 0.578
Validation loss decreased (-0.349985 --> -0.577767).  Saving model ...
Epoch: 3 cost time: 1.1981520652770996
Epoch: 3, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.639 Vali Acc: 0.744 Test Loss: 0.639 Test Acc: 0.744
Validation loss decreased (-0.577767 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.3107867240905762
Epoch: 4, Steps: 12 | Train Loss: 0.525 Vali Loss: 1.080 Vali Acc: 0.633 Test Loss: 1.080 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.325223684310913
Epoch: 5, Steps: 12 | Train Loss: 0.834 Vali Loss: 0.676 Vali Acc: 0.706 Test Loss: 0.676 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4978549480438232
Epoch: 6, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.507 Vali Acc: 0.767 Test Loss: 0.507 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 1.4211256504058838
Epoch: 7, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4151780605316162
Epoch: 8, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.787 Vali Acc: 0.700 Test Loss: 0.787 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4950382709503174
Epoch: 9, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.360 Vali Acc: 0.856 Test Loss: 0.360 Test Acc: 0.856
Validation loss decreased (-0.766662 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 1.2596418857574463
Epoch: 10, Steps: 12 | Train Loss: 0.296 Vali Loss: 1.025 Vali Acc: 0.794 Test Loss: 1.025 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.31789231300354
Epoch: 11, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.902 Vali Acc: 0.783 Test Loss: 0.902 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1061959266662598
Epoch: 12, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.608 Vali Acc: 0.839 Test Loss: 0.608 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5954980850219727
Epoch: 13, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.4235754013061523
Epoch: 14, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.792 Vali Acc: 0.828 Test Loss: 0.792 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5992751121520996
Epoch: 15, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4491806030273438
Epoch: 16, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3186604976654053
Epoch: 17, Steps: 12 | Train Loss: 0.336 Vali Loss: 1.125 Vali Acc: 0.822 Test Loss: 1.125 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3661448955535889
Epoch: 18, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.930 Vali Acc: 0.817 Test Loss: 0.930 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2521717548370361
Epoch: 19, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.564 Vali Acc: 0.889 Test Loss: 0.564 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888883).  Saving model ...
Epoch: 20 cost time: 1.4695675373077393
Epoch: 20, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.848 Vali Acc: 0.844 Test Loss: 0.848 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4632515907287598
Epoch: 21, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1976289749145508
Epoch: 22, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.628 Vali Acc: 0.878 Test Loss: 0.628 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3971924781799316
Epoch: 23, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.998 Vali Acc: 0.856 Test Loss: 0.998 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.607208013534546
Epoch: 24, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.656 Vali Acc: 0.883 Test Loss: 0.656 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4680261611938477
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.910 Vali Acc: 0.867 Test Loss: 0.910 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3306293487548828
Epoch: 26, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.738 Vali Acc: 0.861 Test Loss: 0.738 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3440608978271484
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.725 Vali Acc: 0.878 Test Loss: 0.725 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.501892328262329
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.496 Vali Acc: 0.906 Test Loss: 0.496 Test Acc: 0.906
Validation loss decreased (-0.888883 --> -0.905551).  Saving model ...
Epoch: 29 cost time: 1.4016199111938477
Epoch: 29, Steps: 12 | Train Loss: 0.318 Vali Loss: 1.667 Vali Acc: 0.789 Test Loss: 1.667 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5793368816375732
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.425 Vali Acc: 0.817 Test Loss: 1.425 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4945957660675049
Epoch: 31, Steps: 12 | Train Loss: 0.412 Vali Loss: 1.248 Vali Acc: 0.850 Test Loss: 1.248 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6293308734893799
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.958 Vali Acc: 0.828 Test Loss: 0.958 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7307558059692383
Epoch: 33, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.702 Vali Acc: 0.856 Test Loss: 0.702 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6618566513061523
Epoch: 34, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.863 Vali Acc: 0.856 Test Loss: 0.863 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5123968124389648
Epoch: 35, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.367 Vali Acc: 0.861 Test Loss: 1.367 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.414130449295044
Epoch: 36, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.765 Vali Acc: 0.817 Test Loss: 1.765 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.9214415550231934
Epoch: 37, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.746 Vali Acc: 0.878 Test Loss: 0.746 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.7630658149719238
Epoch: 38, Steps: 12 | Train Loss: 0.266 Vali Loss: 1.108 Vali Acc: 0.867 Test Loss: 1.108 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 3593374
model size : 18.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5722134113311768
Epoch: 1, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.441 Vali Acc: 0.411 Test Loss: 1.441 Test Acc: 0.411
Validation loss decreased (inf --> -0.411097).  Saving model ...
Epoch: 2 cost time: 1.2241344451904297
Epoch: 2, Steps: 12 | Train Loss: 1.116 Vali Loss: 0.950 Vali Acc: 0.628 Test Loss: 0.950 Test Acc: 0.628
Validation loss decreased (-0.411097 --> -0.627768).  Saving model ...
Epoch: 3 cost time: 1.2386236190795898
Epoch: 3, Steps: 12 | Train Loss: 0.867 Vali Loss: 0.632 Vali Acc: 0.706 Test Loss: 0.632 Test Acc: 0.706
Validation loss decreased (-0.627768 --> -0.705549).  Saving model ...
Epoch: 4 cost time: 1.1845321655273438
Epoch: 4, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.584 Vali Acc: 0.761 Test Loss: 0.584 Test Acc: 0.761
Validation loss decreased (-0.705549 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 1.2119829654693604
Epoch: 5, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.548 Vali Acc: 0.778 Test Loss: 0.548 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777772).  Saving model ...
Epoch: 6 cost time: 1.0809853076934814
Epoch: 6, Steps: 12 | Train Loss: 0.593 Vali Loss: 1.445 Vali Acc: 0.650 Test Loss: 1.445 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9734096527099609
Epoch: 7, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.010 Vali Acc: 0.606 Test Loss: 1.010 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1603460311889648
Epoch: 8, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.469 Vali Acc: 0.794 Test Loss: 0.469 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.3205835819244385
Epoch: 9, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.332 Vali Acc: 0.822 Test Loss: 0.332 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 1.2605695724487305
Epoch: 10, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844439).  Saving model ...
Epoch: 11 cost time: 1.0794520378112793
Epoch: 11, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.345 Vali Acc: 0.878 Test Loss: 0.345 Test Acc: 0.878
Validation loss decreased (-0.844439 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 1.4231832027435303
Epoch: 12, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2042605876922607
Epoch: 13, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.680 Vali Acc: 0.817 Test Loss: 0.680 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2647933959960938
Epoch: 14, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.111814022064209
Epoch: 15, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.039581060409546
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.368 Vali Acc: 0.872 Test Loss: 0.368 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0949931144714355
Epoch: 17, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1953909397125244
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.1510276794433594
Epoch: 19, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.430 Vali Acc: 0.878 Test Loss: 0.430 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.15975022315979
Epoch: 20, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.207 Vali Acc: 0.822 Test Loss: 1.207 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4206666946411133
Epoch: 21, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.699 Vali Acc: 0.883 Test Loss: 0.699 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4041192531585693
Epoch: 22, Steps: 12 | Train Loss: 0.658 Vali Loss: 1.416 Vali Acc: 0.822 Test Loss: 1.416 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9719960689544678
Epoch: 23, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.979 Vali Acc: 0.867 Test Loss: 0.979 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.005094051361084
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.728 Vali Acc: 0.850 Test Loss: 0.728 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2742342948913574
Epoch: 25, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1505928039550781
Epoch: 26, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.659 Vali Acc: 0.878 Test Loss: 0.659 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1181800365447998
Epoch: 27, Steps: 12 | Train Loss: 0.186 Vali Loss: 1.403 Vali Acc: 0.844 Test Loss: 1.403 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2171604633331299
Epoch: 28, Steps: 12 | Train Loss: 0.470 Vali Loss: 1.404 Vali Acc: 0.822 Test Loss: 1.404 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3592094
model size : 18.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9987056255340576
Epoch: 1, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.530 Vali Acc: 0.344 Test Loss: 1.530 Test Acc: 0.344
Validation loss decreased (inf --> -0.344429).  Saving model ...
Epoch: 2 cost time: 1.000645637512207
Epoch: 2, Steps: 12 | Train Loss: 1.100 Vali Loss: 0.990 Vali Acc: 0.622 Test Loss: 0.990 Test Acc: 0.622
Validation loss decreased (-0.344429 --> -0.622212).  Saving model ...
Epoch: 3 cost time: 1.3608107566833496
Epoch: 3, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.553 Vali Acc: 0.594 Test Loss: 1.553 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3443384170532227
Epoch: 4, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.809 Vali Acc: 0.706 Test Loss: 0.809 Test Acc: 0.706
Validation loss decreased (-0.622212 --> -0.705547).  Saving model ...
Epoch: 5 cost time: 1.007117509841919
Epoch: 5, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.543 Vali Acc: 0.756 Test Loss: 0.543 Test Acc: 0.756
Validation loss decreased (-0.705547 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 1.2943024635314941
Epoch: 6, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
Validation loss decreased (-0.755550 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.3297181129455566
Epoch: 7, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.628 Vali Acc: 0.778 Test Loss: 0.628 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9563729763031006
Epoch: 8, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.430 Vali Acc: 0.811 Test Loss: 0.430 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9971940517425537
Epoch: 9, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.809 Vali Acc: 0.756 Test Loss: 0.809 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1396045684814453
Epoch: 10, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0506837368011475
Epoch: 11, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 1.0289602279663086
Epoch: 12, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.288 Vali Acc: 0.844 Test Loss: 0.288 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9277310371398926
Epoch: 13, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.446 Vali Acc: 0.828 Test Loss: 0.446 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1245362758636475
Epoch: 14, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.048384428024292
Epoch: 15, Steps: 12 | Train Loss: 0.211 Vali Loss: 1.440 Vali Acc: 0.828 Test Loss: 1.440 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8544166088104248
Epoch: 16, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 17 cost time: 1.0520844459533691
Epoch: 17, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.736 Vali Acc: 0.783 Test Loss: 1.736 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.330291986465454
Epoch: 18, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.497 Vali Acc: 0.789 Test Loss: 1.497 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1938652992248535
Epoch: 19, Steps: 12 | Train Loss: 0.716 Vali Loss: 1.121 Vali Acc: 0.822 Test Loss: 1.121 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5109422206878662
Epoch: 20, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.971 Vali Acc: 0.817 Test Loss: 0.971 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2070534229278564
Epoch: 21, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.748 Vali Acc: 0.839 Test Loss: 0.748 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0930044651031494
Epoch: 22, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.788 Vali Acc: 0.872 Test Loss: 0.788 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872214).  Saving model ...
Epoch: 23 cost time: 0.942133903503418
Epoch: 23, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.211 Vali Acc: 0.822 Test Loss: 1.211 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0645530223846436
Epoch: 24, Steps: 12 | Train Loss: 0.254 Vali Loss: 1.202 Vali Acc: 0.833 Test Loss: 1.202 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9854931831359863
Epoch: 25, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1368706226348877
Epoch: 26, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.959 Vali Acc: 0.883 Test Loss: 0.959 Test Acc: 0.883
Validation loss decreased (-0.872214 --> -0.883324).  Saving model ...
Epoch: 27 cost time: 1.4237949848175049
Epoch: 27, Steps: 12 | Train Loss: 0.203 Vali Loss: 1.295 Vali Acc: 0.844 Test Loss: 1.295 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4596893787384033
Epoch: 28, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.001 Vali Acc: 0.872 Test Loss: 1.001 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.389543056488037
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.987 Vali Acc: 0.861 Test Loss: 0.987 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3537092208862305
Epoch: 30, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.008 Vali Acc: 0.850 Test Loss: 1.008 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4284591674804688
Epoch: 31, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.156 Vali Acc: 0.867 Test Loss: 1.156 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3143908977508545
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.470 Vali Acc: 0.850 Test Loss: 1.470 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2104270458221436
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.727 Vali Acc: 0.878 Test Loss: 0.727 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2376923561096191
Epoch: 34, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.008 Vali Acc: 0.867 Test Loss: 1.008 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2597715854644775
Epoch: 35, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.157 Vali Acc: 0.850 Test Loss: 1.157 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1950838565826416
Epoch: 36, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.057 Vali Acc: 0.861 Test Loss: 1.057 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 3590814
model size : 18.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2043955326080322
Epoch: 1, Steps: 12 | Train Loss: 1.926 Vali Loss: 1.641 Vali Acc: 0.211 Test Loss: 1.641 Test Acc: 0.211
Validation loss decreased (inf --> -0.211095).  Saving model ...
Epoch: 2 cost time: 1.36653733253479
Epoch: 2, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.112 Vali Acc: 0.633 Test Loss: 1.112 Test Acc: 0.633
Validation loss decreased (-0.211095 --> -0.633322).  Saving model ...
Epoch: 3 cost time: 1.330475091934204
Epoch: 3, Steps: 12 | Train Loss: 0.984 Vali Loss: 0.989 Vali Acc: 0.589 Test Loss: 0.989 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.558485746383667
Epoch: 4, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.697 Vali Acc: 0.650 Test Loss: 0.697 Test Acc: 0.650
Validation loss decreased (-0.633322 --> -0.649993).  Saving model ...
Epoch: 5 cost time: 1.276024580001831
Epoch: 5, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.683 Vali Acc: 0.700 Test Loss: 0.683 Test Acc: 0.700
Validation loss decreased (-0.649993 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 1.3586058616638184
Epoch: 6, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.715 Vali Acc: 0.672 Test Loss: 0.715 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.264737844467163
Epoch: 7, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.592 Vali Acc: 0.761 Test Loss: 0.592 Test Acc: 0.761
Validation loss decreased (-0.699993 --> -0.761105).  Saving model ...
Epoch: 8 cost time: 1.2275450229644775
Epoch: 8, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.432 Vali Acc: 0.761 Test Loss: 0.432 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761107).  Saving model ...
Epoch: 9 cost time: 1.577127456665039
Epoch: 9, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.414 Vali Acc: 0.822 Test Loss: 0.414 Test Acc: 0.822
Validation loss decreased (-0.761107 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 1.3155043125152588
Epoch: 10, Steps: 12 | Train Loss: 0.262 Vali Loss: 1.175 Vali Acc: 0.756 Test Loss: 1.175 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.470820665359497
Epoch: 11, Steps: 12 | Train Loss: 0.699 Vali Loss: 1.177 Vali Acc: 0.722 Test Loss: 1.177 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5626907348632812
Epoch: 12, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.481 Vali Acc: 0.828 Test Loss: 0.481 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827773).  Saving model ...
Epoch: 13 cost time: 1.2969443798065186
Epoch: 13, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.406 Vali Acc: 0.806 Test Loss: 0.406 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1942553520202637
Epoch: 14, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.579 Vali Acc: 0.794 Test Loss: 0.579 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5934429168701172
Epoch: 15, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.571 Vali Acc: 0.794 Test Loss: 0.571 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4380784034729004
Epoch: 16, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.4941272735595703
Epoch: 17, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 1.1513476371765137
Epoch: 18, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2272601127624512
Epoch: 19, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.408825159072876
Epoch: 20, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.620 Vali Acc: 0.839 Test Loss: 0.620 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3802824020385742
Epoch: 21, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.346036672592163
Epoch: 22, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.454 Vali Acc: 0.867 Test Loss: 0.454 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866662).  Saving model ...
Epoch: 23 cost time: 1.444931983947754
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5518708229064941
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.496 Vali Acc: 0.872 Test Loss: 0.496 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 25 cost time: 1.189563274383545
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.428 Vali Acc: 0.878 Test Loss: 0.428 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877774).  Saving model ...
Epoch: 26 cost time: 1.310621976852417
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0991129875183105
Epoch: 27, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0714969635009766
Epoch: 28, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2393288612365723
Epoch: 29, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.426 Vali Acc: 0.867 Test Loss: 0.426 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0365972518920898
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.860 Vali Acc: 0.806 Test Loss: 0.860 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1298635005950928
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3824882507324219
Epoch: 32, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2434146404266357
Epoch: 33, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.464935302734375
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.295379400253296
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1701918
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1025030612945557
Epoch: 1, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.560 Vali Acc: 0.394 Test Loss: 1.560 Test Acc: 0.394
Validation loss decreased (inf --> -0.394429).  Saving model ...
Epoch: 2 cost time: 1.172900915145874
Epoch: 2, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.206 Vali Acc: 0.483 Test Loss: 1.206 Test Acc: 0.483
Validation loss decreased (-0.394429 --> -0.483321).  Saving model ...
Epoch: 3 cost time: 1.3113377094268799
Epoch: 3, Steps: 12 | Train Loss: 1.007 Vali Loss: 0.862 Vali Acc: 0.594 Test Loss: 0.862 Test Acc: 0.594
Validation loss decreased (-0.483321 --> -0.594436).  Saving model ...
Epoch: 4 cost time: 1.2453866004943848
Epoch: 4, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.889 Vali Acc: 0.606 Test Loss: 0.889 Test Acc: 0.606
Validation loss decreased (-0.594436 --> -0.605547).  Saving model ...
Epoch: 5 cost time: 1.2769269943237305
Epoch: 5, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.576 Vali Acc: 0.739 Test Loss: 0.576 Test Acc: 0.739
Validation loss decreased (-0.605547 --> -0.738883).  Saving model ...
Epoch: 6 cost time: 1.2319903373718262
Epoch: 6, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.477 Vali Acc: 0.806 Test Loss: 0.477 Test Acc: 0.806
Validation loss decreased (-0.738883 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 1.093122959136963
Epoch: 7, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.620 Vali Acc: 0.778 Test Loss: 0.620 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.229093313217163
Epoch: 8, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.450 Vali Acc: 0.806 Test Loss: 0.450 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 1.0052087306976318
Epoch: 9, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.571 Vali Acc: 0.806 Test Loss: 0.571 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2379977703094482
Epoch: 10, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.399 Vali Acc: 0.828 Test Loss: 0.399 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.262580156326294
Epoch: 11, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.2483534812927246
Epoch: 12, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.522803783416748
Epoch: 13, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.412 Vali Acc: 0.822 Test Loss: 0.412 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3061442375183105
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3774495124816895
Epoch: 15, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.498 Vali Acc: 0.806 Test Loss: 0.498 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2850708961486816
Epoch: 16, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.394 Vali Acc: 0.839 Test Loss: 0.394 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 1.3127691745758057
Epoch: 17, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.348 Vali Acc: 0.839 Test Loss: 0.348 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 1.199018955230713
Epoch: 18, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.378 Vali Acc: 0.856 Test Loss: 0.378 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 1.3676981925964355
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.904 Vali Acc: 0.806 Test Loss: 0.904 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2813022136688232
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.192748785018921
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 22 cost time: 1.1019694805145264
Epoch: 22, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.446 Vali Acc: 0.861 Test Loss: 0.446 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2754120826721191
Epoch: 23, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.809 Vali Acc: 0.833 Test Loss: 0.809 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1658451557159424
Epoch: 24, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.743 Vali Acc: 0.822 Test Loss: 0.743 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4274272918701172
Epoch: 25, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 1.2600586414337158
Epoch: 26, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.672 Vali Acc: 0.844 Test Loss: 0.672 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3502671718597412
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4615468978881836
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.704 Vali Acc: 0.844 Test Loss: 0.704 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9398143291473389
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.589 Vali Acc: 0.839 Test Loss: 0.589 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3622047901153564
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883329).  Saving model ...
Epoch: 31 cost time: 1.2687270641326904
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 32 cost time: 1.293677568435669
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.242 Vali Acc: 0.811 Test Loss: 1.242 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2717859745025635
Epoch: 33, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.082207441329956
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.668 Vali Acc: 0.856 Test Loss: 0.668 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3675215244293213
Epoch: 35, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.654 Vali Acc: 0.833 Test Loss: 0.654 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3226838111877441
Epoch: 36, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3963298797607422
Epoch: 37, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.628 Vali Acc: 0.817 Test Loss: 0.628 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4118266105651855
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.007 Vali Acc: 0.811 Test Loss: 1.007 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4030141830444336
Epoch: 39, Steps: 12 | Train Loss: 0.264 Vali Loss: 1.080 Vali Acc: 0.794 Test Loss: 1.080 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5093202590942383
Epoch: 40, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.936 Vali Acc: 0.828 Test Loss: 0.936 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.399827003479004
Epoch: 41, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.734 Vali Acc: 0.872 Test Loss: 0.734 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1701278
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.534086227416992
Epoch: 1, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.596 Vali Acc: 0.339 Test Loss: 1.596 Test Acc: 0.339
Validation loss decreased (inf --> -0.338873).  Saving model ...
Epoch: 2 cost time: 1.3121047019958496
Epoch: 2, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.160 Vali Acc: 0.533 Test Loss: 1.160 Test Acc: 0.533
Validation loss decreased (-0.338873 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 1.337186336517334
Epoch: 3, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.770 Vali Acc: 0.733 Test Loss: 0.770 Test Acc: 0.733
Validation loss decreased (-0.533322 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.3628785610198975
Epoch: 4, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.679 Vali Acc: 0.694 Test Loss: 0.679 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2078330516815186
Epoch: 5, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.608 Vali Acc: 0.767 Test Loss: 0.608 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 1.3209550380706787
Epoch: 6, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6347639560699463
Epoch: 7, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.835 Vali Acc: 0.728 Test Loss: 0.835 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4788553714752197
Epoch: 8, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.405 Vali Acc: 0.817 Test Loss: 0.405 Test Acc: 0.817
Validation loss decreased (-0.766661 --> -0.816663).  Saving model ...
Epoch: 9 cost time: 1.271139144897461
Epoch: 9, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.447 Vali Acc: 0.772 Test Loss: 0.447 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4345266819000244
Epoch: 10, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.910 Vali Acc: 0.772 Test Loss: 0.910 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5920076370239258
Epoch: 11, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.410 Vali Acc: 0.817 Test Loss: 0.410 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.444678544998169
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.468 Vali Acc: 0.811 Test Loss: 0.468 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4329237937927246
Epoch: 13, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.527 Vali Acc: 0.806 Test Loss: 0.527 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2711679935455322
Epoch: 14, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.899 Vali Acc: 0.756 Test Loss: 0.899 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9584314823150635
Epoch: 15, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.454 Vali Acc: 0.861 Test Loss: 0.454 Test Acc: 0.861
Validation loss decreased (-0.816663 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 1.411566972732544
Epoch: 16, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.361 Vali Acc: 0.844 Test Loss: 0.361 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4226939678192139
Epoch: 17, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.438 Vali Acc: 0.844 Test Loss: 0.438 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.37495756149292
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.286391019821167
Epoch: 19, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.474 Vali Acc: 0.811 Test Loss: 0.474 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2695989608764648
Epoch: 20, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.777 Vali Acc: 0.806 Test Loss: 0.777 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5024592876434326
Epoch: 21, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.481 Vali Acc: 0.839 Test Loss: 0.481 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.319239854812622
Epoch: 22, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3170852661132812
Epoch: 23, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1745309829711914
Epoch: 24, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2843408584594727
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.445 Vali Acc: 0.867 Test Loss: 0.445 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866662).  Saving model ...
Epoch: 26 cost time: 1.2842485904693604
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.675 Vali Acc: 0.844 Test Loss: 0.675 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3435254096984863
Epoch: 27, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.455 Vali Acc: 0.883 Test Loss: 0.455 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 28 cost time: 1.4754712581634521
Epoch: 28, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.583 Vali Acc: 0.883 Test Loss: 0.583 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3690006732940674
Epoch: 29, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.739 Vali Acc: 0.867 Test Loss: 0.739 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4794018268585205
Epoch: 30, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.746 Vali Acc: 0.856 Test Loss: 0.746 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3837387561798096
Epoch: 31, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.822 Vali Acc: 0.839 Test Loss: 0.822 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4385793209075928
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2749297618865967
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.898 Vali Acc: 0.856 Test Loss: 0.898 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3427026271820068
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.803 Vali Acc: 0.856 Test Loss: 0.803 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3870141506195068
Epoch: 35, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5789968967437744
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.648 Vali Acc: 0.867 Test Loss: 0.648 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6187856197357178
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1700638
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6885831356048584
Epoch: 1, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.584 Vali Acc: 0.400 Test Loss: 1.584 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 1.1621599197387695
Epoch: 2, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.218 Vali Acc: 0.572 Test Loss: 1.218 Test Acc: 0.572
Validation loss decreased (-0.399984 --> -0.572210).  Saving model ...
Epoch: 3 cost time: 0.8449342250823975
Epoch: 3, Steps: 12 | Train Loss: 1.064 Vali Loss: 0.917 Vali Acc: 0.606 Test Loss: 0.917 Test Acc: 0.606
Validation loss decreased (-0.572210 --> -0.605546).  Saving model ...
Epoch: 4 cost time: 1.1917872428894043
Epoch: 4, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.639 Vali Acc: 0.733 Test Loss: 0.639 Test Acc: 0.733
Validation loss decreased (-0.605546 --> -0.733327).  Saving model ...
Epoch: 5 cost time: 1.202502965927124
Epoch: 5, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.871 Vali Acc: 0.711 Test Loss: 0.871 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1024773120880127
Epoch: 6, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.527 Vali Acc: 0.733 Test Loss: 0.527 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733328).  Saving model ...
Epoch: 7 cost time: 1.3765437602996826
Epoch: 7, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.533 Vali Acc: 0.750 Test Loss: 0.533 Test Acc: 0.750
Validation loss decreased (-0.733328 --> -0.749995).  Saving model ...
Epoch: 8 cost time: 1.137131929397583
Epoch: 8, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.575 Vali Acc: 0.739 Test Loss: 0.575 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2100389003753662
Epoch: 9, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.749995 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 1.232680320739746
Epoch: 10, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 1.15980863571167
Epoch: 11, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.481 Vali Acc: 0.789 Test Loss: 0.481 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 1.312622308731079
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
Validation loss decreased (-0.788884 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 1.226879358291626
Epoch: 13, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 1.1375138759613037
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.2535016536712646
Epoch: 15, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3776450157165527
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.438 Vali Acc: 0.811 Test Loss: 0.438 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2677850723266602
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.414 Vali Acc: 0.856 Test Loss: 0.414 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5130350589752197
Epoch: 18, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.310 Vali Acc: 0.872 Test Loss: 0.310 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 1.0088114738464355
Epoch: 19, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 1.14156174659729
Epoch: 20, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1509790420532227
Epoch: 21, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.455 Vali Acc: 0.867 Test Loss: 0.455 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1284384727478027
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5287792682647705
Epoch: 23, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 24 cost time: 1.2704131603240967
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3790557384490967
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.456 Vali Acc: 0.861 Test Loss: 0.456 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.344315528869629
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.439 Vali Acc: 0.878 Test Loss: 0.439 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1940298080444336
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.410 Vali Acc: 0.872 Test Loss: 0.410 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2982912063598633
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.445 Vali Acc: 0.894 Test Loss: 0.445 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894440).  Saving model ...
Epoch: 29 cost time: 1.1044793128967285
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.745 Vali Acc: 0.856 Test Loss: 0.745 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1567907333374023
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2302396297454834
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.854 Vali Acc: 0.828 Test Loss: 0.854 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1717047691345215
Epoch: 32, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.700 Vali Acc: 0.844 Test Loss: 0.700 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1947412490844727
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2202143669128418
Epoch: 34, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1751015186309814
Epoch: 35, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.958 Vali Acc: 0.844 Test Loss: 0.958 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2293438911437988
Epoch: 36, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2455494403839111
Epoch: 37, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.934 Vali Acc: 0.844 Test Loss: 0.934 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2943191528320312
Epoch: 38, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1699998
model size : 8.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8647515773773193
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.687 Vali Acc: 0.289 Test Loss: 1.687 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 1.1835694313049316
Epoch: 2, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.273 Vali Acc: 0.433 Test Loss: 1.273 Test Acc: 0.433
Validation loss decreased (-0.288872 --> -0.433321).  Saving model ...
Epoch: 3 cost time: 1.2590909004211426
Epoch: 3, Steps: 12 | Train Loss: 1.028 Vali Loss: 0.897 Vali Acc: 0.589 Test Loss: 0.897 Test Acc: 0.589
Validation loss decreased (-0.433321 --> -0.588880).  Saving model ...
Epoch: 4 cost time: 1.1932570934295654
Epoch: 4, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.669 Vali Acc: 0.744 Test Loss: 0.669 Test Acc: 0.744
Validation loss decreased (-0.588880 --> -0.744438).  Saving model ...
Epoch: 5 cost time: 1.2704081535339355
Epoch: 5, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.665 Vali Acc: 0.700 Test Loss: 0.665 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2088444232940674
Epoch: 6, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.672 Vali Acc: 0.694 Test Loss: 0.672 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2529199123382568
Epoch: 7, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.458 Vali Acc: 0.794 Test Loss: 0.458 Test Acc: 0.794
Validation loss decreased (-0.744438 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 1.0881216526031494
Epoch: 8, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.726 Vali Acc: 0.728 Test Loss: 0.726 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.128941297531128
Epoch: 9, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.471 Vali Acc: 0.767 Test Loss: 0.471 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3103914260864258
Epoch: 10, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.527 Vali Acc: 0.761 Test Loss: 0.527 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1652047634124756
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.526 Vali Acc: 0.772 Test Loss: 0.526 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5351862907409668
Epoch: 12, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.906 Vali Acc: 0.811 Test Loss: 0.906 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811102).  Saving model ...
Epoch: 13 cost time: 1.303802490234375
Epoch: 13, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.474 Vali Acc: 0.811 Test Loss: 0.474 Test Acc: 0.811
Validation loss decreased (-0.811102 --> -0.811106).  Saving model ...
Epoch: 14 cost time: 1.0746774673461914
Epoch: 14, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 1.389742374420166
Epoch: 15, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.264554500579834
Epoch: 16, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.593 Vali Acc: 0.794 Test Loss: 0.593 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.418074369430542
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.619 Vali Acc: 0.817 Test Loss: 0.619 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.541062831878662
Epoch: 18, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4321208000183105
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2484312057495117
Epoch: 20, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.2717468738555908
Epoch: 21, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.471 Vali Acc: 0.839 Test Loss: 0.471 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3838543891906738
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 1.381389856338501
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877774).  Saving model ...
Epoch: 24 cost time: 1.4917664527893066
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3115086555480957
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3236122131347656
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.545 Vali Acc: 0.883 Test Loss: 0.545 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 1.2061855792999268
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3371922969818115
Epoch: 28, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3458585739135742
Epoch: 29, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.637 Vali Acc: 0.883 Test Loss: 0.637 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4803624153137207
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.594 Vali Acc: 0.883 Test Loss: 0.594 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2050669193267822
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.449 Vali Acc: 0.883 Test Loss: 0.449 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 1.318094253540039
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2279102802276611
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.667 Vali Acc: 0.878 Test Loss: 0.667 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3154785633087158
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.520 Vali Acc: 0.883 Test Loss: 0.520 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2436790466308594
Epoch: 35, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.757 Vali Acc: 0.867 Test Loss: 0.757 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7206435203552246
Epoch: 36, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.880 Vali Acc: 0.861 Test Loss: 0.880 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4251618385314941
Epoch: 37, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.103 Vali Acc: 0.850 Test Loss: 1.103 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2496118545532227
Epoch: 38, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.703 Vali Acc: 0.861 Test Loss: 0.703 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4162700176239014
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.817 Vali Acc: 0.872 Test Loss: 0.817 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5400254726409912
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.641 Vali Acc: 0.883 Test Loss: 0.641 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3834259510040283
Epoch: 41, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.777 Vali Acc: 0.883 Test Loss: 0.777 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1307166
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8164024353027344
Epoch: 1, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.611 Vali Acc: 0.200 Test Loss: 1.611 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.3098564147949219
Epoch: 2, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.231 Vali Acc: 0.533 Test Loss: 1.231 Test Acc: 0.533
Validation loss decreased (-0.199984 --> -0.533321).  Saving model ...
Epoch: 3 cost time: 1.3203415870666504
Epoch: 3, Steps: 12 | Train Loss: 0.997 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
Validation loss decreased (-0.533321 --> -0.716658).  Saving model ...
Epoch: 4 cost time: 1.1283953189849854
Epoch: 4, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.734 Vali Acc: 0.683 Test Loss: 0.734 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2598092555999756
Epoch: 5, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.683 Vali Acc: 0.694 Test Loss: 0.683 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4593291282653809
Epoch: 6, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.552 Vali Acc: 0.733 Test Loss: 0.552 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733328).  Saving model ...
Epoch: 7 cost time: 1.2222678661346436
Epoch: 7, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.733328 --> -0.788884).  Saving model ...
Epoch: 8 cost time: 1.2222397327423096
Epoch: 8, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2154979705810547
Epoch: 9, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.443 Vali Acc: 0.806 Test Loss: 0.443 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 1.1465098857879639
Epoch: 10, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.207993745803833
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.647 Vali Acc: 0.778 Test Loss: 0.647 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4440643787384033
Epoch: 12, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.663 Vali Acc: 0.811 Test Loss: 0.663 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 1.1211891174316406
Epoch: 13, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2253186702728271
Epoch: 14, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.565 Vali Acc: 0.811 Test Loss: 0.565 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 15 cost time: 1.2859249114990234
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.645 Vali Acc: 0.794 Test Loss: 0.645 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2006022930145264
Epoch: 16, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
Validation loss decreased (-0.811105 --> -0.849996).  Saving model ...
Epoch: 17 cost time: 1.1627748012542725
Epoch: 17, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 1.307433843612671
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.441438913345337
Epoch: 19, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.430868148803711
Epoch: 20, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.346 Vali Acc: 0.856 Test Loss: 0.346 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.690180778503418
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1941757202148438
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.325 Vali Acc: 0.883 Test Loss: 0.325 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 1.214735507965088
Epoch: 23, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.357 Vali Acc: 0.883 Test Loss: 0.357 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0745675563812256
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.439 Vali Acc: 0.872 Test Loss: 0.439 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2260692119598389
Epoch: 25, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2678310871124268
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.444 Vali Acc: 0.872 Test Loss: 0.444 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0380210876464844
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0073614120483398
Epoch: 28, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 29 cost time: 1.1616325378417969
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.441 Vali Acc: 0.889 Test Loss: 0.441 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3199071884155273
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.425 Vali Acc: 0.883 Test Loss: 0.425 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0454957485198975
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.443 Vali Acc: 0.883 Test Loss: 0.443 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0296289920806885
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.460 Vali Acc: 0.872 Test Loss: 0.460 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2097446918487549
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.663 Vali Acc: 0.878 Test Loss: 0.663 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.166041374206543
Epoch: 34, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0444414615631104
Epoch: 35, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0872101783752441
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0115580558776855
Epoch: 37, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2069292068481445
Epoch: 38, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.830 Vali Acc: 0.844 Test Loss: 0.830 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1306526
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5133726596832275
Epoch: 1, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.596 Vali Acc: 0.339 Test Loss: 1.596 Test Acc: 0.339
Validation loss decreased (inf --> -0.338873).  Saving model ...
Epoch: 2 cost time: 1.320801019668579
Epoch: 2, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.115 Vali Acc: 0.517 Test Loss: 1.115 Test Acc: 0.517
Validation loss decreased (-0.338873 --> -0.516656).  Saving model ...
Epoch: 3 cost time: 1.1500437259674072
Epoch: 3, Steps: 12 | Train Loss: 0.987 Vali Loss: 0.902 Vali Acc: 0.611 Test Loss: 0.902 Test Acc: 0.611
Validation loss decreased (-0.516656 --> -0.611102).  Saving model ...
Epoch: 4 cost time: 1.2357444763183594
Epoch: 4, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.680 Vali Acc: 0.739 Test Loss: 0.680 Test Acc: 0.739
Validation loss decreased (-0.611102 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 1.294806957244873
Epoch: 5, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.299994707107544
Epoch: 6, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.519 Vali Acc: 0.772 Test Loss: 0.519 Test Acc: 0.772
Validation loss decreased (-0.738882 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 1.220632553100586
Epoch: 7, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.695 Vali Acc: 0.706 Test Loss: 0.695 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3258521556854248
Epoch: 8, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.505 Vali Acc: 0.806 Test Loss: 0.505 Test Acc: 0.806
Validation loss decreased (-0.772217 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 1.3155057430267334
Epoch: 9, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.405 Vali Acc: 0.811 Test Loss: 0.405 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 1.3556010723114014
Epoch: 10, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.461 Vali Acc: 0.839 Test Loss: 0.461 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838884).  Saving model ...
Epoch: 11 cost time: 1.2046334743499756
Epoch: 11, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.483 Vali Acc: 0.800 Test Loss: 0.483 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2712998390197754
Epoch: 12, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4537851810455322
Epoch: 13, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.495 Vali Acc: 0.800 Test Loss: 0.495 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2172725200653076
Epoch: 14, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.498 Vali Acc: 0.839 Test Loss: 0.498 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6510143280029297
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.572 Vali Acc: 0.817 Test Loss: 0.572 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1484689712524414
Epoch: 16, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3762669563293457
Epoch: 17, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.573 Vali Acc: 0.817 Test Loss: 0.573 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4699006080627441
Epoch: 18, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.861 Vali Acc: 0.850 Test Loss: 0.861 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849991).  Saving model ...
Epoch: 19 cost time: 1.3448712825775146
Epoch: 19, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.363 Vali Acc: 0.872 Test Loss: 0.363 Test Acc: 0.872
Validation loss decreased (-0.849991 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 1.5104336738586426
Epoch: 20, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3571040630340576
Epoch: 21, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.444 Vali Acc: 0.878 Test Loss: 0.444 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877773).  Saving model ...
Epoch: 22 cost time: 1.717780590057373
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888885).  Saving model ...
Epoch: 23 cost time: 1.4252960681915283
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2487056255340576
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 1.2933919429779053
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4622735977172852
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5965051651000977
Epoch: 27, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4750919342041016
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.523 Vali Acc: 0.889 Test Loss: 0.523 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6049904823303223
Epoch: 29, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.688 Vali Acc: 0.872 Test Loss: 0.688 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.898580551147461
Epoch: 30, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3630566596984863
Epoch: 31, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.436 Vali Acc: 0.883 Test Loss: 0.436 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4267175197601318
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.863 Vali Acc: 0.850 Test Loss: 0.863 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.453204870223999
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.776 Vali Acc: 0.828 Test Loss: 0.776 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6691339015960693
Epoch: 34, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.558 Vali Acc: 0.894 Test Loss: 0.558 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1305886
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5357213020324707
Epoch: 1, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.686 Vali Acc: 0.350 Test Loss: 1.686 Test Acc: 0.350
Validation loss decreased (inf --> -0.349983).  Saving model ...
Epoch: 2 cost time: 1.1313412189483643
Epoch: 2, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.221 Vali Acc: 0.578 Test Loss: 1.221 Test Acc: 0.578
Validation loss decreased (-0.349983 --> -0.577766).  Saving model ...
Epoch: 3 cost time: 1.2647993564605713
Epoch: 3, Steps: 12 | Train Loss: 1.046 Vali Loss: 0.898 Vali Acc: 0.644 Test Loss: 0.898 Test Acc: 0.644
Validation loss decreased (-0.577766 --> -0.644435).  Saving model ...
Epoch: 4 cost time: 1.1194264888763428
Epoch: 4, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.120 Vali Acc: 0.711 Test Loss: 1.120 Test Acc: 0.711
Validation loss decreased (-0.644435 --> -0.711100).  Saving model ...
Epoch: 5 cost time: 1.4239346981048584
Epoch: 5, Steps: 12 | Train Loss: 0.962 Vali Loss: 0.684 Vali Acc: 0.672 Test Loss: 0.684 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1949667930603027
Epoch: 6, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.891 Vali Acc: 0.633 Test Loss: 0.891 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.404076337814331
Epoch: 7, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 1.430757999420166
Epoch: 8, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.465 Vali Acc: 0.794 Test Loss: 0.465 Test Acc: 0.794
Validation loss decreased (-0.722216 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.394948959350586
Epoch: 9, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.499 Vali Acc: 0.794 Test Loss: 0.499 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3665790557861328
Epoch: 10, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
Validation loss decreased (-0.794440 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 1.3382437229156494
Epoch: 11, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.374 Vali Acc: 0.828 Test Loss: 0.374 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3604941368103027
Epoch: 12, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.633 Vali Acc: 0.778 Test Loss: 0.633 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.281109094619751
Epoch: 13, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.162132740020752
Epoch: 14, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.488 Vali Acc: 0.800 Test Loss: 0.488 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4038445949554443
Epoch: 15, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.430 Vali Acc: 0.811 Test Loss: 0.430 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5353631973266602
Epoch: 16, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.462 Vali Acc: 0.828 Test Loss: 0.462 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5102615356445312
Epoch: 17, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.409 Vali Acc: 0.844 Test Loss: 0.409 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.459808588027954
Epoch: 18, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.576 Vali Acc: 0.817 Test Loss: 0.576 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.309291124343872
Epoch: 19, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.434 Vali Acc: 0.833 Test Loss: 0.434 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3033440113067627
Epoch: 20, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.720 Vali Acc: 0.844 Test Loss: 0.720 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 1305246
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.423311710357666
Epoch: 1, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.641 Vali Acc: 0.328 Test Loss: 1.641 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.3448834419250488
Epoch: 2, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.258 Vali Acc: 0.483 Test Loss: 1.258 Test Acc: 0.483
Validation loss decreased (-0.327761 --> -0.483321).  Saving model ...
Epoch: 3 cost time: 1.1076979637145996
Epoch: 3, Steps: 12 | Train Loss: 1.089 Vali Loss: 0.950 Vali Acc: 0.622 Test Loss: 0.950 Test Acc: 0.622
Validation loss decreased (-0.483321 --> -0.622213).  Saving model ...
Epoch: 4 cost time: 1.2973756790161133
Epoch: 4, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.703 Vali Acc: 0.672 Test Loss: 0.703 Test Acc: 0.672
Validation loss decreased (-0.622213 --> -0.672215).  Saving model ...
Epoch: 5 cost time: 1.4634594917297363
Epoch: 5, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.753 Vali Acc: 0.683 Test Loss: 0.753 Test Acc: 0.683
Validation loss decreased (-0.672215 --> -0.683326).  Saving model ...
Epoch: 6 cost time: 1.248406171798706
Epoch: 6, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.775 Vali Acc: 0.728 Test Loss: 0.775 Test Acc: 0.728
Validation loss decreased (-0.683326 --> -0.727770).  Saving model ...
Epoch: 7 cost time: 1.177396297454834
Epoch: 7, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.504 Vali Acc: 0.750 Test Loss: 0.504 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749995).  Saving model ...
Epoch: 8 cost time: 1.265470027923584
Epoch: 8, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.451 Vali Acc: 0.822 Test Loss: 0.451 Test Acc: 0.822
Validation loss decreased (-0.749995 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 1.2161788940429688
Epoch: 9, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.499 Vali Acc: 0.783 Test Loss: 0.499 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2824506759643555
Epoch: 10, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.457 Vali Acc: 0.789 Test Loss: 0.457 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2745678424835205
Epoch: 11, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.379 Vali Acc: 0.811 Test Loss: 0.379 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3957204818725586
Epoch: 12, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.781 Vali Acc: 0.767 Test Loss: 0.781 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5729849338531494
Epoch: 13, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3013145923614502
Epoch: 14, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.380 Vali Acc: 0.844 Test Loss: 0.380 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.4070868492126465
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.404 Vali Acc: 0.828 Test Loss: 0.404 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1589105129241943
Epoch: 16, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.558 Vali Acc: 0.811 Test Loss: 0.558 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.193683385848999
Epoch: 17, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1248061656951904
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 1.2096614837646484
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1345505714416504
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 21 cost time: 1.013397216796875
Epoch: 21, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4826133251190186
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.260934591293335
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.387 Vali Acc: 0.867 Test Loss: 0.387 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2225744724273682
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3641581535339355
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.369 Vali Acc: 0.872 Test Loss: 0.369 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 26 cost time: 1.2066454887390137
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.366 Vali Acc: 0.894 Test Loss: 0.366 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894441).  Saving model ...
Epoch: 27 cost time: 1.324451208114624
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6538341045379639
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.432065486907959
Epoch: 29, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.772 Vali Acc: 0.839 Test Loss: 0.772 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.487910270690918
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.393 Vali Acc: 0.883 Test Loss: 0.393 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4296860694885254
Epoch: 31, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.817 Vali Acc: 0.828 Test Loss: 0.817 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3392140865325928
Epoch: 32, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.471285104751587
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.391 Vali Acc: 0.894 Test Loss: 0.391 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2703673839569092
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.428 Vali Acc: 0.883 Test Loss: 0.428 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3076705932617188
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.481 Vali Acc: 0.878 Test Loss: 0.481 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3634552955627441
Epoch: 36, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.691 Vali Acc: 0.867 Test Loss: 0.691 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1109790
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.190417528152466
Epoch: 1, Steps: 12 | Train Loss: 2.029 Vali Loss: 1.853 Vali Acc: 0.261 Test Loss: 1.853 Test Acc: 0.261
Validation loss decreased (inf --> -0.261093).  Saving model ...
Epoch: 2 cost time: 1.4519059658050537
Epoch: 2, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
Validation loss decreased (-0.261093 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 1.3794364929199219
Epoch: 3, Steps: 12 | Train Loss: 1.117 Vali Loss: 0.861 Vali Acc: 0.644 Test Loss: 0.861 Test Acc: 0.644
Validation loss decreased (-0.399987 --> -0.644436).  Saving model ...
Epoch: 4 cost time: 1.189894676208496
Epoch: 4, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.697 Vali Acc: 0.694 Test Loss: 0.697 Test Acc: 0.694
Validation loss decreased (-0.644436 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 1.1631011962890625
Epoch: 5, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.656 Vali Acc: 0.700 Test Loss: 0.656 Test Acc: 0.700
Validation loss decreased (-0.694437 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 1.3423902988433838
Epoch: 6, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
Validation loss decreased (-0.699993 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.3905999660491943
Epoch: 7, Steps: 12 | Train Loss: 0.475 Vali Loss: 1.175 Vali Acc: 0.678 Test Loss: 1.175 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.305189609527588
Epoch: 8, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.186 Vali Acc: 0.739 Test Loss: 1.186 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738877).  Saving model ...
Epoch: 9 cost time: 1.571852445602417
Epoch: 9, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.582 Vali Acc: 0.778 Test Loss: 0.582 Test Acc: 0.778
Validation loss decreased (-0.738877 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 1.1558811664581299
Epoch: 10, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.387 Vali Acc: 0.817 Test Loss: 0.387 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816663).  Saving model ...
Epoch: 11 cost time: 1.3366930484771729
Epoch: 11, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3092963695526123
Epoch: 12, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.421 Vali Acc: 0.822 Test Loss: 0.421 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 1.4536566734313965
Epoch: 13, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.824 Vali Acc: 0.789 Test Loss: 0.824 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2917611598968506
Epoch: 14, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.790 Vali Acc: 0.783 Test Loss: 0.790 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4500336647033691
Epoch: 15, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3410334587097168
Epoch: 16, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.389 Vali Acc: 0.833 Test Loss: 0.389 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.5355441570281982
Epoch: 17, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.472580909729004
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 19 cost time: 1.3462438583374023
Epoch: 19, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.319 Vali Acc: 0.867 Test Loss: 0.319 Test Acc: 0.867
Validation loss decreased (-0.844440 --> -0.866663).  Saving model ...
Epoch: 20 cost time: 1.2926840782165527
Epoch: 20, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.416 Vali Acc: 0.839 Test Loss: 0.416 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2167153358459473
Epoch: 21, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7099125385284424
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.364037275314331
Epoch: 23, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.818 Vali Acc: 0.828 Test Loss: 0.818 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7050063610076904
Epoch: 24, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.826 Vali Acc: 0.833 Test Loss: 0.826 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5508146286010742
Epoch: 25, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.911 Vali Acc: 0.828 Test Loss: 0.911 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5115227699279785
Epoch: 26, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.437 Vali Acc: 0.872 Test Loss: 0.437 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872218).  Saving model ...
Epoch: 27 cost time: 1.3749256134033203
Epoch: 27, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.903 Vali Acc: 0.839 Test Loss: 0.903 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4781684875488281
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.507 Vali Acc: 0.883 Test Loss: 0.507 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 1.2592604160308838
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.429 Vali Acc: 0.883 Test Loss: 0.429 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 30 cost time: 1.2794463634490967
Epoch: 30, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.618 Vali Acc: 0.872 Test Loss: 0.618 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.482848882675171
Epoch: 31, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.728 Vali Acc: 0.856 Test Loss: 0.728 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3733711242675781
Epoch: 32, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4695756435394287
Epoch: 33, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.716 Vali Acc: 0.872 Test Loss: 0.716 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.318176507949829
Epoch: 34, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.584 Vali Acc: 0.878 Test Loss: 0.584 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3692734241485596
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.5146892070770264
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888883).  Saving model ...
Epoch: 37 cost time: 1.5256342887878418
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2399044036865234
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.497 Vali Acc: 0.883 Test Loss: 0.497 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3225126266479492
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.168332576751709
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.547 Vali Acc: 0.894 Test Loss: 0.547 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894439).  Saving model ...
Epoch: 41 cost time: 1.2646033763885498
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.593 Vali Acc: 0.883 Test Loss: 0.593 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4540092945098877
Epoch: 42, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2278552055358887
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.736 Vali Acc: 0.856 Test Loss: 0.736 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3777563571929932
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.609 Vali Acc: 0.906 Test Loss: 0.609 Test Acc: 0.906
Validation loss decreased (-0.894439 --> -0.905549).  Saving model ...
Epoch: 45 cost time: 1.288637399673462
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.941 Vali Acc: 0.844 Test Loss: 0.941 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4766805171966553
Epoch: 46, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.643 Vali Acc: 0.883 Test Loss: 0.643 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.291609287261963
Epoch: 47, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.279 Vali Acc: 0.850 Test Loss: 1.279 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.4343535900115967
Epoch: 48, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.754 Vali Acc: 0.867 Test Loss: 0.754 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2724530696868896
Epoch: 49, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.105 Vali Acc: 0.861 Test Loss: 1.105 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.487565040588379
Epoch: 50, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.3993959426879883
Epoch: 51, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.930 Vali Acc: 0.872 Test Loss: 0.930 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.3897075653076172
Epoch: 52, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.781 Vali Acc: 0.883 Test Loss: 0.781 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.4864532947540283
Epoch: 53, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.581 Vali Acc: 0.894 Test Loss: 0.581 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.499741554260254
Epoch: 54, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.558 Vali Acc: 0.894 Test Loss: 0.558 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1109150
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7855031490325928
Epoch: 1, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.653 Vali Acc: 0.272 Test Loss: 1.653 Test Acc: 0.272
Validation loss decreased (inf --> -0.272206).  Saving model ...
Epoch: 2 cost time: 1.3986632823944092
Epoch: 2, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.277 Vali Acc: 0.422 Test Loss: 1.277 Test Acc: 0.422
Validation loss decreased (-0.272206 --> -0.422209).  Saving model ...
Epoch: 3 cost time: 1.2617945671081543
Epoch: 3, Steps: 12 | Train Loss: 1.056 Vali Loss: 0.841 Vali Acc: 0.700 Test Loss: 0.841 Test Acc: 0.700
Validation loss decreased (-0.422209 --> -0.699992).  Saving model ...
Epoch: 4 cost time: 1.2210543155670166
Epoch: 4, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.852 Vali Acc: 0.600 Test Loss: 0.852 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1787285804748535
Epoch: 5, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.599 Vali Acc: 0.744 Test Loss: 0.599 Test Acc: 0.744
Validation loss decreased (-0.699992 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 1.1201159954071045
Epoch: 6, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.809 Vali Acc: 0.689 Test Loss: 0.809 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3537747859954834
Epoch: 7, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.622 Vali Acc: 0.767 Test Loss: 0.622 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766660).  Saving model ...
Epoch: 8 cost time: 1.246870517730713
Epoch: 8, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3967716693878174
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3750929832458496
Epoch: 10, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.498 Vali Acc: 0.767 Test Loss: 0.498 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766662).  Saving model ...
Epoch: 11 cost time: 1.239722490310669
Epoch: 11, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.473 Vali Acc: 0.811 Test Loss: 0.473 Test Acc: 0.811
Validation loss decreased (-0.766662 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 1.3707470893859863
Epoch: 12, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.419 Vali Acc: 0.817 Test Loss: 0.419 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 1.468900203704834
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.857 Vali Acc: 0.789 Test Loss: 0.857 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.40101957321167
Epoch: 14, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4145898818969727
Epoch: 15, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.654 Vali Acc: 0.794 Test Loss: 0.654 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.544396162033081
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 1.0315771102905273
Epoch: 17, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.396 Vali Acc: 0.828 Test Loss: 0.396 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2990236282348633
Epoch: 18, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.408 Vali Acc: 0.856 Test Loss: 0.408 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855551).  Saving model ...
Epoch: 19 cost time: 1.348724603652954
Epoch: 19, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.486 Vali Acc: 0.828 Test Loss: 0.486 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.365034580230713
Epoch: 20, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4854061603546143
Epoch: 21, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.462 Vali Acc: 0.839 Test Loss: 0.462 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2253994941711426
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 23 cost time: 1.2314329147338867
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1859543323516846
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.276219367980957
Epoch: 25, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 1.3249118328094482
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.395 Vali Acc: 0.867 Test Loss: 0.395 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1718461513519287
Epoch: 27, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3605883121490479
Epoch: 28, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2510097026824951
Epoch: 29, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.830 Vali Acc: 0.822 Test Loss: 0.830 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2071418762207031
Epoch: 30, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.718 Vali Acc: 0.844 Test Loss: 0.718 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.180037260055542
Epoch: 31, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2196762561798096
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 1.3496918678283691
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3547353744506836
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3729488849639893
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3639464378356934
Epoch: 36, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.583 Vali Acc: 0.889 Test Loss: 0.583 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3981995582580566
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.492 Vali Acc: 0.894 Test Loss: 0.492 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.321753978729248
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.669 Vali Acc: 0.872 Test Loss: 0.669 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.386314868927002
Epoch: 39, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.413 Vali Acc: 0.917 Test Loss: 0.413 Test Acc: 0.917
Validation loss decreased (-0.899995 --> -0.916663).  Saving model ...
Epoch: 40 cost time: 1.2952375411987305
Epoch: 40, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.765 Vali Acc: 0.883 Test Loss: 0.765 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3131403923034668
Epoch: 41, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.31400465965271
Epoch: 42, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.696 Vali Acc: 0.867 Test Loss: 0.696 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.380885124206543
Epoch: 43, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.797 Vali Acc: 0.844 Test Loss: 0.797 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.343407154083252
Epoch: 44, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.075 Vali Acc: 0.789 Test Loss: 1.075 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.284388780593872
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.282888650894165
Epoch: 46, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.816 Vali Acc: 0.844 Test Loss: 0.816 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2164485454559326
Epoch: 47, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.801 Vali Acc: 0.861 Test Loss: 0.801 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2585163116455078
Epoch: 48, Steps: 12 | Train Loss: 0.196 Vali Loss: 1.194 Vali Acc: 0.822 Test Loss: 1.194 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2168054580688477
Epoch: 49, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.818 Vali Acc: 0.872 Test Loss: 0.818 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1108510
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.224008083343506
Epoch: 1, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.557 Vali Acc: 0.339 Test Loss: 1.557 Test Acc: 0.339
Validation loss decreased (inf --> -0.338873).  Saving model ...
Epoch: 2 cost time: 1.162085771560669
Epoch: 2, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.097 Vali Acc: 0.644 Test Loss: 1.097 Test Acc: 0.644
Validation loss decreased (-0.338873 --> -0.644433).  Saving model ...
Epoch: 3 cost time: 1.3812801837921143
Epoch: 3, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.063 Vali Acc: 0.561 Test Loss: 1.063 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.303666114807129
Epoch: 4, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.722 Vali Acc: 0.689 Test Loss: 0.722 Test Acc: 0.689
Validation loss decreased (-0.644433 --> -0.688882).  Saving model ...
Epoch: 5 cost time: 1.3332884311676025
Epoch: 5, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.048 Vali Acc: 0.667 Test Loss: 1.048 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3815414905548096
Epoch: 6, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.543 Vali Acc: 0.744 Test Loss: 0.543 Test Acc: 0.744
Validation loss decreased (-0.688882 --> -0.744439).  Saving model ...
Epoch: 7 cost time: 1.2148547172546387
Epoch: 7, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.482 Vali Acc: 0.778 Test Loss: 0.482 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 1.2898268699645996
Epoch: 8, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.427 Vali Acc: 0.794 Test Loss: 0.427 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.2077255249023438
Epoch: 9, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.503 Vali Acc: 0.761 Test Loss: 0.503 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2418885231018066
Epoch: 10, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4484033584594727
Epoch: 11, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.469 Vali Acc: 0.800 Test Loss: 0.469 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 0.9893760681152344
Epoch: 12, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
Validation loss decreased (-0.799995 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 1.1620218753814697
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.446 Vali Acc: 0.811 Test Loss: 0.446 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2060084342956543
Epoch: 14, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 1.1321911811828613
Epoch: 15, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4474513530731201
Epoch: 16, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.411 Vali Acc: 0.856 Test Loss: 0.411 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4252674579620361
Epoch: 17, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2967097759246826
Epoch: 18, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.333 Vali Acc: 0.844 Test Loss: 0.333 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2855603694915771
Epoch: 19, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3392033576965332
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9826412200927734
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.451 Vali Acc: 0.872 Test Loss: 0.451 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2450611591339111
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2760076522827148
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.543339490890503
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.383 Vali Acc: 0.872 Test Loss: 0.383 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1107870
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4202663898468018
Epoch: 1, Steps: 12 | Train Loss: 1.902 Vali Loss: 1.705 Vali Acc: 0.261 Test Loss: 1.705 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 1.2120895385742188
Epoch: 2, Steps: 12 | Train Loss: 1.495 Vali Loss: 1.185 Vali Acc: 0.589 Test Loss: 1.185 Test Acc: 0.589
Validation loss decreased (-0.261094 --> -0.588877).  Saving model ...
Epoch: 3 cost time: 1.3149528503417969
Epoch: 3, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.892 Vali Acc: 0.678 Test Loss: 0.892 Test Acc: 0.678
Validation loss decreased (-0.588877 --> -0.677769).  Saving model ...
Epoch: 4 cost time: 1.4374144077301025
Epoch: 4, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.878 Vali Acc: 0.617 Test Loss: 0.878 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5332286357879639
Epoch: 5, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.866 Vali Acc: 0.717 Test Loss: 0.866 Test Acc: 0.717
Validation loss decreased (-0.677769 --> -0.716658).  Saving model ...
Epoch: 6 cost time: 1.1081163883209229
Epoch: 6, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.596 Vali Acc: 0.722 Test Loss: 0.596 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.2941641807556152
Epoch: 7, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.520 Vali Acc: 0.761 Test Loss: 0.520 Test Acc: 0.761
Validation loss decreased (-0.722216 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 1.2545595169067383
Epoch: 8, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.450 Vali Acc: 0.817 Test Loss: 0.450 Test Acc: 0.817
Validation loss decreased (-0.761106 --> -0.816662).  Saving model ...
Epoch: 9 cost time: 1.0387461185455322
Epoch: 9, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.595 Vali Acc: 0.744 Test Loss: 0.595 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3081066608428955
Epoch: 10, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.418165922164917
Epoch: 11, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.493 Vali Acc: 0.778 Test Loss: 0.493 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1152422428131104
Epoch: 12, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.495 Vali Acc: 0.789 Test Loss: 0.495 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2101325988769531
Epoch: 13, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
Validation loss decreased (-0.816662 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 1.2801604270935059
Epoch: 14, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.515 Vali Acc: 0.806 Test Loss: 0.515 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1352002620697021
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.506 Vali Acc: 0.806 Test Loss: 0.506 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.940654993057251
Epoch: 16, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2746870517730713
Epoch: 17, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3179762363433838
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.342416524887085
Epoch: 19, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.500 Vali Acc: 0.828 Test Loss: 0.500 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1867330074310303
Epoch: 20, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.798 Vali Acc: 0.794 Test Loss: 0.798 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0603647232055664
Epoch: 21, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.497 Vali Acc: 0.861 Test Loss: 0.497 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 1.107562780380249
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.443 Vali Acc: 0.867 Test Loss: 0.443 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 23 cost time: 0.9864354133605957
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866663).  Saving model ...
Epoch: 24 cost time: 1.1179256439208984
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.9631936550140381
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.596 Vali Acc: 0.839 Test Loss: 0.596 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1959707736968994
Epoch: 26, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.434 Vali Acc: 0.861 Test Loss: 0.434 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1630866527557373
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.474 Vali Acc: 0.883 Test Loss: 0.474 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.139286756515503
Epoch: 28, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.402 Vali Acc: 0.894 Test Loss: 0.402 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894440).  Saving model ...
Epoch: 29 cost time: 1.1883015632629395
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0528838634490967
Epoch: 30, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.422 Vali Acc: 0.872 Test Loss: 0.422 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0515742301940918
Epoch: 31, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.448 Vali Acc: 0.878 Test Loss: 0.448 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0524256229400635
Epoch: 32, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.002455711364746
Epoch: 33, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.658 Vali Acc: 0.883 Test Loss: 0.658 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0914368629455566
Epoch: 34, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.411 Vali Acc: 0.872 Test Loss: 0.411 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9296600818634033
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.185455560684204
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.429 Vali Acc: 0.883 Test Loss: 0.429 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9710676670074463
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0056519508361816
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.691 Vali Acc: 0.883 Test Loss: 0.691 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1011102
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0916709899902344
Epoch: 1, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.516 Vali Acc: 0.533 Test Loss: 1.516 Test Acc: 0.533
Validation loss decreased (inf --> -0.533318).  Saving model ...
Epoch: 2 cost time: 1.3473773002624512
Epoch: 2, Steps: 12 | Train Loss: 1.400 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.533318 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 1.2451667785644531
Epoch: 3, Steps: 12 | Train Loss: 1.083 Vali Loss: 0.969 Vali Acc: 0.578 Test Loss: 0.969 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.152813196182251
Epoch: 4, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.789 Vali Acc: 0.706 Test Loss: 0.789 Test Acc: 0.706
Validation loss decreased (-0.599989 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 1.06121826171875
Epoch: 5, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.288 Vali Acc: 0.528 Test Loss: 1.288 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4477264881134033
Epoch: 6, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.648 Vali Acc: 0.711 Test Loss: 0.648 Test Acc: 0.711
Validation loss decreased (-0.705548 --> -0.711105).  Saving model ...
Epoch: 7 cost time: 1.221508264541626
Epoch: 7, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
Validation loss decreased (-0.711105 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 1.2300693988800049
Epoch: 8, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.511 Vali Acc: 0.756 Test Loss: 0.511 Test Acc: 0.756
Validation loss decreased (-0.716660 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 1.274259328842163
Epoch: 9, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.678 Vali Acc: 0.728 Test Loss: 0.678 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2562065124511719
Epoch: 10, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.427 Vali Acc: 0.828 Test Loss: 0.427 Test Acc: 0.828
Validation loss decreased (-0.755550 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.1637022495269775
Epoch: 11, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4110989570617676
Epoch: 12, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 1.2316293716430664
Epoch: 13, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.497 Vali Acc: 0.828 Test Loss: 0.497 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.517298936843872
Epoch: 14, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.376 Vali Acc: 0.839 Test Loss: 0.376 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 1.3030140399932861
Epoch: 15, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
Validation loss decreased (-0.838885 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.0555925369262695
Epoch: 16, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.342 Vali Acc: 0.894 Test Loss: 0.342 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2794013023376465
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1059775352478027
Epoch: 18, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3639791011810303
Epoch: 19, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0849242210388184
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.376 Vali Acc: 0.878 Test Loss: 0.376 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.535141944885254
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3909459114074707
Epoch: 22, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 1.2666656970977783
Epoch: 23, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.363 Vali Acc: 0.883 Test Loss: 0.363 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3349575996398926
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.225069522857666
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.348 Vali Acc: 0.894 Test Loss: 0.348 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0871384143829346
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0881903171539307
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2235026359558105
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3325142860412598
Epoch: 29, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.689 Vali Acc: 0.878 Test Loss: 0.689 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.241697072982788
Epoch: 30, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2404844760894775
Epoch: 31, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2858734130859375
Epoch: 32, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1010462
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.160691022872925
Epoch: 1, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.681 Vali Acc: 0.406 Test Loss: 1.681 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 1.2708632946014404
Epoch: 2, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.171 Vali Acc: 0.572 Test Loss: 1.171 Test Acc: 0.572
Validation loss decreased (-0.405539 --> -0.572211).  Saving model ...
Epoch: 3 cost time: 1.331132173538208
Epoch: 3, Steps: 12 | Train Loss: 1.052 Vali Loss: 0.901 Vali Acc: 0.611 Test Loss: 0.901 Test Acc: 0.611
Validation loss decreased (-0.572211 --> -0.611102).  Saving model ...
Epoch: 4 cost time: 1.3871963024139404
Epoch: 4, Steps: 12 | Train Loss: 0.941 Vali Loss: 0.819 Vali Acc: 0.678 Test Loss: 0.819 Test Acc: 0.678
Validation loss decreased (-0.611102 --> -0.677770).  Saving model ...
Epoch: 5 cost time: 1.0392706394195557
Epoch: 5, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.634 Vali Acc: 0.728 Test Loss: 0.634 Test Acc: 0.728
Validation loss decreased (-0.677770 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.04811692237854
Epoch: 6, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.083583116531372
Epoch: 7, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.494 Vali Acc: 0.739 Test Loss: 0.494 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738884).  Saving model ...
Epoch: 8 cost time: 1.1055526733398438
Epoch: 8, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.722 Vali Acc: 0.772 Test Loss: 0.722 Test Acc: 0.772
Validation loss decreased (-0.738884 --> -0.772215).  Saving model ...
Epoch: 9 cost time: 1.2759995460510254
Epoch: 9, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.420 Vali Acc: 0.806 Test Loss: 0.420 Test Acc: 0.806
Validation loss decreased (-0.772215 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 1.224829912185669
Epoch: 10, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.629 Vali Acc: 0.767 Test Loss: 0.629 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9827654361724854
Epoch: 11, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.1614406108856201
Epoch: 12, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.581 Vali Acc: 0.794 Test Loss: 0.581 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.270967721939087
Epoch: 13, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.119016408920288
Epoch: 14, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.0951483249664307
Epoch: 15, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.397 Vali Acc: 0.839 Test Loss: 0.397 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1058549880981445
Epoch: 16, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.034970760345459
Epoch: 17, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 1.1767418384552002
Epoch: 18, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.087787389755249
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.359 Vali Acc: 0.844 Test Loss: 0.359 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1629207134246826
Epoch: 20, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.166074275970459
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 1.2983684539794922
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.337 Vali Acc: 0.883 Test Loss: 0.337 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 1.103064775466919
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 24 cost time: 0.9874982833862305
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.383 Vali Acc: 0.867 Test Loss: 0.383 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0748498439788818
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 1.0532433986663818
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.662 Vali Acc: 0.844 Test Loss: 0.662 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0475006103515625
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2350714206695557
Epoch: 28, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.801 Vali Acc: 0.850 Test Loss: 0.801 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1789426803588867
Epoch: 29, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0095171928405762
Epoch: 30, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2183926105499268
Epoch: 31, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.499 Vali Acc: 0.894 Test Loss: 0.499 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1265172958374023
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0956814289093018
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.670 Vali Acc: 0.856 Test Loss: 0.670 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1510088443756104
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1019463539123535
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1009822
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.296156644821167
Epoch: 1, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.537 Vali Acc: 0.339 Test Loss: 1.537 Test Acc: 0.339
Validation loss decreased (inf --> -0.338874).  Saving model ...
Epoch: 2 cost time: 1.2208583354949951
Epoch: 2, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.249 Vali Acc: 0.600 Test Loss: 1.249 Test Acc: 0.600
Validation loss decreased (-0.338874 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 1.3910706043243408
Epoch: 3, Steps: 12 | Train Loss: 1.019 Vali Loss: 0.858 Vali Acc: 0.689 Test Loss: 0.858 Test Acc: 0.689
Validation loss decreased (-0.599988 --> -0.688880).  Saving model ...
Epoch: 4 cost time: 1.4841251373291016
Epoch: 4, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.981 Vali Acc: 0.683 Test Loss: 0.981 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0912163257598877
Epoch: 5, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.702 Vali Acc: 0.644 Test Loss: 0.702 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3711025714874268
Epoch: 6, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
Validation loss decreased (-0.688880 --> -0.761106).  Saving model ...
Epoch: 7 cost time: 1.433089017868042
Epoch: 7, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.563 Vali Acc: 0.767 Test Loss: 0.563 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.3235678672790527
Epoch: 8, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.603 Vali Acc: 0.728 Test Loss: 0.603 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2264552116394043
Epoch: 9, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.629 Vali Acc: 0.733 Test Loss: 0.629 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5532293319702148
Epoch: 10, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.413 Vali Acc: 0.794 Test Loss: 0.413 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.0968358516693115
Epoch: 11, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.553 Vali Acc: 0.767 Test Loss: 0.553 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3257863521575928
Epoch: 12, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.426 Vali Acc: 0.822 Test Loss: 0.426 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 1.1822221279144287
Epoch: 13, Steps: 12 | Train Loss: 0.372 Vali Loss: 1.363 Vali Acc: 0.761 Test Loss: 1.363 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3201735019683838
Epoch: 14, Steps: 12 | Train Loss: 0.863 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1666414737701416
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 1.1723904609680176
Epoch: 16, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.397 Vali Acc: 0.822 Test Loss: 0.397 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3998334407806396
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3637192249298096
Epoch: 18, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2483258247375488
Epoch: 19, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.661 Vali Acc: 0.811 Test Loss: 0.661 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3224427700042725
Epoch: 20, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.519 Vali Acc: 0.839 Test Loss: 0.519 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2030236721038818
Epoch: 21, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 1.417903184890747
Epoch: 22, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.753 Vali Acc: 0.833 Test Loss: 0.753 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3336260318756104
Epoch: 23, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.440 Vali Acc: 0.883 Test Loss: 0.440 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2676808834075928
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.365 Vali Acc: 0.872 Test Loss: 0.365 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4279992580413818
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2222957611083984
Epoch: 26, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2014334201812744
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.660 Vali Acc: 0.861 Test Loss: 0.660 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3560304641723633
Epoch: 28, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.821 Vali Acc: 0.856 Test Loss: 0.821 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.611358404159546
Epoch: 29, Steps: 12 | Train Loss: 0.516 Vali Loss: 1.323 Vali Acc: 0.828 Test Loss: 1.323 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.53951096534729
Epoch: 30, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.600 Vali Acc: 0.878 Test Loss: 0.600 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2690160274505615
Epoch: 31, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1009182
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7769787311553955
Epoch: 1, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.627 Vali Acc: 0.311 Test Loss: 1.627 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 1.1005792617797852
Epoch: 2, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.349 Vali Acc: 0.472 Test Loss: 1.349 Test Acc: 0.472
Validation loss decreased (-0.311095 --> -0.472209).  Saving model ...
Epoch: 3 cost time: 1.115849256515503
Epoch: 3, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.053 Vali Acc: 0.594 Test Loss: 1.053 Test Acc: 0.594
Validation loss decreased (-0.472209 --> -0.594434).  Saving model ...
Epoch: 4 cost time: 0.9669580459594727
Epoch: 4, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.846 Vali Acc: 0.644 Test Loss: 0.846 Test Acc: 0.644
Validation loss decreased (-0.594434 --> -0.644436).  Saving model ...
Epoch: 5 cost time: 1.0447945594787598
Epoch: 5, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.744 Vali Acc: 0.650 Test Loss: 0.744 Test Acc: 0.650
Validation loss decreased (-0.644436 --> -0.649993).  Saving model ...
Epoch: 6 cost time: 1.0165596008300781
Epoch: 6, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.654 Vali Acc: 0.722 Test Loss: 0.654 Test Acc: 0.722
Validation loss decreased (-0.649993 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.083423137664795
Epoch: 7, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.722 Vali Acc: 0.717 Test Loss: 0.722 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0161256790161133
Epoch: 8, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.512 Vali Acc: 0.817 Test Loss: 0.512 Test Acc: 0.817
Validation loss decreased (-0.722216 --> -0.816662).  Saving model ...
Epoch: 9 cost time: 1.04838228225708
Epoch: 9, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1029386520385742
Epoch: 10, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.425 Vali Acc: 0.767 Test Loss: 0.425 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1045787334442139
Epoch: 11, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
Validation loss decreased (-0.816662 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 1.2428438663482666
Epoch: 12, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.384 Vali Acc: 0.856 Test Loss: 0.384 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1033060550689697
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.988532304763794
Epoch: 14, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.461 Vali Acc: 0.806 Test Loss: 0.461 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0164141654968262
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.513 Vali Acc: 0.811 Test Loss: 0.513 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1575677394866943
Epoch: 16, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.575 Vali Acc: 0.794 Test Loss: 0.575 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1005465984344482
Epoch: 17, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.453 Vali Acc: 0.828 Test Loss: 0.453 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0511257648468018
Epoch: 18, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.631 Vali Acc: 0.778 Test Loss: 0.631 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0474567413330078
Epoch: 19, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.442 Vali Acc: 0.839 Test Loss: 0.442 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.244978427886963
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.470 Vali Acc: 0.828 Test Loss: 0.470 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.37550687789917
Epoch: 21, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.434 Vali Acc: 0.828 Test Loss: 0.434 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 655902
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2869555950164795
Epoch: 1, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.745 Vali Acc: 0.322 Test Loss: 1.745 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 1.4518847465515137
Epoch: 2, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.388 Vali Acc: 0.606 Test Loss: 1.388 Test Acc: 0.606
Validation loss decreased (-0.322205 --> -0.605542).  Saving model ...
Epoch: 3 cost time: 1.335829257965088
Epoch: 3, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.030 Vali Acc: 0.683 Test Loss: 1.030 Test Acc: 0.683
Validation loss decreased (-0.605542 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 1.4335441589355469
Epoch: 4, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.883 Vali Acc: 0.622 Test Loss: 0.883 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.324584722518921
Epoch: 5, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.701 Vali Acc: 0.667 Test Loss: 0.701 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.264791488647461
Epoch: 6, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.612 Vali Acc: 0.744 Test Loss: 0.612 Test Acc: 0.744
Validation loss decreased (-0.683323 --> -0.744438).  Saving model ...
Epoch: 7 cost time: 1.1519370079040527
Epoch: 7, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.649 Vali Acc: 0.700 Test Loss: 0.649 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2943387031555176
Epoch: 8, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.468 Vali Acc: 0.783 Test Loss: 0.468 Test Acc: 0.783
Validation loss decreased (-0.744438 --> -0.783329).  Saving model ...
Epoch: 9 cost time: 1.151564598083496
Epoch: 9, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.525 Vali Acc: 0.772 Test Loss: 0.525 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.412123441696167
Epoch: 10, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.416 Vali Acc: 0.789 Test Loss: 0.416 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 11 cost time: 1.302614450454712
Epoch: 11, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.462 Vali Acc: 0.783 Test Loss: 0.462 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.314192295074463
Epoch: 12, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
Validation loss decreased (-0.788885 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 1.0540411472320557
Epoch: 13, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.373 Vali Acc: 0.794 Test Loss: 0.373 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3424797058105469
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2201826572418213
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.327289342880249
Epoch: 16, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.332 Vali Acc: 0.833 Test Loss: 0.332 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0697014331817627
Epoch: 17, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.170882225036621
Epoch: 18, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.383 Vali Acc: 0.822 Test Loss: 0.383 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1310908794403076
Epoch: 19, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1912577152252197
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 1.2220041751861572
Epoch: 21, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2593607902526855
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0349199771881104
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.437 Vali Acc: 0.844 Test Loss: 0.437 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9748184680938721
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.441 Vali Acc: 0.828 Test Loss: 0.441 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.186279296875
Epoch: 25, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.367 Vali Acc: 0.844 Test Loss: 0.367 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2456378936767578
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866662).  Saving model ...
Epoch: 27 cost time: 1.1726677417755127
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9837691783905029
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0687568187713623
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0669214725494385
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5150251388549805
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3611772060394287
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.229142665863037
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1455872058868408
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.542 Vali Acc: 0.839 Test Loss: 0.542 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2927980422973633
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.332077980041504
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 655582
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7603919506073
Epoch: 1, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.754 Vali Acc: 0.283 Test Loss: 1.754 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 1.038102149963379
Epoch: 2, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.434 Vali Acc: 0.561 Test Loss: 1.434 Test Acc: 0.561
Validation loss decreased (-0.283316 --> -0.561097).  Saving model ...
Epoch: 3 cost time: 0.8789198398590088
Epoch: 3, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.077 Vali Acc: 0.700 Test Loss: 1.077 Test Acc: 0.700
Validation loss decreased (-0.561097 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 1.0452015399932861
Epoch: 4, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.842 Vali Acc: 0.728 Test Loss: 0.842 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727769).  Saving model ...
Epoch: 5 cost time: 1.0280041694641113
Epoch: 5, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.708 Vali Acc: 0.689 Test Loss: 0.708 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.257538080215454
Epoch: 6, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.632 Vali Acc: 0.733 Test Loss: 0.632 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733327).  Saving model ...
Epoch: 7 cost time: 1.0956676006317139
Epoch: 7, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
Validation loss decreased (-0.733327 --> -0.783327).  Saving model ...
Epoch: 8 cost time: 0.9146788120269775
Epoch: 8, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.550 Vali Acc: 0.739 Test Loss: 0.550 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.964271068572998
Epoch: 9, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.435 Vali Acc: 0.772 Test Loss: 0.435 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0149295330047607
Epoch: 10, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0627665519714355
Epoch: 11, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.412 Vali Acc: 0.817 Test Loss: 0.412 Test Acc: 0.817
Validation loss decreased (-0.783327 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 1.0853736400604248
Epoch: 12, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.420 Vali Acc: 0.789 Test Loss: 0.420 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1550650596618652
Epoch: 13, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.456 Vali Acc: 0.800 Test Loss: 0.456 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0621535778045654
Epoch: 14, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 1.1581056118011475
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.392 Vali Acc: 0.828 Test Loss: 0.392 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 0.9255237579345703
Epoch: 16, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.402 Vali Acc: 0.817 Test Loss: 0.402 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2018654346466064
Epoch: 17, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.453 Vali Acc: 0.817 Test Loss: 0.453 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0503849983215332
Epoch: 18, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 0.9903771877288818
Epoch: 19, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.464 Vali Acc: 0.800 Test Loss: 0.464 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0068542957305908
Epoch: 20, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8794920444488525
Epoch: 21, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.413 Vali Acc: 0.828 Test Loss: 0.413 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9236352443695068
Epoch: 22, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.422 Vali Acc: 0.839 Test Loss: 0.422 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 1.106494665145874
Epoch: 23, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844440).  Saving model ...
Epoch: 24 cost time: 0.9620709419250488
Epoch: 24, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9878551959991455
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.439 Vali Acc: 0.839 Test Loss: 0.439 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2531344890594482
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.050865650177002
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1942875385284424
Epoch: 28, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.450 Vali Acc: 0.839 Test Loss: 0.450 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0954399108886719
Epoch: 29, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.487 Vali Acc: 0.828 Test Loss: 0.487 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1199119091033936
Epoch: 30, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 31 cost time: 1.2090530395507812
Epoch: 31, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.411 Vali Acc: 0.883 Test Loss: 0.411 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 1.2969615459442139
Epoch: 32, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1987757682800293
Epoch: 33, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2093653678894043
Epoch: 34, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1680026054382324
Epoch: 35, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.630068063735962
Epoch: 36, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4261319637298584
Epoch: 37, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5437140464782715
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4782168865203857
Epoch: 39, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.401106834411621
Epoch: 40, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4598889350891113
Epoch: 41, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 655262
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8629508018493652
Epoch: 1, Steps: 12 | Train Loss: 1.886 Vali Loss: 1.691 Vali Acc: 0.383 Test Loss: 1.691 Test Acc: 0.383
Validation loss decreased (inf --> -0.383316).  Saving model ...
Epoch: 2 cost time: 1.0038607120513916
Epoch: 2, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.328 Vali Acc: 0.594 Test Loss: 1.328 Test Acc: 0.594
Validation loss decreased (-0.383316 --> -0.594431).  Saving model ...
Epoch: 3 cost time: 1.000298261642456
Epoch: 3, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.003 Vali Acc: 0.628 Test Loss: 1.003 Test Acc: 0.628
Validation loss decreased (-0.594431 --> -0.627768).  Saving model ...
Epoch: 4 cost time: 1.1461262702941895
Epoch: 4, Steps: 12 | Train Loss: 0.923 Vali Loss: 0.884 Vali Acc: 0.633 Test Loss: 0.884 Test Acc: 0.633
Validation loss decreased (-0.627768 --> -0.633324).  Saving model ...
Epoch: 5 cost time: 0.9649317264556885
Epoch: 5, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.747 Vali Acc: 0.667 Test Loss: 0.747 Test Acc: 0.667
Validation loss decreased (-0.633324 --> -0.666659).  Saving model ...
Epoch: 6 cost time: 1.209855079650879
Epoch: 6, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.573 Vali Acc: 0.767 Test Loss: 0.573 Test Acc: 0.767
Validation loss decreased (-0.666659 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 1.2019741535186768
Epoch: 7, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.575 Vali Acc: 0.733 Test Loss: 0.575 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.022214412689209
Epoch: 8, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.467 Vali Acc: 0.789 Test Loss: 0.467 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.1165120601654053
Epoch: 9, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.424 Vali Acc: 0.811 Test Loss: 0.424 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 1.2908079624176025
Epoch: 10, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.458 Vali Acc: 0.772 Test Loss: 0.458 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1097886562347412
Epoch: 11, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.462 Vali Acc: 0.767 Test Loss: 0.462 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1221272945404053
Epoch: 12, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.419 Vali Acc: 0.800 Test Loss: 0.419 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3331730365753174
Epoch: 13, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.455 Vali Acc: 0.778 Test Loss: 0.455 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9298460483551025
Epoch: 14, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.415 Vali Acc: 0.867 Test Loss: 0.415 Test Acc: 0.867
Validation loss decreased (-0.811107 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 1.260373592376709
Epoch: 15, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0096869468688965
Epoch: 16, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.033560037612915
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.403 Vali Acc: 0.844 Test Loss: 0.403 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0672659873962402
Epoch: 18, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0788743495941162
Epoch: 19, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.440 Vali Acc: 0.794 Test Loss: 0.440 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1198687553405762
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.020277738571167
Epoch: 21, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.431 Vali Acc: 0.839 Test Loss: 0.431 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1719107627868652
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.019425868988037
Epoch: 23, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0024561882019043
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 654942
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0251822471618652
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.669 Vali Acc: 0.261 Test Loss: 1.669 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 1.1296522617340088
Epoch: 2, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.350 Vali Acc: 0.583 Test Loss: 1.350 Test Acc: 0.583
Validation loss decreased (-0.261094 --> -0.583320).  Saving model ...
Epoch: 3 cost time: 1.0222511291503906
Epoch: 3, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.050 Vali Acc: 0.733 Test Loss: 1.050 Test Acc: 0.733
Validation loss decreased (-0.583320 --> -0.733323).  Saving model ...
Epoch: 4 cost time: 1.2306673526763916
Epoch: 4, Steps: 12 | Train Loss: 0.921 Vali Loss: 0.906 Vali Acc: 0.661 Test Loss: 0.906 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1972529888153076
Epoch: 5, Steps: 12 | Train Loss: 0.832 Vali Loss: 0.737 Vali Acc: 0.678 Test Loss: 0.737 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2243702411651611
Epoch: 6, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.631 Vali Acc: 0.711 Test Loss: 0.631 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0298707485198975
Epoch: 7, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.617 Vali Acc: 0.733 Test Loss: 0.617 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733327).  Saving model ...
Epoch: 8 cost time: 1.235595464706421
Epoch: 8, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.488 Vali Acc: 0.761 Test Loss: 0.488 Test Acc: 0.761
Validation loss decreased (-0.733327 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 1.0351605415344238
Epoch: 9, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.463 Vali Acc: 0.772 Test Loss: 0.463 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772218).  Saving model ...
Epoch: 10 cost time: 0.9058241844177246
Epoch: 10, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.449 Vali Acc: 0.772 Test Loss: 0.449 Test Acc: 0.772
Validation loss decreased (-0.772218 --> -0.772218).  Saving model ...
Epoch: 11 cost time: 1.0424463748931885
Epoch: 11, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.478 Vali Acc: 0.778 Test Loss: 0.478 Test Acc: 0.778
Validation loss decreased (-0.772218 --> -0.777773).  Saving model ...
Epoch: 12 cost time: 1.1639430522918701
Epoch: 12, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.393 Vali Acc: 0.817 Test Loss: 0.393 Test Acc: 0.817
Validation loss decreased (-0.777773 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 1.154644250869751
Epoch: 13, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.371 Vali Acc: 0.794 Test Loss: 0.371 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1304857730865479
Epoch: 14, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.389 Vali Acc: 0.817 Test Loss: 0.389 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 15 cost time: 1.0330259799957275
Epoch: 15, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.377 Vali Acc: 0.806 Test Loss: 0.377 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0058958530426025
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 17 cost time: 0.9954161643981934
Epoch: 17, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.590 Vali Acc: 0.806 Test Loss: 0.590 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0946650505065918
Epoch: 18, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0795161724090576
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8665635585784912
Epoch: 20, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.368 Vali Acc: 0.811 Test Loss: 0.368 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9042291641235352
Epoch: 21, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8993797302246094
Epoch: 22, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.181854248046875
Epoch: 23, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 1.0482261180877686
Epoch: 24, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.441 Vali Acc: 0.833 Test Loss: 0.441 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1280193328857422
Epoch: 25, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 26 cost time: 1.0522735118865967
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1557691097259521
Epoch: 27, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0460543632507324
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0634920597076416
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.469 Vali Acc: 0.839 Test Loss: 0.469 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9666049480438232
Epoch: 30, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.609 Vali Acc: 0.839 Test Loss: 0.609 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0205178260803223
Epoch: 31, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1508755683898926
Epoch: 32, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.056570053100586
Epoch: 33, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 1.2132916450500488
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.489 Vali Acc: 0.878 Test Loss: 0.489 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 35 cost time: 0.9716112613677979
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0022404193878174
Epoch: 36, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 37 cost time: 0.8714168071746826
Epoch: 37, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0480010509490967
Epoch: 38, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.532 Vali Acc: 0.872 Test Loss: 0.532 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.114182710647583
Epoch: 39, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2355878353118896
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.686 Vali Acc: 0.856 Test Loss: 0.686 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.160156488418579
Epoch: 41, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1022114753723145
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.513 Vali Acc: 0.861 Test Loss: 0.513 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0533106327056885
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.468 Vali Acc: 0.867 Test Loss: 0.468 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9754672050476074
Epoch: 44, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.511 Vali Acc: 0.867 Test Loss: 0.511 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0489752292633057
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.542 Vali Acc: 0.861 Test Loss: 0.542 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2298212051391602
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 457758
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5083506107330322
Epoch: 1, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.653 Vali Acc: 0.422 Test Loss: 1.653 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 1.20908522605896
Epoch: 2, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.354 Vali Acc: 0.622 Test Loss: 1.354 Test Acc: 0.622
Validation loss decreased (-0.422206 --> -0.622209).  Saving model ...
Epoch: 3 cost time: 1.1664586067199707
Epoch: 3, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3797063827514648
Epoch: 4, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.930 Vali Acc: 0.606 Test Loss: 0.930 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9929037094116211
Epoch: 5, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.713 Vali Acc: 0.722 Test Loss: 0.713 Test Acc: 0.722
Validation loss decreased (-0.622209 --> -0.722215).  Saving model ...
Epoch: 6 cost time: 1.2726109027862549
Epoch: 6, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.647 Vali Acc: 0.728 Test Loss: 0.647 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.0195612907409668
Epoch: 7, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.586 Vali Acc: 0.744 Test Loss: 0.586 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744439).  Saving model ...
Epoch: 8 cost time: 1.1165838241577148
Epoch: 8, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.503 Vali Acc: 0.767 Test Loss: 0.503 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766662).  Saving model ...
Epoch: 9 cost time: 1.148094892501831
Epoch: 9, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.497 Vali Acc: 0.756 Test Loss: 0.497 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5762767791748047
Epoch: 10, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.523 Vali Acc: 0.767 Test Loss: 0.523 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3755769729614258
Epoch: 11, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.420 Vali Acc: 0.806 Test Loss: 0.420 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 1.1973226070404053
Epoch: 12, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.401 Vali Acc: 0.806 Test Loss: 0.401 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 13 cost time: 1.061323881149292
Epoch: 13, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.382 Vali Acc: 0.844 Test Loss: 0.382 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.1296017169952393
Epoch: 14, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.412 Vali Acc: 0.806 Test Loss: 0.412 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0075628757476807
Epoch: 15, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.388 Vali Acc: 0.844 Test Loss: 0.388 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1216461658477783
Epoch: 16, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.458 Vali Acc: 0.811 Test Loss: 0.458 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3064489364624023
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.376 Vali Acc: 0.828 Test Loss: 0.376 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9794132709503174
Epoch: 18, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 19 cost time: 1.3420486450195312
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.422 Vali Acc: 0.794 Test Loss: 0.422 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2873189449310303
Epoch: 20, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.467 Vali Acc: 0.800 Test Loss: 0.467 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1814706325531006
Epoch: 21, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9956791400909424
Epoch: 22, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6206026077270508
Epoch: 23, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.085627794265747
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.434 Vali Acc: 0.839 Test Loss: 0.434 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2781972885131836
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.414 Vali Acc: 0.856 Test Loss: 0.414 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855551).  Saving model ...
Epoch: 26 cost time: 1.4634804725646973
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2604796886444092
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.449 Vali Acc: 0.839 Test Loss: 0.449 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1940577030181885
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.514 Vali Acc: 0.806 Test Loss: 0.514 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.275775671005249
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.431 Vali Acc: 0.856 Test Loss: 0.431 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2469215393066406
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3449177742004395
Epoch: 31, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.439 Vali Acc: 0.856 Test Loss: 0.439 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2804229259490967
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 33 cost time: 0.9818298816680908
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.420 Vali Acc: 0.872 Test Loss: 0.420 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 34 cost time: 1.1201262474060059
Epoch: 34, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.21047043800354
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.433 Vali Acc: 0.867 Test Loss: 0.433 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1321735382080078
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9424431324005127
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.408 Vali Acc: 0.867 Test Loss: 0.408 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0209026336669922
Epoch: 38, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.588 Vali Acc: 0.817 Test Loss: 0.588 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2023465633392334
Epoch: 39, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2552781105041504
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0194151401519775
Epoch: 41, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1497550010681152
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.2113187313079834
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.461 Vali Acc: 0.883 Test Loss: 0.461 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 44 cost time: 0.9824433326721191
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.507 Vali Acc: 0.878 Test Loss: 0.507 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0779545307159424
Epoch: 45, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3584606647491455
Epoch: 46, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.456 Vali Acc: 0.878 Test Loss: 0.456 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.795382022857666
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2356064319610596
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3982832431793213
Epoch: 49, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.557 Vali Acc: 0.878 Test Loss: 0.557 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.492814540863037
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2747573852539062
Epoch: 51, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.5742504596710205
Epoch: 52, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.648 Vali Acc: 0.878 Test Loss: 0.648 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.3741018772125244
Epoch: 53, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 457438
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.470512628555298
Epoch: 1, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.662 Vali Acc: 0.317 Test Loss: 1.662 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 1.1694109439849854
Epoch: 2, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.314 Vali Acc: 0.672 Test Loss: 1.314 Test Acc: 0.672
Validation loss decreased (-0.316650 --> -0.672209).  Saving model ...
Epoch: 3 cost time: 1.1604702472686768
Epoch: 3, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.059 Vali Acc: 0.589 Test Loss: 1.059 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.016514539718628
Epoch: 4, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.882 Vali Acc: 0.728 Test Loss: 0.882 Test Acc: 0.728
Validation loss decreased (-0.672209 --> -0.727769).  Saving model ...
Epoch: 5 cost time: 1.1111419200897217
Epoch: 5, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.734 Vali Acc: 0.689 Test Loss: 0.734 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1977052688598633
Epoch: 6, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1319777965545654
Epoch: 7, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.654 Vali Acc: 0.694 Test Loss: 0.654 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.178556203842163
Epoch: 8, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.497 Vali Acc: 0.733 Test Loss: 0.497 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733328).  Saving model ...
Epoch: 9 cost time: 1.2340996265411377
Epoch: 9, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.448 Vali Acc: 0.800 Test Loss: 0.448 Test Acc: 0.800
Validation loss decreased (-0.733328 --> -0.799996).  Saving model ...
Epoch: 10 cost time: 1.322275161743164
Epoch: 10, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.473 Vali Acc: 0.744 Test Loss: 0.473 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.320540189743042
Epoch: 11, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.483 Vali Acc: 0.761 Test Loss: 0.483 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0491786003112793
Epoch: 12, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.388 Vali Acc: 0.828 Test Loss: 0.388 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 1.0354623794555664
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.2179317474365234
Epoch: 14, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.361 Vali Acc: 0.856 Test Loss: 0.361 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 1.0405957698822021
Epoch: 15, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.139495849609375
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.390 Vali Acc: 0.811 Test Loss: 0.390 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.181718111038208
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0172679424285889
Epoch: 18, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0843613147735596
Epoch: 19, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0361473560333252
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.321 Vali Acc: 0.828 Test Loss: 0.321 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0442085266113281
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0783843994140625
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.275554895401001
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0340476036071777
Epoch: 24, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 25 cost time: 1.2545857429504395
Epoch: 25, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2284529209136963
Epoch: 26, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9873454570770264
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.362 Vali Acc: 0.844 Test Loss: 0.362 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9544467926025391
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1609673500061035
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1103603839874268
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.427 Vali Acc: 0.856 Test Loss: 0.427 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2239351272583008
Epoch: 31, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.769 Vali Acc: 0.828 Test Loss: 0.769 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2074480056762695
Epoch: 32, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.908 Vali Acc: 0.800 Test Loss: 0.908 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1446568965911865
Epoch: 33, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.744 Vali Acc: 0.828 Test Loss: 0.744 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0885300636291504
Epoch: 34, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 457118
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3819680213928223
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.673 Vali Acc: 0.222 Test Loss: 1.673 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 1.0015652179718018
Epoch: 2, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.328 Vali Acc: 0.606 Test Loss: 1.328 Test Acc: 0.606
Validation loss decreased (-0.222205 --> -0.605542).  Saving model ...
Epoch: 3 cost time: 0.8758807182312012
Epoch: 3, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.053 Vali Acc: 0.606 Test Loss: 1.053 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605545).  Saving model ...
Epoch: 4 cost time: 0.9481010437011719
Epoch: 4, Steps: 12 | Train Loss: 0.935 Vali Loss: 0.790 Vali Acc: 0.706 Test Loss: 0.790 Test Acc: 0.706
Validation loss decreased (-0.605545 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 1.0792186260223389
Epoch: 5, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.755 Vali Acc: 0.672 Test Loss: 0.755 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0381112098693848
Epoch: 6, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.599 Vali Acc: 0.756 Test Loss: 0.599 Test Acc: 0.756
Validation loss decreased (-0.705548 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 1.044642448425293
Epoch: 7, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.516 Vali Acc: 0.761 Test Loss: 0.516 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 0.9227156639099121
Epoch: 8, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.494 Vali Acc: 0.761 Test Loss: 0.494 Test Acc: 0.761
Validation loss decreased (-0.761106 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 0.8881034851074219
Epoch: 9, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.455 Vali Acc: 0.789 Test Loss: 0.455 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 0.911888837814331
Epoch: 10, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.426 Vali Acc: 0.817 Test Loss: 0.426 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 0.8733797073364258
Epoch: 11, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.418 Vali Acc: 0.806 Test Loss: 0.418 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9703102111816406
Epoch: 12, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.526 Vali Acc: 0.750 Test Loss: 0.526 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0014221668243408
Epoch: 13, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
Validation loss decreased (-0.816662 --> -0.849996).  Saving model ...
Epoch: 14 cost time: 1.2372362613677979
Epoch: 14, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0173430442810059
Epoch: 15, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2380852699279785
Epoch: 16, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.354 Vali Acc: 0.867 Test Loss: 0.354 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 17 cost time: 1.3473312854766846
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.389 Vali Acc: 0.867 Test Loss: 0.389 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.112105131149292
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.334 Vali Acc: 0.828 Test Loss: 0.334 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.333449363708496
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.375 Vali Acc: 0.833 Test Loss: 0.375 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2696342468261719
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4245259761810303
Epoch: 21, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.385 Vali Acc: 0.856 Test Loss: 0.385 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4126379489898682
Epoch: 22, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1093816757202148
Epoch: 23, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.395 Vali Acc: 0.817 Test Loss: 0.395 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.179079294204712
Epoch: 24, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.380 Vali Acc: 0.844 Test Loss: 0.380 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0056376457214355
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.028235673904419
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 1.1566295623779297
Epoch: 27, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.157503366470337
Epoch: 28, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1275954246520996
Epoch: 29, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1207454204559326
Epoch: 30, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.101511001586914
Epoch: 31, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1812336444854736
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9239611625671387
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1375291347503662
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1456756591796875
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.415 Vali Acc: 0.872 Test Loss: 0.415 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 36 cost time: 1.1445763111114502
Epoch: 36, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.500 Vali Acc: 0.861 Test Loss: 0.500 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1784319877624512
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2315049171447754
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3767986297607422
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.172640085220337
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.167510747909546
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2188937664031982
Epoch: 42, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.4294233322143555
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.547006368637085
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.203599214553833
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 456798
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.229957342147827
Epoch: 1, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.724 Vali Acc: 0.200 Test Loss: 1.724 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.2275006771087646
Epoch: 2, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.423 Vali Acc: 0.539 Test Loss: 1.423 Test Acc: 0.539
Validation loss decreased (-0.199983 --> -0.538875).  Saving model ...
Epoch: 3 cost time: 1.3323261737823486
Epoch: 3, Steps: 12 | Train Loss: 1.302 Vali Loss: 1.122 Vali Acc: 0.617 Test Loss: 1.122 Test Acc: 0.617
Validation loss decreased (-0.538875 --> -0.616655).  Saving model ...
Epoch: 4 cost time: 1.2176742553710938
Epoch: 4, Steps: 12 | Train Loss: 0.984 Vali Loss: 0.949 Vali Acc: 0.622 Test Loss: 0.949 Test Acc: 0.622
Validation loss decreased (-0.616655 --> -0.622213).  Saving model ...
Epoch: 5 cost time: 1.1239988803863525
Epoch: 5, Steps: 12 | Train Loss: 0.857 Vali Loss: 0.821 Vali Acc: 0.650 Test Loss: 0.821 Test Acc: 0.650
Validation loss decreased (-0.622213 --> -0.649992).  Saving model ...
Epoch: 6 cost time: 1.0095319747924805
Epoch: 6, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.637 Vali Acc: 0.728 Test Loss: 0.637 Test Acc: 0.728
Validation loss decreased (-0.649992 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 1.1813039779663086
Epoch: 7, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 0.9803738594055176
Epoch: 8, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.561 Vali Acc: 0.733 Test Loss: 0.561 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2815237045288086
Epoch: 9, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.531 Vali Acc: 0.733 Test Loss: 0.531 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1790251731872559
Epoch: 10, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.557 Vali Acc: 0.728 Test Loss: 0.557 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9906446933746338
Epoch: 11, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 12 cost time: 1.2667946815490723
Epoch: 12, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
Validation loss decreased (-0.783328 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 1.060887098312378
Epoch: 13, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.392 Vali Acc: 0.772 Test Loss: 0.392 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2120356559753418
Epoch: 14, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.350 Vali Acc: 0.822 Test Loss: 0.350 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.233705759048462
Epoch: 15, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1315276622772217
Epoch: 16, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.364 Vali Acc: 0.839 Test Loss: 0.364 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 1.1421699523925781
Epoch: 17, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1662101745605469
Epoch: 18, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3810648918151855
Epoch: 19, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1250524520874023
Epoch: 20, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.246819019317627
Epoch: 21, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 1.3097150325775146
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.385 Vali Acc: 0.789 Test Loss: 0.385 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1056225299835205
Epoch: 23, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.457 Vali Acc: 0.839 Test Loss: 0.457 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.244811773300171
Epoch: 24, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.276308536529541
Epoch: 25, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 26 cost time: 1.1998486518859863
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.365 Vali Acc: 0.878 Test Loss: 0.365 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 27 cost time: 1.1807124614715576
Epoch: 27, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.425 Vali Acc: 0.844 Test Loss: 0.425 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0279734134674072
Epoch: 28, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1225759983062744
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1850225925445557
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 31 cost time: 0.9457657337188721
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4316892623901367
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.414 Vali Acc: 0.867 Test Loss: 0.414 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1679081916809082
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.386 Vali Acc: 0.872 Test Loss: 0.386 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.246824026107788
Epoch: 34, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3070592880249023
Epoch: 35, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.339 Vali Acc: 0.872 Test Loss: 0.339 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.346745491027832
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.354288101196289
Epoch: 37, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.368 Vali Acc: 0.878 Test Loss: 0.368 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2752811908721924
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.384235143661499
Epoch: 39, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.401 Vali Acc: 0.894 Test Loss: 0.401 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894440).  Saving model ...
Epoch: 40 cost time: 1.417888879776001
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.144327163696289
Epoch: 41, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0878877639770508
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.474 Vali Acc: 0.872 Test Loss: 0.474 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0765345096588135
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.413 Vali Acc: 0.894 Test Loss: 0.413 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1241168975830078
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894441).  Saving model ...
Epoch: 45 cost time: 1.0935428142547607
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.388 Vali Acc: 0.878 Test Loss: 0.388 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0900382995605469
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.394 Vali Acc: 0.894 Test Loss: 0.394 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9575669765472412
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1684515476226807
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1957788467407227
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0029408931732178
Epoch: 50, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0669896602630615
Epoch: 51, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.441 Vali Acc: 0.883 Test Loss: 0.441 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.0844342708587646
Epoch: 52, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.3262412548065186
Epoch: 53, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.495 Vali Acc: 0.878 Test Loss: 0.495 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.2628579139709473
Epoch: 54, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 358686
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9949116706848145
Epoch: 1, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.649 Vali Acc: 0.333 Test Loss: 1.649 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 1.20772385597229
Epoch: 2, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.336 Vali Acc: 0.606 Test Loss: 1.336 Test Acc: 0.606
Validation loss decreased (-0.333317 --> -0.605542).  Saving model ...
Epoch: 3 cost time: 1.0703074932098389
Epoch: 3, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.121 Vali Acc: 0.694 Test Loss: 1.121 Test Acc: 0.694
Validation loss decreased (-0.605542 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 0.9055829048156738
Epoch: 4, Steps: 12 | Train Loss: 0.982 Vali Loss: 0.838 Vali Acc: 0.706 Test Loss: 0.838 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705547).  Saving model ...
Epoch: 5 cost time: 0.9889786243438721
Epoch: 5, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.746 Vali Acc: 0.656 Test Loss: 0.746 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9067542552947998
Epoch: 6, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.675 Vali Acc: 0.706 Test Loss: 0.675 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705549).  Saving model ...
Epoch: 7 cost time: 0.9497208595275879
Epoch: 7, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.638 Vali Acc: 0.694 Test Loss: 0.638 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9936425685882568
Epoch: 8, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.705549 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 0.910330057144165
Epoch: 9, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.516 Vali Acc: 0.756 Test Loss: 0.516 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0280554294586182
Epoch: 10, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.430 Vali Acc: 0.789 Test Loss: 0.430 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788885).  Saving model ...
Epoch: 11 cost time: 0.8718318939208984
Epoch: 11, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
Validation loss decreased (-0.788885 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 1.0260953903198242
Epoch: 12, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.392 Vali Acc: 0.822 Test Loss: 0.392 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0296950340270996
Epoch: 13, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.421 Vali Acc: 0.811 Test Loss: 0.421 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9569828510284424
Epoch: 14, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.376 Vali Acc: 0.800 Test Loss: 0.376 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2100284099578857
Epoch: 15, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.399 Vali Acc: 0.822 Test Loss: 0.399 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1103925704956055
Epoch: 16, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0337903499603271
Epoch: 17, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.668 Vali Acc: 0.778 Test Loss: 0.668 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0550427436828613
Epoch: 18, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 1.0775256156921387
Epoch: 19, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 0.9928879737854004
Epoch: 20, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.038698673248291
Epoch: 21, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.401 Vali Acc: 0.844 Test Loss: 0.401 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.064251184463501
Epoch: 22, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 1.0564708709716797
Epoch: 23, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 1.0985994338989258
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.994603157043457
Epoch: 25, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9293303489685059
Epoch: 26, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.490 Vali Acc: 0.817 Test Loss: 0.490 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2949132919311523
Epoch: 27, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.404 Vali Acc: 0.856 Test Loss: 0.404 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9962780475616455
Epoch: 28, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1929080486297607
Epoch: 29, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.348 Vali Acc: 0.872 Test Loss: 0.348 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0318052768707275
Epoch: 30, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.452 Vali Acc: 0.867 Test Loss: 0.452 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1588940620422363
Epoch: 31, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.427 Vali Acc: 0.883 Test Loss: 0.427 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 0.9853165149688721
Epoch: 32, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.315 Vali Acc: 0.883 Test Loss: 0.315 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883330).  Saving model ...
Epoch: 33 cost time: 1.0425560474395752
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.372 Vali Acc: 0.878 Test Loss: 0.372 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1372435092926025
Epoch: 34, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 35 cost time: 0.9343421459197998
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.386 Vali Acc: 0.878 Test Loss: 0.386 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1523749828338623
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.429 Vali Acc: 0.861 Test Loss: 0.429 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9519298076629639
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0602107048034668
Epoch: 38, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.420 Vali Acc: 0.883 Test Loss: 0.420 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0663528442382812
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1084647178649902
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.573 Vali Acc: 0.883 Test Loss: 0.573 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1348066329956055
Epoch: 41, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.069589614868164
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9136548042297363
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.405 Vali Acc: 0.894 Test Loss: 0.405 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 44 cost time: 1.1736199855804443
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1209022998809814
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8972647190093994
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3120288848876953
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2522530555725098
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.421 Vali Acc: 0.894 Test Loss: 0.421 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.147618293762207
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3717291355133057
Epoch: 50, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.449 Vali Acc: 0.883 Test Loss: 0.449 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.1501514911651611
Epoch: 51, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.470 Vali Acc: 0.883 Test Loss: 0.470 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.896338701248169
Epoch: 52, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0351502895355225
Epoch: 53, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.581 Vali Acc: 0.872 Test Loss: 0.581 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 358366
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.011963129043579
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.659 Vali Acc: 0.411 Test Loss: 1.659 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 1.1042768955230713
Epoch: 2, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
Validation loss decreased (-0.411095 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 1.0621378421783447
Epoch: 3, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.082 Vali Acc: 0.622 Test Loss: 1.082 Test Acc: 0.622
Validation loss decreased (-0.499986 --> -0.622211).  Saving model ...
Epoch: 4 cost time: 1.008415937423706
Epoch: 4, Steps: 12 | Train Loss: 0.934 Vali Loss: 1.000 Vali Acc: 0.611 Test Loss: 1.000 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0252854824066162
Epoch: 5, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.710 Vali Acc: 0.706 Test Loss: 0.710 Test Acc: 0.706
Validation loss decreased (-0.622211 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 0.8808531761169434
Epoch: 6, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
Validation loss decreased (-0.705548 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 0.8707289695739746
Epoch: 7, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.609 Vali Acc: 0.778 Test Loss: 0.609 Test Acc: 0.778
Validation loss decreased (-0.722216 --> -0.777772).  Saving model ...
Epoch: 8 cost time: 1.004822015762329
Epoch: 8, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.499 Vali Acc: 0.767 Test Loss: 0.499 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.112323522567749
Epoch: 9, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.529 Vali Acc: 0.756 Test Loss: 0.529 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1225240230560303
Epoch: 10, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.543 Vali Acc: 0.772 Test Loss: 0.543 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.314436674118042
Epoch: 11, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.401 Vali Acc: 0.800 Test Loss: 0.401 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 1.3327412605285645
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.373 Vali Acc: 0.833 Test Loss: 0.373 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 1.2011418342590332
Epoch: 13, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2545182704925537
Epoch: 14, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9698295593261719
Epoch: 15, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0263540744781494
Epoch: 16, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 17 cost time: 1.0399649143218994
Epoch: 17, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 0.9329841136932373
Epoch: 18, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.394 Vali Acc: 0.817 Test Loss: 0.394 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9184517860412598
Epoch: 19, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.418 Vali Acc: 0.811 Test Loss: 0.418 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0790505409240723
Epoch: 20, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0698354244232178
Epoch: 21, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.306 Vali Acc: 0.822 Test Loss: 0.306 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9347114562988281
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 0.9597287178039551
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 24 cost time: 0.9640529155731201
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 25 cost time: 0.9658629894256592
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 1.0763328075408936
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.326570987701416
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.387 Vali Acc: 0.883 Test Loss: 0.387 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883329).  Saving model ...
Epoch: 28 cost time: 1.0568480491638184
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0836331844329834
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.396 Vali Acc: 0.856 Test Loss: 0.396 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0452709197998047
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.349 Vali Acc: 0.883 Test Loss: 0.349 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883330).  Saving model ...
Epoch: 31 cost time: 1.2008357048034668
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2558698654174805
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9097332954406738
Epoch: 33, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.455 Vali Acc: 0.856 Test Loss: 0.455 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.092789888381958
Epoch: 34, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.688 Vali Acc: 0.861 Test Loss: 0.688 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0589725971221924
Epoch: 35, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.07444167137146
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9409024715423584
Epoch: 37, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9868242740631104
Epoch: 38, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9773471355438232
Epoch: 39, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9747202396392822
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 358046
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2647969722747803
Epoch: 1, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.663 Vali Acc: 0.328 Test Loss: 1.663 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.019916296005249
Epoch: 2, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.380 Vali Acc: 0.483 Test Loss: 1.380 Test Acc: 0.483
Validation loss decreased (-0.327761 --> -0.483320).  Saving model ...
Epoch: 3 cost time: 1.103072166442871
Epoch: 3, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.096 Vali Acc: 0.622 Test Loss: 1.096 Test Acc: 0.622
Validation loss decreased (-0.483320 --> -0.622211).  Saving model ...
Epoch: 4 cost time: 1.145751714706421
Epoch: 4, Steps: 12 | Train Loss: 0.989 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
Validation loss decreased (-0.622211 --> -0.722214).  Saving model ...
Epoch: 5 cost time: 0.828162431716919
Epoch: 5, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.685 Vali Acc: 0.767 Test Loss: 0.685 Test Acc: 0.767
Validation loss decreased (-0.722214 --> -0.766660).  Saving model ...
Epoch: 6 cost time: 0.9911375045776367
Epoch: 6, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.682 Vali Acc: 0.706 Test Loss: 0.682 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9438614845275879
Epoch: 7, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.538 Vali Acc: 0.761 Test Loss: 0.538 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1045260429382324
Epoch: 8, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.630 Vali Acc: 0.767 Test Loss: 0.630 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 9 cost time: 0.9936254024505615
Epoch: 9, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.686 Vali Acc: 0.772 Test Loss: 0.686 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772215).  Saving model ...
Epoch: 10 cost time: 1.1127192974090576
Epoch: 10, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.468 Vali Acc: 0.772 Test Loss: 0.468 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772218).  Saving model ...
Epoch: 11 cost time: 1.0082988739013672
Epoch: 11, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.530 Vali Acc: 0.761 Test Loss: 0.530 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9588325023651123
Epoch: 12, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.379 Vali Acc: 0.806 Test Loss: 0.379 Test Acc: 0.806
Validation loss decreased (-0.772218 --> -0.805552).  Saving model ...
Epoch: 13 cost time: 0.9904732704162598
Epoch: 13, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
Validation loss decreased (-0.805552 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 1.0921740531921387
Epoch: 14, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.405 Vali Acc: 0.794 Test Loss: 0.405 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.092473030090332
Epoch: 15, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 0.82527756690979
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.258169174194336
Epoch: 17, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9164931774139404
Epoch: 18, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.409 Vali Acc: 0.856 Test Loss: 0.409 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9966013431549072
Epoch: 19, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.294 Vali Acc: 0.850 Test Loss: 0.294 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9984934329986572
Epoch: 20, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.528 Vali Acc: 0.811 Test Loss: 0.528 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1865224838256836
Epoch: 21, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.296 Vali Acc: 0.844 Test Loss: 0.296 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0646660327911377
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.183135747909546
Epoch: 23, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.419 Vali Acc: 0.856 Test Loss: 0.419 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.107384443283081
Epoch: 24, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.428 Vali Acc: 0.839 Test Loss: 0.428 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0262584686279297
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.496 Vali Acc: 0.867 Test Loss: 0.496 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866662).  Saving model ...
Epoch: 26 cost time: 1.0681302547454834
Epoch: 26, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1035187244415283
Epoch: 27, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1169631481170654
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1209263801574707
Epoch: 29, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.867316722869873
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9310073852539062
Epoch: 31, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.414 Vali Acc: 0.867 Test Loss: 0.414 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866663).  Saving model ...
Epoch: 32 cost time: 0.8821661472320557
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0392918586730957
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.393 Vali Acc: 0.867 Test Loss: 0.393 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 34 cost time: 0.9150130748748779
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1791343688964844
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.364 Vali Acc: 0.883 Test Loss: 0.364 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 36 cost time: 1.091841220855713
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.008699655532837
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.372 Vali Acc: 0.872 Test Loss: 0.372 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2336311340332031
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.417 Vali Acc: 0.872 Test Loss: 0.417 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1530115604400635
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.419 Vali Acc: 0.867 Test Loss: 0.419 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1251158714294434
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.426 Vali Acc: 0.872 Test Loss: 0.426 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.159172534942627
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.513 Vali Acc: 0.861 Test Loss: 0.513 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1328516006469727
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9626660346984863
Epoch: 43, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.427 Vali Acc: 0.861 Test Loss: 0.427 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.064148187637329
Epoch: 44, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.073150873184204
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888884).  Saving model ...
Epoch: 46 cost time: 0.9185497760772705
Epoch: 46, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.427 Vali Acc: 0.889 Test Loss: 0.427 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 47 cost time: 0.8932299613952637
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.409 Vali Acc: 0.878 Test Loss: 0.409 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8929274082183838
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0255720615386963
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.474 Vali Acc: 0.878 Test Loss: 0.474 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1554203033447266
Epoch: 50, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.525 Vali Acc: 0.883 Test Loss: 0.525 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8995776176452637
Epoch: 51, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.130354881286621
Epoch: 52, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.8984582424163818
Epoch: 53, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.175288200378418
Epoch: 54, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.2120637893676758
Epoch: 55, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9975578784942627
Epoch: 56, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.599 Vali Acc: 0.872 Test Loss: 0.599 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 357726
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0281364917755127
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.639 Vali Acc: 0.367 Test Loss: 1.639 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 1.2053818702697754
Epoch: 2, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.357 Vali Acc: 0.544 Test Loss: 1.357 Test Acc: 0.544
Validation loss decreased (-0.366650 --> -0.544431).  Saving model ...
Epoch: 3 cost time: 1.1558728218078613
Epoch: 3, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.096 Vali Acc: 0.656 Test Loss: 1.096 Test Acc: 0.656
Validation loss decreased (-0.544431 --> -0.655545).  Saving model ...
Epoch: 4 cost time: 1.1420249938964844
Epoch: 4, Steps: 12 | Train Loss: 0.972 Vali Loss: 0.942 Vali Acc: 0.656 Test Loss: 0.942 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655546).  Saving model ...
Epoch: 5 cost time: 1.1712546348571777
Epoch: 5, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.754 Vali Acc: 0.744 Test Loss: 0.754 Test Acc: 0.744
Validation loss decreased (-0.655546 --> -0.744437).  Saving model ...
Epoch: 6 cost time: 1.0973663330078125
Epoch: 6, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.786 Vali Acc: 0.639 Test Loss: 0.786 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2571556568145752
Epoch: 7, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.653 Vali Acc: 0.706 Test Loss: 0.653 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0812184810638428
Epoch: 8, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.569 Vali Acc: 0.706 Test Loss: 0.569 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.123337745666504
Epoch: 9, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.505 Vali Acc: 0.794 Test Loss: 0.505 Test Acc: 0.794
Validation loss decreased (-0.744437 --> -0.794439).  Saving model ...
Epoch: 10 cost time: 1.1811048984527588
Epoch: 10, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.626 Vali Acc: 0.744 Test Loss: 0.626 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.17802095413208
Epoch: 11, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.449 Vali Acc: 0.778 Test Loss: 0.449 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.251338243484497
Epoch: 12, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1041100025177002
Epoch: 13, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.459 Vali Acc: 0.789 Test Loss: 0.459 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1794981956481934
Epoch: 14, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.415 Vali Acc: 0.800 Test Loss: 0.415 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799996).  Saving model ...
Epoch: 15 cost time: 1.2551116943359375
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.471 Vali Acc: 0.806 Test Loss: 0.471 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805551).  Saving model ...
Epoch: 16 cost time: 1.0646569728851318
Epoch: 16, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.337 Vali Acc: 0.811 Test Loss: 0.337 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811108).  Saving model ...
Epoch: 17 cost time: 1.020615577697754
Epoch: 17, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
Validation loss decreased (-0.811108 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 1.3058280944824219
Epoch: 18, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2575783729553223
Epoch: 19, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2934186458587646
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.06455659866333
Epoch: 21, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1548309326171875
Epoch: 22, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1578049659729004
Epoch: 23, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.376805305480957
Epoch: 24, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.388 Vali Acc: 0.878 Test Loss: 0.388 Test Acc: 0.878
Validation loss decreased (-0.849996 --> -0.877774).  Saving model ...
Epoch: 25 cost time: 1.0085086822509766
Epoch: 25, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.410 Vali Acc: 0.872 Test Loss: 0.410 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0442168712615967
Epoch: 26, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1677534580230713
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.345 Vali Acc: 0.867 Test Loss: 0.345 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0225670337677002
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0404818058013916
Epoch: 29, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.342 Vali Acc: 0.872 Test Loss: 0.342 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0131385326385498
Epoch: 30, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.341 Vali Acc: 0.883 Test Loss: 0.341 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 31 cost time: 0.9723310470581055
Epoch: 31, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.08876633644104
Epoch: 32, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.409 Vali Acc: 0.856 Test Loss: 0.409 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.290597915649414
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.447 Vali Acc: 0.861 Test Loss: 0.447 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0756266117095947
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1770358085632324
Epoch: 35, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.115694284439087
Epoch: 36, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.374 Vali Acc: 0.872 Test Loss: 0.374 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0741219520568848
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.362 Vali Acc: 0.872 Test Loss: 0.362 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0434820652008057
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 39 cost time: 1.314709186553955
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.372865915298462
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.409 Vali Acc: 0.878 Test Loss: 0.409 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2658779621124268
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1685950756072998
Epoch: 42, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.428 Vali Acc: 0.872 Test Loss: 0.428 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1710610389709473
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.409 Vali Acc: 0.894 Test Loss: 0.409 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 44 cost time: 1.2798149585723877
Epoch: 44, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.380 Vali Acc: 0.883 Test Loss: 0.380 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1468324661254883
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3100292682647705
Epoch: 46, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3592641353607178
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0777785778045654
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.1788051128387451
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1069843769073486
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.1160144805908203
Epoch: 51, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.1634645462036133
Epoch: 52, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.2299034595489502
Epoch: 53, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.403 Vali Acc: 0.883 Test Loss: 0.403 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 309150
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4713852405548096
Epoch: 1, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.656 Vali Acc: 0.378 Test Loss: 1.656 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.993156909942627
Epoch: 2, Steps: 12 | Train Loss: 1.628 Vali Loss: 1.383 Vali Acc: 0.550 Test Loss: 1.383 Test Acc: 0.550
Validation loss decreased (-0.377761 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 1.116715431213379
Epoch: 3, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.105 Vali Acc: 0.617 Test Loss: 1.105 Test Acc: 0.617
Validation loss decreased (-0.549986 --> -0.616656).  Saving model ...
Epoch: 4 cost time: 1.1071288585662842
Epoch: 4, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.862 Vali Acc: 0.689 Test Loss: 0.862 Test Acc: 0.689
Validation loss decreased (-0.616656 --> -0.688880).  Saving model ...
Epoch: 5 cost time: 1.0514485836029053
Epoch: 5, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.753 Vali Acc: 0.683 Test Loss: 0.753 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.228938341140747
Epoch: 6, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.649 Vali Acc: 0.728 Test Loss: 0.649 Test Acc: 0.728
Validation loss decreased (-0.688880 --> -0.727771).  Saving model ...
Epoch: 7 cost time: 0.860985279083252
Epoch: 7, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.638 Vali Acc: 0.722 Test Loss: 0.638 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.193875789642334
Epoch: 8, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 1.015592336654663
Epoch: 9, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.464 Vali Acc: 0.783 Test Loss: 0.464 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 0.9326343536376953
Epoch: 10, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.596 Vali Acc: 0.744 Test Loss: 0.596 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.890998125076294
Epoch: 11, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.526 Vali Acc: 0.778 Test Loss: 0.526 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9595828056335449
Epoch: 12, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.423 Vali Acc: 0.794 Test Loss: 0.423 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 0.9839046001434326
Epoch: 13, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.427 Vali Acc: 0.778 Test Loss: 0.427 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8903450965881348
Epoch: 14, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.599 Vali Acc: 0.806 Test Loss: 0.599 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805550).  Saving model ...
Epoch: 15 cost time: 1.011857271194458
Epoch: 15, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816663).  Saving model ...
Epoch: 16 cost time: 1.0469615459442139
Epoch: 16, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 17 cost time: 0.9980926513671875
Epoch: 17, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 1.4620933532714844
Epoch: 18, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9904835224151611
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.504 Vali Acc: 0.817 Test Loss: 0.504 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1610729694366455
Epoch: 20, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.364 Vali Acc: 0.844 Test Loss: 0.364 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9642672538757324
Epoch: 21, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2310874462127686
Epoch: 22, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1808547973632812
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.452 Vali Acc: 0.839 Test Loss: 0.452 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2203774452209473
Epoch: 24, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1708905696868896
Epoch: 25, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.381 Vali Acc: 0.878 Test Loss: 0.381 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877774).  Saving model ...
Epoch: 26 cost time: 1.093268632888794
Epoch: 26, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.202646255493164
Epoch: 27, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 28 cost time: 1.0791282653808594
Epoch: 28, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.359 Vali Acc: 0.867 Test Loss: 0.359 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0124597549438477
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.386 Vali Acc: 0.844 Test Loss: 0.386 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9767708778381348
Epoch: 30, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0613951683044434
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.344 Vali Acc: 0.872 Test Loss: 0.344 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1822385787963867
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.366 Vali Acc: 0.872 Test Loss: 0.366 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.10953688621521
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.408 Vali Acc: 0.844 Test Loss: 0.408 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9862406253814697
Epoch: 34, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.029007911682129
Epoch: 35, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.385 Vali Acc: 0.872 Test Loss: 0.385 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0242831707000732
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.764 Vali Acc: 0.839 Test Loss: 0.764 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9919345378875732
Epoch: 37, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.521 Vali Acc: 0.839 Test Loss: 0.521 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 308830
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1996052265167236
Epoch: 1, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.705 Vali Acc: 0.361 Test Loss: 1.705 Test Acc: 0.361
Validation loss decreased (inf --> -0.361094).  Saving model ...
Epoch: 2 cost time: 1.4540841579437256
Epoch: 2, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.401 Vali Acc: 0.483 Test Loss: 1.401 Test Acc: 0.483
Validation loss decreased (-0.361094 --> -0.483319).  Saving model ...
Epoch: 3 cost time: 1.027667760848999
Epoch: 3, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.119 Vali Acc: 0.611 Test Loss: 1.119 Test Acc: 0.611
Validation loss decreased (-0.483319 --> -0.611100).  Saving model ...
Epoch: 4 cost time: 1.303328037261963
Epoch: 4, Steps: 12 | Train Loss: 1.052 Vali Loss: 0.981 Vali Acc: 0.583 Test Loss: 0.981 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.098726511001587
Epoch: 5, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.732 Vali Acc: 0.728 Test Loss: 0.732 Test Acc: 0.728
Validation loss decreased (-0.611100 --> -0.727770).  Saving model ...
Epoch: 6 cost time: 1.1758382320404053
Epoch: 6, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.670 Vali Acc: 0.722 Test Loss: 0.670 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9969332218170166
Epoch: 7, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.555 Vali Acc: 0.772 Test Loss: 0.555 Test Acc: 0.772
Validation loss decreased (-0.727770 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 1.0797944068908691
Epoch: 8, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.589 Vali Acc: 0.750 Test Loss: 0.589 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0162718296051025
Epoch: 9, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.481 Vali Acc: 0.772 Test Loss: 0.481 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 10 cost time: 1.0731956958770752
Epoch: 10, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.479 Vali Acc: 0.783 Test Loss: 0.479 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 11 cost time: 1.1047234535217285
Epoch: 11, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.438 Vali Acc: 0.789 Test Loss: 0.438 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 12 cost time: 1.1310818195343018
Epoch: 12, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.411 Vali Acc: 0.772 Test Loss: 0.411 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3110055923461914
Epoch: 13, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.599 Vali Acc: 0.772 Test Loss: 0.599 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1799945831298828
Epoch: 14, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.402 Vali Acc: 0.822 Test Loss: 0.402 Test Acc: 0.822
Validation loss decreased (-0.788885 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 1.2114195823669434
Epoch: 15, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.427 Vali Acc: 0.806 Test Loss: 0.427 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2318661212921143
Epoch: 16, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.550 Vali Acc: 0.806 Test Loss: 0.550 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0990946292877197
Epoch: 17, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.472 Vali Acc: 0.806 Test Loss: 0.472 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1522419452667236
Epoch: 18, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 1.1321516036987305
Epoch: 19, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.568 Vali Acc: 0.806 Test Loss: 0.568 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3658924102783203
Epoch: 20, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 21 cost time: 1.2833058834075928
Epoch: 21, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.328 Vali Acc: 0.828 Test Loss: 0.328 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1582920551300049
Epoch: 22, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.458 Vali Acc: 0.839 Test Loss: 0.458 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0914788246154785
Epoch: 23, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.362 Vali Acc: 0.844 Test Loss: 0.362 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0840034484863281
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 25 cost time: 0.9592344760894775
Epoch: 25, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.368 Vali Acc: 0.867 Test Loss: 0.368 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 26 cost time: 1.001985788345337
Epoch: 26, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872218).  Saving model ...
Epoch: 27 cost time: 1.0322461128234863
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.341 Vali Acc: 0.883 Test Loss: 0.341 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 28 cost time: 0.9999618530273438
Epoch: 28, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.352 Vali Acc: 0.867 Test Loss: 0.352 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3368642330169678
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.327 Vali Acc: 0.878 Test Loss: 0.327 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2702994346618652
Epoch: 30, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.350 Vali Acc: 0.867 Test Loss: 0.350 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6298165321350098
Epoch: 31, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.459 Vali Acc: 0.872 Test Loss: 0.459 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3420448303222656
Epoch: 32, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4631500244140625
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.407 Vali Acc: 0.861 Test Loss: 0.407 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9412233829498291
Epoch: 34, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.387 Vali Acc: 0.878 Test Loss: 0.387 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3407511711120605
Epoch: 35, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.367 Vali Acc: 0.872 Test Loss: 0.367 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3681046962738037
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.358 Vali Acc: 0.878 Test Loss: 0.358 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1702041625976562
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 38 cost time: 1.149825096130371
Epoch: 38, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.369077444076538
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.104184627532959
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.409 Vali Acc: 0.883 Test Loss: 0.409 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2553493976593018
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.104102373123169
Epoch: 42, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.417 Vali Acc: 0.878 Test Loss: 0.417 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1031575202941895
Epoch: 43, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.467 Vali Acc: 0.883 Test Loss: 0.467 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.170436143875122
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4003896713256836
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4512834548950195
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 1.1333284378051758
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.393 Vali Acc: 0.894 Test Loss: 0.393 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4149651527404785
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.394 Vali Acc: 0.878 Test Loss: 0.394 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2386527061462402
Epoch: 49, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.515 Vali Acc: 0.872 Test Loss: 0.515 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.3712122440338135
Epoch: 50, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.447 Vali Acc: 0.894 Test Loss: 0.447 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.3199796676635742
Epoch: 51, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1304841041564941
Epoch: 52, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.2416820526123047
Epoch: 53, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.465 Vali Acc: 0.883 Test Loss: 0.465 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.2235403060913086
Epoch: 54, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.883 Test Loss: 0.495 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.1904809474945068
Epoch: 55, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.0970945358276367
Epoch: 56, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 308510
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1372170448303223
Epoch: 1, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.665 Vali Acc: 0.356 Test Loss: 1.665 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 1.2800872325897217
Epoch: 2, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.351 Vali Acc: 0.583 Test Loss: 1.351 Test Acc: 0.583
Validation loss decreased (-0.355539 --> -0.583320).  Saving model ...
Epoch: 3 cost time: 1.0576019287109375
Epoch: 3, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.043 Vali Acc: 0.672 Test Loss: 1.043 Test Acc: 0.672
Validation loss decreased (-0.583320 --> -0.672212).  Saving model ...
Epoch: 4 cost time: 1.0788187980651855
Epoch: 4, Steps: 12 | Train Loss: 0.938 Vali Loss: 0.846 Vali Acc: 0.667 Test Loss: 0.846 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2207534313201904
Epoch: 5, Steps: 12 | Train Loss: 0.832 Vali Loss: 0.836 Vali Acc: 0.650 Test Loss: 0.836 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2674295902252197
Epoch: 6, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.652 Vali Acc: 0.700 Test Loss: 0.652 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699993).  Saving model ...
Epoch: 7 cost time: 1.0079102516174316
Epoch: 7, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.748 Vali Acc: 0.733 Test Loss: 0.748 Test Acc: 0.733
Validation loss decreased (-0.699993 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 1.1406116485595703
Epoch: 8, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.698 Vali Acc: 0.667 Test Loss: 0.698 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0707027912139893
Epoch: 9, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.614 Vali Acc: 0.733 Test Loss: 0.614 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 1.1177232265472412
Epoch: 10, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.445 Vali Acc: 0.794 Test Loss: 0.445 Test Acc: 0.794
Validation loss decreased (-0.733327 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.109539270401001
Epoch: 11, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.440 Vali Acc: 0.789 Test Loss: 0.440 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3257741928100586
Epoch: 12, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.439 Vali Acc: 0.778 Test Loss: 0.439 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4769749641418457
Epoch: 13, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.392 Vali Acc: 0.794 Test Loss: 0.392 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794441).  Saving model ...
Epoch: 14 cost time: 1.2365150451660156
Epoch: 14, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.382 Vali Acc: 0.806 Test Loss: 0.382 Test Acc: 0.806
Validation loss decreased (-0.794441 --> -0.805552).  Saving model ...
Epoch: 15 cost time: 1.239680528640747
Epoch: 15, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1430246829986572
Epoch: 16, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.338 Vali Acc: 0.817 Test Loss: 0.338 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 17 cost time: 1.3091845512390137
Epoch: 17, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838886).  Saving model ...
Epoch: 18 cost time: 0.9044556617736816
Epoch: 18, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
Validation loss decreased (-0.838886 --> -0.877774).  Saving model ...
Epoch: 19 cost time: 0.9322688579559326
Epoch: 19, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.370 Vali Acc: 0.872 Test Loss: 0.370 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3830316066741943
Epoch: 20, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0100839138031006
Epoch: 21, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.381 Vali Acc: 0.872 Test Loss: 0.381 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0255980491638184
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.393 Vali Acc: 0.856 Test Loss: 0.393 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2370362281799316
Epoch: 23, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.382 Vali Acc: 0.856 Test Loss: 0.382 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2130026817321777
Epoch: 24, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9600131511688232
Epoch: 25, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.360 Vali Acc: 0.867 Test Loss: 0.360 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9936034679412842
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.141263484954834
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.382 Vali Acc: 0.856 Test Loss: 0.382 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.033783197402954
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 308190
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6101365089416504
Epoch: 1, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.723 Vali Acc: 0.256 Test Loss: 1.723 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 1.054481029510498
Epoch: 2, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.537 Vali Acc: 0.472 Test Loss: 1.537 Test Acc: 0.472
Validation loss decreased (-0.255538 --> -0.472207).  Saving model ...
Epoch: 3 cost time: 0.9186792373657227
Epoch: 3, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
Validation loss decreased (-0.472207 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.9232354164123535
Epoch: 4, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.059 Vali Acc: 0.650 Test Loss: 1.059 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 1.023301124572754
Epoch: 5, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
Validation loss decreased (-0.649989 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 1.004042625427246
Epoch: 6, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.735 Vali Acc: 0.689 Test Loss: 0.735 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.123790979385376
Epoch: 7, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.12847900390625
Epoch: 8, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.662 Vali Acc: 0.733 Test Loss: 0.662 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 1.1087498664855957
Epoch: 9, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.595 Vali Acc: 0.744 Test Loss: 0.595 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 10 cost time: 1.0666606426239014
Epoch: 10, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.489 Vali Acc: 0.767 Test Loss: 0.489 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766662).  Saving model ...
Epoch: 11 cost time: 1.0547480583190918
Epoch: 11, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.463 Vali Acc: 0.761 Test Loss: 0.463 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.408846139907837
Epoch: 12, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.459 Vali Acc: 0.806 Test Loss: 0.459 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 1.1853563785552979
Epoch: 13, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2993903160095215
Epoch: 14, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.533 Vali Acc: 0.778 Test Loss: 0.533 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1749281883239746
Epoch: 15, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.445 Vali Acc: 0.794 Test Loss: 0.445 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2111501693725586
Epoch: 16, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.392 Vali Acc: 0.822 Test Loss: 0.392 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 1.1547906398773193
Epoch: 17, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.381 Vali Acc: 0.844 Test Loss: 0.381 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 0.9559354782104492
Epoch: 18, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.398 Vali Acc: 0.783 Test Loss: 0.398 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.100606918334961
Epoch: 19, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3095612525939941
Epoch: 20, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.390 Vali Acc: 0.839 Test Loss: 0.390 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0290188789367676
Epoch: 21, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.383 Vali Acc: 0.833 Test Loss: 0.383 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2160766124725342
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 23 cost time: 0.8962059020996094
Epoch: 23, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.399 Vali Acc: 0.817 Test Loss: 0.399 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9560389518737793
Epoch: 24, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4482076168060303
Epoch: 25, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3350577354431152
Epoch: 26, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9611830711364746
Epoch: 27, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.391 Vali Acc: 0.844 Test Loss: 0.391 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0852982997894287
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1284172534942627
Epoch: 29, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0550007820129395
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.438 Vali Acc: 0.839 Test Loss: 0.438 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.016294240951538
Epoch: 31, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9688127040863037
Epoch: 32, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 33 cost time: 1.107781171798706
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.466 Vali Acc: 0.800 Test Loss: 0.466 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1125659942626953
Epoch: 34, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9303817749023438
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.486 Vali Acc: 0.828 Test Loss: 0.486 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.230576992034912
Epoch: 36, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.450 Vali Acc: 0.833 Test Loss: 0.450 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0632085800170898
Epoch: 37, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.351503610610962
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.545 Vali Acc: 0.811 Test Loss: 0.545 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1447041034698486
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.564 Vali Acc: 0.800 Test Loss: 0.564 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.141387701034546
Epoch: 40, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2236328125
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0940697193145752
Epoch: 42, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.595 Vali Acc: 0.839 Test Loss: 0.595 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 280350
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.788252115249634
Epoch: 1, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.681 Vali Acc: 0.328 Test Loss: 1.681 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 1.076246738433838
Epoch: 2, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.488 Vali Acc: 0.594 Test Loss: 1.488 Test Acc: 0.594
Validation loss decreased (-0.327761 --> -0.594430).  Saving model ...
Epoch: 3 cost time: 1.2783958911895752
Epoch: 3, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.259 Vali Acc: 0.594 Test Loss: 1.259 Test Acc: 0.594
Validation loss decreased (-0.594430 --> -0.594432).  Saving model ...
Epoch: 4 cost time: 0.988724946975708
Epoch: 4, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.011 Vali Acc: 0.667 Test Loss: 1.011 Test Acc: 0.667
Validation loss decreased (-0.594432 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 1.1138732433319092
Epoch: 5, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.819 Vali Acc: 0.733 Test Loss: 0.819 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733325).  Saving model ...
Epoch: 6 cost time: 1.2215945720672607
Epoch: 6, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.694 Vali Acc: 0.694 Test Loss: 0.694 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.212587833404541
Epoch: 7, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.592 Vali Acc: 0.761 Test Loss: 0.592 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761105).  Saving model ...
Epoch: 8 cost time: 1.2278780937194824
Epoch: 8, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.565 Vali Acc: 0.739 Test Loss: 0.565 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2060770988464355
Epoch: 9, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.530 Vali Acc: 0.772 Test Loss: 0.530 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 10 cost time: 1.2191252708435059
Epoch: 10, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.476 Vali Acc: 0.800 Test Loss: 0.476 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 1.4996092319488525
Epoch: 11, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.466 Vali Acc: 0.761 Test Loss: 0.466 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.040517807006836
Epoch: 12, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.406 Vali Acc: 0.800 Test Loss: 0.406 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 1.3638429641723633
Epoch: 13, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.412 Vali Acc: 0.839 Test Loss: 0.412 Test Acc: 0.839
Validation loss decreased (-0.799996 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 1.2642858028411865
Epoch: 14, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.396 Vali Acc: 0.789 Test Loss: 0.396 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3040695190429688
Epoch: 15, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.368 Vali Acc: 0.789 Test Loss: 0.368 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4906678199768066
Epoch: 16, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.391 Vali Acc: 0.806 Test Loss: 0.391 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1949167251586914
Epoch: 17, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.376 Vali Acc: 0.822 Test Loss: 0.376 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.495915412902832
Epoch: 18, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3969388008117676
Epoch: 19, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.379 Vali Acc: 0.811 Test Loss: 0.379 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5052454471588135
Epoch: 20, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.373 Vali Acc: 0.794 Test Loss: 0.373 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6571381092071533
Epoch: 21, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.353874921798706
Epoch: 22, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.428 Vali Acc: 0.772 Test Loss: 0.428 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3511741161346436
Epoch: 23, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.398 Vali Acc: 0.817 Test Loss: 0.398 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 280190
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.847468614578247
Epoch: 1, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.698 Vali Acc: 0.356 Test Loss: 1.698 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 1.170201063156128
Epoch: 2, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.519 Vali Acc: 0.522 Test Loss: 1.519 Test Acc: 0.522
Validation loss decreased (-0.355539 --> -0.522207).  Saving model ...
Epoch: 3 cost time: 0.904038667678833
Epoch: 3, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.314 Vali Acc: 0.578 Test Loss: 1.314 Test Acc: 0.578
Validation loss decreased (-0.522207 --> -0.577765).  Saving model ...
Epoch: 4 cost time: 0.9332528114318848
Epoch: 4, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.068 Vali Acc: 0.694 Test Loss: 1.068 Test Acc: 0.694
Validation loss decreased (-0.577765 --> -0.694434).  Saving model ...
Epoch: 5 cost time: 1.143014907836914
Epoch: 5, Steps: 12 | Train Loss: 0.923 Vali Loss: 0.867 Vali Acc: 0.678 Test Loss: 0.867 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0039880275726318
Epoch: 6, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.709 Vali Acc: 0.711 Test Loss: 0.709 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711104).  Saving model ...
Epoch: 7 cost time: 0.8618402481079102
Epoch: 7, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.696 Vali Acc: 0.733 Test Loss: 0.696 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 1.0550479888916016
Epoch: 8, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.576 Vali Acc: 0.733 Test Loss: 0.576 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733328).  Saving model ...
Epoch: 9 cost time: 1.1541805267333984
Epoch: 9, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.505 Vali Acc: 0.767 Test Loss: 0.505 Test Acc: 0.767
Validation loss decreased (-0.733328 --> -0.766662).  Saving model ...
Epoch: 10 cost time: 0.8612213134765625
Epoch: 10, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.462 Vali Acc: 0.794 Test Loss: 0.462 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 0.9495658874511719
Epoch: 11, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.431 Vali Acc: 0.800 Test Loss: 0.431 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 12 cost time: 0.9373831748962402
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.413 Vali Acc: 0.806 Test Loss: 0.413 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 0.8541314601898193
Epoch: 13, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.382 Vali Acc: 0.794 Test Loss: 0.382 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.026043176651001
Epoch: 14, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822219).  Saving model ...
Epoch: 15 cost time: 1.0786478519439697
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0380427837371826
Epoch: 16, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.372 Vali Acc: 0.806 Test Loss: 0.372 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0698761940002441
Epoch: 17, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.568 Vali Acc: 0.806 Test Loss: 0.568 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2551593780517578
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.431 Vali Acc: 0.800 Test Loss: 0.431 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0302324295043945
Epoch: 19, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.390 Vali Acc: 0.794 Test Loss: 0.390 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.958064079284668
Epoch: 20, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1873230934143066
Epoch: 21, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.454 Vali Acc: 0.794 Test Loss: 0.454 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0060980319976807
Epoch: 22, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.485 Vali Acc: 0.811 Test Loss: 0.485 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.160287857055664
Epoch: 23, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.413 Vali Acc: 0.811 Test Loss: 0.413 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1115283966064453
Epoch: 24, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.480 Vali Acc: 0.789 Test Loss: 0.480 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 280030
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5775387287139893
Epoch: 1, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.768 Vali Acc: 0.200 Test Loss: 1.768 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.0258960723876953
Epoch: 2, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.557 Vali Acc: 0.550 Test Loss: 1.557 Test Acc: 0.550
Validation loss decreased (-0.199982 --> -0.549984).  Saving model ...
Epoch: 3 cost time: 0.9163699150085449
Epoch: 3, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.324 Vali Acc: 0.600 Test Loss: 1.324 Test Acc: 0.600
Validation loss decreased (-0.549984 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 1.038832426071167
Epoch: 4, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.055 Vali Acc: 0.678 Test Loss: 1.055 Test Acc: 0.678
Validation loss decreased (-0.599987 --> -0.677767).  Saving model ...
Epoch: 5 cost time: 0.8587841987609863
Epoch: 5, Steps: 12 | Train Loss: 0.937 Vali Loss: 0.872 Vali Acc: 0.650 Test Loss: 0.872 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0080184936523438
Epoch: 6, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.738 Vali Acc: 0.678 Test Loss: 0.738 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677770).  Saving model ...
Epoch: 7 cost time: 1.0095911026000977
Epoch: 7, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.649 Vali Acc: 0.728 Test Loss: 0.649 Test Acc: 0.728
Validation loss decreased (-0.677770 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 1.0982122421264648
Epoch: 8, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.126401662826538
Epoch: 9, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.517 Vali Acc: 0.806 Test Loss: 0.517 Test Acc: 0.806
Validation loss decreased (-0.749994 --> -0.805550).  Saving model ...
Epoch: 10 cost time: 1.0150775909423828
Epoch: 10, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.460 Vali Acc: 0.794 Test Loss: 0.460 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0539886951446533
Epoch: 11, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.473 Vali Acc: 0.794 Test Loss: 0.473 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9043943881988525
Epoch: 12, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.449 Vali Acc: 0.778 Test Loss: 0.449 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.044006586074829
Epoch: 13, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.422 Vali Acc: 0.817 Test Loss: 0.422 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816662).  Saving model ...
Epoch: 14 cost time: 1.0114097595214844
Epoch: 14, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.404 Vali Acc: 0.800 Test Loss: 0.404 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0175433158874512
Epoch: 15, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 0.9689435958862305
Epoch: 16, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.388 Vali Acc: 0.783 Test Loss: 0.388 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9831459522247314
Epoch: 17, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.383 Vali Acc: 0.822 Test Loss: 0.383 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0462696552276611
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.451 Vali Acc: 0.800 Test Loss: 0.451 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0458002090454102
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.513 Vali Acc: 0.794 Test Loss: 0.513 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2187047004699707
Epoch: 20, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2913334369659424
Epoch: 21, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.384 Vali Acc: 0.783 Test Loss: 0.384 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9863419532775879
Epoch: 22, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.402 Vali Acc: 0.800 Test Loss: 0.402 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1954374313354492
Epoch: 23, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.412 Vali Acc: 0.817 Test Loss: 0.412 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1387302875518799
Epoch: 24, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.426 Vali Acc: 0.833 Test Loss: 0.426 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0590167045593262
Epoch: 25, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.450 Vali Acc: 0.778 Test Loss: 0.450 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 279870
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.867154836654663
Epoch: 1, Steps: 12 | Train Loss: 1.966 Vali Loss: 1.738 Vali Acc: 0.233 Test Loss: 1.738 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.0647532939910889
Epoch: 2, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.570 Vali Acc: 0.428 Test Loss: 1.570 Test Acc: 0.428
Validation loss decreased (-0.233316 --> -0.427762).  Saving model ...
Epoch: 3 cost time: 0.8771214485168457
Epoch: 3, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.336 Vali Acc: 0.589 Test Loss: 1.336 Test Acc: 0.589
Validation loss decreased (-0.427762 --> -0.588876).  Saving model ...
Epoch: 4 cost time: 1.0893347263336182
Epoch: 4, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.095 Vali Acc: 0.639 Test Loss: 1.095 Test Acc: 0.639
Validation loss decreased (-0.588876 --> -0.638878).  Saving model ...
Epoch: 5 cost time: 1.1574430465698242
Epoch: 5, Steps: 12 | Train Loss: 0.997 Vali Loss: 0.914 Vali Acc: 0.678 Test Loss: 0.914 Test Acc: 0.678
Validation loss decreased (-0.638878 --> -0.677769).  Saving model ...
Epoch: 6 cost time: 1.0389759540557861
Epoch: 6, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.806 Vali Acc: 0.617 Test Loss: 0.806 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0831587314605713
Epoch: 7, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.658 Vali Acc: 0.700 Test Loss: 0.658 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699993).  Saving model ...
Epoch: 8 cost time: 1.1122915744781494
Epoch: 8, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.621 Vali Acc: 0.767 Test Loss: 0.621 Test Acc: 0.767
Validation loss decreased (-0.699993 --> -0.766660).  Saving model ...
Epoch: 9 cost time: 0.8324799537658691
Epoch: 9, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.593 Vali Acc: 0.744 Test Loss: 0.593 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0295295715332031
Epoch: 10, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.530 Vali Acc: 0.744 Test Loss: 0.530 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.000412940979004
Epoch: 11, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.483 Vali Acc: 0.767 Test Loss: 0.483 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766662).  Saving model ...
Epoch: 12 cost time: 1.1942358016967773
Epoch: 12, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.419 Vali Acc: 0.789 Test Loss: 0.419 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 13 cost time: 1.3123493194580078
Epoch: 13, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.401 Vali Acc: 0.828 Test Loss: 0.401 Test Acc: 0.828
Validation loss decreased (-0.788885 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.1359295845031738
Epoch: 14, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.379 Vali Acc: 0.828 Test Loss: 0.379 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 15 cost time: 0.9263801574707031
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.371 Vali Acc: 0.811 Test Loss: 0.371 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.962151050567627
Epoch: 16, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.395 Vali Acc: 0.789 Test Loss: 0.395 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3640501499176025
Epoch: 17, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.506 Vali Acc: 0.794 Test Loss: 0.506 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0614213943481445
Epoch: 18, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.360 Vali Acc: 0.839 Test Loss: 0.360 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 1.130760908126831
Epoch: 19, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.219463586807251
Epoch: 20, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 21 cost time: 1.0306851863861084
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.363 Vali Acc: 0.806 Test Loss: 0.363 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0117456912994385
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.384 Vali Acc: 0.822 Test Loss: 0.384 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9970464706420898
Epoch: 23, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0642457008361816
Epoch: 24, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.127488613128662
Epoch: 25, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.408 Vali Acc: 0.778 Test Loss: 0.408 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0587713718414307
Epoch: 26, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.428 Vali Acc: 0.828 Test Loss: 0.428 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2361290454864502
Epoch: 27, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9883124828338623
Epoch: 28, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.481 Vali Acc: 0.767 Test Loss: 0.481 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1052613258361816
Epoch: 29, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.441 Vali Acc: 0.839 Test Loss: 0.441 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2968862056732178
Epoch: 30, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.470 Vali Acc: 0.828 Test Loss: 0.470 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 180510
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.185357093811035
Epoch: 1, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.695 Vali Acc: 0.317 Test Loss: 1.695 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 1.3479466438293457
Epoch: 2, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.525 Vali Acc: 0.533 Test Loss: 1.525 Test Acc: 0.533
Validation loss decreased (-0.316650 --> -0.533318).  Saving model ...
Epoch: 3 cost time: 1.251333475112915
Epoch: 3, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.285 Vali Acc: 0.633 Test Loss: 1.285 Test Acc: 0.633
Validation loss decreased (-0.533318 --> -0.633320).  Saving model ...
Epoch: 4 cost time: 0.9335379600524902
Epoch: 4, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.077 Vali Acc: 0.739 Test Loss: 1.077 Test Acc: 0.739
Validation loss decreased (-0.633320 --> -0.738878).  Saving model ...
Epoch: 5 cost time: 1.1192858219146729
Epoch: 5, Steps: 12 | Train Loss: 1.031 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1377363204956055
Epoch: 6, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.758 Vali Acc: 0.711 Test Loss: 0.758 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4411311149597168
Epoch: 7, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.694 Vali Acc: 0.706 Test Loss: 0.694 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.212266206741333
Epoch: 8, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.585 Vali Acc: 0.778 Test Loss: 0.585 Test Acc: 0.778
Validation loss decreased (-0.738878 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 1.2156734466552734
Epoch: 9, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.532 Vali Acc: 0.767 Test Loss: 0.532 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.018735408782959
Epoch: 10, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.484 Vali Acc: 0.761 Test Loss: 0.484 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.219358205795288
Epoch: 11, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.462 Vali Acc: 0.800 Test Loss: 0.462 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 1.1211094856262207
Epoch: 12, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.420 Vali Acc: 0.800 Test Loss: 0.420 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 0.998558521270752
Epoch: 13, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.424 Vali Acc: 0.828 Test Loss: 0.424 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.001758337020874
Epoch: 14, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.422 Vali Acc: 0.794 Test Loss: 0.422 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1484720706939697
Epoch: 15, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.398 Vali Acc: 0.817 Test Loss: 0.398 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2760343551635742
Epoch: 16, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 1.2739639282226562
Epoch: 17, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.451 Vali Acc: 0.800 Test Loss: 0.451 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2122409343719482
Epoch: 18, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 1.0570259094238281
Epoch: 19, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.338 Vali Acc: 0.822 Test Loss: 0.338 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1271493434906006
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.355 Vali Acc: 0.856 Test Loss: 0.355 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 1.0295183658599854
Epoch: 21, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.342 Vali Acc: 0.822 Test Loss: 0.342 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1914174556732178
Epoch: 22, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.397 Vali Acc: 0.839 Test Loss: 0.397 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.239954948425293
Epoch: 23, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2702407836914062
Epoch: 24, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.372 Vali Acc: 0.817 Test Loss: 0.372 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.205963373184204
Epoch: 25, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.401 Vali Acc: 0.828 Test Loss: 0.401 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1911144256591797
Epoch: 26, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.391 Vali Acc: 0.817 Test Loss: 0.391 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2400777339935303
Epoch: 27, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.409 Vali Acc: 0.839 Test Loss: 0.409 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0832500457763672
Epoch: 28, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.176668643951416
Epoch: 29, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0148489475250244
Epoch: 30, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.422 Vali Acc: 0.817 Test Loss: 0.422 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 180350
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.019362688064575
Epoch: 1, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.722 Vali Acc: 0.228 Test Loss: 1.722 Test Acc: 0.228
Validation loss decreased (inf --> -0.227761).  Saving model ...
Epoch: 2 cost time: 1.4072151184082031
Epoch: 2, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.548 Vali Acc: 0.528 Test Loss: 1.548 Test Acc: 0.528
Validation loss decreased (-0.227761 --> -0.527762).  Saving model ...
Epoch: 3 cost time: 1.0622704029083252
Epoch: 3, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.336 Vali Acc: 0.606 Test Loss: 1.336 Test Acc: 0.606
Validation loss decreased (-0.527762 --> -0.605542).  Saving model ...
Epoch: 4 cost time: 1.209179162979126
Epoch: 4, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.128 Vali Acc: 0.667 Test Loss: 1.128 Test Acc: 0.667
Validation loss decreased (-0.605542 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 1.0642364025115967
Epoch: 5, Steps: 12 | Train Loss: 1.020 Vali Loss: 0.936 Vali Acc: 0.672 Test Loss: 0.936 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672213).  Saving model ...
Epoch: 6 cost time: 1.1635019779205322
Epoch: 6, Steps: 12 | Train Loss: 0.867 Vali Loss: 0.796 Vali Acc: 0.683 Test Loss: 0.796 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683325).  Saving model ...
Epoch: 7 cost time: 0.9165141582489014
Epoch: 7, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.691 Vali Acc: 0.744 Test Loss: 0.691 Test Acc: 0.744
Validation loss decreased (-0.683325 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 0.8795430660247803
Epoch: 8, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.609 Vali Acc: 0.733 Test Loss: 0.609 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9524612426757812
Epoch: 9, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.548 Vali Acc: 0.761 Test Loss: 0.548 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761106).  Saving model ...
Epoch: 10 cost time: 1.0041999816894531
Epoch: 10, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.514 Vali Acc: 0.750 Test Loss: 0.514 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9237871170043945
Epoch: 11, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.478 Vali Acc: 0.783 Test Loss: 0.478 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 12 cost time: 1.0371649265289307
Epoch: 12, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.427 Vali Acc: 0.839 Test Loss: 0.427 Test Acc: 0.839
Validation loss decreased (-0.783329 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 1.2121374607086182
Epoch: 13, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.412 Vali Acc: 0.800 Test Loss: 0.412 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0261595249176025
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.464 Vali Acc: 0.800 Test Loss: 0.464 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.945610761642456
Epoch: 15, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.472 Vali Acc: 0.806 Test Loss: 0.472 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8347218036651611
Epoch: 16, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.373 Vali Acc: 0.839 Test Loss: 0.373 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 0.992809534072876
Epoch: 17, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8724613189697266
Epoch: 18, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9315187931060791
Epoch: 19, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.370 Vali Acc: 0.839 Test Loss: 0.370 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 1.0096728801727295
Epoch: 20, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.372 Vali Acc: 0.817 Test Loss: 0.372 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9610452651977539
Epoch: 21, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.404 Vali Acc: 0.828 Test Loss: 0.404 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9177713394165039
Epoch: 22, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.423 Vali Acc: 0.794 Test Loss: 0.423 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9601731300354004
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.367 Vali Acc: 0.844 Test Loss: 0.367 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 24 cost time: 0.8372209072113037
Epoch: 24, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.401 Vali Acc: 0.828 Test Loss: 0.401 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2018721103668213
Epoch: 25, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.437 Vali Acc: 0.778 Test Loss: 0.437 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.136540174484253
Epoch: 26, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.421 Vali Acc: 0.806 Test Loss: 0.421 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.982914924621582
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.413 Vali Acc: 0.783 Test Loss: 0.413 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0226621627807617
Epoch: 28, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.399 Vali Acc: 0.828 Test Loss: 0.399 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2307133674621582
Epoch: 29, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1425771713256836
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9706568717956543
Epoch: 31, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0424151420593262
Epoch: 32, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.458 Vali Acc: 0.822 Test Loss: 0.458 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.161482572555542
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.467 Vali Acc: 0.822 Test Loss: 0.467 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 180190
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5332512855529785
Epoch: 1, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.743 Vali Acc: 0.233 Test Loss: 1.743 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.1024539470672607
Epoch: 2, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.562 Vali Acc: 0.439 Test Loss: 1.562 Test Acc: 0.439
Validation loss decreased (-0.233316 --> -0.438873).  Saving model ...
Epoch: 3 cost time: 0.7769360542297363
Epoch: 3, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.317 Vali Acc: 0.633 Test Loss: 1.317 Test Acc: 0.633
Validation loss decreased (-0.438873 --> -0.633320).  Saving model ...
Epoch: 4 cost time: 0.8985207080841064
Epoch: 4, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.108 Vali Acc: 0.650 Test Loss: 1.108 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 1.0561034679412842
Epoch: 5, Steps: 12 | Train Loss: 1.019 Vali Loss: 0.927 Vali Acc: 0.706 Test Loss: 0.927 Test Acc: 0.706
Validation loss decreased (-0.649989 --> -0.705546).  Saving model ...
Epoch: 6 cost time: 0.9071316719055176
Epoch: 6, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 1.055466890335083
Epoch: 7, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.665 Vali Acc: 0.689 Test Loss: 0.665 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8586342334747314
Epoch: 8, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.594 Vali Acc: 0.728 Test Loss: 0.594 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727772).  Saving model ...
Epoch: 9 cost time: 0.8572390079498291
Epoch: 9, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.578 Vali Acc: 0.756 Test Loss: 0.578 Test Acc: 0.756
Validation loss decreased (-0.727772 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 0.9180679321289062
Epoch: 10, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.530 Vali Acc: 0.761 Test Loss: 0.530 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 1.1099302768707275
Epoch: 11, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.484 Vali Acc: 0.783 Test Loss: 0.484 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783328).  Saving model ...
Epoch: 12 cost time: 1.1416246891021729
Epoch: 12, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.442 Vali Acc: 0.783 Test Loss: 0.442 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 13 cost time: 0.9186193943023682
Epoch: 13, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.417 Vali Acc: 0.817 Test Loss: 0.417 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816662).  Saving model ...
Epoch: 14 cost time: 1.2045392990112305
Epoch: 14, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.407 Vali Acc: 0.794 Test Loss: 0.407 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9647953510284424
Epoch: 15, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.462 Vali Acc: 0.800 Test Loss: 0.462 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9226574897766113
Epoch: 16, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.402 Vali Acc: 0.789 Test Loss: 0.402 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8300626277923584
Epoch: 17, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.413 Vali Acc: 0.800 Test Loss: 0.413 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0592694282531738
Epoch: 18, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.430 Vali Acc: 0.811 Test Loss: 0.430 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8387711048126221
Epoch: 19, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 20 cost time: 1.0009660720825195
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.382 Vali Acc: 0.806 Test Loss: 0.382 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9858560562133789
Epoch: 21, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.384 Vali Acc: 0.811 Test Loss: 0.384 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8309671878814697
Epoch: 22, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.407 Vali Acc: 0.806 Test Loss: 0.407 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9032773971557617
Epoch: 23, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9774925708770752
Epoch: 24, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.408 Vali Acc: 0.811 Test Loss: 0.408 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9168779850006104
Epoch: 25, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.434 Vali Acc: 0.778 Test Loss: 0.434 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8880965709686279
Epoch: 26, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.411 Vali Acc: 0.783 Test Loss: 0.411 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8384411334991455
Epoch: 27, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8551886081695557
Epoch: 28, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.477 Vali Acc: 0.794 Test Loss: 0.477 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.109501600265503
Epoch: 29, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.430 Vali Acc: 0.806 Test Loss: 0.430 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 180030
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.833839178085327
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.736 Vali Acc: 0.239 Test Loss: 1.736 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 1.0950562953948975
Epoch: 2, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.581 Vali Acc: 0.417 Test Loss: 1.581 Test Acc: 0.417
Validation loss decreased (-0.238872 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 1.2506616115570068
Epoch: 3, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.372 Vali Acc: 0.589 Test Loss: 1.372 Test Acc: 0.589
Validation loss decreased (-0.416651 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 1.4009926319122314
Epoch: 4, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.170 Vali Acc: 0.617 Test Loss: 1.170 Test Acc: 0.617
Validation loss decreased (-0.588875 --> -0.616655).  Saving model ...
Epoch: 5 cost time: 1.3384604454040527
Epoch: 5, Steps: 12 | Train Loss: 1.155 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
Validation loss decreased (-0.616655 --> -0.738879).  Saving model ...
Epoch: 6 cost time: 1.2962148189544678
Epoch: 6, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.820 Vali Acc: 0.733 Test Loss: 0.820 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0573029518127441
Epoch: 7, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.731 Vali Acc: 0.694 Test Loss: 0.731 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1609272956848145
Epoch: 8, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.649 Vali Acc: 0.756 Test Loss: 0.649 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.4236912727355957
Epoch: 9, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.582 Vali Acc: 0.739 Test Loss: 0.582 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4519546031951904
Epoch: 10, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 1.19553542137146
Epoch: 11, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.538 Vali Acc: 0.728 Test Loss: 0.538 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.513087272644043
Epoch: 12, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.476 Vali Acc: 0.772 Test Loss: 0.476 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1872167587280273
Epoch: 13, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.523 Vali Acc: 0.794 Test Loss: 0.523 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794439).  Saving model ...
Epoch: 14 cost time: 1.0152478218078613
Epoch: 14, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.452 Vali Acc: 0.772 Test Loss: 0.452 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0208733081817627
Epoch: 15, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.514 Vali Acc: 0.778 Test Loss: 0.514 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9957113265991211
Epoch: 16, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.395 Vali Acc: 0.844 Test Loss: 0.395 Test Acc: 0.844
Validation loss decreased (-0.794439 --> -0.844440).  Saving model ...
Epoch: 17 cost time: 1.0636119842529297
Epoch: 17, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.371 Vali Acc: 0.839 Test Loss: 0.371 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0233209133148193
Epoch: 18, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.418 Vali Acc: 0.817 Test Loss: 0.418 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2482116222381592
Epoch: 19, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3277819156646729
Epoch: 20, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0961782932281494
Epoch: 21, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.371 Vali Acc: 0.800 Test Loss: 0.371 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9884629249572754
Epoch: 22, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.350 Vali Acc: 0.811 Test Loss: 0.350 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.164726972579956
Epoch: 23, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.383 Vali Acc: 0.856 Test Loss: 0.383 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 1.2302098274230957
Epoch: 24, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.356 Vali Acc: 0.817 Test Loss: 0.356 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3764381408691406
Epoch: 25, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0790131092071533
Epoch: 26, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.378 Vali Acc: 0.822 Test Loss: 0.378 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1303763389587402
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1005394458770752
Epoch: 28, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.400 Vali Acc: 0.844 Test Loss: 0.400 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1744093894958496
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.473 Vali Acc: 0.783 Test Loss: 0.473 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1935737133026123
Epoch: 30, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.296452522277832
Epoch: 31, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.418 Vali Acc: 0.844 Test Loss: 0.418 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4194788932800293
Epoch: 32, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.395 Vali Acc: 0.833 Test Loss: 0.395 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1978669166564941
Epoch: 33, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.408 Vali Acc: 0.844 Test Loss: 0.408 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 130590
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5838255882263184
Epoch: 1, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.716 Vali Acc: 0.228 Test Loss: 1.716 Test Acc: 0.228
Validation loss decreased (inf --> -0.227761).  Saving model ...
Epoch: 2 cost time: 1.3308055400848389
Epoch: 2, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.533 Vali Acc: 0.444 Test Loss: 1.533 Test Acc: 0.444
Validation loss decreased (-0.227761 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 1.0875749588012695
Epoch: 3, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.307 Vali Acc: 0.606 Test Loss: 1.307 Test Acc: 0.606
Validation loss decreased (-0.444429 --> -0.605542).  Saving model ...
Epoch: 4 cost time: 0.9994292259216309
Epoch: 4, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.106 Vali Acc: 0.639 Test Loss: 1.106 Test Acc: 0.639
Validation loss decreased (-0.605542 --> -0.638878).  Saving model ...
Epoch: 5 cost time: 1.0483312606811523
Epoch: 5, Steps: 12 | Train Loss: 1.039 Vali Loss: 0.926 Vali Acc: 0.644 Test Loss: 0.926 Test Acc: 0.644
Validation loss decreased (-0.638878 --> -0.644435).  Saving model ...
Epoch: 6 cost time: 1.0688965320587158
Epoch: 6, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.796 Vali Acc: 0.700 Test Loss: 0.796 Test Acc: 0.700
Validation loss decreased (-0.644435 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 1.1049227714538574
Epoch: 7, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.714 Vali Acc: 0.672 Test Loss: 0.714 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1313066482543945
Epoch: 8, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.639 Vali Acc: 0.700 Test Loss: 0.639 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699994).  Saving model ...
Epoch: 9 cost time: 1.344332218170166
Epoch: 9, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.614 Vali Acc: 0.717 Test Loss: 0.614 Test Acc: 0.717
Validation loss decreased (-0.699994 --> -0.716661).  Saving model ...
Epoch: 10 cost time: 1.288301944732666
Epoch: 10, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
Validation loss decreased (-0.716661 --> -0.716661).  Saving model ...
Epoch: 11 cost time: 1.0921123027801514
Epoch: 11, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.540 Vali Acc: 0.750 Test Loss: 0.540 Test Acc: 0.750
Validation loss decreased (-0.716661 --> -0.749995).  Saving model ...
Epoch: 12 cost time: 1.164381504058838
Epoch: 12, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.447 Vali Acc: 0.772 Test Loss: 0.447 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772218).  Saving model ...
Epoch: 13 cost time: 1.3043251037597656
Epoch: 13, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.451 Vali Acc: 0.806 Test Loss: 0.451 Test Acc: 0.806
Validation loss decreased (-0.772218 --> -0.805551).  Saving model ...
Epoch: 14 cost time: 1.3226346969604492
Epoch: 14, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.427 Vali Acc: 0.794 Test Loss: 0.427 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.166506052017212
Epoch: 15, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.403 Vali Acc: 0.783 Test Loss: 0.403 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2437329292297363
Epoch: 16, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.393 Vali Acc: 0.822 Test Loss: 0.393 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 17 cost time: 1.0952751636505127
Epoch: 17, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.389 Vali Acc: 0.817 Test Loss: 0.389 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2952601909637451
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.376 Vali Acc: 0.822 Test Loss: 0.376 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 19 cost time: 1.2535710334777832
Epoch: 19, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.184730052947998
Epoch: 20, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 21 cost time: 1.1752753257751465
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 1.0863409042358398
Epoch: 22, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.379 Vali Acc: 0.817 Test Loss: 0.379 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2252917289733887
Epoch: 23, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2219047546386719
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.375 Vali Acc: 0.794 Test Loss: 0.375 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0747325420379639
Epoch: 25, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3272325992584229
Epoch: 26, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.188485860824585
Epoch: 27, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.398 Vali Acc: 0.817 Test Loss: 0.398 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0351769924163818
Epoch: 28, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0208241939544678
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.381 Vali Acc: 0.828 Test Loss: 0.381 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0327703952789307
Epoch: 30, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844440).  Saving model ...
Epoch: 31 cost time: 1.1326847076416016
Epoch: 31, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.534 Vali Acc: 0.778 Test Loss: 0.534 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.28255295753479
Epoch: 32, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.422 Vali Acc: 0.817 Test Loss: 0.422 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2757148742675781
Epoch: 33, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4169440269470215
Epoch: 34, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.242091417312622
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.438 Vali Acc: 0.817 Test Loss: 0.438 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0659759044647217
Epoch: 36, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 37 cost time: 0.9628312587738037
Epoch: 37, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.469 Vali Acc: 0.806 Test Loss: 0.469 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.18975830078125
Epoch: 38, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.464 Vali Acc: 0.811 Test Loss: 0.464 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0813114643096924
Epoch: 39, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849995).  Saving model ...
Epoch: 40 cost time: 1.3117060661315918
Epoch: 40, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.490 Vali Acc: 0.828 Test Loss: 0.490 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.263091802597046
Epoch: 41, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.526 Vali Acc: 0.800 Test Loss: 0.526 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2520880699157715
Epoch: 42, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.470 Vali Acc: 0.817 Test Loss: 0.470 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.292961597442627
Epoch: 43, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.235065221786499
Epoch: 44, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.496 Vali Acc: 0.811 Test Loss: 0.496 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2401683330535889
Epoch: 45, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.505 Vali Acc: 0.817 Test Loss: 0.505 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3450090885162354
Epoch: 46, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.553 Vali Acc: 0.839 Test Loss: 0.553 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1123909950256348
Epoch: 47, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1279850006103516
Epoch: 48, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.1815943717956543
Epoch: 49, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.566 Vali Acc: 0.817 Test Loss: 0.566 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 130430
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.747443437576294
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.724 Vali Acc: 0.317 Test Loss: 1.724 Test Acc: 0.317
Validation loss decreased (inf --> -0.316649).  Saving model ...
Epoch: 2 cost time: 0.8993489742279053
Epoch: 2, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.537 Vali Acc: 0.544 Test Loss: 1.537 Test Acc: 0.544
Validation loss decreased (-0.316649 --> -0.544429).  Saving model ...
Epoch: 3 cost time: 1.1071076393127441
Epoch: 3, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.326 Vali Acc: 0.589 Test Loss: 1.326 Test Acc: 0.589
Validation loss decreased (-0.544429 --> -0.588876).  Saving model ...
Epoch: 4 cost time: 1.1230103969573975
Epoch: 4, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.103 Vali Acc: 0.633 Test Loss: 1.103 Test Acc: 0.633
Validation loss decreased (-0.588876 --> -0.633322).  Saving model ...
Epoch: 5 cost time: 1.2003250122070312
Epoch: 5, Steps: 12 | Train Loss: 1.019 Vali Loss: 0.927 Vali Acc: 0.683 Test Loss: 0.927 Test Acc: 0.683
Validation loss decreased (-0.633322 --> -0.683324).  Saving model ...
Epoch: 6 cost time: 1.0942871570587158
Epoch: 6, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.771 Vali Acc: 0.739 Test Loss: 0.771 Test Acc: 0.739
Validation loss decreased (-0.683324 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 0.937382698059082
Epoch: 7, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 0.9807147979736328
Epoch: 8, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.624 Vali Acc: 0.728 Test Loss: 0.624 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8875918388366699
Epoch: 9, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.544 Vali Acc: 0.733 Test Loss: 0.544 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9906957149505615
Epoch: 10, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.525 Vali Acc: 0.772 Test Loss: 0.525 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 0.9596576690673828
Epoch: 11, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.514 Vali Acc: 0.756 Test Loss: 0.514 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0526676177978516
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.448 Vali Acc: 0.800 Test Loss: 0.448 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 0.9683113098144531
Epoch: 13, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 1.104099988937378
Epoch: 14, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.068406343460083
Epoch: 15, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.419 Vali Acc: 0.800 Test Loss: 0.419 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9952313899993896
Epoch: 16, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.416 Vali Acc: 0.783 Test Loss: 0.416 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9501199722290039
Epoch: 17, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.385 Vali Acc: 0.817 Test Loss: 0.385 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0918312072753906
Epoch: 18, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.386 Vali Acc: 0.856 Test Loss: 0.386 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 1.2260119915008545
Epoch: 19, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.372 Vali Acc: 0.794 Test Loss: 0.372 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0379154682159424
Epoch: 20, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.406 Vali Acc: 0.811 Test Loss: 0.406 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1713387966156006
Epoch: 21, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.360 Vali Acc: 0.811 Test Loss: 0.360 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9293022155761719
Epoch: 22, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.372 Vali Acc: 0.822 Test Loss: 0.372 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2695188522338867
Epoch: 23, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0539960861206055
Epoch: 24, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1715223789215088
Epoch: 25, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.388 Vali Acc: 0.844 Test Loss: 0.388 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1151692867279053
Epoch: 26, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.022934913635254
Epoch: 27, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0062882900238037
Epoch: 28, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 130270
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.367180585861206
Epoch: 1, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.707 Vali Acc: 0.339 Test Loss: 1.707 Test Acc: 0.339
Validation loss decreased (inf --> -0.338872).  Saving model ...
Epoch: 2 cost time: 0.9251842498779297
Epoch: 2, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.537 Vali Acc: 0.456 Test Loss: 1.537 Test Acc: 0.456
Validation loss decreased (-0.338872 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 0.929990291595459
Epoch: 3, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.324 Vali Acc: 0.578 Test Loss: 1.324 Test Acc: 0.578
Validation loss decreased (-0.455540 --> -0.577765).  Saving model ...
Epoch: 4 cost time: 0.8941981792449951
Epoch: 4, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.111 Vali Acc: 0.644 Test Loss: 1.111 Test Acc: 0.644
Validation loss decreased (-0.577765 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 0.8678290843963623
Epoch: 5, Steps: 12 | Train Loss: 1.036 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
Validation loss decreased (-0.644433 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.9300665855407715
Epoch: 6, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8461871147155762
Epoch: 7, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.671 Vali Acc: 0.767 Test Loss: 0.671 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766660).  Saving model ...
Epoch: 8 cost time: 1.012834072113037
Epoch: 8, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.613 Vali Acc: 0.733 Test Loss: 0.613 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8660101890563965
Epoch: 9, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.531 Vali Acc: 0.761 Test Loss: 0.531 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8406176567077637
Epoch: 10, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.510 Vali Acc: 0.772 Test Loss: 0.510 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 1.0991606712341309
Epoch: 11, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.466 Vali Acc: 0.772 Test Loss: 0.466 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772218).  Saving model ...
Epoch: 12 cost time: 0.9226555824279785
Epoch: 12, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.506 Vali Acc: 0.761 Test Loss: 0.506 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9443063735961914
Epoch: 13, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.431 Vali Acc: 0.789 Test Loss: 0.431 Test Acc: 0.789
Validation loss decreased (-0.772218 --> -0.788885).  Saving model ...
Epoch: 14 cost time: 0.8671329021453857
Epoch: 14, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.414 Vali Acc: 0.811 Test Loss: 0.414 Test Acc: 0.811
Validation loss decreased (-0.788885 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 0.8451361656188965
Epoch: 15, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 0.9322266578674316
Epoch: 16, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.388 Vali Acc: 0.789 Test Loss: 0.388 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9717512130737305
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.383 Vali Acc: 0.828 Test Loss: 0.383 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2822504043579102
Epoch: 18, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.367 Vali Acc: 0.794 Test Loss: 0.367 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.175203561782837
Epoch: 19, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.420 Vali Acc: 0.806 Test Loss: 0.420 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0288197994232178
Epoch: 20, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.363 Vali Acc: 0.817 Test Loss: 0.363 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9572720527648926
Epoch: 21, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.359 Vali Acc: 0.833 Test Loss: 0.359 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 0.8450379371643066
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.412 Vali Acc: 0.794 Test Loss: 0.412 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9512794017791748
Epoch: 23, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.370 Vali Acc: 0.839 Test Loss: 0.370 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 24 cost time: 0.9523873329162598
Epoch: 24, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.441 Vali Acc: 0.833 Test Loss: 0.441 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1240017414093018
Epoch: 25, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.438 Vali Acc: 0.806 Test Loss: 0.438 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2445402145385742
Epoch: 26, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.368 Vali Acc: 0.828 Test Loss: 0.368 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0284178256988525
Epoch: 27, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.469 Vali Acc: 0.828 Test Loss: 0.469 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2712242603302002
Epoch: 28, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.424 Vali Acc: 0.789 Test Loss: 0.424 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0736291408538818
Epoch: 29, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.398 Vali Acc: 0.817 Test Loss: 0.398 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0510056018829346
Epoch: 30, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844440).  Saving model ...
Epoch: 31 cost time: 0.9927561283111572
Epoch: 31, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.371 Vali Acc: 0.817 Test Loss: 0.371 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0263433456420898
Epoch: 32, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9945802688598633
Epoch: 33, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 34 cost time: 0.9435584545135498
Epoch: 34, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.437 Vali Acc: 0.856 Test Loss: 0.437 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 35 cost time: 1.3161730766296387
Epoch: 35, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.430 Vali Acc: 0.811 Test Loss: 0.430 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.263944149017334
Epoch: 36, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.477280855178833
Epoch: 37, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2268824577331543
Epoch: 38, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.422 Vali Acc: 0.839 Test Loss: 0.422 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2168540954589844
Epoch: 39, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.463 Vali Acc: 0.822 Test Loss: 0.463 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1204097270965576
Epoch: 40, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.466 Vali Acc: 0.839 Test Loss: 0.466 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3060641288757324
Epoch: 41, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.469 Vali Acc: 0.828 Test Loss: 0.469 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3246266841888428
Epoch: 42, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.3926992416381836
Epoch: 43, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2513830661773682
Epoch: 44, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 130110
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.82123064994812
Epoch: 1, Steps: 12 | Train Loss: 1.909 Vali Loss: 1.748 Vali Acc: 0.283 Test Loss: 1.748 Test Acc: 0.283
Validation loss decreased (inf --> -0.283316).  Saving model ...
Epoch: 2 cost time: 1.0151960849761963
Epoch: 2, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.569 Vali Acc: 0.483 Test Loss: 1.569 Test Acc: 0.483
Validation loss decreased (-0.283316 --> -0.483318).  Saving model ...
Epoch: 3 cost time: 1.081153154373169
Epoch: 3, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.346 Vali Acc: 0.611 Test Loss: 1.346 Test Acc: 0.611
Validation loss decreased (-0.483318 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 0.996889591217041
Epoch: 4, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.141 Vali Acc: 0.656 Test Loss: 1.141 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 1.005354881286621
Epoch: 5, Steps: 12 | Train Loss: 1.068 Vali Loss: 0.962 Vali Acc: 0.667 Test Loss: 0.962 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 0.8491649627685547
Epoch: 6, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.825 Vali Acc: 0.661 Test Loss: 0.825 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9442241191864014
Epoch: 7, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.731 Vali Acc: 0.722 Test Loss: 0.731 Test Acc: 0.722
Validation loss decreased (-0.666657 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 1.0022776126861572
Epoch: 8, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.630 Vali Acc: 0.767 Test Loss: 0.630 Test Acc: 0.767
Validation loss decreased (-0.722215 --> -0.766660).  Saving model ...
Epoch: 9 cost time: 1.1373615264892578
Epoch: 9, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0137767791748047
Epoch: 10, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.625 Vali Acc: 0.728 Test Loss: 0.625 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.238374948501587
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.511 Vali Acc: 0.756 Test Loss: 0.511 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2675104141235352
Epoch: 12, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.481 Vali Acc: 0.806 Test Loss: 0.481 Test Acc: 0.806
Validation loss decreased (-0.766660 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 1.2004024982452393
Epoch: 13, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.468 Vali Acc: 0.772 Test Loss: 0.468 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9032514095306396
Epoch: 14, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.595 Vali Acc: 0.756 Test Loss: 0.595 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8852763175964355
Epoch: 15, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.528 Vali Acc: 0.778 Test Loss: 0.528 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9340395927429199
Epoch: 16, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.450 Vali Acc: 0.772 Test Loss: 0.450 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9370331764221191
Epoch: 17, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.459 Vali Acc: 0.778 Test Loss: 0.459 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0286359786987305
Epoch: 18, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.428 Vali Acc: 0.822 Test Loss: 0.428 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 19 cost time: 1.0312278270721436
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 20 cost time: 1.10648512840271
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.386 Vali Acc: 0.800 Test Loss: 0.386 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2937285900115967
Epoch: 21, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0185096263885498
Epoch: 22, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9221482276916504
Epoch: 23, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9239304065704346
Epoch: 24, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.424 Vali Acc: 0.794 Test Loss: 0.424 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9486374855041504
Epoch: 25, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9643025398254395
Epoch: 26, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8218934535980225
Epoch: 27, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.418 Vali Acc: 0.800 Test Loss: 0.418 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1348857879638672
Epoch: 28, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.367 Vali Acc: 0.844 Test Loss: 0.367 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 29 cost time: 1.3647186756134033
Epoch: 29, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.407 Vali Acc: 0.828 Test Loss: 0.407 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8640272617340088
Epoch: 30, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.468 Vali Acc: 0.794 Test Loss: 0.468 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1051199436187744
Epoch: 31, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.005242109298706
Epoch: 32, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0538201332092285
Epoch: 33, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8561117649078369
Epoch: 34, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.348 Vali Acc: 0.856 Test Loss: 0.348 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 35 cost time: 1.0075080394744873
Epoch: 35, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.386 Vali Acc: 0.817 Test Loss: 0.386 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.075235366821289
Epoch: 36, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9530112743377686
Epoch: 37, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.367 Vali Acc: 0.839 Test Loss: 0.367 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9164068698883057
Epoch: 38, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9782490730285645
Epoch: 39, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8832895755767822
Epoch: 40, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8805921077728271
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.396 Vali Acc: 0.844 Test Loss: 0.396 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9228332042694092
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.380 Vali Acc: 0.844 Test Loss: 0.380 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7909975051879883
Epoch: 43, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.410 Vali Acc: 0.844 Test Loss: 0.410 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9922380447387695
Epoch: 44, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 105630
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0537800788879395
Epoch: 1, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.755 Vali Acc: 0.144 Test Loss: 1.755 Test Acc: 0.144
Validation loss decreased (inf --> -0.144427).  Saving model ...
Epoch: 2 cost time: 0.8862934112548828
Epoch: 2, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.587 Vali Acc: 0.444 Test Loss: 1.587 Test Acc: 0.444
Validation loss decreased (-0.144427 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 0.9428143501281738
Epoch: 3, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.369 Vali Acc: 0.656 Test Loss: 1.369 Test Acc: 0.656
Validation loss decreased (-0.444429 --> -0.655542).  Saving model ...
Epoch: 4 cost time: 1.1515119075775146
Epoch: 4, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.191 Vali Acc: 0.639 Test Loss: 1.191 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9937684535980225
Epoch: 5, Steps: 12 | Train Loss: 1.091 Vali Loss: 0.979 Vali Acc: 0.728 Test Loss: 0.979 Test Acc: 0.728
Validation loss decreased (-0.655542 --> -0.727768).  Saving model ...
Epoch: 6 cost time: 1.1194260120391846
Epoch: 6, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.842 Vali Acc: 0.694 Test Loss: 0.842 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1672601699829102
Epoch: 7, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.760 Vali Acc: 0.678 Test Loss: 0.760 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.126967191696167
Epoch: 8, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.748 Vali Acc: 0.667 Test Loss: 0.748 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0963518619537354
Epoch: 9, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.613 Vali Acc: 0.739 Test Loss: 0.613 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738883).  Saving model ...
Epoch: 10 cost time: 0.9730172157287598
Epoch: 10, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.536 Vali Acc: 0.778 Test Loss: 0.536 Test Acc: 0.778
Validation loss decreased (-0.738883 --> -0.777772).  Saving model ...
Epoch: 11 cost time: 1.0422570705413818
Epoch: 11, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.523 Vali Acc: 0.772 Test Loss: 0.523 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8338711261749268
Epoch: 12, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.538 Vali Acc: 0.744 Test Loss: 0.538 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0717768669128418
Epoch: 13, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.459 Vali Acc: 0.772 Test Loss: 0.459 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0098097324371338
Epoch: 14, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.458 Vali Acc: 0.789 Test Loss: 0.458 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 15 cost time: 1.1394059658050537
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.407 Vali Acc: 0.822 Test Loss: 0.407 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 0.9625377655029297
Epoch: 16, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 0.8945386409759521
Epoch: 17, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.419 Vali Acc: 0.806 Test Loss: 0.419 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8993651866912842
Epoch: 18, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9464981555938721
Epoch: 19, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9561636447906494
Epoch: 20, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 21 cost time: 0.9182770252227783
Epoch: 21, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.367 Vali Acc: 0.800 Test Loss: 0.367 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.044926643371582
Epoch: 22, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 1.249863862991333
Epoch: 23, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.334 Vali Acc: 0.833 Test Loss: 0.334 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.119882345199585
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.2798047065734863
Epoch: 25, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.387 Vali Acc: 0.828 Test Loss: 0.387 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1760532855987549
Epoch: 26, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.334 Vali Acc: 0.828 Test Loss: 0.334 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9597659111022949
Epoch: 27, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0317776203155518
Epoch: 28, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.450 Vali Acc: 0.817 Test Loss: 0.450 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8442819118499756
Epoch: 29, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8887951374053955
Epoch: 30, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.405 Vali Acc: 0.817 Test Loss: 0.405 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9057791233062744
Epoch: 31, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2517173290252686
Epoch: 32, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0785715579986572
Epoch: 33, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.382 Vali Acc: 0.867 Test Loss: 0.382 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 34 cost time: 1.0939743518829346
Epoch: 34, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.484 Vali Acc: 0.817 Test Loss: 0.484 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.070429801940918
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.391 Vali Acc: 0.828 Test Loss: 0.391 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.939058780670166
Epoch: 36, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9386775493621826
Epoch: 37, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9897470474243164
Epoch: 38, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.409 Vali Acc: 0.844 Test Loss: 0.409 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9791481494903564
Epoch: 39, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1928517818450928
Epoch: 40, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0150928497314453
Epoch: 41, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.424 Vali Acc: 0.839 Test Loss: 0.424 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9632537364959717
Epoch: 42, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.2443032264709473
Epoch: 43, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 105470
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.257932186126709
Epoch: 1, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.764 Vali Acc: 0.217 Test Loss: 1.764 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 1.3596115112304688
Epoch: 2, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.586 Vali Acc: 0.428 Test Loss: 1.586 Test Acc: 0.428
Validation loss decreased (-0.216649 --> -0.427762).  Saving model ...
Epoch: 3 cost time: 1.3753602504730225
Epoch: 3, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.362 Vali Acc: 0.589 Test Loss: 1.362 Test Acc: 0.589
Validation loss decreased (-0.427762 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 1.3238131999969482
Epoch: 4, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.160 Vali Acc: 0.683 Test Loss: 1.160 Test Acc: 0.683
Validation loss decreased (-0.588875 --> -0.683322).  Saving model ...
Epoch: 5 cost time: 1.145744800567627
Epoch: 5, Steps: 12 | Train Loss: 1.080 Vali Loss: 0.998 Vali Acc: 0.694 Test Loss: 0.998 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 6 cost time: 1.1833579540252686
Epoch: 6, Steps: 12 | Train Loss: 0.896 Vali Loss: 0.838 Vali Acc: 0.756 Test Loss: 0.838 Test Acc: 0.756
Validation loss decreased (-0.694434 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 1.0670936107635498
Epoch: 7, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.744 Vali Acc: 0.678 Test Loss: 0.744 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.142552137374878
Epoch: 8, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.661 Vali Acc: 0.744 Test Loss: 0.661 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2314612865447998
Epoch: 9, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.613 Vali Acc: 0.717 Test Loss: 0.613 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1774346828460693
Epoch: 10, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0497827529907227
Epoch: 11, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.565 Vali Acc: 0.756 Test Loss: 0.565 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755550).  Saving model ...
Epoch: 12 cost time: 1.1084041595458984
Epoch: 12, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.485 Vali Acc: 0.767 Test Loss: 0.485 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 13 cost time: 0.9717011451721191
Epoch: 13, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.440 Vali Acc: 0.822 Test Loss: 0.440 Test Acc: 0.822
Validation loss decreased (-0.766662 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 1.1114873886108398
Epoch: 14, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.464 Vali Acc: 0.794 Test Loss: 0.464 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.515648365020752
Epoch: 15, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 1.1443166732788086
Epoch: 16, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0738027095794678
Epoch: 17, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0898048877716064
Epoch: 18, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.418 Vali Acc: 0.806 Test Loss: 0.418 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1547186374664307
Epoch: 19, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9930925369262695
Epoch: 20, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.406 Vali Acc: 0.822 Test Loss: 0.406 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9923543930053711
Epoch: 21, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 22 cost time: 1.0577659606933594
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.395 Vali Acc: 0.811 Test Loss: 0.395 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0315802097320557
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.365 Vali Acc: 0.872 Test Loss: 0.365 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 1.1350910663604736
Epoch: 24, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.350 Vali Acc: 0.817 Test Loss: 0.350 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0111992359161377
Epoch: 25, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0859355926513672
Epoch: 26, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.498 Vali Acc: 0.811 Test Loss: 0.498 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1814701557159424
Epoch: 27, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.517 Vali Acc: 0.800 Test Loss: 0.517 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0923469066619873
Epoch: 28, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.295743703842163
Epoch: 29, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.375 Vali Acc: 0.839 Test Loss: 0.375 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0793178081512451
Epoch: 30, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2352793216705322
Epoch: 31, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0489020347595215
Epoch: 32, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0063543319702148
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 105310
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8062314987182617
Epoch: 1, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.792 Vali Acc: 0.150 Test Loss: 1.792 Test Acc: 0.150
Validation loss decreased (inf --> -0.149982).  Saving model ...
Epoch: 2 cost time: 1.1622271537780762
Epoch: 2, Steps: 12 | Train Loss: 1.727 Vali Loss: 1.607 Vali Acc: 0.444 Test Loss: 1.607 Test Acc: 0.444
Validation loss decreased (-0.149982 --> -0.444428).  Saving model ...
Epoch: 3 cost time: 1.1453404426574707
Epoch: 3, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.391 Vali Acc: 0.606 Test Loss: 1.391 Test Acc: 0.606
Validation loss decreased (-0.444428 --> -0.605542).  Saving model ...
Epoch: 4 cost time: 1.0433506965637207
Epoch: 4, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.171 Vali Acc: 0.672 Test Loss: 1.171 Test Acc: 0.672
Validation loss decreased (-0.605542 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 1.3517255783081055
Epoch: 5, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.973 Vali Acc: 0.717 Test Loss: 0.973 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 1.089930772781372
Epoch: 6, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.850 Vali Acc: 0.717 Test Loss: 0.850 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716658).  Saving model ...
Epoch: 7 cost time: 1.0939555168151855
Epoch: 7, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.721 Vali Acc: 0.706 Test Loss: 0.721 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1041626930236816
Epoch: 8, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.652 Vali Acc: 0.733 Test Loss: 0.652 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 1.0054833889007568
Epoch: 9, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.604 Vali Acc: 0.733 Test Loss: 0.604 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733327).  Saving model ...
Epoch: 10 cost time: 1.142059087753296
Epoch: 10, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
Validation loss decreased (-0.733327 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 0.9316685199737549
Epoch: 11, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0456562042236328
Epoch: 12, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.493 Vali Acc: 0.800 Test Loss: 0.493 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 13 cost time: 0.9356415271759033
Epoch: 13, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.476 Vali Acc: 0.800 Test Loss: 0.476 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 14 cost time: 1.0799059867858887
Epoch: 14, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.461 Vali Acc: 0.767 Test Loss: 0.461 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2188551425933838
Epoch: 15, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.429 Vali Acc: 0.806 Test Loss: 0.429 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 16 cost time: 1.0887494087219238
Epoch: 16, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.484 Vali Acc: 0.772 Test Loss: 0.484 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0145297050476074
Epoch: 17, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 0.9836878776550293
Epoch: 18, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.444 Vali Acc: 0.794 Test Loss: 0.444 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1568362712860107
Epoch: 19, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.374 Vali Acc: 0.856 Test Loss: 0.374 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 1.2859938144683838
Epoch: 20, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.390 Vali Acc: 0.828 Test Loss: 0.390 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.137099027633667
Epoch: 21, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.375 Vali Acc: 0.794 Test Loss: 0.375 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2102208137512207
Epoch: 22, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.355 Vali Acc: 0.811 Test Loss: 0.355 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3234333992004395
Epoch: 23, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9707424640655518
Epoch: 24, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.475 Vali Acc: 0.811 Test Loss: 0.475 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0026512145996094
Epoch: 25, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.413 Vali Acc: 0.839 Test Loss: 0.413 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0309123992919922
Epoch: 26, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.010948896408081
Epoch: 27, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1026074886322021
Epoch: 28, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2380387783050537
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_Crossformer_UEA_ftM_sl51_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 105150
model size : 1.08MB
