Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        0                   
  Model ID:           CLS_SelfRegulationSCP2Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints_best/FEDformer

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
fourier enhanced block used!
modes=32, index=[1, 28, 32, 52, 90, 98, 106, 125, 141, 165, 167, 199, 200, 201, 258, 296, 297, 303, 320, 334, 360, 362, 376, 389, 408, 428, 450, 486, 487, 498, 552, 553]
fourier enhanced block used!
modes=32, index=[16, 18, 19, 38, 61, 62, 63, 65, 94, 110, 111, 113, 127, 128, 130, 142, 152, 154, 175, 176, 178, 187, 190, 201, 204, 214, 215, 235, 259, 270, 279, 281]
 fourier enhanced cross attention used!
modes_q=32, index_q=[7, 10, 13, 27, 35, 44, 47, 52, 56, 88, 92, 105, 106, 114, 116, 119, 125, 140, 148, 151, 152, 173, 184, 200, 209, 211, 213, 217, 220, 259, 268, 277]
modes_kv=32, index_kv=[31, 40, 71, 79, 121, 127, 147, 148, 162, 169, 187, 199, 235, 237, 244, 250, 256, 264, 344, 352, 373, 387, 396, 404, 472, 482, 501, 542, 556, 561, 566, 571]
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_FEDformer_UEA_ftM_sl1152_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
loading model
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5944444444444444
model parameter : 1352450
model size : 10.07MB
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 186, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/yoom618/TSLib/exp/exp_long_term_forecasting.py", line 2, in <module>
    from exp.exp_basic import Exp_Basic
  File "/home/yoom618/TSLib/exp/exp_basic.py", line 3, in <module>
    from models import Autoformer, Transformer, TimesNet, Nonstationary_Transformer, DLinear, FEDformer, \
  File "/home/yoom618/TSLib/models/Transformer.py", line 5, in <module>
    from layers.SelfAttention_Family import FullAttention, AttentionLayer
  File "/home/yoom618/TSLib/layers/SelfAttention_Family.py", line 6, in <module>
    from reformer_pytorch import LSHSelfAttention
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/reformer_pytorch/__init__.py", line 1, in <module>
    from reformer_pytorch.reformer_pytorch import LSHAttention, LSHSelfAttention, Reformer, ReformerLM
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/reformer_pytorch/reformer_pytorch.py", line 11, in <module>
    from local_attention import LocalAttention
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/local_attention/__init__.py", line 2, in <module>
    from local_attention.transformer import LocalTransformer, LocalMHA, DynamicPositionBias
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/local_attention/transformer.py", line 15, in <module>
    from hyper_connections import get_init_and_expand_reduce_stream_functions
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/hyper_connections/__init__.py", line 1, in <module>
    from hyper_connections.hyper_connections import (
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/hyper_connections/hyper_connections.py", line 14, in <module>
    from einops.layers.torch import Reduce
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/einops/layers/torch.py", line 7, in <module>
    from .._torch_specific import apply_for_scriptable_torch
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/einops/_torch_specific.py", line 128, in <module>
    allow_ops_in_compiled_graph()
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/einops/_torch_specific.py", line 107, in allow_ops_in_compiled_graph
    from torch._dynamo import allow_in_graph
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/_dynamo/__init__.py", line 3, in <module>
    from . import convert_frame, eval_frame, resume_execution
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 33, in <module>
    from torch._dynamo.symbolic_convert import TensorifyState
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 30, in <module>
    from . import config, exc, logging as torchdynamo_logging, trace_rules, variables
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/_dynamo/trace_rules.py", line 46, in <module>
    from .variables import (
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/_dynamo/variables/__init__.py", line 2, in <module>
    from .builtin import BuiltinVariable
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py", line 53, in <module>
    from .ctx_manager import EventVariable, StreamVariable
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/_dynamo/variables/ctx_manager.py", line 22, in <module>
    from .functions import (
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 33, in <module>
    from torch.distributed.fsdp._fully_shard import _fsdp_param_group
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/distributed/fsdp/__init__.py", line 1, in <module>
    from ._flat_param import FlatParameter as FlatParameter
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/distributed/fsdp/_flat_param.py", line 47, in <module>
    from ._fsdp_extensions import (
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/distributed/fsdp/_fsdp_extensions.py", line 8, in <module>
    from torch.distributed.fsdp._shard_utils import (
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/distributed/fsdp/_shard_utils.py", line 18, in <module>
    from torch.distributed.tensor import DeviceMesh, DTensor, Replicate, Shard as DShard
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/distributed/tensor/__init__.py", line 4, in <module>
    import torch.distributed.tensor._ops  # force import all built-in dtensor ops
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/distributed/tensor/_ops/__init__.py", line 5, in <module>
    from ._math_ops import *  # noqa: F403
    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap_external>", line 1091, in get_code
  File "<frozen importlib._bootstrap_external>", line 1191, in get_data
KeyboardInterrupt
